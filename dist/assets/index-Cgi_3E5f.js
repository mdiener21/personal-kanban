import{l as J,g as fn,s as Ee,a as ae,b as He,c as le,d as Pt,e as X,f as Mt,h as jn,i as It,j as Wn,k as ze,r as xe,m as pn,n as hn,o as xo,p as Ao}from"./storage-oGbS4rzY.js";const _o=new Set(["low","medium","high"]);function qn(e){const t=(e||"").toString().trim().toLowerCase();return _o.has(t)?t:"low"}function Gn(e){return(e||"").toString().trim()}function No(e,t,o,n,a,i=[]){if(!e||e.trim()==="")return;const l=J(),r=l.filter(m=>m.column===a).slice().sort((m,f)=>(m.order??0)-(f.order??0)),s=new Map;r.forEach((m,f)=>{s.set(m.id,f+2)});const d=l.map(m=>{if(m.column!==a)return m;const f=s.get(m.id);return typeof f=="number"?{...m,order:f}:m}),c=new Date().toISOString(),u={id:fn(),title:e.trim(),description:(t||"").toString().trim(),priority:qn(o),dueDate:Gn(n),column:a,order:1,labels:[...i],creationDate:c,changeDate:c,columnHistory:[{column:a,at:c}],...a==="done"?{doneDate:c}:{}};d.push(u),Ee(d)}function Oo(e,t,o,n,a,i,l=[]){if(!t||t.trim()==="")return;const r=J(),s=r.findIndex(d=>d.id===e);if(s!==-1){const d=r[s].column,c=i,u=new Date().toISOString();if(!Array.isArray(r[s].columnHistory)||r[s].columnHistory.length===0){const m=r[s].creationDate||r[s].changeDate||u,f=typeof d=="string"?d:c;r[s].columnHistory=[{column:f,at:m}]}r[s].title=t.trim(),r[s].description=(o||"").toString().trim(),r[s].priority=qn(n),r[s].dueDate=Gn(a),r[s].column=c,r[s].labels=[...l],d!==c&&r[s].columnHistory.push({column:c,at:u}),d!=="done"&&c==="done"?r[s].doneDate=u:d==="done"&&c!=="done"&&delete r[s].doneDate,r[s].changeDate=u,Ee(r)}}function Po(e){const o=J().filter(n=>n.id!==e);return Ee(o),!0}function Mo(){const e=[];return document.querySelectorAll(".task-column").forEach(t=>{const o=t.dataset.column;t.querySelectorAll(".task").forEach(n=>{e.push({id:n.dataset.taskId,column:o})})}),e}function Ro(){const e=Mo(),t=J(),o=new Date().toISOString(),n=t.map(a=>{const i=e.findIndex(l=>l.id===a.id);if(i!==-1){const l=e[i],r=e.filter((m,f)=>m.column===l.column&&f<=i),s=l.column,d=r.length,c=a.column!==s,u={...a,column:s,order:d,...c?{changeDate:o}:{}};if(c){const m=Array.isArray(a.columnHistory)&&a.columnHistory.length?[...a.columnHistory]:[{column:a.column,at:a.creationDate||a.changeDate||o}];m.push({column:s,at:o}),u.columnHistory=m,a.column!=="done"&&s==="done"?u.doneDate=o:a.column==="done"&&s!=="done"&&delete u.doneDate}return{...u}}return a});Ee(n)}function Fo(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function Vn(e){return Fo(e)?e.trim():"#3b82f6"}function $o(e,t){if(!e||e.trim()==="")return;const o=ae(),n=o.reduce((l,r)=>Math.max(l,r.order??0),0),i={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+fn().substring(0,8),name:e.trim(),color:Vn(t),order:n-1,collapsed:!1};o.push(i),He(o)}function Ho(e){const t=typeof e=="string"?e.trim():"";if(!t)return!1;const o=ae(),n=o.find(a=>a.id===t);return n?(n.collapsed=n.collapsed!==!0,He(o),!0):!1}function zo(e,t,o){if(!t||t.trim()==="")return;const n=ae(),a=n.findIndex(i=>i.id===e);a!==-1&&(n[a].name=t.trim(),n[a].color=Vn(o),He(n))}function Yo(e){if(e==="done")return!1;const t=ae();if(t.length<=1)return!1;const o=J();if(o.filter(i=>i.column===e).length>0){const i=o.filter(l=>l.column!==e);Ee(i)}const a=t.filter(i=>i.id!==e);return He(a),!0}function Uo(){const t=document.getElementById("board-container").querySelectorAll(".task-column"),o=ae();t.forEach((n,a)=>{const i=n.dataset.column,l=o.find(r=>r.id===i);l&&(l.order=a+1)}),He(o)}const Xo="modulepreload",jo=function(e,t){return new URL(e,t).href},Ln={},ce=function(t,o,n){let a=Promise.resolve();if(o&&o.length>0){let d=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const l=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),s=r?.nonce||r?.getAttribute("nonce");a=d(o.map(c=>{if(c=jo(c,n),c in Ln)return;Ln[c]=!0;const u=c.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(n)for(let p=l.length-1;p>=0;p--){const g=l[p];if(g.href===c&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Xo,u||(f.as="script"),f.crossOrigin="",f.href=c,s&&f.setAttribute("nonce",s),document.head.appendChild(f),u)return new Promise((p,g)=>{f.addEventListener("load",p),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l}return a.then(l=>{for(const r of l||[])r.status==="rejected"&&i(r.reason);return t().catch(i)})},gn=40;function bn(e){return e.trim().slice(0,gn).toLowerCase().replace(/\s+/g," ")}function Kn(e,t,o=null){return e.some(n=>o&&n.id===o?!1:bn(n.name)===t)}function Wo(e,t){if(!e||e.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const o=e.trim().slice(0,gn),n=bn(o),a=le();if(Kn(a,n))return{success:!1,reason:"DUPLICATE_NAME",message:`Label "${o}" already exists.`};const l={id:n.replace(/\s+/g,"-")+"-"+fn().substring(0,8),name:o,color:t};return a.push(l),Pt(a),{success:!0,label:l}}function qo(e,t,o){if(!t||t.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const n=t.trim().slice(0,gn),a=bn(n),i=le(),l=i.findIndex(r=>r.id===e);return l===-1?{success:!1,reason:"NOT_FOUND"}:Kn(i,a,e)?{success:!1,reason:"DUPLICATE_NAME",message:`Another label with the name "${n}" already exists.`}:(i[l].name=n,i[l].color=o,Pt(i),{success:!0,label:i[l]})}function Go(e){const t=le(),o=J();o.forEach(a=>{a.labels&&(a.labels=a.labels.filter(i=>i!==e))}),Ee(o);const n=t.filter(a=>a.id!==e);Pt(n)}let St=null;function oe(e){return document.getElementById(e)}function ut(e){const t=oe("dialog-modal");t&&t.classList.add("hidden");const o=St;St=null,typeof o=="function"&&o(!!e)}function Vo(){const e=oe("dialog-modal");return e&&!e.classList.contains("hidden")}function Jn({title:e,message:t,confirmText:o,cancelText:n,showCancel:a}){const i=oe("dialog-modal-title"),l=oe("dialog-modal-message"),r=oe("dialog-confirm-btn"),s=oe("dialog-cancel-btn");i&&(i.textContent=e||"Confirm"),l&&(l.textContent=t||""),r&&(r.textContent=o||"OK"),s&&(s.textContent=n||"Cancel"),s&&(s.style.display=a?"inline-flex":"none")}function Qn(){const e=oe("dialog-modal");if(!e||e.dataset.handlersAttached==="true")return;e.dataset.handlersAttached="true";const t=oe("dialog-confirm-btn"),o=oe("dialog-cancel-btn");e.querySelector(".modal-backdrop"),t?.addEventListener("click",()=>ut(!0)),o?.addEventListener("click",()=>ut(!1)),te("dialog-modal",()=>ut(!1)),document.addEventListener("keydown",n=>{n.key==="Escape"&&Vo()&&ut(!1)})}function Zn(){const e=oe("dialog-modal");if(!e)return;e.classList.remove("hidden"),oe("dialog-confirm-btn")?.focus()}function Te({title:e="Confirm",message:t="",confirmText:o="Delete",cancelText:n="Cancel"}={}){return Qn(),Jn({title:e,message:t,confirmText:o,cancelText:n,showCancel:!0}),Zn(),new Promise(a=>{St=a})}function de({title:e="Notice",message:t="",okText:o="OK"}={}){return Qn(),Jn({title:e,message:t,confirmText:o,cancelText:"",showCancel:!1}),Zn(),new Promise(n=>{St=()=>n(!0)})}function Yt(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return Array.isArray(o)?o:null}catch{return null}}function Ko(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return o&&typeof o=="object"&&!Array.isArray(o)?o:null}catch{return null}}function eo(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function Jo(e){const t=document.getElementById("brand-text")||document.querySelector(".brand-text");t&&(t.textContent=Mt());const o=document.getElementById("board-select");if(!o)return;const n=ze();o.innerHTML="",n.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=eo(a),o.appendChild(i)}),e&&(o.value=e)}function Qo(e){const t=typeof e?.name=="string"?e.name.trim():"";return t?t.replace(/\.[^.]+$/,"").trim():""}function Rt(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const Zo=new Set(["low","medium","high"]);function Ft(e){const t=(e||"").toString().trim().toLowerCase();return Zo.has(t)?t:"low"}function ea(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},o=t.showPriority!==!1,n=t.showDueDate!==!1,a=t.showAge!==!1,i=t.showChangeDate!==!1,l=typeof t.locale=="string"&&t.locale.trim()?t.locale.trim():typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US",r=Ft(t.defaultPriority),s=Number.parseInt((t.notificationDays??"").toString(),10),d=Number.isFinite(s)?Math.min(365,Math.max(0,s)):3;return{showPriority:o,showDueDate:n,showAge:a,showChangeDate:i,locale:l,defaultPriority:r,notificationDays:d}}function to(e){const t=(e||"").toString().trim();return t.length>=10&&t.includes("T")?t.slice(0,10):t}function no(e){const t=typeof e?.text=="string"?e.text:"",o=typeof e?.title=="string"?e.title:t,n=typeof e?.description=="string"?e.description:"",a=to(e?.dueDate??e?.["due-date"]),i=typeof e?.changeDate=="string"?e.changeDate:typeof e?.changedDate=="string"?e.changedDate:void 0,l=e?.column==="done",r=typeof e?.doneDate=="string"?e.doneDate.toString().trim():"",s=Array.isArray(e?.columnHistory)?e.columnHistory.map(d=>{const c=typeof d?.column=="string"?d.column.trim():"",u=typeof d?.at=="string"?d.at.trim():"";return!c||!u?null:{column:c,at:u}}).filter(Boolean):void 0;return{...e,title:o.toString().trim(),description:n.toString().trim(),priority:Ft(e?.priority),dueDate:a,...typeof i=="string"?{changeDate:i.toString().trim()}:{},...l&&r?{doneDate:r}:{doneDate:void 0},...s&&s.length?{columnHistory:s}:{columnHistory:void 0},changedDate:void 0}}function ta(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.text=="string"?n.text:String(n?.text??""),l=typeof n?.title=="string"?n.title:i,r=typeof n?.description=="string"?n.description:String(n?.description??""),s=Ft(n?.priority),d=typeof n?.dueDate=="string"?n.dueDate:typeof n?.["due-date"]=="string"?n["due-date"]:String(n?.dueDate??n?.["due-date"]??""),c=to(d),u=typeof n?.column=="string"?n.column:String(n?.column??""),m=Array.isArray(n?.labels)?n.labels.map(C=>typeof C=="string"?C:String(C)):[],f=Number.isFinite(n?.order)?n.order:void 0,p=typeof n?.creationDate=="string"?n.creationDate:void 0,g=typeof n?.changeDate=="string"?n.changeDate:typeof n?.changedDate=="string"?n.changedDate:void 0,v=typeof n?.doneDate=="string"?n.doneDate.trim():"",B=u.trim()==="done"&&(v||(typeof g=="string"?g.trim():"")||p)||"",k=Array.isArray(n?.columnHistory)?n.columnHistory.map(C=>{const E=typeof C?.column=="string"?C.column.trim():String(C?.column??"").trim(),D=typeof C?.at=="string"?C.at.trim():String(C?.at??"").trim();return!E||!D?null:{column:E,at:D}}).filter(Boolean):void 0;return{id:a.trim(),title:l.trim(),description:r.trim(),priority:s,dueDate:c.trim(),column:u.trim(),...f!==void 0?{order:f}:{},...p?{creationDate:p}:{},...typeof g=="string"&&g.trim()?{changeDate:g.trim()}:{},...B?{doneDate:B}:{},...k&&k.length?{columnHistory:k}:{},labels:m}});return t.every(n=>n.id&&n.title&&n.column)?t:null}function na(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),l=Number.isFinite(n?.order)?n.order:void 0,r=Rt(n?.color)?n.color.trim():"#3b82f6",s=n?.collapsed===!0;return{id:a.trim(),name:i.trim(),color:r,collapsed:s,...l!==void 0?{order:l}:{}}});if(!t.some(n=>n.id==="done")){const n=t.reduce((a,i)=>Math.max(a,Number.isFinite(i?.order)?i.order:0),0);t.push({id:"done",name:"Done",color:"#16a34a",order:n+1,collapsed:!1})}return t.every(n=>n.id&&n.name)?t:null}function oa(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),l=Rt(n?.color)?n.color.trim():"#3b82f6";return{id:a.trim(),name:i.trim(),color:l}});return t.every(n=>n.id&&n.name&&n.color)?t:null}function aa(e){if(!e||typeof e!="object"||Array.isArray(e))return null;const t=e.showPriority!==!1,o=e.showDueDate!==!1,n=e.showAge!==!1,a=e.showChangeDate!==!1,i=typeof e.locale=="string"&&e.locale.trim()?e.locale.trim():void 0,l=typeof e.defaultPriority=="string"?e.defaultPriority:void 0,r=l?Ft(l):void 0,s=Number.parseInt((e.notificationDays??"").toString(),10),d=Number.isFinite(s)?Math.min(365,Math.max(0,s)):void 0;return{showPriority:t,showDueDate:o,showAge:n,showChangeDate:a,...i?{locale:i}:{},...r?{defaultPriority:r}:{},...d!==void 0?{notificationDays:d}:{}}}function ia(){const e=J().map(no),t=ae().map(c=>({...c,color:Rt(c?.color)?c.color.trim():"#3b82f6"})),o=le(),n=X(),a=Mt(),l=JSON.stringify({boardName:a,columns:t,tasks:e,labels:o,settings:n},null,2),r=new Blob([l],{type:"application/json"}),s=URL.createObjectURL(r),d=document.createElement("a");d.href=s,d.download=`${a.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(s)}function ra(e){const t=typeof e=="string"?e.trim():"";if(!t)return;const o=ze().find(E=>E.id===t),n=eo(o),a=`kanbanBoard:${t}:columns`,i=`kanbanBoard:${t}:tasks`,l=`kanbanBoard:${t}:labels`,r=`kanbanBoard:${t}:settings`,s=Yt(i)||[],d=Yt(a)||[],c=Yt(l)||[],u=Ko(r)||null,m=s.map(no),f=d.map(E=>({...E,color:Rt(E?.color)?E.color.trim():"#3b82f6",collapsed:E?.collapsed===!0})),p=Array.isArray(c)?c:[],g=ea(u),S=JSON.stringify({boardName:n,columns:f,tasks:m,labels:p,settings:g},null,2),B=new Blob([S],{type:"application/json"}),k=URL.createObjectURL(B),C=document.createElement("a");C.href=k,C.download=`${n.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(k)}function la(e){const t=new FileReader;t.onload=async o=>{try{const n=JSON.parse(o.target.result);let a,i,l,r,s;if(Array.isArray(n))a=n,i=null,l=null,r=null,s=null;else if(n.tasks&&n.columns)a=n.tasks,i=n.columns,l=Object.prototype.hasOwnProperty.call(n,"labels")?n.labels:null,r=Object.prototype.hasOwnProperty.call(n,"settings")?n.settings:null,s=typeof n.boardName=="string"?n.boardName.trim():null;else{alert("Invalid JSON file format");return}const d=ta(a),c=i?na(i):null,u=l?oa(l):null,m=r?aa(r):null;if(!d||i&&!c||l&&!u||r&&!m){alert("Invalid data structure");return}const f=s||Qo(e)||"Imported board",p=jn(f);if(p?.id&&It(p.id),c&&He(c),Ee(d),u&&Pt(u),m){const v=X();Wn({...v,...m})}Jo(p?.id);const{renderBoard:g}=await ce(async()=>{const{renderBoard:v}=await Promise.resolve().then(()=>me);return{renderBoard:v}},void 0,import.meta.url);g(),document.dispatchEvent(new CustomEvent("kanban:boards-changed")),alert("Board imported successfully!")}catch(n){alert("Error parsing JSON file: "+n.message)}},t.readAsText(e)}function oo(e,t){if(!e)return;const o=e.closest(".form-group");if(!o)return;o.classList.add("error");let n=o.querySelector(".error-message");n||(n=document.createElement("div"),n.classList.add("error-message"),o.appendChild(n)),n.textContent=t,e.focus()}function Ye(e){if(!e)return;const t=e.closest(".form-group");t&&t.classList.remove("error")}function sa(e){return(e?.trim()||"").length>0}function da(e){const t=e?.value?.trim()||"";return sa(t)?(Ye(e),!0):(oo(e,"Task title is required"),!1)}function ca(e){return(e?.trim()||"").length>0}function ua(e){const t=e?.value?.trim()||"";return ca(t)?(Ye(e),!0):(oo(e,"Column name is required"),!1)}let In="todo",ot=null,at=null,Ve=null,Bt=null,j=[],ve=!1,rt=!1;const Ce=40;let Xe=!1;function $t(e){const t=document.getElementById("task-modal");if(!t)return;t.classList.toggle("fullscreen",!!e);const o=document.getElementById("task-fullpage-btn");if(o?.setAttribute("aria-pressed",e?"true":"false"),o){const n=o.querySelector("[data-lucide]");n&&n.setAttribute("data-lucide",e?"minimize-2":"maximize-2"),o.title=e?"Exit full page":"Open in full page"}xe()}function De(e){const t=document.getElementById(e);return!!t&&!t.classList.contains("hidden")}function te(e,t){const o=document.getElementById(e);if(!o)return;o.querySelector(".modal-backdrop")?.addEventListener("click",t),o.querySelectorAll('[id$="-close-btn"], [id$="-close-modal-btn"], [id$="-cancel-btn"], [id^="cancel-"]').forEach(i=>{i.addEventListener("click",t)})}function ma(){const e=document.getElementById("task-modal");e&&(e.classList.remove("hidden"),Fe(),document.getElementById("task-label-search")?.focus(),ve=!1)}function fa(){return(document.getElementById("task-label-search")?.value||"").trim().toLowerCase()}function pa(){return(document.getElementById("labels-search")?.value||"").trim().toLowerCase()}function rn(){const e=document.getElementById("task-active-labels");if(!e)return;const t=le(),o=[];for(const a of j)o.includes(a)||o.push(a);j=o;const n=o.map(a=>t.find(i=>i.id===a)).filter(Boolean);e.innerHTML="",e.style.display=n.length>0?"flex":"none",n.forEach(a=>{const i=document.createElement("span");i.classList.add("task-label"),i.style.backgroundColor=a.color,i.textContent=a.name;const l=document.createElement("button");l.type="button",l.classList.add("active-label-remove"),l.setAttribute("aria-label",`Remove label ${a.name}`),l.title="Remove label",l.textContent="Ã—",l.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation(),j=j.filter(s=>s!==a.id),rn(),Fe()}),i.appendChild(l),e.appendChild(i)})}function ha(e){In=e||ae()[0]?.id||"todo",ot=null,j=[],ve=!1,rt=!1,$t(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden");const t=document.getElementById("task-modal"),o=document.getElementById("task-column"),n=document.getElementById("task-title"),a=document.getElementById("task-description"),i=document.getElementById("task-priority"),l=document.getElementById("task-due-date"),r=document.getElementById("task-modal-title"),s=document.getElementById("task-submit-btn");if(Ye(n),r.textContent="Add New Task",s.textContent="Add Task",o.value=In,n.value="",a.value="",i){const c=X();i.value=c.defaultPriority||"low"}l&&(l.value="");const d=document.getElementById("task-label-search");d&&(d.value=""),Fe(),t.classList.remove("hidden"),n.focus()}function Ke(e){const o=J().find(g=>g.id===e);if(!o)return;ot=e,j=o.labels||[],ve=!1,rt=!1,$t(!1),document.getElementById("task-fullpage-btn")?.classList.remove("hidden");const n=document.getElementById("task-modal"),a=document.getElementById("task-column"),i=document.getElementById("task-title"),l=document.getElementById("task-description"),r=document.getElementById("task-priority"),s=document.getElementById("task-due-date"),d=document.getElementById("task-modal-title"),c=document.getElementById("task-submit-btn");Ye(i),d.textContent="Edit Task",c.textContent="Save Changes",a.value=o.column;const u=typeof o.text=="string"?o.text:"";i.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:u,l.value=typeof o.description=="string"?o.description:"",r&&(r.value=typeof o.priority=="string"?o.priority:"medium");const m=typeof o.dueDate=="string"?o.dueDate:"",f=m.includes("T")?m.slice(0,10):m;s&&(s.value=f);const p=document.getElementById("task-label-search");p&&(p.value=""),Fe(),n.classList.remove("hidden"),i.focus()}function Ut(){document.getElementById("task-modal").classList.add("hidden"),ot=null,ve=!1,$t(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden")}function ga(){at=null;const e=document.getElementById("column-modal"),t=document.getElementById("column-name"),o=document.getElementById("column-color"),n=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");Ye(t),n.textContent="Add New Column",a.textContent="Add Column",t.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),t.focus()}function ba(e){const o=ae().find(s=>s.id===e);if(!o)return;at=e;const n=document.getElementById("column-modal"),a=document.getElementById("column-name"),i=document.getElementById("column-color"),l=document.getElementById("column-modal-title"),r=document.getElementById("column-submit-btn");Ye(a),l.textContent="Edit Column",r.textContent="Save Changes",a.value=o.name,i&&(i.value=o.color||"#3b82f6"),n.classList.remove("hidden"),a.focus()}function Xt(){document.getElementById("column-modal").classList.add("hidden"),at=null}function ya(){const e=document.getElementById("labels-search");e&&(e.value=""),Tt(),document.getElementById("labels-modal").classList.remove("hidden"),ve||document.getElementById("labels-search")?.focus()}function jt(){document.getElementById("labels-modal").classList.add("hidden");const t=document.getElementById("labels-search");t&&(t.value=""),ve&&ma()}function va(){document.getElementById("help-modal").classList.remove("hidden")}function Sn(){document.getElementById("help-modal").classList.add("hidden")}const Ea=/^#[0-9a-fA-F]{6}$/;function Bn(e){return Ea.test(e)}function ao(e){const t=document.getElementById("label-color-hex");t&&(t.value=e,t.classList.remove("invalid"))}function kt(e=null,{openedFromTaskEditor:t=!1,initialName:o=""}={}){Ve=e,Xe=!1,rt=!!t;const n=document.getElementById("label-modal"),a=document.getElementById("label-modal-title"),i=document.getElementById("label-name"),l=document.getElementById("label-color"),r=document.getElementById("label-submit-btn");if(e){const d=le().find(c=>c.id===e);d&&(a.textContent="Edit Label",r.textContent="Update Label",i.value=d.name,l.value=d.color)}else a.textContent="Add Label",r.textContent="Add Label",i.value=o||"",l.value="#3b82f6";ao(l.value),n.classList.remove("hidden"),i.focus()}function Wt(){document.getElementById("label-modal").classList.add("hidden"),Ve=null,rt=!1}function Tt(){const e=document.getElementById("labels-list");e.innerHTML="";const t=le(),o=pa(),n=o?t.filter(a=>{const i=(a.name||"").toLowerCase(),l=(a.id||"").toLowerCase();return i.includes(o)||l.includes(o)}):t;if(n.length===0){const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent=o?"No matching labels":"No labels yet",e.appendChild(a);return}n.forEach(a=>{const i=document.createElement("div");i.classList.add("label-item"),i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="space-between";const l=document.createElement("span");l.classList.add("task-label"),l.style.backgroundColor=a.color,l.textContent=a.name;const r=document.createElement("div");r.classList.add("label-actions"),r.style.display="flex",r.style.gap="4px";const s=document.createElement("button");s.classList.add("btn-small");const d=document.createElement("span");d.dataset.lucide="pencil",s.appendChild(d),s.title="Edit label",s.addEventListener("click",()=>kt(a.id));const c=document.createElement("button");c.classList.add("btn-small","btn-danger");const u=document.createElement("span");u.dataset.lucide="trash-2",c.appendChild(u),c.title="Delete label",c.addEventListener("click",async()=>{if(await Te({title:"Delete Label",message:`Delete label "${a.name}"? This will remove it from all tasks.`,confirmText:"Delete"})){Go(a.id),Tt();const{renderBoard:f}=await ce(async()=>{const{renderBoard:p}=await Promise.resolve().then(()=>me);return{renderBoard:p}},void 0,import.meta.url);f()}}),r.appendChild(s),r.appendChild(c),i.appendChild(l),i.appendChild(r),e.appendChild(i)}),xe()}function ln(){const e=document.getElementById("board-select");if(!e)return;const t=ze(),o=hn();e.innerHTML="",t.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=typeof a.name=="string"&&a.name.trim()?a.name.trim():"Untitled board",e.appendChild(i)}),o&&(e.value=o);const n=document.getElementById("brand-text")||document.querySelector(".brand-text");n&&(n.textContent=Mt())}function it(){pn();const e=document.getElementById("boards-list");if(!e)return;e.innerHTML="";const t=ze(),o=hn();t.forEach(n=>{const a=document.createElement("div");a.classList.add("label-item"),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="10px";const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";const l=document.createElement("span");if(l.textContent=(n.name||"").toString(),i.appendChild(l),n.id===o){const g=document.createElement("span");g.classList.add("task-label"),g.style.backgroundColor="var(--color-primary)",g.textContent="Active",i.appendChild(g)}const r=document.createElement("div");r.classList.add("label-actions"),r.style.display="flex",r.style.gap="4px";const s=document.createElement("button");s.classList.add("btn-small"),s.textContent="Open",s.title="Open board",s.addEventListener("click",async()=>{It(n.id),ln(),it();const{renderBoard:g}=await ce(async()=>{const{renderBoard:v}=await Promise.resolve().then(()=>me);return{renderBoard:v}},void 0,import.meta.url);g()});const d=document.createElement("button");d.classList.add("btn-small"),d.type="button",d.title="Export board",d.setAttribute("aria-label",`Export board ${String(n.name||"Untitled board")}`);const c=document.createElement("span");c.dataset.lucide="download",d.appendChild(c),d.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),ra(n.id)});const u=document.createElement("button");u.classList.add("btn-small");const m=document.createElement("span");m.dataset.lucide="pencil",u.appendChild(m),u.title="Rename board",u.addEventListener("click",()=>Da(n.id));const f=document.createElement("button");f.classList.add("btn-small","btn-danger");const p=document.createElement("span");p.dataset.lucide="trash-2",f.appendChild(p),f.title="Delete board",f.addEventListener("click",async()=>{if(!await Te({title:"Delete Board",message:`Do you really want to delete the board "${n.name}"? This cannot be undone.`,confirmText:"Delete"}))return;if(!xo(n.id)){await de({title:"Unable to Delete",message:"Unable to delete board (you may be trying to delete the last board)."});return}ln(),it();const{renderBoard:S}=await ce(async()=>{const{renderBoard:B}=await Promise.resolve().then(()=>me);return{renderBoard:B}},void 0,import.meta.url);S()}),r.appendChild(s),r.appendChild(d),r.appendChild(u),r.appendChild(f),a.appendChild(i),a.appendChild(r),e.appendChild(a)}),xe()}function wa(){it(),document.getElementById("boards-modal")?.classList.remove("hidden")}function kn(){document.getElementById("boards-modal")?.classList.add("hidden")}function Ca(){const e=document.getElementById("boards-modal");!e||e.classList.contains("hidden")||it()}function Da(e){pn();const t=ze().find(l=>l.id===e);if(!t)return;Bt=e;const o=document.getElementById("board-rename-modal"),n=document.getElementById("board-rename-name"),a=document.getElementById("board-rename-modal-title"),i=document.getElementById("board-rename-submit-btn");a&&(a.textContent="Rename Board"),i&&(i.textContent="Save"),n&&(n.value=(t.name||"").toString()),o?.classList.remove("hidden"),n?.focus()}function qt(){document.getElementById("board-rename-modal")?.classList.add("hidden"),Bt=null}function Fe(){rn();const e=document.getElementById("task-labels-selection");e.innerHTML="";const t=fa(),o=le(),n=t?o.filter(a=>{const i=(a.name||"").toLowerCase(),l=(a.id||"").toLowerCase();return i.includes(t)||l.includes(t)}):o;if(n.length===0){if(t){const a=document.createElement("button");a.type="button",a.classList.add("labels-empty-button"),a.textContent=`No label found "${t}" - Create label`,a.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),kt(null,{openedFromTaskEditor:!0,initialName:t})}),e.appendChild(a)}else{const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent="No matching labels",e.appendChild(a)}return}n.forEach(a=>{const i=document.createElement("label");i.classList.add("label-checkbox");const l=document.createElement("input");l.type="checkbox",l.value=a.id,l.checked=j.includes(a.id),l.addEventListener("change",s=>{s.target.checked?j.includes(a.id)||j.push(a.id):j=j.filter(d=>d!==a.id),rn()});const r=document.createElement("span");r.classList.add("task-label","label-color-swatch"),r.style.backgroundColor=a.color,r.textContent=a.name,i.appendChild(l),i.appendChild(r),e.appendChild(i)})}function La(){document.addEventListener("kanban:boards-changed",()=>{Ca()}),document.getElementById("task-label-search")?.addEventListener("input",Fe),document.getElementById("labels-search")?.addEventListener("input",Tt),document.getElementById("task-add-label-btn")?.addEventListener("click",()=>{ve=!1,kt(null,{openedFromTaskEditor:!0})}),document.getElementById("task-fullpage-btn")?.addEventListener("click",()=>{const r=document.getElementById("task-modal");r&&$t(!r.classList.contains("fullscreen"))}),document.getElementById("task-form").addEventListener("submit",async r=>{r.preventDefault();const s=document.getElementById("task-title");if(!da(s))return;const d=s.value.trim(),c=document.getElementById("task-description").value,u=document.getElementById("task-priority")?.value,m=document.getElementById("task-due-date")?.value,f=document.getElementById("task-column").value;ot?Oo(ot,d,c,u,m,f,j):No(d,c,u,m,f,j),Ut();const{renderBoard:p}=await ce(async()=>{const{renderBoard:g}=await Promise.resolve().then(()=>me);return{renderBoard:g}},void 0,import.meta.url);p()}),te("task-modal",Ut),document.getElementById("column-form").addEventListener("submit",async r=>{r.preventDefault();const s=document.getElementById("column-name");if(!ua(s))return;const d=s.value.trim(),c=document.getElementById("column-color")?.value;at?zo(at,d,c):$o(d,c),Xt();const{renderBoard:u}=await ce(async()=>{const{renderBoard:m}=await Promise.resolve().then(()=>me);return{renderBoard:m}},void 0,import.meta.url);u()}),te("column-modal",Xt),document.getElementById("manage-labels-btn").addEventListener("click",ya),document.getElementById("add-label-btn").addEventListener("click",()=>kt()),te("labels-modal",jt);const a=document.getElementById("label-name");a?.addEventListener("beforeinput",r=>{if(!r||typeof r.data!="string"||r.data.length===0)return;const s=r.target;if(!s||typeof s.value!="string")return;const d=typeof s.selectionStart=="number"?s.selectionStart:s.value.length,c=typeof s.selectionEnd=="number"?s.selectionEnd:s.value.length;(s.value.slice(0,d)+r.data+s.value.slice(c)).trim().length<=Ce||(r.preventDefault(),!Xe&&(Xe=!0,de({title:"Label Name Too Long",message:`Label names are limited to ${Ce} characters.`})))});const i=document.getElementById("label-color");i?.addEventListener("input",r=>{ao(r.target.value)}),document.getElementById("label-color-hex")?.addEventListener("input",r=>{let s=r.target.value;s&&!s.startsWith("#")&&(s="#"+s),Bn(s)?(i.value=s,r.target.classList.remove("invalid")):r.target.classList.toggle("invalid",s.length>0)}),a?.addEventListener("input",r=>{const s=r.target;if(!s||typeof s.value!="string")return;const d=s.value.trim();d.length<=Ce||(s.value=d.slice(0,Ce),!Xe&&(Xe=!0,de({title:"Label Name Too Long",message:`Label names are limited to ${Ce} characters.`})))}),document.getElementById("label-form").addEventListener("submit",async r=>{r.preventDefault();const s=document.getElementById("label-name").value,d=document.getElementById("label-color-hex"),c=(d?.value||"").trim();let u;if(c&&c!==document.getElementById("label-color").value){const v=c.startsWith("#")?c:"#"+c;if(!Bn(v)){d?.classList.add("invalid"),await de({title:"Invalid Hex Color",message:"Please enter a valid hex color code (e.g. #3b82f6)."}),d?.focus();return}document.getElementById("label-color").value=v,u=v}else u=document.getElementById("label-color").value;const m=(s||"").trim();if(m.length>Ce){await de({title:"Label Name Too Long",message:`Label names are limited to ${Ce} characters.`});return}const f=!Ve,p=Ve?qo(Ve,m,u):Wo(m,u);if(!p?.success){let v="Unable to Save Label",S="Could not save label.";p?.reason==="DUPLICATE_NAME"?(v="Label Already Exists",S=p?.message||"A label with that name already exists (case-insensitive)."):p?.reason==="EMPTY_NAME"&&(v="Label Name Required",S="Please enter a label name."),await de({title:v,message:S}),document.getElementById("label-name")?.focus();return}f&&rt&&p?.label?.id&&(j.includes(p.label.id)||j.push(p.label.id),Fe(),document.getElementById("task-label-search")?.focus()),Wt(),Tt();const{renderBoard:g}=await ce(async()=>{const{renderBoard:v}=await Promise.resolve().then(()=>me);return{renderBoard:v}},void 0,import.meta.url);g(),ve&&f&&jt()}),te("label-modal",Wt),document.getElementById("manage-boards-btn")?.addEventListener("click",wa),document.getElementById("add-board-btn")?.addEventListener("click",async()=>{document.dispatchEvent(new CustomEvent("kanban:open-board-create"))}),document.getElementById("boards-import-btn")?.addEventListener("click",async()=>{await Te({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file")?.click()}),te("boards-modal",kn),document.getElementById("board-rename-form")?.addEventListener("submit",r=>{if(r.preventDefault(),!Bt)return;const d=(document.getElementById("board-rename-name")?.value||"").trim();if(!d){alert("Board name cannot be empty.");return}if(!Ao(Bt,d)){alert("Unable to rename board.");return}qt(),ln(),it(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),te("board-rename-modal",qt),document.getElementById("help-btn").addEventListener("click",va),te("help-modal",Sn),document.getElementById("add-column-btn").addEventListener("click",ga),document.addEventListener("keydown",r=>{if(r.key==="Escape"){if(De("label-modal")){Wt();return}if(De("labels-modal")){jt();return}if(De("board-rename-modal")){qt();return}if(De("boards-modal")){kn();return}if(De("help-modal")){Sn();return}if(De("column-modal")){Xt();return}De("task-modal")&&Ut()}})}function Tn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),o.push.apply(o,n)}return o}function re(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Tn(Object(o),!0).forEach(function(n){Ia(e,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Tn(Object(o)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))})}return e}function bt(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bt=function(t){return typeof t}:bt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(e)}function Ia(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function fe(){return fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},fe.apply(this,arguments)}function Sa(e,t){if(e==null)return{};var o={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(o[a]=e[a]);return o}function Ba(e,t){if(e==null)return{};var o=Sa(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var ka="1.15.6";function ue(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var he=ue(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),lt=ue(/Edge/i),xn=ue(/firefox/i),Je=ue(/safari/i)&&!ue(/chrome/i)&&!ue(/android/i),yn=ue(/iP(ad|od|hone)/i),io=ue(/chrome/i)&&ue(/android/i),ro={capture:!1,passive:!1};function I(e,t,o){e.addEventListener(t,o,!he&&ro)}function L(e,t,o){e.removeEventListener(t,o,!he&&ro)}function xt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function lo(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function ne(e,t,o,n){if(e){o=o||document;do{if(t!=null&&(t[0]===">"?e.parentNode===o&&xt(e,t):xt(e,t))||n&&e===o)return e;if(e===o)break}while(e=lo(e))}return null}var An=/\s+/g;function V(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(An," ").replace(" "+t+" "," ");e.className=(n+(o?" "+t:"")).replace(An," ")}}function y(e,t,o){var n=e&&e.style;if(n){if(o===void 0)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),t===void 0?o:o[t];!(t in n)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),n[t]=o+(typeof o=="string"?"":"px")}}function Me(e,t){var o="";if(typeof e=="string")o=e;else do{var n=y(e,"transform");n&&n!=="none"&&(o=n+" "+o)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(o)}function so(e,t,o){if(e){var n=e.getElementsByTagName(t),a=0,i=n.length;if(o)for(;a<i;a++)o(n[a],a);return n}return[]}function ie(){var e=document.scrollingElement;return e||document.documentElement}function M(e,t,o,n,a){if(!(!e.getBoundingClientRect&&e!==window)){var i,l,r,s,d,c,u;if(e!==window&&e.parentNode&&e!==ie()?(i=e.getBoundingClientRect(),l=i.top,r=i.left,s=i.bottom,d=i.right,c=i.height,u=i.width):(l=0,r=0,s=window.innerHeight,d=window.innerWidth,c=window.innerHeight,u=window.innerWidth),(t||o)&&e!==window&&(a=a||e.parentNode,!he))do if(a&&a.getBoundingClientRect&&(y(a,"transform")!=="none"||o&&y(a,"position")!=="static")){var m=a.getBoundingClientRect();l-=m.top+parseInt(y(a,"border-top-width")),r-=m.left+parseInt(y(a,"border-left-width")),s=l+i.height,d=r+i.width;break}while(a=a.parentNode);if(n&&e!==window){var f=Me(a||e),p=f&&f.a,g=f&&f.d;f&&(l/=g,r/=p,u/=p,c/=g,s=l+c,d=r+u)}return{top:l,left:r,bottom:s,right:d,width:u,height:c}}}function _n(e,t,o){for(var n=ye(e,!0),a=M(e)[t];n;){var i=M(n)[o],l=void 0;if(l=a>=i,!l)return n;if(n===ie())break;n=ye(n,!1)}return!1}function $e(e,t,o,n){for(var a=0,i=0,l=e.children;i<l.length;){if(l[i].style.display!=="none"&&l[i]!==b.ghost&&(n||l[i]!==b.dragged)&&ne(l[i],o.draggable,e,!1)){if(a===t)return l[i];a++}i++}return null}function vn(e,t){for(var o=e.lastElementChild;o&&(o===b.ghost||y(o,"display")==="none"||t&&!xt(o,t));)o=o.previousElementSibling;return o||null}function Q(e,t){var o=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==b.clone&&(!t||xt(e,t))&&o++;return o}function Nn(e){var t=0,o=0,n=ie();if(e)do{var a=Me(e),i=a.a,l=a.d;t+=e.scrollLeft*i,o+=e.scrollTop*l}while(e!==n&&(e=e.parentNode));return[t,o]}function Ta(e,t){for(var o in e)if(e.hasOwnProperty(o)){for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[o][n])return Number(o)}return-1}function ye(e,t){if(!e||!e.getBoundingClientRect)return ie();var o=e,n=!1;do if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var a=y(o);if(o.clientWidth<o.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||o.clientHeight<o.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!o.getBoundingClientRect||o===document.body)return ie();if(n||t)return o;n=!0}}while(o=o.parentNode);return ie()}function xa(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function Gt(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Qe;function co(e,t){return function(){if(!Qe){var o=arguments,n=this;o.length===1?e.call(n,o[0]):e.apply(n,o),Qe=setTimeout(function(){Qe=void 0},t)}}}function Aa(){clearTimeout(Qe),Qe=void 0}function uo(e,t,o){e.scrollLeft+=t,e.scrollTop+=o}function mo(e){var t=window.Polymer,o=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):o?o(e).clone(!0)[0]:e.cloneNode(!0)}function fo(e,t,o){var n={};return Array.from(e.children).forEach(function(a){var i,l,r,s;if(!(!ne(a,t.draggable,e,!1)||a.animated||a===o)){var d=M(a);n.left=Math.min((i=n.left)!==null&&i!==void 0?i:1/0,d.left),n.top=Math.min((l=n.top)!==null&&l!==void 0?l:1/0,d.top),n.right=Math.max((r=n.right)!==null&&r!==void 0?r:-1/0,d.right),n.bottom=Math.max((s=n.bottom)!==null&&s!==void 0?s:-1/0,d.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var q="Sortable"+new Date().getTime();function _a(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(a){if(!(y(a,"display")==="none"||a===b.ghost)){e.push({target:a,rect:M(a)});var i=re({},e[e.length-1].rect);if(a.thisAnimationDuration){var l=Me(a,!0);l&&(i.top-=l.f,i.left-=l.e)}a.fromRect=i}})}},addAnimationState:function(n){e.push(n)},removeAnimationState:function(n){e.splice(Ta(e,{target:n}),1)},animateAll:function(n){var a=this;if(!this.options.animation){clearTimeout(t),typeof n=="function"&&n();return}var i=!1,l=0;e.forEach(function(r){var s=0,d=r.target,c=d.fromRect,u=M(d),m=d.prevFromRect,f=d.prevToRect,p=r.rect,g=Me(d,!0);g&&(u.top-=g.f,u.left-=g.e),d.toRect=u,d.thisAnimationDuration&&Gt(m,u)&&!Gt(c,u)&&(p.top-u.top)/(p.left-u.left)===(c.top-u.top)/(c.left-u.left)&&(s=Oa(p,m,f,a.options)),Gt(u,c)||(d.prevFromRect=c,d.prevToRect=u,s||(s=a.options.animation),a.animate(d,p,u,s)),s&&(i=!0,l=Math.max(l,s),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},s),d.thisAnimationDuration=s)}),clearTimeout(t),i?t=setTimeout(function(){typeof n=="function"&&n()},l):typeof n=="function"&&n(),e=[]},animate:function(n,a,i,l){if(l){y(n,"transition",""),y(n,"transform","");var r=Me(this.el),s=r&&r.a,d=r&&r.d,c=(a.left-i.left)/(s||1),u=(a.top-i.top)/(d||1);n.animatingX=!!c,n.animatingY=!!u,y(n,"transform","translate3d("+c+"px,"+u+"px,0)"),this.forRepaintDummy=Na(n),y(n,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),y(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){y(n,"transition",""),y(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},l)}}}}function Na(e){return e.offsetWidth}function Oa(e,t,o,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))*n.animation}var _e=[],Vt={initializeByDefault:!0},st={mount:function(t){for(var o in Vt)Vt.hasOwnProperty(o)&&!(o in t)&&(t[o]=Vt[o]);_e.forEach(function(n){if(n.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),_e.push(t)},pluginEvent:function(t,o,n){var a=this;this.eventCanceled=!1,n.cancel=function(){a.eventCanceled=!0};var i=t+"Global";_e.forEach(function(l){o[l.pluginName]&&(o[l.pluginName][i]&&o[l.pluginName][i](re({sortable:o},n)),o.options[l.pluginName]&&o[l.pluginName][t]&&o[l.pluginName][t](re({sortable:o},n)))})},initializePlugins:function(t,o,n,a){_e.forEach(function(r){var s=r.pluginName;if(!(!t.options[s]&&!r.initializeByDefault)){var d=new r(t,o,t.options);d.sortable=t,d.options=t.options,t[s]=d,fe(n,d.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var l=this.modifyOption(t,i,t.options[i]);typeof l<"u"&&(t.options[i]=l)}},getEventProperties:function(t,o){var n={};return _e.forEach(function(a){typeof a.eventProperties=="function"&&fe(n,a.eventProperties.call(o[a.pluginName],t))}),n},modifyOption:function(t,o,n){var a;return _e.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[o]=="function"&&(a=i.optionListeners[o].call(t[i.pluginName],n))}),a}};function Pa(e){var t=e.sortable,o=e.rootEl,n=e.name,a=e.targetEl,i=e.cloneEl,l=e.toEl,r=e.fromEl,s=e.oldIndex,d=e.newIndex,c=e.oldDraggableIndex,u=e.newDraggableIndex,m=e.originalEvent,f=e.putSortable,p=e.extraEventProperties;if(t=t||o&&o[q],!!t){var g,v=t.options,S="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!he&&!lt?g=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(g=document.createEvent("Event"),g.initEvent(n,!0,!0)),g.to=l||o,g.from=r||o,g.item=a||o,g.clone=i,g.oldIndex=s,g.newIndex=d,g.oldDraggableIndex=c,g.newDraggableIndex=u,g.originalEvent=m,g.pullMode=f?f.lastPutMode:void 0;var B=re(re({},p),st.getEventProperties(n,t));for(var k in B)g[k]=B[k];o&&o.dispatchEvent(g),v[S]&&v[S].call(t,g)}}var Ma=["evt"],W=function(t,o){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=n.evt,i=Ba(n,Ma);st.pluginEvent.bind(b)(t,o,re({dragEl:h,parentEl:N,ghostEl:w,rootEl:x,nextEl:Be,lastDownEl:yt,cloneEl:A,cloneHidden:be,dragStarted:je,putSortable:$,activeSortable:b.active,originalEvent:a,oldIndex:Pe,oldDraggableIndex:Ze,newIndex:K,newDraggableIndex:ge,hideGhostForTarget:bo,unhideGhostForTarget:yo,cloneNowHidden:function(){be=!0},cloneNowShown:function(){be=!1},dispatchSortableEvent:function(r){U({sortable:o,name:r,originalEvent:a})}},i))};function U(e){Pa(re({putSortable:$,cloneEl:A,targetEl:h,rootEl:x,oldIndex:Pe,oldDraggableIndex:Ze,newIndex:K,newDraggableIndex:ge},e))}var h,N,w,x,Be,yt,A,be,Pe,K,Ze,ge,mt,$,Oe=!1,At=!1,_t=[],Le,ee,Kt,Jt,On,Pn,je,Ne,et,tt=!1,ft=!1,vt,H,Qt=[],sn=!1,Nt=[],Ht=typeof document<"u",pt=yn,Mn=lt||he?"cssFloat":"float",Ra=Ht&&!io&&!yn&&"draggable"in document.createElement("div"),po=(function(){if(Ht){if(he)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),ho=function(t,o){var n=y(t),a=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=$e(t,0,o),l=$e(t,1,o),r=i&&y(i),s=l&&y(l),d=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+M(i).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+M(l).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&r.float&&r.float!=="none"){var u=r.float==="left"?"left":"right";return l&&(s.clear==="both"||s.clear===u)?"vertical":"horizontal"}return i&&(r.display==="block"||r.display==="flex"||r.display==="table"||r.display==="grid"||d>=a&&n[Mn]==="none"||l&&n[Mn]==="none"&&d+c>a)?"vertical":"horizontal"},Fa=function(t,o,n){var a=n?t.left:t.top,i=n?t.right:t.bottom,l=n?t.width:t.height,r=n?o.left:o.top,s=n?o.right:o.bottom,d=n?o.width:o.height;return a===r||i===s||a+l/2===r+d/2},$a=function(t,o){var n;return _t.some(function(a){var i=a[q].options.emptyInsertThreshold;if(!(!i||vn(a))){var l=M(a),r=t>=l.left-i&&t<=l.right+i,s=o>=l.top-i&&o<=l.bottom+i;if(r&&s)return n=a}}),n},go=function(t){function o(i,l){return function(r,s,d,c){var u=r.options.group.name&&s.options.group.name&&r.options.group.name===s.options.group.name;if(i==null&&(l||u))return!0;if(i==null||i===!1)return!1;if(l&&i==="clone")return i;if(typeof i=="function")return o(i(r,s,d,c),l)(r,s,d,c);var m=(l?r:s).options.group.name;return i===!0||typeof i=="string"&&i===m||i.join&&i.indexOf(m)>-1}}var n={},a=t.group;(!a||bt(a)!="object")&&(a={name:a}),n.name=a.name,n.checkPull=o(a.pull,!0),n.checkPut=o(a.put),n.revertClone=a.revertClone,t.group=n},bo=function(){!po&&w&&y(w,"display","none")},yo=function(){!po&&w&&y(w,"display","")};Ht&&!io&&document.addEventListener("click",function(e){if(At)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),At=!1,!1},!0);var Ie=function(t){if(h){t=t.touches?t.touches[0]:t;var o=$a(t.clientX,t.clientY);if(o){var n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=t[a]);n.target=n.rootEl=o,n.preventDefault=void 0,n.stopPropagation=void 0,o[q]._onDragOver(n)}}},Ha=function(t){h&&h.parentNode[q]._isOutsideThisEl(t.target)};function b(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=fe({},t),e[q]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return ho(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,r){l.setData("Text",r.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:b.supportPointer!==!1&&"PointerEvent"in window&&(!Je||yn),emptyInsertThreshold:5};st.initializePlugins(this,e,o);for(var n in o)!(n in t)&&(t[n]=o[n]);go(t);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=t.forceFallback?!1:Ra,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?I(e,"pointerdown",this._onTapStart):(I(e,"mousedown",this._onTapStart),I(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(I(e,"dragover",this),I(e,"dragenter",this)),_t.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),fe(this,_a())}b.prototype={constructor:b,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Ne=null)},_getDirection:function(t,o){return typeof this.options.direction=="function"?this.options.direction.call(this,t,o,h):this.options.direction},_onTapStart:function(t){if(t.cancelable){var o=this,n=this.el,a=this.options,i=a.preventOnFilter,l=t.type,r=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,s=(r||t).target,d=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,c=a.filter;if(Ga(n),!h&&!(/mousedown|pointerdown/.test(l)&&t.button!==0||a.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&Je&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=ne(s,a.draggable,n,!1),!(s&&s.animated)&&yt!==s)){if(Pe=Q(s),Ze=Q(s,a.draggable),typeof c=="function"){if(c.call(this,t,s,this)){U({sortable:o,rootEl:d,name:"filter",targetEl:s,toEl:n,fromEl:n}),W("filter",o,{evt:t}),i&&t.preventDefault();return}}else if(c&&(c=c.split(",").some(function(u){if(u=ne(d,u.trim(),n,!1),u)return U({sortable:o,rootEl:u,name:"filter",targetEl:s,fromEl:n,toEl:n}),W("filter",o,{evt:t}),!0}),c)){i&&t.preventDefault();return}a.handle&&!ne(d,a.handle,n,!1)||this._prepareDragStart(t,r,s)}}},_prepareDragStart:function(t,o,n){var a=this,i=a.el,l=a.options,r=i.ownerDocument,s;if(n&&!h&&n.parentNode===i){var d=M(n);if(x=i,h=n,N=h.parentNode,Be=h.nextSibling,yt=n,mt=l.group,b.dragged=h,Le={target:h,clientX:(o||t).clientX,clientY:(o||t).clientY},On=Le.clientX-d.left,Pn=Le.clientY-d.top,this._lastX=(o||t).clientX,this._lastY=(o||t).clientY,h.style["will-change"]="all",s=function(){if(W("delayEnded",a,{evt:t}),b.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!xn&&a.nativeDraggable&&(h.draggable=!0),a._triggerDragStart(t,o),U({sortable:a,name:"choose",originalEvent:t}),V(h,l.chosenClass,!0)},l.ignore.split(",").forEach(function(c){so(h,c.trim(),Zt)}),I(r,"dragover",Ie),I(r,"mousemove",Ie),I(r,"touchmove",Ie),l.supportPointer?(I(r,"pointerup",a._onDrop),!this.nativeDraggable&&I(r,"pointercancel",a._onDrop)):(I(r,"mouseup",a._onDrop),I(r,"touchend",a._onDrop),I(r,"touchcancel",a._onDrop)),xn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,h.draggable=!0),W("delayStart",this,{evt:t}),l.delay&&(!l.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(lt||he))){if(b.eventCanceled){this._onDrop();return}l.supportPointer?(I(r,"pointerup",a._disableDelayedDrag),I(r,"pointercancel",a._disableDelayedDrag)):(I(r,"mouseup",a._disableDelayedDrag),I(r,"touchend",a._disableDelayedDrag),I(r,"touchcancel",a._disableDelayedDrag)),I(r,"mousemove",a._delayedDragTouchMoveHandler),I(r,"touchmove",a._delayedDragTouchMoveHandler),l.supportPointer&&I(r,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(s,l.delay)}else s()}},_delayedDragTouchMoveHandler:function(t){var o=t.touches?t.touches[0]:t;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){h&&Zt(h),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;L(t,"mouseup",this._disableDelayedDrag),L(t,"touchend",this._disableDelayedDrag),L(t,"touchcancel",this._disableDelayedDrag),L(t,"pointerup",this._disableDelayedDrag),L(t,"pointercancel",this._disableDelayedDrag),L(t,"mousemove",this._delayedDragTouchMoveHandler),L(t,"touchmove",this._delayedDragTouchMoveHandler),L(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,o){o=o||t.pointerType=="touch"&&t,!this.nativeDraggable||o?this.options.supportPointer?I(document,"pointermove",this._onTouchMove):o?I(document,"touchmove",this._onTouchMove):I(document,"mousemove",this._onTouchMove):(I(h,"dragend",this),I(x,"dragstart",this._onDragStart));try{document.selection?Et(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,o){if(Oe=!1,x&&h){W("dragStarted",this,{evt:o}),this.nativeDraggable&&I(document,"dragover",Ha);var n=this.options;!t&&V(h,n.dragClass,!1),V(h,n.ghostClass,!0),b.active=this,t&&this._appendGhost(),U({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(ee){this._lastX=ee.clientX,this._lastY=ee.clientY,bo();for(var t=document.elementFromPoint(ee.clientX,ee.clientY),o=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ee.clientX,ee.clientY),t!==o);)o=t;if(h.parentNode[q]._isOutsideThisEl(t),o)do{if(o[q]){var n=void 0;if(n=o[q]._onDragOver({clientX:ee.clientX,clientY:ee.clientY,target:t,rootEl:o}),n&&!this.options.dragoverBubble)break}t=o}while(o=lo(o));yo()}},_onTouchMove:function(t){if(Le){var o=this.options,n=o.fallbackTolerance,a=o.fallbackOffset,i=t.touches?t.touches[0]:t,l=w&&Me(w,!0),r=w&&l&&l.a,s=w&&l&&l.d,d=pt&&H&&Nn(H),c=(i.clientX-Le.clientX+a.x)/(r||1)+(d?d[0]-Qt[0]:0)/(r||1),u=(i.clientY-Le.clientY+a.y)/(s||1)+(d?d[1]-Qt[1]:0)/(s||1);if(!b.active&&!Oe){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(w){l?(l.e+=c-(Kt||0),l.f+=u-(Jt||0)):l={a:1,b:0,c:0,d:1,e:c,f:u};var m="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");y(w,"webkitTransform",m),y(w,"mozTransform",m),y(w,"msTransform",m),y(w,"transform",m),Kt=c,Jt=u,ee=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!w){var t=this.options.fallbackOnBody?document.body:x,o=M(h,!0,pt,!0,t),n=this.options;if(pt){for(H=t;y(H,"position")==="static"&&y(H,"transform")==="none"&&H!==document;)H=H.parentNode;H!==document.body&&H!==document.documentElement?(H===document&&(H=ie()),o.top+=H.scrollTop,o.left+=H.scrollLeft):H=ie(),Qt=Nn(H)}w=h.cloneNode(!0),V(w,n.ghostClass,!1),V(w,n.fallbackClass,!0),V(w,n.dragClass,!0),y(w,"transition",""),y(w,"transform",""),y(w,"box-sizing","border-box"),y(w,"margin",0),y(w,"top",o.top),y(w,"left",o.left),y(w,"width",o.width),y(w,"height",o.height),y(w,"opacity","0.8"),y(w,"position",pt?"absolute":"fixed"),y(w,"zIndex","100000"),y(w,"pointerEvents","none"),b.ghost=w,t.appendChild(w),y(w,"transform-origin",On/parseInt(w.style.width)*100+"% "+Pn/parseInt(w.style.height)*100+"%")}},_onDragStart:function(t,o){var n=this,a=t.dataTransfer,i=n.options;if(W("dragStart",this,{evt:t}),b.eventCanceled){this._onDrop();return}W("setupClone",this),b.eventCanceled||(A=mo(h),A.removeAttribute("id"),A.draggable=!1,A.style["will-change"]="",this._hideClone(),V(A,this.options.chosenClass,!1),b.clone=A),n.cloneId=Et(function(){W("clone",n),!b.eventCanceled&&(n.options.removeCloneOnHide||x.insertBefore(A,h),n._hideClone(),U({sortable:n,name:"clone"}))}),!o&&V(h,i.dragClass,!0),o?(At=!0,n._loopId=setInterval(n._emulateDragOver,50)):(L(document,"mouseup",n._onDrop),L(document,"touchend",n._onDrop),L(document,"touchcancel",n._onDrop),a&&(a.effectAllowed="move",i.setData&&i.setData.call(n,a,h)),I(document,"drop",n),y(h,"transform","translateZ(0)")),Oe=!0,n._dragStartId=Et(n._dragStarted.bind(n,o,t)),I(document,"selectstart",n),je=!0,window.getSelection().removeAllRanges(),Je&&y(document.body,"user-select","none")},_onDragOver:function(t){var o=this.el,n=t.target,a,i,l,r=this.options,s=r.group,d=b.active,c=mt===s,u=r.sort,m=$||d,f,p=this,g=!1;if(sn)return;function v(Ae,dt){W(Ae,p,re({evt:t,isOwner:c,axis:f?"vertical":"horizontal",revert:l,dragRect:a,targetRect:i,canSort:u,fromSortable:m,target:n,completed:B,onMove:function(ct,Dn){return ht(x,o,h,a,ct,M(ct),t,Dn)},changed:k},dt))}function S(){v("dragOverAnimationCapture"),p.captureAnimationState(),p!==m&&m.captureAnimationState()}function B(Ae){return v("dragOverCompleted",{insertion:Ae}),Ae&&(c?d._hideClone():d._showClone(p),p!==m&&(V(h,$?$.options.ghostClass:d.options.ghostClass,!1),V(h,r.ghostClass,!0)),$!==p&&p!==b.active?$=p:p===b.active&&$&&($=null),m===p&&(p._ignoreWhileAnimating=n),p.animateAll(function(){v("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(n===h&&!h.animated||n===o&&!n.animated)&&(Ne=null),!r.dragoverBubble&&!t.rootEl&&n!==document&&(h.parentNode[q]._isOutsideThisEl(t.target),!Ae&&Ie(t)),!r.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),g=!0}function k(){K=Q(h),ge=Q(h,r.draggable),U({sortable:p,name:"change",toEl:o,newIndex:K,newDraggableIndex:ge,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),n=ne(n,r.draggable,o,!0),v("dragOver"),b.eventCanceled)return g;if(h.contains(t.target)||n.animated&&n.animatingX&&n.animatingY||p._ignoreWhileAnimating===n)return B(!1);if(At=!1,d&&!r.disabled&&(c?u||(l=N!==x):$===this||(this.lastPutMode=mt.checkPull(this,d,h,t))&&s.checkPut(this,d,h,t))){if(f=this._getDirection(t,n)==="vertical",a=M(h),v("dragOverValid"),b.eventCanceled)return g;if(l)return N=x,S(),this._hideClone(),v("revert"),b.eventCanceled||(Be?x.insertBefore(h,Be):x.appendChild(h)),B(!0);var C=vn(o,r.draggable);if(!C||Xa(t,f,this)&&!C.animated){if(C===h)return B(!1);if(C&&o===t.target&&(n=C),n&&(i=M(n)),ht(x,o,h,a,n,i,t,!!n)!==!1)return S(),C&&C.nextSibling?o.insertBefore(h,C.nextSibling):o.appendChild(h),N=o,k(),B(!0)}else if(C&&Ua(t,f,this)){var E=$e(o,0,r,!0);if(E===h)return B(!1);if(n=E,i=M(n),ht(x,o,h,a,n,i,t,!1)!==!1)return S(),o.insertBefore(h,E),N=o,k(),B(!0)}else if(n.parentNode===o){i=M(n);var D=0,_,O=h.parentNode!==o,R=!Fa(h.animated&&h.toRect||a,n.animated&&n.toRect||i,f),we=f?"top":"left",G=_n(n,"top","top")||_n(h,"top","top"),z=G?G.scrollTop:void 0;Ne!==n&&(_=i[we],tt=!1,ft=!R&&r.invertSwap||O),D=ja(t,n,i,f,R?1:r.swapThreshold,r.invertedSwapThreshold==null?r.swapThreshold:r.invertedSwapThreshold,ft,Ne===n);var F;if(D!==0){var Y=Q(h);do Y-=D,F=N.children[Y];while(F&&(y(F,"display")==="none"||F===w))}if(D===0||F===n)return B(!1);Ne=n,et=D;var Z=n.nextElementSibling,T=!1;T=D===1;var se=ht(x,o,h,a,n,i,t,T);if(se!==!1)return(se===1||se===-1)&&(T=se===1),sn=!0,setTimeout(Ya,30),S(),T&&!Z?o.appendChild(h):n.parentNode.insertBefore(h,T?Z:n),G&&uo(G,0,z-G.scrollTop),N=h.parentNode,_!==void 0&&!ft&&(vt=Math.abs(_-M(n)[we])),k(),B(!0)}if(o.contains(h))return B(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){L(document,"mousemove",this._onTouchMove),L(document,"touchmove",this._onTouchMove),L(document,"pointermove",this._onTouchMove),L(document,"dragover",Ie),L(document,"mousemove",Ie),L(document,"touchmove",Ie)},_offUpEvents:function(){var t=this.el.ownerDocument;L(t,"mouseup",this._onDrop),L(t,"touchend",this._onDrop),L(t,"pointerup",this._onDrop),L(t,"pointercancel",this._onDrop),L(t,"touchcancel",this._onDrop),L(document,"selectstart",this)},_onDrop:function(t){var o=this.el,n=this.options;if(K=Q(h),ge=Q(h,n.draggable),W("drop",this,{evt:t}),N=h&&h.parentNode,K=Q(h),ge=Q(h,n.draggable),b.eventCanceled){this._nulling();return}Oe=!1,ft=!1,tt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),dn(this.cloneId),dn(this._dragStartId),this.nativeDraggable&&(L(document,"drop",this),L(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Je&&y(document.body,"user-select",""),y(h,"transform",""),t&&(je&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),w&&w.parentNode&&w.parentNode.removeChild(w),(x===N||$&&$.lastPutMode!=="clone")&&A&&A.parentNode&&A.parentNode.removeChild(A),h&&(this.nativeDraggable&&L(h,"dragend",this),Zt(h),h.style["will-change"]="",je&&!Oe&&V(h,$?$.options.ghostClass:this.options.ghostClass,!1),V(h,this.options.chosenClass,!1),U({sortable:this,name:"unchoose",toEl:N,newIndex:null,newDraggableIndex:null,originalEvent:t}),x!==N?(K>=0&&(U({rootEl:N,name:"add",toEl:N,fromEl:x,originalEvent:t}),U({sortable:this,name:"remove",toEl:N,originalEvent:t}),U({rootEl:N,name:"sort",toEl:N,fromEl:x,originalEvent:t}),U({sortable:this,name:"sort",toEl:N,originalEvent:t})),$&&$.save()):K!==Pe&&K>=0&&(U({sortable:this,name:"update",toEl:N,originalEvent:t}),U({sortable:this,name:"sort",toEl:N,originalEvent:t})),b.active&&((K==null||K===-1)&&(K=Pe,ge=Ze),U({sortable:this,name:"end",toEl:N,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){W("nulling",this),x=h=N=w=Be=A=yt=be=Le=ee=je=K=ge=Pe=Ze=Ne=et=$=mt=b.dragged=b.ghost=b.clone=b.active=null,Nt.forEach(function(t){t.checked=!0}),Nt.length=Kt=Jt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":h&&(this._onDragOver(t),za(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],o,n=this.el.children,a=0,i=n.length,l=this.options;a<i;a++)o=n[a],ne(o,l.draggable,this.el,!1)&&t.push(o.getAttribute(l.dataIdAttr)||qa(o));return t},sort:function(t,o){var n={},a=this.el;this.toArray().forEach(function(i,l){var r=a.children[l];ne(r,this.options.draggable,a,!1)&&(n[i]=r)},this),o&&this.captureAnimationState(),t.forEach(function(i){n[i]&&(a.removeChild(n[i]),a.appendChild(n[i]))}),o&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,o){return ne(t,o||this.options.draggable,this.el,!1)},option:function(t,o){var n=this.options;if(o===void 0)return n[t];var a=st.modifyOption(this,t,o);typeof a<"u"?n[t]=a:n[t]=o,t==="group"&&go(n)},destroy:function(){W("destroy",this);var t=this.el;t[q]=null,L(t,"mousedown",this._onTapStart),L(t,"touchstart",this._onTapStart),L(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(L(t,"dragover",this),L(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),_t.splice(_t.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!be){if(W("hideClone",this),b.eventCanceled)return;y(A,"display","none"),this.options.removeCloneOnHide&&A.parentNode&&A.parentNode.removeChild(A),be=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(be){if(W("showClone",this),b.eventCanceled)return;h.parentNode==x&&!this.options.group.revertClone?x.insertBefore(A,h):Be?x.insertBefore(A,Be):x.appendChild(A),this.options.group.revertClone&&this.animate(h,A),y(A,"display",""),be=!1}}};function za(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function ht(e,t,o,n,a,i,l,r){var s,d=e[q],c=d.options.onMove,u;return window.CustomEvent&&!he&&!lt?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=t,s.from=e,s.dragged=o,s.draggedRect=n,s.related=a||t,s.relatedRect=i||M(t),s.willInsertAfter=r,s.originalEvent=l,e.dispatchEvent(s),c&&(u=c.call(d,s,l)),u}function Zt(e){e.draggable=!1}function Ya(){sn=!1}function Ua(e,t,o){var n=M($e(o.el,0,o.options,!0)),a=fo(o.el,o.options,w),i=10;return t?e.clientX<a.left-i||e.clientY<n.top&&e.clientX<n.right:e.clientY<a.top-i||e.clientY<n.bottom&&e.clientX<n.left}function Xa(e,t,o){var n=M(vn(o.el,o.options.draggable)),a=fo(o.el,o.options,w),i=10;return t?e.clientX>a.right+i||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>a.bottom+i||e.clientX>n.right&&e.clientY>n.top}function ja(e,t,o,n,a,i,l,r){var s=n?e.clientY:e.clientX,d=n?o.height:o.width,c=n?o.top:o.left,u=n?o.bottom:o.right,m=!1;if(!l){if(r&&vt<d*a){if(!tt&&(et===1?s>c+d*i/2:s<u-d*i/2)&&(tt=!0),tt)m=!0;else if(et===1?s<c+vt:s>u-vt)return-et}else if(s>c+d*(1-a)/2&&s<u-d*(1-a)/2)return Wa(t)}return m=m||l,m&&(s<c+d*i/2||s>u-d*i/2)?s>c+d/2?1:-1:0}function Wa(e){return Q(h)<Q(e)?1:-1}function qa(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,n=0;o--;)n+=t.charCodeAt(o);return n.toString(36)}function Ga(e){Nt.length=0;for(var t=e.getElementsByTagName("input"),o=t.length;o--;){var n=t[o];n.checked&&Nt.push(n)}}function Et(e){return setTimeout(e,0)}function dn(e){return clearTimeout(e)}Ht&&I(document,"touchmove",function(e){(b.active||Oe)&&e.cancelable&&e.preventDefault()});b.utils={on:I,off:L,css:y,find:so,is:function(t,o){return!!ne(t,o,t,!1)},extend:xa,throttle:co,closest:ne,toggleClass:V,clone:mo,index:Q,nextTick:Et,cancelNextTick:dn,detectDirection:ho,getChild:$e,expando:q};b.get=function(e){return e[q]};b.mount=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];t[0].constructor===Array&&(t=t[0]),t.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(b.utils=re(re({},b.utils),n.utils)),st.mount(n)})};b.create=function(e,t){return new b(e,t)};b.version=ka;var P=[],We,cn,un=!1,en,tn,Ot,qe;function Va(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(o){var n=o.originalEvent;this.sortable.nativeDraggable?I(document,"dragover",this._handleAutoScroll):this.options.supportPointer?I(document,"pointermove",this._handleFallbackAutoScroll):n.touches?I(document,"touchmove",this._handleFallbackAutoScroll):I(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var n=o.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?L(document,"dragover",this._handleAutoScroll):(L(document,"pointermove",this._handleFallbackAutoScroll),L(document,"touchmove",this._handleFallbackAutoScroll),L(document,"mousemove",this._handleFallbackAutoScroll)),Rn(),wt(),Aa()},nulling:function(){Ot=cn=We=un=qe=en=tn=null,P.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,n){var a=this,i=(o.touches?o.touches[0]:o).clientX,l=(o.touches?o.touches[0]:o).clientY,r=document.elementFromPoint(i,l);if(Ot=o,n||this.options.forceAutoScrollFallback||lt||he||Je){nn(o,this.options,r,n);var s=ye(r,!0);un&&(!qe||i!==en||l!==tn)&&(qe&&Rn(),qe=setInterval(function(){var d=ye(document.elementFromPoint(i,l),!0);d!==s&&(s=d,wt()),nn(o,a.options,d,n)},10),en=i,tn=l)}else{if(!this.options.bubbleScroll||ye(r,!0)===ie()){wt();return}nn(o,this.options,ye(r,!1),!1)}}},fe(e,{pluginName:"scroll",initializeByDefault:!0})}function wt(){P.forEach(function(e){clearInterval(e.pid)}),P=[]}function Rn(){clearInterval(qe)}var nn=co(function(e,t,o,n){if(t.scroll){var a=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,r=t.scrollSpeed,s=ie(),d=!1,c;cn!==o&&(cn=o,wt(),We=t.scroll,c=t.scrollFn,We===!0&&(We=ye(o,!0)));var u=0,m=We;do{var f=m,p=M(f),g=p.top,v=p.bottom,S=p.left,B=p.right,k=p.width,C=p.height,E=void 0,D=void 0,_=f.scrollWidth,O=f.scrollHeight,R=y(f),we=f.scrollLeft,G=f.scrollTop;f===s?(E=k<_&&(R.overflowX==="auto"||R.overflowX==="scroll"||R.overflowX==="visible"),D=C<O&&(R.overflowY==="auto"||R.overflowY==="scroll"||R.overflowY==="visible")):(E=k<_&&(R.overflowX==="auto"||R.overflowX==="scroll"),D=C<O&&(R.overflowY==="auto"||R.overflowY==="scroll"));var z=E&&(Math.abs(B-a)<=l&&we+k<_)-(Math.abs(S-a)<=l&&!!we),F=D&&(Math.abs(v-i)<=l&&G+C<O)-(Math.abs(g-i)<=l&&!!G);if(!P[u])for(var Y=0;Y<=u;Y++)P[Y]||(P[Y]={});(P[u].vx!=z||P[u].vy!=F||P[u].el!==f)&&(P[u].el=f,P[u].vx=z,P[u].vy=F,clearInterval(P[u].pid),(z!=0||F!=0)&&(d=!0,P[u].pid=setInterval((function(){n&&this.layer===0&&b.active._onTouchMove(Ot);var Z=P[this.layer].vy?P[this.layer].vy*r:0,T=P[this.layer].vx?P[this.layer].vx*r:0;typeof c=="function"&&c.call(b.dragged.parentNode[q],T,Z,e,Ot,P[this.layer].el)!=="continue"||uo(P[this.layer].el,T,Z)}).bind({layer:u}),24))),u++}while(t.bubbleScroll&&m!==s&&(m=ye(m,!1)));un=d}},30),vo=function(t){var o=t.originalEvent,n=t.putSortable,a=t.dragEl,i=t.activeSortable,l=t.dispatchSortableEvent,r=t.hideGhostForTarget,s=t.unhideGhostForTarget;if(o){var d=n||i;r();var c=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,u=document.elementFromPoint(c.clientX,c.clientY);s(),d&&!d.el.contains(u)&&(l("spill"),this.onSpill({dragEl:a,putSortable:n}))}};function En(){}En.prototype={startIndex:null,dragStart:function(t){var o=t.oldDraggableIndex;this.startIndex=o},onSpill:function(t){var o=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var a=$e(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(o,a):this.sortable.el.appendChild(o),this.sortable.animateAll(),n&&n.animateAll()},drop:vo};fe(En,{pluginName:"revertOnSpill"});function wn(){}wn.prototype={onSpill:function(t){var o=t.dragEl,n=t.putSortable,a=n||this.sortable;a.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),a.animateAll()},drop:vo};fe(wn,{pluginName:"removeOnSpill"});b.mount(new Va);b.mount(wn,En);let mn=[],Ct=null,nt=null,Re=0;function Ka(){Ja(),Za(),ei()}function Ja(){mn.forEach(e=>e.destroy()),mn=[],Ct&&(Ct.destroy(),Ct=null),Eo()}function Qa(){const e=document.getElementById("board-container");!e||nt||(nt=setInterval(()=>{if(!e)return;const t=e.getBoundingClientRect(),o=80,n=12;Re>0&&(Re<t.left+o&&e.scrollLeft>0?e.scrollLeft-=n:Re>t.right-o&&e.scrollLeft<e.scrollWidth-e.clientWidth&&(e.scrollLeft+=n))},16))}function Eo(){nt&&(clearInterval(nt),nt=null),Re=0}function gt(e){e.touches&&e.touches[0]?Re=e.touches[0].clientX:e.clientX&&(Re=e.clientX)}function Za(){document.querySelectorAll(".tasks:not(.hidden)").forEach(t=>{const o=new b(t,{group:{name:"tasks",pull:!0,put:!0},animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"task-ghost",chosenClass:"task-chosen",dragClass:"task-drag",draggable:".task",forceFallback:!0,fallbackClass:"task-fallback",fallbackOnBody:!0,fallbackTolerance:0,swapThreshold:.65,emptyInsertThreshold:20,direction:"vertical",onStart:function(n){document.body.classList.add("dragging"),Qa(),document.addEventListener("touchmove",gt,{passive:!0}),document.addEventListener("mousemove",gt,{passive:!0})},onEnd:async function(n){document.body.classList.remove("dragging"),Eo(),document.removeEventListener("touchmove",gt),document.removeEventListener("mousemove",gt),Ro();const{renderBoard:a}=await ce(async()=>{const{renderBoard:i}=await Promise.resolve().then(()=>me);return{renderBoard:i}},void 0,import.meta.url);a()}});mn.push(o)})}function ei(){const e=document.getElementById("board-container");e&&(Ct=new b(e,{animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"column-ghost",chosenClass:"column-chosen",dragClass:"column-drag",handle:".column-header",filter:"button:not(.column-drag-handle), a, input, select, textarea, [contenteditable]",preventOnFilter:!0,draggable:".task-column",scrollSensitivity:80,scrollSpeed:15,forceFallback:!1,fallbackOnBody:!0,onStart:function(t){document.body.classList.add("dragging-column")},onEnd:function(t){document.body.classList.remove("dragging-column"),Uo()}}))}const wo="kanbanNotificationBannerHidden";let Fn;function Co(){return localStorage.getItem(wo)==="true"}function $n(e){localStorage.setItem(wo,e?"true":"false")}function Do(){const e=document.getElementById("notification-banner-visibility-toggle");e&&(e.checked=!Co())}function Cn(){const e=J(),t=X(),o=Number.isFinite(t.notificationDays)?t.notificationDays:3,n=new Date;return n.setHours(0,0,0,0),e.filter(a=>{if(a.column==="done")return!1;const i=(a.dueDate||"").toString().trim();if(!i)return!1;const l=new Date(i+"T00:00:00");if(Number.isNaN(l.getTime()))return!1;const r=l.getTime()-n.getTime();return Math.floor(r/(1e3*60*60*24))<=o}).map(a=>{const l=new Date(a.dueDate+"T00:00:00").getTime()-n.getTime(),r=Math.floor(l/(1e3*60*60*24));return{...a,daysUntilDue:r}}).sort((a,i)=>a.daysUntilDue-i.daysUntilDue)}function Lo(e,t,o){const a=new Date(t+"T00:00:00").toLocaleDateString(o||void 0);if(e<0){const i=Math.abs(e);return{text:`Overdue by ${i} day${i===1?"":"s"} (${a})`,className:"overdue"}}else return e===0?{text:`Due today (${a})`,className:"overdue"}:e===1?{text:`Due tomorrow (${a})`,className:"due-soon"}:{text:`Due in ${e} days (${a})`,className:"due-soon"}}function Io(){const e=document.getElementById("notification-banner"),t=document.getElementById("notification-banner-list");if(!e||!t)return;const o=Cn(),n=X();if(o.length===0){e.classList.add("hidden");return}if(Co()){e.classList.add("hidden");return}t.innerHTML="";const a=window.matchMedia("(min-width: 601px)").matches,i=l=>{const r=document.createElement("div");r.classList.add("notification-banner-item"),r.setAttribute("role","button"),r.setAttribute("tabindex","0"),r.setAttribute("aria-label",`Open task: ${l.title}`);const s=document.createElement("span");s.classList.add("task-title");const d=typeof l.text=="string"?l.text:"";s.textContent=typeof l.title=="string"&&l.title.trim()?l.title:d;const c=Lo(l.daysUntilDue,l.dueDate,n.locale),u=document.createElement("span");u.classList.add("due-date",c.className),u.textContent=c.text,r.appendChild(s),r.appendChild(u);const m=()=>Ke(l.id);return r.addEventListener("click",m),r.addEventListener("keydown",f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),m())}),r};if(a){const l=t.clientWidth||t.getBoundingClientRect().width;let r=0;for(const d of o){const c=i(d);if(t.appendChild(c),r+=1,t.scrollWidth>l&&r>1){t.removeChild(c),r-=1;break}}const s=o.length-r;if(s>0){const d=document.createElement("div");if(d.classList.add("notification-banner-item","notification-more"),d.setAttribute("role","button"),d.setAttribute("tabindex","0"),d.textContent=`+${s} `,d.addEventListener("click",Ge),d.addEventListener("keydown",c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),Ge())}),t.appendChild(d),t.scrollWidth>l&&r>0){t.removeChild(t.children[r-1]),r-=1;const c=o.length-r;d.textContent=`+${c} `,t.appendChild(d)}}}else if(o.slice(0,5).forEach(r=>{const s=i(r);t.appendChild(s)}),o.length>5){const r=document.createElement("div");r.classList.add("notification-banner-item","notification-more"),r.setAttribute("role","button"),r.setAttribute("tabindex","0"),r.textContent=`+${o.length-5} `,r.addEventListener("click",Ge),r.addEventListener("keydown",s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),Ge())}),t.appendChild(r)}e.classList.remove("hidden"),xe()}function ti(){const e=document.getElementById("notifications-list");if(!e)return;const t=Cn(),o=X(),n=Number.isFinite(o.notificationDays)?o.notificationDays:3;if(e.innerHTML="",t.length===0){const a=document.createElement("div");a.classList.add("notifications-empty"),a.textContent=n===0?"No tasks due today.":`No tasks due within the next ${n} day${n===1?"":"s"}.`,e.appendChild(a);return}t.forEach(a=>{const i=document.createElement("div");i.classList.add("notification-item"),i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.setAttribute("aria-label",`Open task: ${a.title}`);const l=document.createElement("div");l.classList.add("notification-item-content");const r=document.createElement("div");r.classList.add("notification-item-title");const s=typeof a.text=="string"?a.text:"";r.textContent=typeof a.title=="string"&&a.title.trim()?a.title:s;const d=document.createElement("div");d.classList.add("notification-item-meta");const c=Lo(a.daysUntilDue,a.dueDate,o.locale),u=document.createElement("span");u.classList.add(c.className),u.textContent=c.text;const m=typeof a.priority=="string"?a.priority:"low",f=document.createElement("span");f.classList.add("notification-item-priority",`priority-${m}`),f.textContent=m,d.appendChild(u),d.appendChild(f),l.appendChild(r),l.appendChild(d);const p=document.createElement("span");p.classList.add("notification-item-arrow"),p.dataset.lucide="chevron-right",i.appendChild(l),i.appendChild(p);const g=()=>{Dt(),Ke(a.id)};i.addEventListener("click",g),i.addEventListener("keydown",v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),g())}),e.appendChild(i)}),xe()}function ni(){const e=document.getElementById("notification-badge");if(!e)return;const o=Cn().length;o===0?(e.classList.add("hidden"),e.textContent=""):(e.classList.remove("hidden"),e.textContent=o>99?"99+":String(o))}function Ge(){Do(),ti(),document.getElementById("notifications-modal")?.classList.remove("hidden")}function Dt(){document.getElementById("notifications-modal")?.classList.add("hidden")}function oi(){const e=document.getElementById("notifications-modal");return e&&!e.classList.contains("hidden")}function ai(){document.getElementById("notification-banner-close-btn")?.addEventListener("click",()=>{$n(!0),Lt()});const t=document.getElementById("notification-banner-visibility-toggle");t?.addEventListener("change",()=>{$n(!t.checked),Lt()}),document.getElementById("notifications-btn")?.addEventListener("click",Ge),document.getElementById("notifications-close-btn")?.addEventListener("click",Dt),te("notifications-modal",Dt),document.addEventListener("keydown",a=>{a.key==="Escape"&&oi()&&Dt()}),window.addEventListener("resize",()=>{clearTimeout(Fn),Fn=setTimeout(Io,120)}),Lt(),Do()}function Lt(){Io(),ni()}let Hn=!1,So="";function Bo(e){So=(e||"").toString()}function ii(e){return J().filter(o=>o.column===e).length}function ri(e,t,o){if(!t)return!0;const n=typeof e?.text=="string"?e.text:"",a=typeof e?.title=="string"&&e.title.trim()!==""?e.title:n,i=typeof e?.description=="string"?e.description:"",l=typeof e?.priority=="string"?e.priority:"";if(a.toLowerCase().includes(t)||i.toLowerCase().includes(t)||l.toLowerCase().includes(t))return!0;const r=Array.isArray(e?.labels)?e.labels:[];for(const s of r){const d=o.get(s);if(d&&d.includes(t))return!0}return!1}function ke(e=null){document.querySelectorAll(".column-menu").forEach(t=>{e&&t===e||t.classList.add("hidden")}),document.querySelectorAll(".column-submenu").forEach(t=>{t.classList.add("hidden")})}function li(e){return[...e].sort((t,o)=>{const n=(t.dueDate||"").toString().trim(),a=(o.dueDate||"").toString().trim();return!n&&!a?0:n?a?n.localeCompare(a):-1:1})}function si(e){const t={high:0,medium:1,low:2};return[...e].sort((o,n)=>{const a=t[o.priority]??2,i=t[n.priority]??2;return a-i})}function zn(e,t){const o=J(),n=o.filter(s=>s.column===e),a=o.filter(s=>s.column!==e),l=(t==="dueDate"?li(n):si(n)).map((s,d)=>({...s,order:d+1})),r=[...a,...l];Ee(r),pe()}function di(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=o.includes("T")?o:`${o}T00:00:00`,a=new Date(n);return Number.isNaN(a.getTime())?o:a.toLocaleDateString(t||void 0)}function ci(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=new Date(o);return Number.isNaN(n.getTime())?o:n.toLocaleString(t||void 0)}function ui(e){const t=(e?.creationDate||"").toString().trim();if(!t)return"";const o=new Date(t);if(Number.isNaN(o.getTime()))return"";const n=1440*60*1e3,a=Math.max(0,Math.floor((Date.now()-o.getTime())/n));if(a<30)return`${a}d`;const i=Math.floor(a/365);let l=a%365;const r=Math.floor(l/30);l=l%30;const s=[];return i>=1&&s.push(`${i}y`),r>=1&&s.push(`${r}M`),s.push(`${l}d`),s.join(" ")}function mi(e,t){const o=document.createElement("li");o.classList.add("task"),o.draggable=!0,o.dataset.taskId=e.id,o.setAttribute("role","listitem"),o.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const n=document.createElement("div");n.classList.add("task-labels"),n.setAttribute("role","list"),n.setAttribute("aria-label","Task labels");const a=le();e.labels&&e.labels.length>0&&e.labels.forEach(E=>{const D=a.find(_=>_.id===E);if(D){const _=document.createElement("span");_.classList.add("task-label"),_.setAttribute("role","listitem"),_.style.backgroundColor=D.color,_.textContent=D.name,n.appendChild(_)}});const i=document.createElement("div");i.classList.add("task-header");const l=document.createElement("div");l.classList.add("task-title"),l.setAttribute("role","button"),l.setAttribute("tabindex","0");const r=typeof e.text=="string"?e.text:"";l.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:r,l.addEventListener("click",()=>Ke(e.id)),l.addEventListener("keydown",E=>{(E.key==="Enter"||E.key===" ")&&(E.preventDefault(),Ke(e.id))});const s=document.createElement("div");s.classList.add("task-actions");const d=document.createElement("button");d.classList.add("delete-task-btn"),d.setAttribute("aria-label","Delete task"),d.type="button";const c=document.createElement("span");c.dataset.lucide="trash-2",c.setAttribute("aria-hidden","true"),d.appendChild(c),d.addEventListener("click",async E=>{E.stopPropagation(),await Te({title:"Delete Task",message:"Are you sure you want to delete this task?",confirmText:"Delete"})&&Po(e.id)&&pe()}),s.appendChild(d),i.appendChild(l),i.appendChild(s);const u=typeof e.description=="string"?e.description.trim():"",m=document.createElement("div");m.classList.add("task-description"),m.textContent=u,m.style.display=u?"block":"none",m.addEventListener("click",()=>Ke(e.id));const f=document.createElement("div");f.classList.add("task-meta");const p=t?.showPriority!==!1,g=t?.showDueDate!==!1;if(p){const E=typeof e.priority=="string"?e.priority:"medium",D=document.createElement("span");D.classList.add("task-priority",`priority-${E}`),D.textContent=E,D.setAttribute("aria-label",`Priority: ${E}`),f.appendChild(D)}if(g){const E=typeof e.dueDate=="string"?e.dueDate.trim():"",D=document.createElement("span");D.classList.add("task-date"),E?D.textContent="Due "+di(E,t?.locale):D.textContent="No due date",f.appendChild(D)}o.appendChild(i),o.appendChild(m),o.appendChild(n),f.childNodes.length>0&&o.appendChild(f);const v=t?.showChangeDate!==!1,S=t?.showAge!==!1,B=t?.locale,k=document.createElement("div");if(k.classList.add("task-footer"),v){const E=document.createElement("span");E.classList.add("task-change-date");const D=ci(e?.changeDate,B);E.textContent=D?`Updated ${D}`:"",k.appendChild(E)}if(S){const E=document.createElement("span");E.classList.add("task-age");const D=ui(e);E.textContent=D?`Age ${D}`:"",k.appendChild(E)}return Array.from(k.childNodes).some(E=>(E.textContent||"").trim()!=="")&&o.appendChild(k),o}function fi(e){const t=document.createElement("article");t.classList.add("task-column"),t.dataset.column=e.id,t.draggable=!1,t.setAttribute("aria-labelledby",`column-title-${e.id}`);const o=e?.collapsed===!0;o&&t.classList.add("is-collapsed"),e?.color&&t.style.setProperty("--column-accent",e.color);const n=document.createElement("button");n.classList.add("column-collapse-btn"),n.type="button",n.setAttribute("aria-label",o?`Expand ${e.name} column`:`Collapse ${e.name} column`),n.title=o?"Expand column":"Collapse column";const a=document.createElement("span");a.dataset.lucide=o?"chevron-right":"chevrons-right-left",a.setAttribute("aria-hidden","true"),n.appendChild(a),n.addEventListener("click",T=>{T.stopPropagation(),Ho(e.id)&&pe()});const i=document.createElement("button");i.classList.add("column-drag-handle"),i.type="button",i.setAttribute("aria-label","Drag to reorder column");const l=document.createElement("span");l.dataset.lucide="grip-vertical",l.setAttribute("aria-hidden","true"),i.appendChild(l),i.title="Drag to reorder";const r=document.createElement("header");r.classList.add("column-header");const s=document.createElement("h2");if(s.id=`column-title-${e.id}`,o){const T=ii(e.id);s.textContent=`${e.name} (${T})`}else s.textContent=e.name;const d=document.createElement("span");d.classList.add("task-counter"),d.dataset.columnId=e.id,d.textContent="0",d.setAttribute("aria-label","Task count");const c=document.createElement("div");c.classList.add("column-actions");const u=document.createElement("button");u.classList.add("add-task-btn-icon"),u.type="button",u.setAttribute("aria-label",`Add task to ${e.name}`);const m=document.createElement("span");m.dataset.lucide="plus",m.setAttribute("aria-hidden","true"),u.appendChild(m),u.title="Add task",u.addEventListener("click",()=>ha(e.id));const f=document.createElement("div");f.classList.add("column-menu-wrapper");const p=document.createElement("button");p.classList.add("column-menu-btn"),p.type="button",p.setAttribute("aria-haspopup","menu"),p.setAttribute("aria-expanded","false"),p.setAttribute("aria-label",`${e.name} column menu`);const g=document.createElement("span");g.dataset.lucide="ellipsis-vertical",g.setAttribute("aria-hidden","true"),p.appendChild(g),p.title="Column menu";const v=document.createElement("div");v.classList.add("column-menu","hidden"),v.setAttribute("role","menu");const S=document.createElement("button");S.classList.add("column-menu-item"),S.type="button",S.setAttribute("role","menuitem");const B=document.createElement("span");B.dataset.lucide="pencil",B.setAttribute("aria-hidden","true"),S.appendChild(B);const k=document.createTextNode(" Edit");S.appendChild(k),S.title="Edit column",S.addEventListener("click",T=>{T.stopPropagation(),ke(),ba(e.id)});const C=document.createElement("button");C.classList.add("column-menu-item","danger"),C.type="button",C.setAttribute("role","menuitem");const E=document.createElement("span");E.dataset.lucide="trash-2",E.setAttribute("aria-hidden","true"),C.appendChild(E);const D=document.createTextNode(" Delete");C.appendChild(D),C.title="Delete column",C.addEventListener("click",T=>{T.stopPropagation(),ke(),(async()=>{if(e.id==="done"){await de({title:"Cannot Delete Column",message:"The Done column is permanent and cannot be deleted."});return}if(ae().length<=1){await de({title:"Cannot Delete Column",message:"Cannot delete the last column."});return}const dt=J().filter(To=>To.column===e.id),zt=e?.name?`"${e.name}"`:"this column",ct=dt.length>0?`Delete ${zt}? This will also delete ${dt.length} task(s).`:`Delete ${zt}?`;await Te({title:"Delete Column",message:ct,confirmText:"Delete"})&&Yo(e.id)&&pe()})()});const _=document.createElement("div");_.classList.add("column-menu-submenu-wrapper");const O=document.createElement("button");O.classList.add("column-menu-item","has-submenu"),O.type="button",O.setAttribute("role","menuitem"),O.setAttribute("aria-haspopup","menu"),O.setAttribute("aria-expanded","false");const R=document.createElement("span");R.dataset.lucide="arrow-up-down",R.setAttribute("aria-hidden","true"),O.appendChild(R);const we=document.createTextNode(" Sort");O.appendChild(we);const G=document.createElement("span");G.dataset.lucide="chevron-left",G.classList.add("submenu-chevron"),G.setAttribute("aria-hidden","true"),O.appendChild(G),O.title="Sort tasks in column";const z=document.createElement("div");z.classList.add("column-submenu","hidden"),z.setAttribute("role","menu");const F=document.createElement("button");F.classList.add("column-menu-item"),F.type="button",F.setAttribute("role","menuitem"),F.textContent="By Due Date",F.title="Sort by due date (earliest first)",F.addEventListener("click",T=>{T.stopPropagation(),ke(),zn(e.id,"dueDate")});const Y=document.createElement("button");Y.classList.add("column-menu-item"),Y.type="button",Y.setAttribute("role","menuitem"),Y.textContent="By Priority",Y.title="Sort by priority (high to low)",Y.addEventListener("click",T=>{T.stopPropagation(),ke(),zn(e.id,"priority")}),z.appendChild(F),z.appendChild(Y),O.addEventListener("click",T=>{T.stopPropagation();const se=!z.classList.contains("hidden");z.classList.toggle("hidden"),O.setAttribute("aria-expanded",se?"false":"true")}),_.addEventListener("mouseenter",()=>{z.classList.remove("hidden"),O.setAttribute("aria-expanded","true")}),_.addEventListener("mouseleave",()=>{z.classList.add("hidden"),O.setAttribute("aria-expanded","false")}),_.appendChild(O),_.appendChild(z),v.appendChild(S),v.appendChild(_),v.appendChild(C),p.addEventListener("click",T=>{T.stopPropagation();const se=!v.classList.contains("hidden");ke(),se?p.setAttribute("aria-expanded","false"):(v.classList.remove("hidden"),p.setAttribute("aria-expanded","true"))}),f.appendChild(p),f.appendChild(v),c.appendChild(u),c.appendChild(f),r.appendChild(n),r.appendChild(i),r.appendChild(s),r.appendChild(d),r.appendChild(c);const Z=document.createElement("ul");return Z.classList.add("tasks"),Z.setAttribute("role","list"),Z.setAttribute("aria-label",`Tasks in ${e.name}`),o&&(Z.classList.add("hidden"),c.classList.add("hidden"),d.classList.add("hidden")),t.appendChild(r),t.appendChild(Z),t}function pi(){const e=ae(),t=document.getElementById("task-column");t.innerHTML="",e.forEach(o=>{const n=document.createElement("option");n.value=o.id,n.textContent=o.name,t.appendChild(n)})}function pe(){const e=ae(),t=J(),o=le(),n=X(),a=new Map(o.map(d=>[d.id,(d.name||"").toString().trim().toLowerCase()])),i=(So||"").toString().trim().toLowerCase(),l=i?t.filter(d=>ri(d,i,a)):t,r=document.getElementById("board-container");r.innerHTML="",[...e].sort((d,c)=>(d.order??0)-(c.order??0)).forEach(d=>{const c=fi(d);r.appendChild(c);const u=c.querySelector(".tasks"),m=c.querySelector(".task-counter"),f=l.filter(p=>p.column===d.id).sort((p,g)=>(p.order??0)-(g.order??0));f.forEach(p=>{u.appendChild(mi(p,n))}),m.textContent=f.length}),Ka(),pi(),xe(),Lt(),Hn||(Hn=!0,document.addEventListener("click",()=>ke()),document.addEventListener("keydown",d=>{d.key==="Escape"&&ke()}))}const me=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:pe,setBoardFilterQuery:Bo},Symbol.toStringTag,{value:"Module"})),ko="kanban-theme";function hi(){const e=localStorage.getItem(ko);return e==="light"||e==="dark"?e:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Yn(e){document.documentElement.dataset.theme=e}function Un(e){const t=document.getElementById("theme-toggle-btn");if(!t)return;const o=e==="dark"?"light":"dark",n=o==="dark"?"Dark":"Light",a=o==="dark"?"moon":"sun";t.setAttribute("aria-pressed",String(e==="dark"));const i=t.querySelector("[data-lucide]");i&&i.setAttribute("data-lucide",a);const l=Array.from(t.childNodes).filter(r=>r.nodeType===Node.TEXT_NODE);for(const r of l)r.remove();t.appendChild(document.createTextNode(` ${n}`)),xe()}function gi(){const e=hi();Yn(e),Un(e);const t=document.getElementById("theme-toggle-btn");t&&t.addEventListener("click",()=>{const n=(document.documentElement.dataset.theme==="dark"?"dark":"light")==="dark"?"light":"dark";Yn(n),localStorage.setItem(ko,n),Un(n)})}function bi(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function Xn(e){const t=ze(),o=hn();e.innerHTML="",t.forEach(n=>{const a=document.createElement("option");a.value=n.id,a.textContent=bi(n),e.appendChild(a)}),o&&(e.value=o)}function on(){const e=document.getElementById("brand-text")||document.querySelector(".brand-text");e&&(e.textContent=Mt())}function yi(){const e=document.getElementById("board-create-modal"),t=document.getElementById("board-create-name");!e||!t||(t.value="",e.classList.remove("hidden"),t.focus())}function Ue(){const e=document.getElementById("board-create-modal");e&&e.classList.add("hidden")}function vi(){pn();const e=document.getElementById("board-select");if(!e)return;Xn(e),on(),document.addEventListener("kanban:open-board-create",()=>{yi()}),e.addEventListener("change",()=>{const a=e.value;if(!a)return;It(a),on(),pe();const i=document.getElementById("board-controls-menu"),l=document.getElementById("desktop-menu-btn");i?.classList.remove("show"),l?.setAttribute("aria-expanded","false")});const t=document.getElementById("board-create-modal"),o=document.getElementById("board-create-form"),n=document.getElementById("cancel-board-create-btn");t&&(t.querySelector(".modal-backdrop")?.addEventListener("click",Ue),t.addEventListener("keydown",i=>{i.key==="Escape"&&Ue()})),n&&n.addEventListener("click",Ue),te("board-create-modal",Ue),o&&o.addEventListener("submit",async a=>{a.preventDefault();const i=document.getElementById("board-create-name"),l=(i?.value||"").trim();if(!l){await de({title:"Error",message:"Board name cannot be empty."}),i?.focus();return}const r=jn(l);It(r.id),Xn(e),on(),pe(),Ue(),document.dispatchEvent(new CustomEvent("kanban:boards-changed"))})}function Ei(e){const t=[];for(const o of e){if(typeof o!="string")continue;const n=o.trim();n&&(t.includes(n)||t.push(n))}return t}function wi(e){const t=typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US";return Ei([e,t,"en-US","en-GB","de-DE","fr-FR","es-ES","it-IT","pt-BR","ja-JP","zh-CN"])}function Ci(){document.getElementById("settings-modal")?.classList.remove("hidden")}function an(){document.getElementById("settings-modal")?.classList.add("hidden")}async function Se(e){Wn(e);const{renderBoard:t}=await ce(async()=>{const{renderBoard:o}=await Promise.resolve().then(()=>me);return{renderBoard:o}},void 0,import.meta.url);t()}function Di(){const e=document.getElementById("settings-btn"),t=document.getElementById("settings-close-btn");document.querySelector("#settings-modal .modal-backdrop");const o=document.getElementById("settings-show-priority"),n=document.getElementById("settings-show-due-date"),a=document.getElementById("settings-notification-days"),i=document.getElementById("settings-show-age"),l=document.getElementById("settings-show-change-date"),r=document.getElementById("settings-locale"),s=document.getElementById("settings-default-priority");if(!e||!t||!o||!n||!a||!i||!l||!r||!s)return;function d(){const c=X();o.checked=c.showPriority!==!1,n.checked=c.showDueDate!==!1,i.checked=c.showAge!==!1,l.checked=c.showChangeDate!==!1,a.value=String(Number.isFinite(c.notificationDays)?c.notificationDays:3);const u=wi(c.locale);r.innerHTML="",u.forEach(m=>{const f=document.createElement("option");f.value=m,f.textContent=m,r.appendChild(f)}),r.value=c.locale,s.value=c.defaultPriority||"low"}e.addEventListener("click",()=>{d(),Ci()}),t.addEventListener("click",an),te("settings-modal",an),document.addEventListener("keydown",c=>{const u=document.getElementById("settings-modal");!u||u.classList.contains("hidden")||c.key==="Escape"&&an()}),i.addEventListener("change",async()=>{const c=X();await Se({...c,showAge:!!i.checked})}),l.addEventListener("change",async()=>{const c=X();await Se({...c,showChangeDate:!!l.checked})}),o.addEventListener("change",async()=>{const c=X();await Se({...c,showPriority:!!o.checked})}),n.addEventListener("change",async()=>{const c=X();await Se({...c,showDueDate:!!n.checked})}),a.addEventListener("change",async()=>{const c=X(),u=Number.parseInt(a.value,10),m=Number.isFinite(u)?u:3;await Se({...c,notificationDays:m})}),r.addEventListener("change",async()=>{const c=X();await Se({...c,locale:r.value})}),s.addEventListener("change",async()=>{const c=X();await Se({...c,defaultPriority:s.value})})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("app-version");e&&(e.textContent="v1.0.7",e.title="Version 1.0.7"),gi(),Di();const t=document.getElementById("board-search-input");t&&t.addEventListener("input",()=>{Bo(t.value),pe()}),vi(),La(),ai(),document.getElementById("export-btn").addEventListener("click",async()=>{await Te({title:"Export Board (Active Only)",message:`Export ONLY saves the current active board. It does NOT back up all boards.

To back up everything, export each board individually.

Continue with export?`,confirmText:"Export"})&&ia()}),document.getElementById("import-btn").addEventListener("click",async()=>{await Te({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",a=>{const i=a.target.files[0];i&&la(i),a.target.value=""});const o=document.getElementById("desktop-menu-btn"),n=document.getElementById("board-controls-menu");o&&n&&(o.addEventListener("click",a=>{a.stopPropagation();const i=o.getAttribute("aria-expanded")==="true";n.classList.toggle("show"),o.setAttribute("aria-expanded",String(!i)),document.querySelectorAll(".column-menu").forEach(l=>l.classList.add("hidden"))}),n.addEventListener("click",a=>{a.target.closest("select, option, input, textarea, label")||!a.target.closest('button, a, [role="menuitem"]')||(n.classList.remove("show"),o.setAttribute("aria-expanded","false"))}),document.addEventListener("click",a=>{!n.contains(a.target)&&!o.contains(a.target)&&(n.classList.remove("show"),o.setAttribute("aria-expanded","false"))})),pe()});
