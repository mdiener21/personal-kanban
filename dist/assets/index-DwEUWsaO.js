(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function o(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(a){if(a.ep)return;a.ep=!0;const r=o(a);fetch(a.href,r)}})();function x(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const n=Math.random()*16|0;return(e==="x"?n:n&3|8).toString(16)})}const _e="kanbanBoards",U="kanbanActiveBoardId",tt="kanbanColumns",nt="kanbanTasks",ot="kanbanLabels",E="default",H=new Map;function ve(){return new Date().toISOString()}function y(e,n){return`kanbanBoard:${e}:${n}`}function M(e){if(!e)return null;try{const n=JSON.parse(e);return Array.isArray(n)?n:null}catch{return null}}function at(e){if(!e)return null;try{const n=JSON.parse(e);return n&&typeof n=="object"&&!Array.isArray(n)?n:null}catch{return null}}function w(){const e=M(localStorage.getItem(_e));return e?e.filter(n=>n&&typeof n.id=="string").map(n=>({id:n.id,name:typeof n.name=="string"?n.name:"Untitled board",createdAt:typeof n.createdAt=="string"?n.createdAt:void 0})):[]}function rt(e){const n=typeof e=="string"?e:"";return n&&w().find(o=>o.id===n)||null}function re(){const e=B(),n=e?rt(e):null;return(typeof(n==null?void 0:n.name)=="string"?n.name.trim():"")||"Untitled board"}function ie(e){localStorage.setItem(_e,JSON.stringify(e))}function B(){var o;const e=localStorage.getItem(U),n=w();return e&&n.some(t=>t.id===e)?e:((o=n[0])==null?void 0:o.id)||null}function V(e){const n=typeof e=="string"?e:"";!n||!w().some(t=>t.id===n)||localStorage.setItem(U,n)}function Le(){return[{id:"todo",name:"To Do",color:"#3b82f6"},{id:"inprogress",name:"In Progress",color:"#f59e0b"},{id:"done",name:"Done",color:"#16a34a"}]}function Ie(){return[{id:"urgent",name:"Urgent",color:"#ef4444"},{id:"feature",name:"Feature",color:"#3b82f6"},{id:"task",name:"Task",color:"#f59e0b"}]}function Me(){const e=ve();return[{id:x(),title:"Find out where the Soul Stone is",description:"Identify current location and access requirements.",priority:"high",dueDate:"",column:"todo",labels:["urgent"],creationDate:e,changeDate:e},{id:x(),title:"Collect the Time Stone",description:"Coordinate with Dr. Strange and plan retrieval.",priority:"medium",dueDate:"",column:"inprogress",labels:["feature"],creationDate:e,changeDate:e},{id:x(),title:"Collect the Mind Stone",description:"Determine safe extraction approach.",priority:"medium",dueDate:"",column:"inprogress",labels:[],creationDate:e,changeDate:e},{id:x(),title:"Collect the Reality Stone",description:"Negotiate with the Collector, avoid escalation.",priority:"low",dueDate:"",column:"inprogress",labels:["task"],creationDate:e,changeDate:e},{id:x(),title:"Collect the Power Stone",description:"Verify secure containment after retrieval.",priority:"high",dueDate:"",column:"done",labels:["urgent","feature"],creationDate:e,changeDate:e},{id:x(),title:"Collect the Space Stone",description:"",priority:"low",dueDate:"",column:"done",labels:[],creationDate:e,changeDate:e}]}function de(){return{showAge:!0,showChangeDate:!0,locale:typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US",defaultPriority:"low"}}function it(){const e=M(localStorage.getItem(tt)),n=M(localStorage.getItem(nt)),o=M(localStorage.getItem(ot)),t=!!(e||n||o),a=[{id:E,name:"Default Board",createdAt:ve()}];return ie(a),localStorage.setItem(U,E),localStorage.setItem(y(E,"columns"),JSON.stringify(e||Le())),localStorage.setItem(y(E,"tasks"),JSON.stringify(n||Me())),localStorage.setItem(y(E,"labels"),JSON.stringify(o||Ie())),localStorage.setItem(y(E,"settings"),JSON.stringify(de())),t}function v(){const e=w();if(e.length>0){B()||V(e[0].id);return}it()}function Re(e){v();const o=(typeof e=="string"?e.trim():"")||"Untitled board",t=w(),a=`board-${x()}`,r={id:a,name:o,createdAt:ve()};return ie([...t,r]),localStorage.setItem(y(a,"columns"),JSON.stringify(Le())),localStorage.setItem(y(a,"tasks"),JSON.stringify([])),localStorage.setItem(y(a,"labels"),JSON.stringify(Ie())),localStorage.setItem(y(a,"settings"),JSON.stringify(de())),localStorage.setItem(U,a),r}function dt(e,n){v();const o=typeof e=="string"?e:"",t=typeof n=="string"?n.trim():"";if(!o||!t)return!1;const a=w();if(!a.some(i=>i.id===o))return!1;const r=a.map(i=>i.id===o?{...i,name:t}:i);return ie(r),!0}function lt(e){v();const n=typeof e=="string"?e:"";if(!n)return!1;const o=w();if(!o.some(r=>r.id===n)||o.length<=1)return!1;const t=o.filter(r=>r.id!==n);return ie(t),localStorage.removeItem(y(n,"columns")),localStorage.removeItem(y(n,"tasks")),localStorage.removeItem(y(n,"labels")),localStorage.removeItem(y(n,"settings")),H.delete(n),localStorage.getItem(U)===n&&localStorage.setItem(U,t[0].id),!0}function st(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function ct(e){return e==="todo"?"#3b82f6":e==="inprogress"?"#f59e0b":e==="done"?"#16a34a":"#3b82f6"}function Se(e){const n=st(e==null?void 0:e.color)?e.color.trim():ct(e==null?void 0:e.id);return{...e,color:n}}function D(){v();const e=B()||E,n=localStorage.getItem(y(e,"columns")),o=M(n);return o?o.map(Se):Le().map(Se)}function K(e){v();const n=B()||E;localStorage.setItem(y(n,"columns"),JSON.stringify(e))}function A(){v();const e=B()||E,n=localStorage.getItem(y(e,"tasks")),o=M(n);if(o)return H.set(e,o),o;const t=H.get(e);if(Array.isArray(t))return t;const a=Me();return H.set(e,a),a}function $(e){v();const n=B()||E;localStorage.setItem(y(n,"tasks"),JSON.stringify(e)),H.set(n,e)}function T(){v();const e=B()||E,n=localStorage.getItem(y(e,"labels")),o=M(n);return o||Ie()}function le(e){v();const n=B()||E;localStorage.setItem(y(n,"labels"),JSON.stringify(e))}function $e(e){const n=e&&typeof e=="object"?e:{},o=typeof n.locale=="string"&&n.locale.trim()?n.locale.trim():de().locale,t=n.showAge!==!1,a=n.showChangeDate!==!1,r=(n.defaultPriority||"").toString().trim().toLowerCase();return{showAge:t,showChangeDate:a,locale:o,defaultPriority:r==="low"||r==="medium"||r==="high"?r:"low"}}function N(){v();const e=B()||E,n=localStorage.getItem(y(e,"settings")),o=at(n);if(o)return $e(o);const t=de();return localStorage.setItem(y(e,"settings"),JSON.stringify(t)),t}function qe(e){v();const n=B()||E,o=$e(e);localStorage.setItem(y(n,"settings"),JSON.stringify(o))}const ut=new Set(["low","medium","high"]);function Ue(e){const n=(e||"").toString().trim().toLowerCase();return ut.has(n)?n:"low"}function ze(e){return(e||"").toString().trim()}function mt(e,n,o,t,a,r=[]){if(!e||e.trim()==="")return;const i=A(),d=i.filter(c=>c.column===a).reduce((c,f)=>Math.max(c,f.order??0),0),s=new Date().toISOString(),u={id:x(),title:e.trim(),description:(n||"").toString().trim(),priority:Ue(o),dueDate:ze(t),column:a,order:d+1,labels:[...r],creationDate:s,changeDate:s};i.push(u),$(i)}function ft(e,n,o,t,a,r,i=[]){if(!n||n.trim()==="")return;const l=A(),d=l.findIndex(s=>s.id===e);d!==-1&&(l[d].title=n.trim(),l[d].description=(o||"").toString().trim(),l[d].priority=Ue(t),l[d].dueDate=ze(a),l[d].column=r,l[d].labels=[...i],l[d].changeDate=new Date().toISOString(),$(l))}function gt(e){const o=A().filter(t=>t.id!==e);return $(o),!0}function pt(){const e=[];return document.querySelectorAll(".task-column").forEach(n=>{const o=n.dataset.column;n.querySelectorAll(".task").forEach(t=>{e.push({id:t.dataset.taskId,column:o})})}),e}function yt(){const e=pt(),n=A(),o=new Date().toISOString(),t=n.map(a=>{const r=e.findIndex(i=>i.id===a.id);if(r!==-1){const i=e[r],l=e.filter((c,f)=>c.column===i.column&&f<=r),d=i.column,s=l.length,u=a.column!==d;return{...a,column:d,order:s,...u?{changeDate:o}:{}}}return a});$(t)}function ht(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function Fe(e){return ht(e)?e.trim():"#3b82f6"}function bt(e,n){if(!e||e.trim()==="")return;const o=D(),t=o.reduce((i,l)=>Math.max(i,l.order??0),0),r={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+x().substring(0,8),name:e.trim(),color:Fe(n),order:t+1};o.push(r),K(o)}function Et(e,n,o){if(!n||n.trim()==="")return;const t=D(),a=t.findIndex(r=>r.id===e);a!==-1&&(t[a].name=n.trim(),t[a].color=Fe(o),K(t))}function vt(e){const n=D();if(n.length<=1)return!1;const o=A();if(o.filter(r=>r.column===e).length>0){const r=o.filter(i=>i.column!==e);$(r)}const a=n.filter(r=>r.id!==e);return K(a),!0}function Lt(){const n=document.getElementById("board-container").querySelectorAll(".task-column"),o=D();n.forEach((t,a)=>{const r=t.dataset.column,i=o.find(l=>l.id===r);i&&(i.order=a+1)}),K(o)}const It="modulepreload",Ct=function(e){return"/"+e},ke={},P=function(n,o,t){let a=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(o.map(d=>{if(d=Ct(d),d in ke)return;ke[d]=!0;const s=d.endsWith(".css"),u=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${u}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":It,s||(c.as="script"),c.crossOrigin="",c.href=d,l&&c.setAttribute("nonce",l),document.head.appendChild(c),s)return new Promise((f,g)=>{c.addEventListener("load",f),c.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function r(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&r(l.reason);return n().catch(r)})};function Bt(e,n){if(!e||e.trim()==="")return;const o=T(),a={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+x().substring(0,8),name:e.trim(),color:n};return o.push(a),le(o),a}function wt(e,n,o){if(!n||n.trim()==="")return;const t=T(),a=t.findIndex(r=>r.id===e);a!==-1&&(t[a].name=n.trim(),t[a].color=o,le(t))}function St(e){const n=T(),o=A();o.forEach(a=>{a.labels&&(a.labels=a.labels.filter(r=>r!==e))}),$(o);const t=n.filter(a=>a.id!==e);le(t)}let te=null;function k(e){return document.getElementById(e)}function W(e){const n=k("dialog-modal");n&&n.classList.add("hidden");const o=te;te=null,typeof o=="function"&&o(!!e)}function kt(){const e=k("dialog-modal");return e&&!e.classList.contains("hidden")}function He({title:e,message:n,confirmText:o,cancelText:t,showCancel:a}){const r=k("dialog-modal-title"),i=k("dialog-modal-message"),l=k("dialog-confirm-btn"),d=k("dialog-cancel-btn");r&&(r.textContent=e||"Confirm"),i&&(i.textContent=n||""),l&&(l.textContent=o||"OK"),d&&(d.textContent=t||"Cancel"),d&&(d.style.display=a?"inline-flex":"none")}function Je(){const e=k("dialog-modal");if(!e||e.dataset.handlersAttached==="true")return;e.dataset.handlersAttached="true";const n=k("dialog-confirm-btn"),o=k("dialog-cancel-btn"),t=e.querySelector(".modal-backdrop");n==null||n.addEventListener("click",()=>W(!0)),o==null||o.addEventListener("click",()=>W(!1)),t==null||t.addEventListener("click",()=>W(!1)),document.addEventListener("keydown",a=>{a.key==="Escape"&&kt()&&W(!1)})}function Ve(){const e=k("dialog-modal");if(!e)return;e.classList.remove("hidden");const n=k("dialog-confirm-btn");n==null||n.focus()}function z({title:e="Confirm",message:n="",confirmText:o="Delete",cancelText:t="Cancel"}={}){return Je(),He({title:e,message:n,confirmText:o,cancelText:t,showCancel:!0}),Ve(),new Promise(a=>{te=a})}function je({title:e="Notice",message:n="",okText:o="OK"}={}){return Je(),He({title:e,message:n,confirmText:o,cancelText:"",showCancel:!1}),Ve(),new Promise(t=>{te=()=>t(!0)})}let xe="todo",j=null,Y=null,ne=null,oe=null,C=[];function xt(){const e=document.getElementById("task-label-search");return((e==null?void 0:e.value)||"").trim().toLowerCase()}function be(){const e=document.getElementById("task-active-labels");if(!e)return;const n=T(),o=[];for(const a of C)o.includes(a)||o.push(a);C=o;const t=o.map(a=>n.find(r=>r.id===a)).filter(Boolean);e.innerHTML="",e.style.display=t.length>0?"flex":"none",t.forEach(a=>{const r=document.createElement("span");r.classList.add("task-label"),r.style.backgroundColor=a.color,r.textContent=a.name;const i=document.createElement("button");i.type="button",i.classList.add("active-label-remove"),i.setAttribute("aria-label",`Remove label ${a.name}`),i.title="Remove label",i.textContent="Ã—",i.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),C=C.filter(d=>d!==a.id),be(),se()}),r.appendChild(i),e.appendChild(r)})}function Dt(e){var u;xe=e||((u=D()[0])==null?void 0:u.id)||"todo",j=null,C=[];const n=document.getElementById("task-modal"),o=document.getElementById("task-column"),t=document.getElementById("task-title"),a=document.getElementById("task-description"),r=document.getElementById("task-priority"),i=document.getElementById("task-due-date"),l=document.getElementById("task-modal-title"),d=document.getElementById("task-submit-btn");if(l.textContent="Add New Task",d.textContent="Add Task",o.value=xe,t.value="",a.value="",r){const c=N();r.value=c.defaultPriority||"low"}i&&(i.value="");const s=document.getElementById("task-label-search");s&&(s.value=""),se(),n.classList.remove("hidden"),t.focus()}function me(e){const o=A().find(p=>p.id===e);if(!o)return;j=e,C=o.labels||[];const t=document.getElementById("task-modal"),a=document.getElementById("task-column"),r=document.getElementById("task-title"),i=document.getElementById("task-description"),l=document.getElementById("task-priority"),d=document.getElementById("task-due-date"),s=document.getElementById("task-modal-title"),u=document.getElementById("task-submit-btn");s.textContent="Edit Task",u.textContent="Save Changes",a.value=o.column;const c=typeof o.text=="string"?o.text:"";r.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:c,i.value=typeof o.description=="string"?o.description:"",l&&(l.value=typeof o.priority=="string"?o.priority:"medium");const f=typeof o.dueDate=="string"?o.dueDate:"",g=f.includes("T")?f.slice(0,10):f;d&&(d.value=g);const m=document.getElementById("task-label-search");m&&(m.value=""),se(),t.classList.remove("hidden"),r.focus()}function G(){document.getElementById("task-modal").classList.add("hidden"),j=null}function At(){Y=null;const e=document.getElementById("column-modal"),n=document.getElementById("column-name"),o=document.getElementById("column-color"),t=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");t.textContent="Add New Column",a.textContent="Add Column",n.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),n.focus()}function Tt(e){const o=D().find(d=>d.id===e);if(!o)return;Y=e;const t=document.getElementById("column-modal"),a=document.getElementById("column-name"),r=document.getElementById("column-color"),i=document.getElementById("column-modal-title"),l=document.getElementById("column-submit-btn");i.textContent="Edit Column",l.textContent="Save Changes",a.value=o.name,r&&(r.value=o.color||"#3b82f6"),t.classList.remove("hidden"),a.focus()}function Q(){document.getElementById("column-modal").classList.add("hidden"),Y=null}function Ot(){Ce(),document.getElementById("labels-modal").classList.remove("hidden")}function fe(){document.getElementById("labels-modal").classList.add("hidden")}function Nt(){document.getElementById("help-modal").classList.remove("hidden")}function ge(){document.getElementById("help-modal").classList.add("hidden")}function Ye(e=null){ne=e;const n=document.getElementById("label-modal"),o=document.getElementById("label-modal-title"),t=document.getElementById("label-name"),a=document.getElementById("label-color"),r=document.getElementById("label-submit-btn");if(e){const l=T().find(d=>d.id===e);l&&(o.textContent="Edit Label",r.textContent="Update Label",t.value=l.name,a.value=l.color)}else o.textContent="Add Label",r.textContent="Add Label",t.value="",a.value="#3b82f6";n.classList.remove("hidden"),t.focus()}function X(){document.getElementById("label-modal").classList.add("hidden"),ne=null}function Ce(){const e=document.getElementById("labels-list");e.innerHTML="",T().forEach(o=>{const t=document.createElement("div");t.classList.add("label-item"),t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-between";const a=document.createElement("span");a.classList.add("task-label"),a.style.backgroundColor=o.color,a.textContent=o.name;const r=document.createElement("div");r.classList.add("label-actions"),r.style.display="flex",r.style.gap="4px";const i=document.createElement("button");i.classList.add("btn-small");const l=document.createElement("span");l.dataset.lucide="pencil",i.appendChild(l),i.title="Edit label",i.addEventListener("click",()=>Ye(o.id));const d=document.createElement("button");d.classList.add("btn-small","btn-danger");const s=document.createElement("span");s.dataset.lucide="trash-2",d.appendChild(s),d.title="Delete label",d.addEventListener("click",async()=>{if(await z({title:"Delete Label",message:`Delete label "${o.name}"? This will remove it from all tasks.`,confirmText:"Delete"})){St(o.id),Ce();const{renderBoard:c}=await P(async()=>{const{renderBoard:f}=await Promise.resolve().then(()=>_);return{renderBoard:f}},void 0);c()}}),r.appendChild(i),r.appendChild(d),t.appendChild(a),t.appendChild(r),e.appendChild(t)}),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}function Ee(){const e=document.getElementById("board-select");if(!e)return;const n=w(),o=B();e.innerHTML="",n.forEach(a=>{const r=document.createElement("option");r.value=a.id,r.textContent=typeof a.name=="string"&&a.name.trim()?a.name.trim():"Untitled board",e.appendChild(r)}),o&&(e.value=o);const t=document.getElementById("brand-text")||document.querySelector(".brand-text");t&&(t.textContent=re())}function ae(){v();const e=document.getElementById("boards-list");if(!e)return;e.innerHTML="";const n=w(),o=B();n.forEach(t=>{const a=document.createElement("div");a.classList.add("label-item"),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="10px";const r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.gap="8px";const i=document.createElement("span");if(i.textContent=(t.name||"").toString(),r.appendChild(i),t.id===o){const g=document.createElement("span");g.classList.add("task-label"),g.style.backgroundColor="var(--color-primary)",g.textContent="Active",r.appendChild(g)}const l=document.createElement("div");l.classList.add("label-actions"),l.style.display="flex",l.style.gap="4px";const d=document.createElement("button");d.classList.add("btn-small"),d.textContent="Open",d.title="Open board",d.addEventListener("click",async()=>{V(t.id),Ee(),ae();const{renderBoard:g}=await P(async()=>{const{renderBoard:m}=await Promise.resolve().then(()=>_);return{renderBoard:m}},void 0);g()});const s=document.createElement("button");s.classList.add("btn-small");const u=document.createElement("span");u.dataset.lucide="pencil",s.appendChild(u),s.title="Rename board",s.addEventListener("click",()=>_t(t.id));const c=document.createElement("button");c.classList.add("btn-small","btn-danger");const f=document.createElement("span");f.dataset.lucide="trash-2",c.appendChild(f),c.title="Delete board",c.addEventListener("click",async()=>{if(!await z({title:"Delete Board",message:`Do you really want to delete the board "${t.name}"? This cannot be undone.`,confirmText:"Delete"}))return;if(!lt(t.id)){await je({title:"Unable to Delete",message:"Unable to delete board (you may be trying to delete the last board)."});return}Ee(),ae();const{renderBoard:p}=await P(async()=>{const{renderBoard:b}=await Promise.resolve().then(()=>_);return{renderBoard:b}},void 0);p(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),l.appendChild(d),l.appendChild(s),l.appendChild(c),a.appendChild(r),a.appendChild(l),e.appendChild(a)}),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}function Pt(){ae();const e=document.getElementById("boards-modal");e==null||e.classList.remove("hidden")}function pe(){const e=document.getElementById("boards-modal");e==null||e.classList.add("hidden")}function _t(e){v();const n=w().find(i=>i.id===e);if(!n)return;oe=e;const o=document.getElementById("board-rename-modal"),t=document.getElementById("board-rename-name"),a=document.getElementById("board-rename-modal-title"),r=document.getElementById("board-rename-submit-btn");a&&(a.textContent="Rename Board"),r&&(r.textContent="Save"),t&&(t.value=(n.name||"").toString()),o==null||o.classList.remove("hidden"),t==null||t.focus()}function Z(){const e=document.getElementById("board-rename-modal");e==null||e.classList.add("hidden"),oe=null}function se(){be();const e=document.getElementById("task-labels-selection");e.innerHTML="";const n=xt(),o=T(),t=n?o.filter(a=>{const r=(a.name||"").toLowerCase(),i=(a.id||"").toLowerCase();return r.includes(n)||i.includes(n)}):o;if(t.length===0){const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent="No matching labels",e.appendChild(a);return}t.forEach(a=>{const r=document.createElement("label");r.classList.add("label-checkbox");const i=document.createElement("input");i.type="checkbox",i.value=a.id,i.checked=C.includes(a.id),i.addEventListener("change",d=>{d.target.checked?C.includes(a.id)||C.push(a.id):C=C.filter(s=>s!==a.id),be()});const l=document.createElement("span");l.classList.add("task-label","label-color-swatch"),l.style.backgroundColor=a.color,l.textContent=a.name,r.appendChild(i),r.appendChild(l),e.appendChild(r)})}function Mt(){var n,o,t,a,r,i;const e=document.getElementById("task-label-search");e==null||e.addEventListener("input",se),document.getElementById("task-form").addEventListener("submit",async l=>{var m,p;l.preventDefault();const d=document.getElementById("task-title").value,s=document.getElementById("task-description").value,u=(m=document.getElementById("task-priority"))==null?void 0:m.value,c=(p=document.getElementById("task-due-date"))==null?void 0:p.value,f=document.getElementById("task-column").value;j?ft(j,d,s,u,c,f,C):mt(d,s,u,c,f,C),G();const{renderBoard:g}=await P(async()=>{const{renderBoard:b}=await Promise.resolve().then(()=>_);return{renderBoard:b}},void 0);g()}),document.getElementById("cancel-task-btn").addEventListener("click",G),document.querySelector("#task-modal .modal-backdrop").addEventListener("click",G),document.getElementById("column-form").addEventListener("submit",async l=>{var c;l.preventDefault();const d=document.getElementById("column-name").value,s=(c=document.getElementById("column-color"))==null?void 0:c.value;Y?Et(Y,d,s):bt(d,s),Q();const{renderBoard:u}=await P(async()=>{const{renderBoard:f}=await Promise.resolve().then(()=>_);return{renderBoard:f}},void 0);u()}),document.getElementById("cancel-column-btn").addEventListener("click",Q),document.querySelector("#column-modal .modal-backdrop").addEventListener("click",Q),document.getElementById("manage-labels-btn").addEventListener("click",Ot),document.getElementById("labels-close-btn").addEventListener("click",fe),document.getElementById("add-label-btn").addEventListener("click",()=>Ye()),document.getElementById("label-form").addEventListener("submit",async l=>{l.preventDefault();const d=document.getElementById("label-name").value,s=document.getElementById("label-color").value;ne?wt(ne,d,s):Bt(d,s),X(),Ce();const{renderBoard:u}=await P(async()=>{const{renderBoard:c}=await Promise.resolve().then(()=>_);return{renderBoard:c}},void 0);u()}),document.getElementById("cancel-label-btn").addEventListener("click",X),document.querySelector("#labels-modal .modal-backdrop").addEventListener("click",fe),document.querySelector("#label-modal .modal-backdrop").addEventListener("click",X),(n=document.getElementById("manage-boards-btn"))==null||n.addEventListener("click",Pt),(o=document.getElementById("boards-close-btn"))==null||o.addEventListener("click",pe),(t=document.querySelector("#boards-modal .modal-backdrop"))==null||t.addEventListener("click",pe),(a=document.getElementById("board-rename-form"))==null||a.addEventListener("submit",l=>{if(l.preventDefault(),!oe)return;const d=document.getElementById("board-rename-name"),s=((d==null?void 0:d.value)||"").trim();if(!s){alert("Board name cannot be empty.");return}if(!dt(oe,s)){alert("Unable to rename board.");return}Z(),Ee(),ae(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),(r=document.getElementById("cancel-board-rename-btn"))==null||r.addEventListener("click",Z),(i=document.querySelector("#board-rename-modal .modal-backdrop"))==null||i.addEventListener("click",Z),document.getElementById("help-btn").addEventListener("click",Nt),document.getElementById("help-close-btn").addEventListener("click",ge),document.querySelector("#help-modal .modal-backdrop").addEventListener("click",ge),document.getElementById("add-column-btn").addEventListener("click",At),document.addEventListener("keydown",l=>{l.key==="Escape"&&(G(),Q(),fe(),X(),pe(),Z(),ge())})}function Rt(){document.querySelectorAll(".task").forEach(n=>{n.addEventListener("dragstart",o=>{n.id="dragged-task",o.dataTransfer.effectAllowed="move",o.dataTransfer.setData("task","")}),n.addEventListener("dragend",o=>{n.removeAttribute("id")})})}function $t(){document.querySelectorAll(".task-column").forEach(n=>{n.addEventListener("dragover",o=>{o.dataTransfer.types.includes("task")?Ut(o):o.dataTransfer.types.includes("column")&&Ke(o)}),n.addEventListener("dragleave",o=>{if(n.contains(o.relatedTarget))return;const t=n.querySelector(".placeholder");t==null||t.remove()}),n.addEventListener("drop",async o=>{o.preventDefault();const t=document.getElementById("dragged-task"),a=n.querySelector(".placeholder");if(!t||!a)return;const r=n.querySelector(".tasks");t.remove(),r.insertBefore(t,a),a.remove(),yt();const{renderBoard:i}=await P(async()=>{const{renderBoard:l}=await Promise.resolve().then(()=>_);return{renderBoard:l}},void 0);i()})})}function qt(){const e=document.querySelectorAll(".task-column"),n=document.getElementById("board-container");e.forEach(o=>{const t=o.querySelector(".column-drag-handle");o.draggable=!1,t.addEventListener("mousedown",()=>{o.draggable=!0}),document.addEventListener("mouseup",()=>{o.draggable=!1}),o.addEventListener("dragstart",a=>{a.target.closest(".task")||(o.id="dragged-column",a.dataTransfer.effectAllowed="move",a.dataTransfer.setData("column",""))}),o.addEventListener("dragend",()=>{o.removeAttribute("id"),o.draggable=!1;const a=n.querySelector(".column-placeholder");a==null||a.remove()})}),n.addEventListener("dragover",o=>{o.dataTransfer.types.includes("column")&&(o.preventDefault(),Ke(o))}),n.addEventListener("drop",o=>{if(!o.dataTransfer.types.includes("column"))return;o.preventDefault();const t=document.getElementById("dragged-column"),a=n.querySelector(".column-placeholder");!t||!a||(n.insertBefore(t,a),a.remove(),Lt())})}function De(e){const n=document.createElement("li");return n.classList.add("placeholder"),n.style.height=`${e.offsetHeight}px`,n}function Ut(e){if(!e.dataTransfer.types.includes("task"))return;e.preventDefault();const n=document.getElementById("dragged-task"),o=e.currentTarget,t=o.querySelector(".tasks"),a=o.querySelector(".placeholder");if(a){const r=a.getBoundingClientRect();if(r.top<=e.clientY&&r.bottom>=e.clientY)return}for(const r of t.children)if(r.getBoundingClientRect().bottom>=e.clientY){if(r===a||(a==null||a.remove(),r===n||r.previousElementSibling===n))return;t.insertBefore(a??De(n),r);return}a==null||a.remove(),t.lastElementChild!==n&&t.append(a??De(n))}function Ae(e){const n=document.createElement("div");return n.classList.add("column-placeholder"),n.style.width=`${e.offsetWidth}px`,n.style.height=`${e.offsetHeight}px`,n}function Ke(e){if(!e.dataTransfer.types.includes("column"))return;const n=document.getElementById("board-container"),o=document.getElementById("dragged-column");if(!o)return;const t=n.querySelector(".column-placeholder"),a=Array.from(n.querySelectorAll(".task-column:not(#dragged-column)"));for(const r of a){const i=r.getBoundingClientRect(),l=i.left+i.width/2;if(e.clientX<l){if(t&&t.nextElementSibling===r)return;t==null||t.remove(),n.insertBefore(Ae(o),r);return}}t==null||t.remove(),n.appendChild(Ae(o))}let Te=!1,We="";function Ge(e){We=(e||"").toString()}function zt(e,n,o){if(!n)return!0;const t=typeof(e==null?void 0:e.text)=="string"?e.text:"",a=typeof(e==null?void 0:e.title)=="string"&&e.title.trim()!==""?e.title:t,r=typeof(e==null?void 0:e.description)=="string"?e.description:"",i=typeof(e==null?void 0:e.priority)=="string"?e.priority:"";if(a.toLowerCase().includes(n)||r.toLowerCase().includes(n)||i.toLowerCase().includes(n))return!0;const l=Array.isArray(e==null?void 0:e.labels)?e.labels:[];for(const d of l){const s=o.get(d);if(s&&s.includes(n))return!0}return!1}function J(e=null){document.querySelectorAll(".column-menu").forEach(n=>{e&&n===e||n.classList.add("hidden")})}function Ft(e,n){const o=(e||"").toString().trim();if(!o)return"";const t=o.includes("T")?o:`${o}T00:00:00`,a=new Date(t);return Number.isNaN(a.getTime())?o:a.toLocaleDateString(n||void 0)}function Ht(e,n){const o=(e||"").toString().trim();if(!o)return"";const t=new Date(o);return Number.isNaN(t.getTime())?o:t.toLocaleString(n||void 0)}function Jt(e){const n=((e==null?void 0:e.creationDate)||"").toString().trim();if(!n)return"";const o=new Date(n);if(Number.isNaN(o.getTime()))return"";const t=Date.now()-o.getTime(),a=Math.max(0,Math.floor(t/(24*60*60*1e3)));return a>=30?`${Math.max(1,Math.floor(a/30))}M`:`${a}d`}function Vt(e,n){const o=document.createElement("li");o.classList.add("task"),o.draggable=!0,o.dataset.taskId=e.id,o.setAttribute("role","listitem"),o.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const t=document.createElement("div");t.classList.add("task-labels"),t.setAttribute("aria-label","Task labels");const a=T();e.labels&&e.labels.length>0&&e.labels.forEach(h=>{const I=a.find(O=>O.id===h);if(I){const O=document.createElement("span");O.classList.add("task-label"),O.style.backgroundColor=I.color,O.textContent=I.name,t.appendChild(O)}});const r=document.createElement("div");r.classList.add("task-header");const i=document.createElement("div");i.classList.add("task-title"),i.setAttribute("role","button"),i.setAttribute("tabindex","0");const l=typeof e.text=="string"?e.text:"";i.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:l,i.addEventListener("click",()=>me(e.id)),i.addEventListener("keydown",h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),me(e.id))});const d=document.createElement("div");d.classList.add("task-actions");const s=document.createElement("button");s.classList.add("delete-task-btn"),s.setAttribute("aria-label","Delete task"),s.type="button";const u=document.createElement("span");u.dataset.lucide="trash-2",u.setAttribute("aria-hidden","true"),s.appendChild(u),s.addEventListener("click",async h=>{h.stopPropagation(),await z({title:"Delete Task",message:"Are you sure you want to delete this task?",confirmText:"Delete"})&&gt(e.id)&&R()}),d.appendChild(s),r.appendChild(i),r.appendChild(d);const c=typeof e.description=="string"?e.description.trim():"",f=document.createElement("div");f.classList.add("task-description"),f.textContent=c,f.style.display=c?"block":"none",f.addEventListener("click",()=>me(e.id));const g=document.createElement("div");g.classList.add("task-meta");const m=typeof e.priority=="string"?e.priority:"medium",p=document.createElement("span");p.classList.add("task-priority",`priority-${m}`),p.textContent=m,p.setAttribute("aria-label",`Priority: ${m}`);const b=typeof e.dueDate=="string"?e.dueDate.trim():"",L=document.createElement("span");L.classList.add("task-date"),b?L.textContent=Ft(b,n==null?void 0:n.locale):L.textContent="No due date",g.appendChild(p),g.appendChild(L),o.appendChild(r),o.appendChild(f),o.appendChild(t),o.appendChild(g);const F=(n==null?void 0:n.showChangeDate)!==!1,ce=(n==null?void 0:n.showAge)!==!1,q=n==null?void 0:n.locale,S=document.createElement("div");if(S.classList.add("task-footer"),F){const h=document.createElement("span");h.classList.add("task-change-date");const I=Ht(e==null?void 0:e.changeDate,q);h.textContent=I?`Updated ${I}`:"",S.appendChild(h)}if(ce){const h=document.createElement("span");h.classList.add("task-age");const I=Jt(e);h.textContent=I?`Age ${I}`:"",S.appendChild(h)}return Array.from(S.childNodes).some(h=>(h.textContent||"").trim()!=="")&&o.appendChild(S),o}function jt(e){const n=document.createElement("article");n.classList.add("task-column"),n.dataset.column=e.id,n.draggable=!1,n.setAttribute("aria-labelledby",`column-title-${e.id}`),e!=null&&e.color&&n.style.setProperty("--column-accent",e.color);const o=document.createElement("button");o.classList.add("column-drag-handle"),o.type="button",o.setAttribute("aria-label","Drag to reorder column");const t=document.createElement("span");t.dataset.lucide="grip-vertical",t.setAttribute("aria-hidden","true"),o.appendChild(t),o.title="Drag to reorder";const a=document.createElement("header");a.classList.add("column-header");const r=document.createElement("h2");r.id=`column-title-${e.id}`,r.textContent=e.name;const i=document.createElement("span");i.classList.add("task-counter"),i.dataset.columnId=e.id,i.textContent="0",i.setAttribute("aria-label","Task count");const l=document.createElement("div");l.classList.add("column-actions");const d=document.createElement("button");d.classList.add("add-task-btn-icon"),d.type="button",d.setAttribute("aria-label",`Add task to ${e.name}`);const s=document.createElement("span");s.dataset.lucide="plus",s.setAttribute("aria-hidden","true"),d.appendChild(s),d.title="Add task",d.addEventListener("click",()=>Dt(e.id));const u=document.createElement("div");u.classList.add("column-menu-wrapper");const c=document.createElement("button");c.classList.add("column-menu-btn"),c.type="button",c.setAttribute("aria-haspopup","menu"),c.setAttribute("aria-expanded","false"),c.setAttribute("aria-label",`${e.name} column menu`);const f=document.createElement("span");f.dataset.lucide="ellipsis-vertical",f.setAttribute("aria-hidden","true"),c.appendChild(f),c.title="Column menu";const g=document.createElement("div");g.classList.add("column-menu","hidden"),g.setAttribute("role","menu");const m=document.createElement("button");m.classList.add("column-menu-item"),m.type="button",m.setAttribute("role","menuitem");const p=document.createElement("span");p.dataset.lucide="pencil",p.setAttribute("aria-hidden","true"),m.appendChild(p);const b=document.createTextNode(" Edit");m.appendChild(b),m.title="Edit column",m.addEventListener("click",S=>{S.stopPropagation(),J(),Tt(e.id)});const L=document.createElement("button");L.classList.add("column-menu-item","danger"),L.type="button",L.setAttribute("role","menuitem");const F=document.createElement("span");F.dataset.lucide="trash-2",F.setAttribute("aria-hidden","true"),L.appendChild(F);const ce=document.createTextNode(" Delete");L.appendChild(ce),L.title="Delete column",L.addEventListener("click",S=>{S.stopPropagation(),J(),(async()=>{if(D().length<=1){await je({title:"Cannot Delete Column",message:"Cannot delete the last column."});return}const I=A().filter(et=>et.column===e.id),O=e!=null&&e.name?`"${e.name}"`:"this column",Ze=I.length>0?`Delete ${O}? This will also delete ${I.length} task(s).`:`Delete ${O}?`;await z({title:"Delete Column",message:Ze,confirmText:"Delete"})&&vt(e.id)&&R()})()}),g.appendChild(m),g.appendChild(L),c.addEventListener("click",S=>{S.stopPropagation();const ue=!g.classList.contains("hidden");J(),ue?c.setAttribute("aria-expanded","false"):(g.classList.remove("hidden"),c.setAttribute("aria-expanded","true"))}),u.appendChild(c),u.appendChild(g),l.appendChild(d),l.appendChild(u),a.appendChild(o),a.appendChild(r),a.appendChild(i),a.appendChild(l);const q=document.createElement("ul");return q.classList.add("tasks"),q.setAttribute("role","list"),q.setAttribute("aria-label",`Tasks in ${e.name}`),n.appendChild(a),n.appendChild(q),n}function Yt(){const e=D(),n=document.getElementById("task-column");n.innerHTML="",e.forEach(o=>{const t=document.createElement("option");t.value=o.id,t.textContent=o.name,n.appendChild(t)})}function R(){const e=D(),n=A(),o=T(),t=N(),a=new Map(o.map(s=>[s.id,(s.name||"").toString().trim().toLowerCase()])),r=(We||"").toString().trim().toLowerCase(),i=r?n.filter(s=>zt(s,r,a)):n,l=document.getElementById("board-container");l.innerHTML="",[...e].sort((s,u)=>(s.order??0)-(u.order??0)).forEach(s=>{const u=jt(s);l.appendChild(u);const c=u.querySelector(".tasks"),f=u.querySelector(".task-counter"),g=i.filter(m=>m.column===s.id).sort((m,p)=>(m.order??0)-(p.order??0));if(g.forEach(m=>{c.appendChild(Vt(m,t))}),f.textContent=g.length,g.length>12){u.classList.add("has-hidden-tasks");const m=document.createElement("button");m.classList.add("show-all-tasks-btn"),m.type="button";const p=g.length;m.textContent=`Show all tasks (${p})`,m.addEventListener("click",()=>{c.classList.toggle("expanded"),m.textContent=c.classList.contains("expanded")?"Hide extra tasks":`Show all tasks (${p})`}),u.appendChild(m)}}),Rt(),$t(),qt(),Yt(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons(),Te||(Te=!0,document.addEventListener("click",()=>J()),document.addEventListener("keydown",s=>{s.key==="Escape"&&J()}))}const _=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:R,setBoardFilterQuery:Ge},Symbol.toStringTag,{value:"Module"}));function Kt(e){return(typeof(e==null?void 0:e.name)=="string"?e.name.trim():"")||"Untitled board"}function Wt(e){const n=document.getElementById("brand-text")||document.querySelector(".brand-text");n&&(n.textContent=re());const o=document.getElementById("board-select");if(!o)return;const t=w();o.innerHTML="",t.forEach(a=>{const r=document.createElement("option");r.value=a.id,r.textContent=Kt(a),o.appendChild(r)}),e&&(o.value=e)}function Gt(e){const n=typeof(e==null?void 0:e.name)=="string"?e.name.trim():"";return n?n.replace(/\.[^.]+$/,"").trim():""}function Be(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const Qt=new Set(["low","medium","high"]);function we(e){const n=(e||"").toString().trim().toLowerCase();return Qt.has(n)?n:"low"}function Qe(e){const n=(e||"").toString().trim();return n.length>=10&&n.includes("T")?n.slice(0,10):n}function Xt(e){const n=typeof(e==null?void 0:e.text)=="string"?e.text:"",o=typeof(e==null?void 0:e.title)=="string"?e.title:n,t=typeof(e==null?void 0:e.description)=="string"?e.description:"",a=Qe((e==null?void 0:e.dueDate)??(e==null?void 0:e["due-date"])),r=typeof(e==null?void 0:e.changeDate)=="string"?e.changeDate:typeof(e==null?void 0:e.changedDate)=="string"?e.changedDate:void 0;return{...e,title:o.toString().trim(),description:t.toString().trim(),priority:we(e==null?void 0:e.priority),dueDate:a,...typeof r=="string"?{changeDate:r.toString().trim()}:{},changedDate:void 0}}function Zt(e){if(!Array.isArray(e))return null;const n=e.map(t=>{const a=typeof(t==null?void 0:t.id)=="string"?t.id:String((t==null?void 0:t.id)??""),r=typeof(t==null?void 0:t.text)=="string"?t.text:String((t==null?void 0:t.text)??""),i=typeof(t==null?void 0:t.title)=="string"?t.title:r,l=typeof(t==null?void 0:t.description)=="string"?t.description:String((t==null?void 0:t.description)??""),d=we(t==null?void 0:t.priority),s=typeof(t==null?void 0:t.dueDate)=="string"?t.dueDate:typeof(t==null?void 0:t["due-date"])=="string"?t["due-date"]:String((t==null?void 0:t.dueDate)??(t==null?void 0:t["due-date"])??""),u=Qe(s),c=typeof(t==null?void 0:t.column)=="string"?t.column:String((t==null?void 0:t.column)??""),f=Array.isArray(t==null?void 0:t.labels)?t.labels.map(b=>typeof b=="string"?b:String(b)):[],g=Number.isFinite(t==null?void 0:t.order)?t.order:void 0,m=typeof(t==null?void 0:t.creationDate)=="string"?t.creationDate:void 0,p=typeof(t==null?void 0:t.changeDate)=="string"?t.changeDate:typeof(t==null?void 0:t.changedDate)=="string"?t.changedDate:void 0;return{id:a.trim(),title:i.trim(),description:l.trim(),priority:d,dueDate:u.trim(),column:c.trim(),...g!==void 0?{order:g}:{},...m?{creationDate:m}:{},...typeof p=="string"&&p.trim()?{changeDate:p.trim()}:{},labels:f}});return n.every(t=>t.id&&t.title&&t.column)?n:null}function en(e){if(!Array.isArray(e))return null;const n=e.map(t=>{const a=typeof(t==null?void 0:t.id)=="string"?t.id:String((t==null?void 0:t.id)??""),r=typeof(t==null?void 0:t.name)=="string"?t.name:String((t==null?void 0:t.name)??""),i=Number.isFinite(t==null?void 0:t.order)?t.order:void 0,l=Be(t==null?void 0:t.color)?t.color.trim():"#3b82f6";return{id:a.trim(),name:r.trim(),color:l,...i!==void 0?{order:i}:{}}});return n.every(t=>t.id&&t.name)?n:null}function tn(e){if(!Array.isArray(e))return null;const n=e.map(t=>{const a=typeof(t==null?void 0:t.id)=="string"?t.id:String((t==null?void 0:t.id)??""),r=typeof(t==null?void 0:t.name)=="string"?t.name:String((t==null?void 0:t.name)??""),i=Be(t==null?void 0:t.color)?t.color.trim():"#3b82f6";return{id:a.trim(),name:r.trim(),color:i}});return n.every(t=>t.id&&t.name&&t.color)?n:null}function nn(e){if(!e||typeof e!="object"||Array.isArray(e))return null;const n=e.showAge!==!1,o=e.showChangeDate!==!1,t=typeof e.locale=="string"&&e.locale.trim()?e.locale.trim():void 0,a=typeof e.defaultPriority=="string"?e.defaultPriority:void 0,r=a?we(a):void 0;return{showAge:n,showChangeDate:o,...t?{locale:t}:{},...r?{defaultPriority:r}:{}}}function on(){const e=A().map(Xt),n=D().map(u=>({...u,color:Be(u==null?void 0:u.color)?u.color.trim():"#3b82f6"})),o=T(),t=N(),r={boardName:re(),columns:n,tasks:e,labels:o,settings:t},i=JSON.stringify(r,null,2),l=new Blob([i],{type:"application/json"}),d=URL.createObjectURL(l),s=document.createElement("a");s.href=d,s.download=`kanban-board-${new Date().toISOString()}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(d)}function an(e){const n=new FileReader;n.onload=async o=>{try{const t=JSON.parse(o.target.result);let a,r,i,l,d;if(Array.isArray(t))a=t,r=null,i=null,l=null,d=null;else if(t.tasks&&t.columns)a=t.tasks,r=t.columns,i=Object.prototype.hasOwnProperty.call(t,"labels")?t.labels:null,l=Object.prototype.hasOwnProperty.call(t,"settings")?t.settings:null,d=typeof t.boardName=="string"?t.boardName.trim():null;else{alert("Invalid JSON file format");return}const s=Zt(a),u=r?en(r):null,c=i?tn(i):null,f=l?nn(l):null;if(!s||r&&!u||i&&!c||l&&!f){alert("Invalid data structure");return}const g=d||Gt(e)||"Imported board",m=Re(g);if(m!=null&&m.id&&V(m.id),u&&K(u),$(s),c&&le(c),f){const b=N();qe({...b,...f})}Wt(m==null?void 0:m.id);const{renderBoard:p}=await P(async()=>{const{renderBoard:b}=await Promise.resolve().then(()=>_);return{renderBoard:b}},void 0);p(),alert("Board imported successfully!")}catch(t){alert("Error parsing JSON file: "+t.message)}},n.readAsText(e)}const Xe="kanban-theme";function rn(){const e=localStorage.getItem(Xe);return e==="light"||e==="dark"?e:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Oe(e){document.documentElement.dataset.theme=e}function Ne(e){const n=document.getElementById("theme-toggle-btn");if(!n)return;const o=e==="dark"?"light":"dark",t=o==="dark"?"Dark":"Light",a=o==="dark"?"moon":"sun";n.setAttribute("aria-pressed",String(e==="dark"));const r=n.querySelector("span[data-lucide]");r&&r.setAttribute("data-lucide",a);const i=Array.from(n.childNodes).filter(l=>l.nodeType===Node.TEXT_NODE);for(const l of i)l.remove();n.appendChild(document.createTextNode(` ${t}`)),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}function dn(){const e=rn();Oe(e),Ne(e);const n=document.getElementById("theme-toggle-btn");n&&n.addEventListener("click",()=>{const t=(document.documentElement.dataset.theme==="dark"?"dark":"light")==="dark"?"light":"dark";Oe(t),localStorage.setItem(Xe,t),Ne(t)})}function ln(e){return(typeof(e==null?void 0:e.name)=="string"?e.name.trim():"")||"Untitled board"}function Pe(e){const n=w(),o=B();e.innerHTML="",n.forEach(t=>{const a=document.createElement("option");a.value=t.id,a.textContent=ln(t),e.appendChild(a)}),o&&(e.value=o)}function ye(){const e=document.getElementById("brand-text")||document.querySelector(".brand-text");e&&(e.textContent=re())}function sn(){v();const e=document.getElementById("board-select"),n=document.getElementById("new-board-btn");!e||!n||(Pe(e),ye(),e.addEventListener("change",()=>{const o=e.value;if(!o)return;V(o),ye(),R();const t=document.getElementById("board-controls-menu"),a=document.getElementById("desktop-menu-btn");t==null||t.classList.remove("show"),a==null||a.setAttribute("aria-expanded","false")}),n.addEventListener("click",()=>{const o=window.prompt("New board name:");if(o===null)return;const t=o.trim();if(!t){alert("Board name cannot be empty.");return}const a=Re(t);V(a.id),Pe(e),ye(),R()}))}function cn(e){const n=[];for(const o of e){if(typeof o!="string")continue;const t=o.trim();t&&(n.includes(t)||n.push(t))}return n}function un(e){const n=typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US";return cn([e,n,"en-US","en-GB","de-DE","fr-FR","es-ES","it-IT","pt-BR","ja-JP","zh-CN"])}function mn(){var e;(e=document.getElementById("settings-modal"))==null||e.classList.remove("hidden")}function he(){var e;(e=document.getElementById("settings-modal"))==null||e.classList.add("hidden")}async function ee(e){qe(e);const{renderBoard:n}=await P(async()=>{const{renderBoard:o}=await Promise.resolve().then(()=>_);return{renderBoard:o}},void 0);n()}function fn(){const e=document.getElementById("settings-btn"),n=document.getElementById("settings-close-btn"),o=document.querySelector("#settings-modal .modal-backdrop"),t=document.getElementById("settings-show-age"),a=document.getElementById("settings-show-change-date"),r=document.getElementById("settings-locale"),i=document.getElementById("settings-default-priority");if(!e||!n||!t||!a||!r||!i)return;function l(){const d=N();t.checked=d.showAge!==!1,a.checked=d.showChangeDate!==!1;const s=un(d.locale);r.innerHTML="",s.forEach(u=>{const c=document.createElement("option");c.value=u,c.textContent=u,r.appendChild(c)}),r.value=d.locale,i.value=d.defaultPriority||"low"}e.addEventListener("click",()=>{l(),mn()}),n.addEventListener("click",he),o==null||o.addEventListener("click",he),document.addEventListener("keydown",d=>{const s=document.getElementById("settings-modal");!s||s.classList.contains("hidden")||d.key==="Escape"&&he()}),t.addEventListener("change",async()=>{const d=N();await ee({...d,showAge:!!t.checked})}),a.addEventListener("change",async()=>{const d=N();await ee({...d,showChangeDate:!!a.checked})}),r.addEventListener("change",async()=>{const d=N();await ee({...d,locale:r.value})}),i.addEventListener("change",async()=>{const d=N();await ee({...d,defaultPriority:i.value})})}document.addEventListener("DOMContentLoaded",()=>{dn(),fn();const e=document.getElementById("board-search-input");e&&e.addEventListener("input",()=>{Ge(e.value),R()}),sn(),Mt(),document.getElementById("export-btn").addEventListener("click",async()=>{await z({title:"Export Board (Active Only)",message:`Export ONLY saves the current active board. It does NOT back up all boards.

To back up everything, export each board individually.

Continue with export?`,confirmText:"Export"})&&on()}),document.getElementById("import-btn").addEventListener("click",async()=>{await z({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",t=>{const a=t.target.files[0];a&&an(a),t.target.value=""});const n=document.getElementById("desktop-menu-btn"),o=document.getElementById("board-controls-menu");n&&o&&(n.addEventListener("click",t=>{t.stopPropagation();const a=n.getAttribute("aria-expanded")==="true";o.classList.toggle("show"),n.setAttribute("aria-expanded",String(!a)),document.querySelectorAll(".column-menu").forEach(r=>r.classList.add("hidden"))}),o.addEventListener("click",t=>{t.target.closest("select, option, input, textarea, label")||!t.target.closest('button, a, [role="menuitem"]')||(o.classList.remove("show"),n.setAttribute("aria-expanded","false"))}),document.addEventListener("click",t=>{!o.contains(t.target)&&!n.contains(t.target)&&(o.classList.remove("show"),n.setAttribute("aria-expanded","false"))})),window.addEventListener("beforeunload",t=>{const a="Your board data is stored in browser localStorage. Please export to a JSON file to save your work before closing.";return t.preventDefault(),t.returnValue=a,a}),R()});
