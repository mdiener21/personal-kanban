import{l as x,g as Ge,s as q,a as P,b as oe,c as A,d as xe,e as k,f as Te,h as ht,i as fe,j as yt,k as ae,r as ee,m as Ae,n as Je,o as Gt,p as Jt,q as Kt}from"./theme-BHSURPZY.js";import{S as bt}from"./vendor-pJTqpwCg.js";const Xt=new Set(["urgent","high","medium","low","none"]);function Et(e){const t=(e||"").toString().trim().toLowerCase();return Xt.has(t)?t:"none"}function vt(e){return(e||"").toString().trim()}function Qt(e,t,o,n,a,i=[]){if(!e||e.trim()==="")return;const l=x(),s=l.filter(u=>u.column===a).slice().sort((u,m)=>(u.order??0)-(m.order??0)),r=new Map;s.forEach((u,m)=>{r.set(u.id,m+2)});const d=l.map(u=>{if(u.column!==a)return u;const m=r.get(u.id);return typeof m=="number"?{...u,order:m}:u}),c=new Date().toISOString(),f={id:Ge(),title:e.trim(),description:(t||"").toString().trim(),priority:Et(o),dueDate:vt(n),column:a,order:1,labels:[...i],creationDate:c,changeDate:c,columnHistory:[{column:a,at:c}],...a==="done"?{doneDate:c}:{}};d.push(f),q(d)}function Zt(e,t,o,n,a,i,l=[]){if(!t||t.trim()==="")return;const s=x(),r=s.findIndex(d=>d.id===e);if(r!==-1){const d=s[r].column,c=i,f=new Date().toISOString();if(!Array.isArray(s[r].columnHistory)||s[r].columnHistory.length===0){const u=s[r].creationDate||s[r].changeDate||f,m=typeof d=="string"?d:c;s[r].columnHistory=[{column:m,at:u}]}s[r].title=t.trim(),s[r].description=(o||"").toString().trim(),s[r].priority=Et(n),s[r].dueDate=vt(a),s[r].column=c,s[r].labels=[...l],d!==c&&s[r].columnHistory.push({column:c,at:f}),d!=="done"&&c==="done"?s[r].doneDate=f:d==="done"&&c!=="done"&&delete s[r].doneDate,s[r].changeDate=f,q(s)}}function en(e){const o=x().filter(n=>n.id!==e);return q(o),!0}function tn(e){const t=e.item?.dataset?.taskId;if(!t)return null;const o=e.from.closest(".task-column"),n=e.to.closest(".task-column");if(!o||!n)return null;const a=o.dataset.column,i=n.dataset.column,l=a!==i,s=x(),r=new Date().toISOString(),d=s.findIndex(m=>m.id===t);if(d===-1)return null;s[d];const c=new Set([a,i]),f=new Map;c.forEach(m=>{const p=document.querySelector(`.task-column[data-column="${m}"]`);if(!p)return;const g=p.querySelectorAll(".task"),y=[];g.forEach((b,w)=>{const L=b.dataset.taskId;L&&y.push({id:L,order:w+1})}),f.set(m,y)});const u=s.map(m=>{if(m.id===t){const p={...m,column:i},y=f.get(i)?.find(b=>b.id===t);if(y&&(p.order=y.order),l){p.changeDate=r;const b=Array.isArray(m.columnHistory)&&m.columnHistory.length?[...m.columnHistory]:[{column:m.column,at:m.creationDate||m.changeDate||r}];b.push({column:i,at:r}),p.columnHistory=b,m.column!=="done"&&i==="done"?p.doneDate=r:m.column==="done"&&i!=="done"&&delete p.doneDate}return p}if(c.has(m.column)){const g=f.get(m.column)?.find(y=>y.id===m.id);if(g&&g.order!==m.order)return{...m,order:g.order}}return m});return q(u),{movedTaskId:t,fromColumn:a,toColumn:i,didChangeColumn:l}}function nn(e,t){if(!e||!t)return;const o=x(),n=o.filter(s=>s.column===t&&s.id!==e).slice().sort((s,r)=>(s.order??0)-(r.order??0)),a=new Map;a.set(e,1),n.forEach((s,r)=>{a.set(s.id,r+2)});let i=!1;const l=o.map(s=>{if(s.column!==t&&s.id!==e)return s;const r=a.get(s.id);return typeof r=="number"&&r!==s.order?(i=!0,{...s,order:r}):s});i&&q(l)}function on(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function Lt(e){return on(e)?e.trim():"#3b82f6"}function an(e,t){if(!e||e.trim()==="")return;const o=P(),n=o.reduce((l,s)=>Math.max(l,s.order??0),0),i={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+Ge().substring(0,8),name:e.trim(),color:Lt(t),order:n-1,collapsed:!1};o.push(i),oe(o)}function sn(e){const t=typeof e=="string"?e.trim():"";if(!t)return!1;const o=P(),n=o.find(a=>a.id===t);return n?(n.collapsed=n.collapsed!==!0,oe(o),!0):!1}function rn(e,t,o){if(!t||t.trim()==="")return;const n=P(),a=n.findIndex(i=>i.id===e);a!==-1&&(n[a].name=t.trim(),n[a].color=Lt(o),oe(n))}function ln(e){if(e==="done")return!1;const t=P();if(t.length<=1)return!1;const o=x();if(o.filter(i=>i.column===e).length>0){const i=o.filter(l=>l.column!==e);q(i)}const a=t.filter(i=>i.id!==e);return oe(a),!0}function dn(){const t=document.getElementById("board-container").querySelectorAll(".task-column"),o=P();t.forEach((n,a)=>{const i=n.dataset.column,l=o.find(s=>s.id===i);l&&(l.order=a+1)}),oe(o)}const cn="modulepreload",un=function(e,t){return new URL(e,t).href},ot={},_=function(t,o,n){let a=Promise.resolve();if(o&&o.length>0){let d=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};const l=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),r=s?.nonce||s?.getAttribute("nonce");a=d(o.map(c=>{if(c=un(c,n),c in ot)return;ot[c]=!0;const f=c.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(n)for(let p=l.length-1;p>=0;p--){const g=l[p];if(g.href===c&&(!f||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${u}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":cn,f||(m.as="script"),m.crossOrigin="",m.href=c,r&&m.setAttribute("nonce",r),document.head.appendChild(m),f)return new Promise((p,g)=>{m.addEventListener("load",p),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=l,window.dispatchEvent(s),!s.defaultPrevented)throw l}return a.then(l=>{for(const s of l||[])s.status==="rejected"&&i(s.reason);return t().catch(i)})},Ke=40;function Xe(e){return e.trim().slice(0,Ke).toLowerCase().replace(/\s+/g," ")}function Ct(e,t,o=null){return e.some(n=>o&&n.id===o?!1:Xe(n.name)===t)}function mn(e,t,o=""){if(!e||e.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const n=e.trim().slice(0,Ke),a=Xe(n),i=A();if(Ct(i,a))return{success:!1,reason:"DUPLICATE_NAME",message:`Label "${n}" already exists.`};const l=a.replace(/\s+/g,"-")+"-"+Ge().substring(0,8),s=typeof o=="string"?o.trim():"",r={id:l,name:n,color:t,group:s};return i.push(r),xe(i),{success:!0,label:r}}function fn(e,t,o,n=""){if(!t||t.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const a=t.trim().slice(0,Ke),i=Xe(a),l=A(),s=l.findIndex(r=>r.id===e);return s===-1?{success:!1,reason:"NOT_FOUND"}:Ct(l,i,e)?{success:!1,reason:"DUPLICATE_NAME",message:`Another label with the name "${a}" already exists.`}:(l[s].name=a,l[s].color=o,l[s].group=typeof n=="string"?n.trim():"",xe(l),{success:!0,label:l[s]})}function pn(e){const t=A(),o=x();o.forEach(a=>{a.labels&&(a.labels=a.labels.filter(i=>i!==e))}),q(o);const n=t.filter(a=>a.id!==e);xe(n)}let we=null;function M(e){return document.getElementById(e)}function Ee(e){const t=M("dialog-modal");t&&t.classList.add("hidden");const o=we;we=null,typeof o=="function"&&o(!!e)}function gn(){const e=M("dialog-modal");return e&&!e.classList.contains("hidden")}function wt({title:e,message:t,confirmText:o,cancelText:n,showCancel:a}){const i=M("dialog-modal-title"),l=M("dialog-modal-message"),s=M("dialog-confirm-btn"),r=M("dialog-cancel-btn");i&&(i.textContent=e||"Confirm"),l&&(l.textContent=t||""),s&&(s.textContent=o||"OK"),r&&(r.textContent=n||"Cancel"),r&&(r.style.display=a?"inline-flex":"none")}function Bt(){const e=M("dialog-modal");if(!e||e.dataset.handlersAttached==="true")return;e.dataset.handlersAttached="true";const t=M("dialog-confirm-btn"),o=M("dialog-cancel-btn");e.querySelector(".modal-backdrop"),t?.addEventListener("click",()=>Ee(!0)),o?.addEventListener("click",()=>Ee(!1)),N("dialog-modal",()=>Ee(!1)),document.addEventListener("keydown",n=>{n.key==="Escape"&&gn()&&Ee(!1)})}function kt(){const e=M("dialog-modal");if(!e)return;e.classList.remove("hidden"),M("dialog-confirm-btn")?.focus()}function Z({title:e="Confirm",message:t="",confirmText:o="Delete",cancelText:n="Cancel"}={}){return Bt(),wt({title:e,message:t,confirmText:o,cancelText:n,showCancel:!0}),kt(),new Promise(a=>{we=a})}function z({title:e="Notice",message:t="",okText:o="OK"}={}){return Bt(),wt({title:e,message:t,confirmText:o,cancelText:"",showCancel:!1}),kt(),new Promise(n=>{we=()=>n(!0)})}function $e(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return Array.isArray(o)?o:null}catch{return null}}function hn(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return o&&typeof o=="object"&&!Array.isArray(o)?o:null}catch{return null}}function It(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function yn(e){const t=document.getElementById("brand-text")||document.querySelector(".brand-text");t&&(t.textContent=Te());const o=document.getElementById("board-select");if(!o)return;const n=ae();o.innerHTML="",n.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=It(a),o.appendChild(i)}),e&&(o.value=e)}function bn(e){const t=typeof e?.name=="string"?e.name.trim():"";return t?t.replace(/\.[^.]+$/,"").trim():""}function Se(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const En=new Set(["urgent","high","medium","low","none"]);function Ne(e){const t=(e||"").toString().trim().toLowerCase();return En.has(t)?t:"none"}function vn(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},o=t.showPriority!==!1,n=t.showDueDate!==!1,a=t.showAge!==!1,i=t.showChangeDate!==!1,l=typeof t.locale=="string"&&t.locale.trim()?t.locale.trim():typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US",s=Ne(t.defaultPriority),r=Number.parseInt((t.notificationDays??"").toString(),10),d=Number.isFinite(r)?Math.min(365,Math.max(0,r)):3;return{showPriority:o,showDueDate:n,showAge:a,showChangeDate:i,locale:l,defaultPriority:s,notificationDays:d}}function Dt(e){const t=(e||"").toString().trim();return t.length>=10&&t.includes("T")?t.slice(0,10):t}function xt(e){const t=typeof e?.text=="string"?e.text:"",o=typeof e?.title=="string"?e.title:t,n=typeof e?.description=="string"?e.description:"",a=Dt(e?.dueDate??e?.["due-date"]),i=typeof e?.changeDate=="string"?e.changeDate:typeof e?.changedDate=="string"?e.changedDate:void 0,l=e?.column==="done",s=typeof e?.doneDate=="string"?e.doneDate.toString().trim():"",r=Array.isArray(e?.columnHistory)?e.columnHistory.map(d=>{const c=typeof d?.column=="string"?d.column.trim():"",f=typeof d?.at=="string"?d.at.trim():"";return!c||!f?null:{column:c,at:f}}).filter(Boolean):void 0;return{...e,title:o.toString().trim(),description:n.toString().trim(),priority:Ne(e?.priority),dueDate:a,...typeof i=="string"?{changeDate:i.toString().trim()}:{},...l&&s?{doneDate:s}:{doneDate:void 0},...r&&r.length?{columnHistory:r}:{columnHistory:void 0},changedDate:void 0}}function Ln(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.text=="string"?n.text:String(n?.text??""),l=typeof n?.title=="string"?n.title:i,s=typeof n?.description=="string"?n.description:String(n?.description??""),r=Ne(n?.priority),d=typeof n?.dueDate=="string"?n.dueDate:typeof n?.["due-date"]=="string"?n["due-date"]:String(n?.dueDate??n?.["due-date"]??""),c=Dt(d),f=typeof n?.column=="string"?n.column:String(n?.column??""),u=Array.isArray(n?.labels)?n.labels.map(E=>typeof E=="string"?E:String(E)):[],m=Number.isFinite(n?.order)?n.order:void 0,p=typeof n?.creationDate=="string"?n.creationDate:void 0,g=typeof n?.changeDate=="string"?n.changeDate:typeof n?.changedDate=="string"?n.changedDate:void 0,y=typeof n?.doneDate=="string"?n.doneDate.trim():"",w=f.trim()==="done"&&(y||(typeof g=="string"?g.trim():"")||p)||"",L=Array.isArray(n?.columnHistory)?n.columnHistory.map(E=>{const B=typeof E?.column=="string"?E.column.trim():String(E?.column??"").trim(),ie=typeof E?.at=="string"?E.at.trim():String(E?.at??"").trim();return!B||!ie?null:{column:B,at:ie}}).filter(Boolean):void 0;return{id:a.trim(),title:l.trim(),description:s.trim(),priority:r,dueDate:c.trim(),column:f.trim(),...m!==void 0?{order:m}:{},...p?{creationDate:p}:{},...typeof g=="string"&&g.trim()?{changeDate:g.trim()}:{},...w?{doneDate:w}:{},...L&&L.length?{columnHistory:L}:{},labels:u}});return t.every(n=>n.id&&n.title&&n.column)?t:null}function Cn(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),l=Number.isFinite(n?.order)?n.order:void 0,s=Se(n?.color)?n.color.trim():"#3b82f6",r=n?.collapsed===!0;return{id:a.trim(),name:i.trim(),color:s,collapsed:r,...l!==void 0?{order:l}:{}}});if(!t.some(n=>n.id==="done")){const n=t.reduce((a,i)=>Math.max(a,Number.isFinite(i?.order)?i.order:0),0);t.push({id:"done",name:"Done",color:"#16a34a",order:n+1,collapsed:!1})}return t.every(n=>n.id&&n.name)?t:null}function wn(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),l=Se(n?.color)?n.color.trim():"#3b82f6",s=typeof n?.group=="string"?n.group.trim():"";return{id:a.trim(),name:i.trim(),color:l,group:s}});return t.every(n=>n.id&&n.name&&n.color)?t:null}function Bn(e){if(!e||typeof e!="object"||Array.isArray(e))return null;const t=e.showPriority!==!1,o=e.showDueDate!==!1,n=e.showAge!==!1,a=e.showChangeDate!==!1,i=typeof e.locale=="string"&&e.locale.trim()?e.locale.trim():void 0,l=typeof e.defaultPriority=="string"?e.defaultPriority:void 0,s=l?Ne(l):void 0,r=Number.parseInt((e.notificationDays??"").toString(),10),d=Number.isFinite(r)?Math.min(365,Math.max(0,r)):void 0;return{showPriority:t,showDueDate:o,showAge:n,showChangeDate:a,...i?{locale:i}:{},...s?{defaultPriority:s}:{},...d!==void 0?{notificationDays:d}:{}}}function kn(){const e=x().map(xt),t=P().map(c=>({...c,color:Se(c?.color)?c.color.trim():"#3b82f6"})),o=A(),n=k(),a=Te(),l=JSON.stringify({boardName:a,columns:t,tasks:e,labels:o,settings:n},null,2),s=new Blob([l],{type:"application/json"}),r=URL.createObjectURL(s),d=document.createElement("a");d.href=r,d.download=`${a.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(r)}function In(e){const t=typeof e=="string"?e.trim():"";if(!t)return;const o=ae().find(B=>B.id===t),n=It(o),a=`kanbanBoard:${t}:columns`,i=`kanbanBoard:${t}:tasks`,l=`kanbanBoard:${t}:labels`,s=`kanbanBoard:${t}:settings`,r=$e(i)||[],d=$e(a)||[],c=$e(l)||[],f=hn(s)||null,u=r.map(xt),m=d.map(B=>({...B,color:Se(B?.color)?B.color.trim():"#3b82f6",collapsed:B?.collapsed===!0})),p=Array.isArray(c)?c:[],g=vn(f),b=JSON.stringify({boardName:n,columns:m,tasks:u,labels:p,settings:g},null,2),w=new Blob([b],{type:"application/json"}),L=URL.createObjectURL(w),E=document.createElement("a");E.href=L,E.download=`${n.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(L)}function Dn(e){const t=new FileReader;t.onload=async o=>{try{const n=JSON.parse(o.target.result);let a,i,l,s,r;if(Array.isArray(n))a=n,i=null,l=null,s=null,r=null;else if(n.tasks&&n.columns)a=n.tasks,i=n.columns,l=Object.prototype.hasOwnProperty.call(n,"labels")?n.labels:null,s=Object.prototype.hasOwnProperty.call(n,"settings")?n.settings:null,r=typeof n.boardName=="string"?n.boardName.trim():null;else{alert("Invalid JSON file format");return}const d=Ln(a),c=i?Cn(i):null,f=l?wn(l):null,u=s?Bn(s):null;if(!d||i&&!c||l&&!f||s&&!u){alert("Invalid data structure");return}const m=r||bn(e)||"Imported board",p=ht(m);if(p?.id&&fe(p.id),c&&oe(c),q(d),f&&xe(f),u){const y=k();yt({...y,...u})}yn(p?.id);const{renderBoard:g}=await _(async()=>{const{renderBoard:y}=await Promise.resolve().then(()=>U);return{renderBoard:y}},void 0,import.meta.url);g(),document.dispatchEvent(new CustomEvent("kanban:boards-changed")),alert("Board imported successfully!")}catch(n){alert("Error parsing JSON file: "+n.message)}},t.readAsText(e)}function Tt(e,t){if(!e)return;const o=e.closest(".form-group");if(!o)return;o.classList.add("error");let n=o.querySelector(".error-message");n||(n=document.createElement("div"),n.classList.add("error-message"),o.appendChild(n)),n.textContent=t,e.focus()}function se(e){if(!e)return;const t=e.closest(".form-group");t&&t.classList.remove("error")}function xn(e){return(e?.trim()||"").length>0}function Tn(e){const t=e?.value?.trim()||"";return xn(t)?(se(e),!0):(Tt(e,"Task title is required"),!1)}function An(e){return(e?.trim()||"").length>0}function Sn(e){const t=e?.value?.trim()||"";return An(t)?(se(e),!0):(Tt(e,"Column name is required"),!1)}function at(e,t,o,n){const a=document.createElement("div");a.classList.add("accordion");const i=document.createElement("button");i.type="button",i.classList.add("accordion-header"),i.setAttribute("aria-expanded",String(o));const l=document.createElement("span");l.dataset.lucide=o?"chevron-down":"chevron-right",l.setAttribute("aria-hidden","true");const s=document.createElement("span");s.classList.add("accordion-title"),s.textContent=e;const r=document.createElement("span");r.classList.add("accordion-count"),r.textContent=t.length,i.appendChild(l),i.appendChild(s),i.appendChild(r);const d=document.createElement("div");return d.classList.add("accordion-body"),o||d.classList.add("collapsed"),t.forEach(c=>{d.appendChild(n(c))}),i.addEventListener("click",()=>{const c=i.getAttribute("aria-expanded")==="true";i.setAttribute("aria-expanded",String(!c)),d.classList.toggle("collapsed",c),l.dataset.lucide=c?"chevron-right":"chevron-down",ee()}),a.appendChild(i),a.appendChild(d),a}let st="todo",pe=null,ge=null,de=null,Be=null,D=[],W=!1,ye=!1;const J=40;let le=!1;function Me(e){const t=document.getElementById("task-modal");if(!t)return;t.classList.toggle("fullscreen",!!e);const o=document.getElementById("task-fullpage-btn");if(o?.setAttribute("aria-pressed",e?"true":"false"),o){const n=o.querySelector("[data-lucide]");n&&n.setAttribute("data-lucide",e?"minimize-2":"maximize-2"),o.title=e?"Exit full page":"Open in full page"}ee()}function K(e){const t=document.getElementById(e);return!!t&&!t.classList.contains("hidden")}function N(e,t){const o=document.getElementById(e);if(!o)return;o.querySelector(".modal-backdrop")?.addEventListener("click",t),o.querySelectorAll('[id$="-close-btn"], [id$="-close-modal-btn"], [id$="-cancel-btn"], [id^="cancel-"]').forEach(i=>{i.addEventListener("click",t)})}function Nn(){const e=document.getElementById("task-modal");e&&(e.classList.remove("hidden"),ne(),document.getElementById("task-label-search")?.focus(),W=!1)}function Mn(){return(document.getElementById("task-label-search")?.value||"").trim().toLowerCase()}function Pn(){return(document.getElementById("labels-search")?.value||"").trim().toLowerCase()}function Qe(){const e=document.getElementById("task-active-labels");if(!e)return;const t=A(),o=[];for(const a of D)o.includes(a)||o.push(a);D=o;const n=o.map(a=>t.find(i=>i.id===a)).filter(Boolean);e.innerHTML="",e.style.display=n.length>0?"flex":"none",n.forEach(a=>{const i=document.createElement("span");i.classList.add("task-label"),i.style.backgroundColor=a.color,i.textContent=a.name;const l=document.createElement("button");l.type="button",l.classList.add("active-label-remove"),l.setAttribute("aria-label",`Remove label ${a.name}`),l.title="Remove label",l.textContent="Ã—",l.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),D=D.filter(r=>r!==a.id),Qe(),ne()}),i.appendChild(l),e.appendChild(i)})}function $n(e){st=e||P()[0]?.id||"todo",pe=null,D=[],W=!1,ye=!1,Me(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden");const t=document.getElementById("task-modal"),o=document.getElementById("task-column"),n=document.getElementById("task-title"),a=document.getElementById("task-description"),i=document.getElementById("task-priority"),l=document.getElementById("task-due-date"),s=document.getElementById("task-modal-title"),r=document.getElementById("task-submit-btn");if(se(n),s.textContent="Add New Task",r.textContent="Add Task",o.value=st,n.value="",a.value="",i){const c=k();i.value=c.defaultPriority||"none"}l&&(l.value="");const d=document.getElementById("task-label-search");d&&(d.value=""),ne(),t.classList.remove("hidden"),n.focus()}function j(e){const o=x().find(g=>g.id===e);if(!o)return;pe=e,D=o.labels||[],W=!1,ye=!1,Me(!1),document.getElementById("task-fullpage-btn")?.classList.remove("hidden");const n=document.getElementById("task-modal"),a=document.getElementById("task-column"),i=document.getElementById("task-title"),l=document.getElementById("task-description"),s=document.getElementById("task-priority"),r=document.getElementById("task-due-date"),d=document.getElementById("task-modal-title"),c=document.getElementById("task-submit-btn");se(i),d.textContent="Edit Task",c.textContent="Save Changes",a.value=o.column;const f=typeof o.text=="string"?o.text:"";i.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:f,l.value=typeof o.description=="string"?o.description:"",s&&(s.value=typeof o.priority=="string"?o.priority:"none");const u=typeof o.dueDate=="string"?o.dueDate:"",m=u.includes("T")?u.slice(0,10):u;r&&(r.value=m);const p=document.getElementById("task-label-search");p&&(p.value=""),ne(),n.classList.remove("hidden"),i.focus()}function _e(){document.getElementById("task-modal").classList.add("hidden"),pe=null,W=!1,Me(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden")}function _n(){ge=null;const e=document.getElementById("column-modal"),t=document.getElementById("column-name"),o=document.getElementById("column-color"),n=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");se(t),n.textContent="Add New Column",a.textContent="Add Column",t.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),t.focus()}function On(e){const o=P().find(r=>r.id===e);if(!o)return;ge=e;const n=document.getElementById("column-modal"),a=document.getElementById("column-name"),i=document.getElementById("column-color"),l=document.getElementById("column-modal-title"),s=document.getElementById("column-submit-btn");se(a),l.textContent="Edit Column",s.textContent="Save Changes",a.value=o.name,i&&(i.value=o.color||"#3b82f6"),n.classList.remove("hidden"),a.focus()}function Oe(){document.getElementById("column-modal").classList.add("hidden"),ge=null}function Rn(){const e=document.getElementById("labels-search");e&&(e.value=""),Ie(),document.getElementById("labels-modal").classList.remove("hidden"),W||document.getElementById("labels-search")?.focus()}function Re(){document.getElementById("labels-modal").classList.add("hidden");const t=document.getElementById("labels-search");t&&(t.value=""),W&&Nn()}function Hn(){document.getElementById("help-modal").classList.remove("hidden")}function it(){document.getElementById("help-modal").classList.add("hidden")}const Fn=/^#[0-9a-fA-F]{6}$/;function rt(e){return Fn.test(e)}function At(e){const t=document.getElementById("label-color-hex");t&&(t.value=e,t.classList.remove("invalid"))}function zn(){const e=document.getElementById("label-group-suggestions");if(!e)return;e.innerHTML="";const t=A();[...new Set(t.map(n=>(n.group||"").trim()).filter(n=>n.length>0))].sort((n,a)=>n.localeCompare(a)).forEach(n=>{const a=document.createElement("option");a.value=n,e.appendChild(a)})}function ke(e=null,{openedFromTaskEditor:t=!1,initialName:o=""}={}){de=e,le=!1,ye=!!t;const n=document.getElementById("label-modal"),a=document.getElementById("label-modal-title"),i=document.getElementById("label-name"),l=document.getElementById("label-color"),s=document.getElementById("label-group"),r=document.getElementById("label-submit-btn");if(e){const c=A().find(f=>f.id===e);c&&(a.textContent="Edit Label",r.textContent="Update Label",i.value=c.name,l.value=c.color,s&&(s.value=c.group||""))}else a.textContent="Add Label",r.textContent="Add Label",i.value=o||"",l.value="#3b82f6",s&&(s.value="");zn(),At(l.value),n.classList.remove("hidden"),i.focus()}function He(){document.getElementById("label-modal").classList.add("hidden"),de=null,ye=!1}function lt(e){const t=document.createElement("div");t.classList.add("label-item"),t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-between";const o=document.createElement("span");o.classList.add("task-label"),o.style.backgroundColor=e.color,o.textContent=e.name;const n=document.createElement("div");n.classList.add("label-actions"),n.style.display="flex",n.style.gap="4px";const a=document.createElement("button");a.classList.add("btn-small");const i=document.createElement("span");i.dataset.lucide="pencil",a.appendChild(i),a.title="Edit label",a.addEventListener("click",()=>ke(e.id));const l=document.createElement("button");l.classList.add("btn-small","btn-danger");const s=document.createElement("span");return s.dataset.lucide="trash-2",l.appendChild(s),l.title="Delete label",l.addEventListener("click",async()=>{if(await Z({title:"Delete Label",message:`Delete label "${e.name}"? This will remove it from all tasks.`,confirmText:"Delete"})){pn(e.id),Ie();const{renderBoard:d}=await _(async()=>{const{renderBoard:c}=await Promise.resolve().then(()=>U);return{renderBoard:c}},void 0,import.meta.url);d()}}),n.appendChild(a),n.appendChild(l),t.appendChild(o),t.appendChild(n),t}function St(e){const t=e.filter(a=>!(a.group||"").trim()),o=new Map;e.forEach(a=>{const i=(a.group||"").trim();i&&(o.has(i)||o.set(i,[]),o.get(i).push(a))});const n=[...o.keys()].sort((a,i)=>a.localeCompare(i));return{ungrouped:t,groupMap:o,sortedGroups:n}}function Ie(){const e=document.getElementById("labels-list");e.innerHTML="";const t=A(),o=Pn(),n=o?t.filter(r=>{const d=(r.name||"").toLowerCase(),c=(r.id||"").toLowerCase(),f=(r.group||"").toLowerCase();return d.includes(o)||c.includes(o)||f.includes(o)}):t;if(n.length===0){const r=document.createElement("div");r.classList.add("labels-empty"),r.textContent=o?"No matching labels":"No labels yet",e.appendChild(r);return}const{ungrouped:a,groupMap:i,sortedGroups:l}=St(n);let s=!0;a.length>0&&(e.appendChild(at("Ungrouped",a,s,lt)),s=!1),l.forEach(r=>{e.appendChild(at(r,i.get(r),s,lt)),s=!1}),ee()}function qe(){const e=document.getElementById("board-select");if(!e)return;const t=ae(),o=Je();e.innerHTML="",t.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=typeof a.name=="string"&&a.name.trim()?a.name.trim():"Untitled board",e.appendChild(i)}),o&&(e.value=o);const n=document.getElementById("brand-text")||document.querySelector(".brand-text");n&&(n.textContent=Te())}function he(){Ae();const e=document.getElementById("boards-list");if(!e)return;e.innerHTML="";const t=ae(),o=Je();t.forEach(n=>{const a=document.createElement("div");a.classList.add("label-item"),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="10px";const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";const l=document.createElement("span");if(l.textContent=(n.name||"").toString(),i.appendChild(l),n.id===o){const g=document.createElement("span");g.classList.add("task-label"),g.style.backgroundColor="var(--color-primary)",g.textContent="Active",i.appendChild(g)}const s=document.createElement("div");s.classList.add("label-actions"),s.style.display="flex",s.style.gap="4px";const r=document.createElement("button");r.classList.add("btn-small"),r.textContent="Open",r.title="Open board",r.addEventListener("click",async()=>{fe(n.id),qe(),he();const{renderBoard:g}=await _(async()=>{const{renderBoard:y}=await Promise.resolve().then(()=>U);return{renderBoard:y}},void 0,import.meta.url);g()});const d=document.createElement("button");d.classList.add("btn-small"),d.type="button",d.title="Export board",d.setAttribute("aria-label",`Export board ${String(n.name||"Untitled board")}`);const c=document.createElement("span");c.dataset.lucide="download",d.appendChild(c),d.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),In(n.id)});const f=document.createElement("button");f.classList.add("btn-small");const u=document.createElement("span");u.dataset.lucide="pencil",f.appendChild(u),f.title="Rename board",f.addEventListener("click",()=>jn(n.id));const m=document.createElement("button");m.classList.add("btn-small","btn-danger");const p=document.createElement("span");p.dataset.lucide="trash-2",m.appendChild(p),m.title="Delete board",m.addEventListener("click",async()=>{if(!await Z({title:"Delete Board",message:`Do you really want to delete the board "${n.name}"? This cannot be undone.`,confirmText:"Delete"}))return;if(!Gt(n.id)){await z({title:"Unable to Delete",message:"Unable to delete board (you may be trying to delete the last board)."});return}qe(),he();const{renderBoard:b}=await _(async()=>{const{renderBoard:w}=await Promise.resolve().then(()=>U);return{renderBoard:w}},void 0,import.meta.url);b()}),s.appendChild(r),s.appendChild(d),s.appendChild(f),s.appendChild(m),a.appendChild(i),a.appendChild(s),e.appendChild(a)}),ee()}function Un(){he(),document.getElementById("boards-modal")?.classList.remove("hidden")}function dt(){document.getElementById("boards-modal")?.classList.add("hidden")}function qn(){const e=document.getElementById("boards-modal");!e||e.classList.contains("hidden")||he()}function jn(e){Ae();const t=ae().find(l=>l.id===e);if(!t)return;Be=e;const o=document.getElementById("board-rename-modal"),n=document.getElementById("board-rename-name"),a=document.getElementById("board-rename-modal-title"),i=document.getElementById("board-rename-submit-btn");a&&(a.textContent="Rename Board"),i&&(i.textContent="Save"),n&&(n.value=(t.name||"").toString()),o?.classList.remove("hidden"),n?.focus()}function Fe(){document.getElementById("board-rename-modal")?.classList.add("hidden"),Be=null}function ct(e){const t=document.createElement("label");t.classList.add("label-checkbox");const o=document.createElement("input");o.type="checkbox",o.value=e.id,o.checked=D.includes(e.id),o.addEventListener("change",a=>{a.target.checked?D.includes(e.id)||D.push(e.id):D=D.filter(i=>i!==e.id),Qe()});const n=document.createElement("span");return n.classList.add("task-label","label-color-swatch"),n.style.backgroundColor=e.color,n.textContent=e.name,t.appendChild(o),t.appendChild(n),t}function ne(){Qe();const e=document.getElementById("task-labels-selection");e.innerHTML="";const t=Mn(),o=A(),n=t?o.filter(s=>{const r=(s.name||"").toLowerCase(),d=(s.id||"").toLowerCase(),c=(s.group||"").toLowerCase();return r.includes(t)||d.includes(t)||c.includes(t)}):o;if(n.length===0){if(t){const s=document.createElement("button");s.type="button",s.classList.add("labels-empty-button"),s.textContent=`No label found "${t}" - Create label`,s.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation(),ke(null,{openedFromTaskEditor:!0,initialName:t})}),e.appendChild(s)}else{const s=document.createElement("div");s.classList.add("labels-empty"),s.textContent="No matching labels",e.appendChild(s)}return}const{ungrouped:a,groupMap:i,sortedGroups:l}=St(n);a.forEach(s=>{e.appendChild(ct(s))}),l.forEach(s=>{const r=document.createElement("div");r.classList.add("label-group-header","label-group-header-picker"),r.textContent=s,e.appendChild(r),i.get(s).forEach(d=>{e.appendChild(ct(d))})})}function Vn(){document.addEventListener("kanban:boards-changed",()=>{qn()}),document.getElementById("task-label-search")?.addEventListener("input",ne),document.getElementById("labels-search")?.addEventListener("input",Ie),document.getElementById("task-add-label-btn")?.addEventListener("click",()=>{W=!1,ke(null,{openedFromTaskEditor:!0})}),document.getElementById("task-fullpage-btn")?.addEventListener("click",()=>{const s=document.getElementById("task-modal");s&&Me(!s.classList.contains("fullscreen"))}),document.getElementById("task-form").addEventListener("submit",async s=>{s.preventDefault();const r=document.getElementById("task-title");if(!Tn(r))return;const d=r.value.trim(),c=document.getElementById("task-description").value,f=document.getElementById("task-priority")?.value,u=document.getElementById("task-due-date")?.value,m=document.getElementById("task-column").value;pe?Zt(pe,d,c,f,u,m,D):Qt(d,c,f,u,m,D),_e();const{renderBoard:p}=await _(async()=>{const{renderBoard:g}=await Promise.resolve().then(()=>U);return{renderBoard:g}},void 0,import.meta.url);p()}),N("task-modal",_e),document.getElementById("column-form").addEventListener("submit",async s=>{s.preventDefault();const r=document.getElementById("column-name");if(!Sn(r))return;const d=r.value.trim(),c=document.getElementById("column-color")?.value;ge?rn(ge,d,c):an(d,c),Oe();const{renderBoard:f}=await _(async()=>{const{renderBoard:u}=await Promise.resolve().then(()=>U);return{renderBoard:u}},void 0,import.meta.url);f()}),N("column-modal",Oe),document.getElementById("manage-labels-btn").addEventListener("click",Rn),document.getElementById("add-label-btn").addEventListener("click",()=>ke()),N("labels-modal",Re);const a=document.getElementById("label-name");a?.addEventListener("beforeinput",s=>{if(!s||typeof s.data!="string"||s.data.length===0)return;const r=s.target;if(!r||typeof r.value!="string")return;const d=typeof r.selectionStart=="number"?r.selectionStart:r.value.length,c=typeof r.selectionEnd=="number"?r.selectionEnd:r.value.length;(r.value.slice(0,d)+s.data+r.value.slice(c)).trim().length<=J||(s.preventDefault(),!le&&(le=!0,z({title:"Label Name Too Long",message:`Label names are limited to ${J} characters.`})))});const i=document.getElementById("label-color");i?.addEventListener("input",s=>{At(s.target.value)}),document.getElementById("label-color-hex")?.addEventListener("input",s=>{let r=s.target.value;r&&!r.startsWith("#")&&(r="#"+r),rt(r)?(i.value=r,s.target.classList.remove("invalid")):s.target.classList.toggle("invalid",r.length>0)}),a?.addEventListener("input",s=>{const r=s.target;if(!r||typeof r.value!="string")return;const d=r.value.trim();d.length<=J||(r.value=d.slice(0,J),!le&&(le=!0,z({title:"Label Name Too Long",message:`Label names are limited to ${J} characters.`})))}),document.getElementById("label-form").addEventListener("submit",async s=>{s.preventDefault();const r=document.getElementById("label-name").value,d=document.getElementById("label-color-hex"),c=(d?.value||"").trim();let f;if(c&&c!==document.getElementById("label-color").value){const b=c.startsWith("#")?c:"#"+c;if(!rt(b)){d?.classList.add("invalid"),await z({title:"Invalid Hex Color",message:"Please enter a valid hex color code (e.g. #3b82f6)."}),d?.focus();return}document.getElementById("label-color").value=b,f=b}else f=document.getElementById("label-color").value;const u=(r||"").trim();if(u.length>J){await z({title:"Label Name Too Long",message:`Label names are limited to ${J} characters.`});return}const m=(document.getElementById("label-group")?.value||"").trim(),p=!de,g=de?fn(de,u,f,m):mn(u,f,m);if(!g?.success){let b="Unable to Save Label",w="Could not save label.";g?.reason==="DUPLICATE_NAME"?(b="Label Already Exists",w=g?.message||"A label with that name already exists (case-insensitive)."):g?.reason==="EMPTY_NAME"&&(b="Label Name Required",w="Please enter a label name."),await z({title:b,message:w}),document.getElementById("label-name")?.focus();return}p&&ye&&g?.label?.id&&(D.includes(g.label.id)||D.push(g.label.id),ne(),document.getElementById("task-label-search")?.focus()),He(),Ie();const{renderBoard:y}=await _(async()=>{const{renderBoard:b}=await Promise.resolve().then(()=>U);return{renderBoard:b}},void 0,import.meta.url);y(),W&&p&&Re()}),N("label-modal",He),document.getElementById("manage-boards-btn")?.addEventListener("click",Un),document.getElementById("add-board-btn")?.addEventListener("click",async()=>{document.dispatchEvent(new CustomEvent("kanban:open-board-create"))}),document.getElementById("boards-import-btn")?.addEventListener("click",async()=>{await Z({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file")?.click()}),N("boards-modal",dt),document.getElementById("board-rename-form")?.addEventListener("submit",s=>{if(s.preventDefault(),!Be)return;const d=(document.getElementById("board-rename-name")?.value||"").trim();if(!d){alert("Board name cannot be empty.");return}if(!Jt(Be,d)){alert("Unable to rename board.");return}Fe(),qe(),he(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),N("board-rename-modal",Fe),document.getElementById("help-btn").addEventListener("click",Hn),N("help-modal",it),document.getElementById("add-column-btn").addEventListener("click",_n),document.addEventListener("keydown",s=>{if(s.key==="Escape"){if(K("label-modal")){He();return}if(K("labels-modal")){Re();return}if(K("board-rename-modal")){Fe();return}if(K("boards-modal")){dt();return}if(K("help-modal")){it();return}if(K("column-modal")){Oe();return}K("task-modal")&&_e()}})}let je=[],Ce=null,ce=null,V=0,$=0;const Ve="is-drop-hover";let We=!1,Q=null;function Wn(){const e=typeof navigator<"u"&&(navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0),t=typeof window<"u"&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer: coarse)").matches;return e||t}function Yn(){Gn(),Zn(),eo()}function Gn(){je.forEach(e=>e.destroy()),je=[],Ce&&(Ce.destroy(),Ce=null),Nt()}function Jn(){const e=document.getElementById("board-container");!e||ce||(ce=setInterval(()=>{if(!e)return;const t=e.getBoundingClientRect(),o=80,n=12;V>0&&(V<t.left+o&&e.scrollLeft>0?e.scrollLeft-=n:V>t.right-o&&e.scrollLeft<e.scrollWidth-e.clientWidth&&(e.scrollLeft+=n))},16))}function Nt(){ce&&(clearInterval(ce),ce=null),V=0,$=0}function Kn(){if(!We||!Q)return;const e=Q.getBoundingClientRect(),t=80,o=20;let n=0;if($>0){if($<e.top+t){const a=Math.max(0,$-e.top),i=(t-a)/t;n=-Math.ceil(i*o)}else if($>e.bottom-t){const a=Math.max(0,e.bottom-$),i=(t-a)/t;n=Math.ceil(i*o)}}n!==0&&(Q.scrollTop+=n)}function Xn(){document.querySelectorAll(".task-column.is-collapsed .tasks").forEach(e=>{e.classList.contains("hidden")&&(e.dataset.wasHidden="true",e.classList.remove("hidden"))})}function Qn(){document.querySelectorAll(".task-column.is-collapsed .tasks").forEach(e=>{e.dataset.wasHidden==="true"&&(e.classList.add("hidden"),delete e.dataset.wasHidden)})}function De(){document.querySelectorAll(`.task-column.is-collapsed.${Ve}`).forEach(e=>e.classList.remove(Ve))}function Mt(e){De(),e&&e.classList.add(Ve)}function ve(e){e.touches&&e.touches[0]?(V=e.touches[0].clientX,$=e.touches[0].clientY):e.clientX&&(V=e.clientX,$=e.clientY),Pt(V,$),Kn()}function Pt(e,t){if(!e&&!t)return;const n=document.elementFromPoint(e,t)?.closest?.(".task-column");n&&n.classList.contains("is-collapsed")?Mt(n):De()}function Zn(){const e=document.querySelectorAll(".tasks"),t=Wn();e.forEach(o=>{const n=new bt(o,{group:{name:"tasks",pull:!0,put:!0},animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"task-ghost",chosenClass:"task-chosen",dragClass:"task-drag",draggable:".task",forceFallback:t,fallbackClass:"task-fallback",fallbackOnBody:!0,fallbackTolerance:0,swapThreshold:.65,emptyInsertThreshold:20,direction:"vertical",scroll:!0,scrollSensitivity:120,scrollSpeed:22,bubbleScroll:!0,onStart:function(a){document.body.classList.add("dragging"),We=!0,Q=a.from||null,Xn(),Jn(),document.addEventListener("touchmove",ve,{passive:!0}),document.addEventListener("mousemove",ve,{passive:!0}),Pt(V,$)},onMove:function(a){Q=a.to||Q;const i=a.to?.closest(".task-column");i&&i.classList.contains("is-collapsed")?Mt(i):De()},onEnd:async function(a){document.body.classList.remove("dragging"),We=!1,Q=null,Nt(),document.removeEventListener("touchmove",ve),document.removeEventListener("mousemove",ve);const i=tn(a),l=a.to?.closest(".task-column");if(i&&l?.classList.contains("is-collapsed")&&nn(i.movedTaskId,i.toColumn),De(),Qn(),i){const{syncTaskCounters:s,syncCollapsedTitles:r}=await _(async()=>{const{syncTaskCounters:c,syncCollapsedTitles:f}=await Promise.resolve().then(()=>U);return{syncTaskCounters:c,syncCollapsedTitles:f}},void 0,import.meta.url),{refreshNotifications:d}=await _(async()=>{const{refreshNotifications:c}=await Promise.resolve().then(()=>ao);return{refreshNotifications:c}},void 0,import.meta.url);s(),i.didChangeColumn&&(r(),d())}}});je.push(n)})}function eo(){const e=document.getElementById("board-container");e&&(Ce=new bt(e,{animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"column-ghost",chosenClass:"column-chosen",dragClass:"column-drag",handle:".column-header",filter:"button:not(.column-drag-handle), a, input, select, textarea, [contenteditable]",preventOnFilter:!0,draggable:".task-column",scrollSensitivity:80,scrollSpeed:15,forceFallback:!1,fallbackOnBody:!0,onStart:function(t){document.body.classList.add("dragging-column")},onEnd:function(t){document.body.classList.remove("dragging-column"),dn()}}))}function Ye(e,t=null){const o=(e||"").toString().trim();if(!o)return null;const n=new Date(o+"T00:00:00");if(Number.isNaN(n.getTime()))return null;const a=t||new Date;a.setHours(0,0,0,0);const i=n.getTime()-a.getTime();return Math.floor(i/(1e3*60*60*24))}function to(e){if(e===null)return"";if(e<0){const t=Math.abs(e);if(t<30)return`overdue by ${t} day${t===1?"":"s"}`;{const o=Math.floor(t/30),n=t%30,a=`${o} month${o===1?"":"s"}`,i=n>0?` ${n} day${n===1?"":"s"}`:"";return`overdue by ${a}${i}`}}else{if(e===0)return"today";if(e===1)return"tomorrow";if(e<30)return`${e} days`;{const t=Math.floor(e/30),o=e%30,n=`${t} month${t===1?"":"s"}`,a=o>0?` ${o} day${o===1?"":"s"}`:"";return`${n}${a}`}}}function no(e,t=3,o=10){return e===null?"countdown-none":e<t?"countdown-urgent":e<=o?"countdown-warning":"countdown-normal"}const $t="kanbanNotificationBannerHidden";let ut;function _t(){return localStorage.getItem($t)==="true"}function mt(e){localStorage.setItem($t,e?"true":"false")}function Ot(){const e=document.getElementById("notification-banner-visibility-toggle");e&&(e.checked=!_t())}function Pe(){const e=x(),t=k(),o=Number.isFinite(t.notificationDays)?t.notificationDays:3,n=new Date;return n.setHours(0,0,0,0),e.filter(a=>{if(a.column==="done")return!1;const i=(a.dueDate||"").toString().trim();if(!i)return!1;const l=Ye(i,n);return l===null?!1:l<=o}).map(a=>{const i=Ye(a.dueDate,n);return{...a,daysUntilDue:i}}).sort((a,i)=>a.daysUntilDue-i.daysUntilDue)}function Rt(e,t,o){const a=new Date(t+"T00:00:00").toLocaleDateString(o||void 0);if(e<0){const i=Math.abs(e);return{text:`Overdue by ${i} day${i===1?"":"s"} (${a})`,className:"overdue"}}else return e===0?{text:`Due today (${a})`,className:"overdue"}:e===1?{text:`Due tomorrow (${a})`,className:"due-soon"}:{text:`Due in ${e} days (${a})`,className:"due-soon"}}function Ze(){const e=document.getElementById("notification-banner"),t=document.getElementById("notification-banner-list");if(!e||!t)return;const o=Pe(),n=k();if(o.length===0){e.classList.add("hidden");return}if(_t()){e.classList.add("hidden");return}t.innerHTML="";const a=window.matchMedia("(min-width: 601px)").matches,i=l=>{const s=document.createElement("div");s.classList.add("notification-banner-item"),s.setAttribute("role","button"),s.setAttribute("tabindex","0"),s.setAttribute("aria-label",`Open task: ${l.title}`);const r=document.createElement("span");r.classList.add("task-title");const d=typeof l.text=="string"?l.text:"";r.textContent=typeof l.title=="string"&&l.title.trim()?l.title:d;const c=Rt(l.daysUntilDue,l.dueDate,n.locale),f=document.createElement("span");f.classList.add("due-date",c.className),f.textContent=c.text,s.appendChild(r),s.appendChild(f);const u=()=>j(l.id);return s.addEventListener("click",u),s.addEventListener("keydown",m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),u())}),s};if(a){const l=t.clientWidth||t.getBoundingClientRect().width;let s=0;for(const d of o){const c=i(d);if(t.appendChild(c),s+=1,t.scrollWidth>l&&s>1){t.removeChild(c),s-=1;break}}const r=o.length-s;if(r>0){const d=document.createElement("div");if(d.classList.add("notification-banner-item","notification-more"),d.setAttribute("role","button"),d.setAttribute("tabindex","0"),d.textContent=`+${r} `,d.addEventListener("click",te),d.addEventListener("keydown",c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),te())}),t.appendChild(d),t.scrollWidth>l&&s>0){t.removeChild(t.children[s-1]),s-=1;const c=o.length-s;d.textContent=`+${c} `,t.appendChild(d)}}}else if(o.slice(0,5).forEach(s=>{const r=i(s);t.appendChild(r)}),o.length>5){const s=document.createElement("div");s.classList.add("notification-banner-item","notification-more"),s.setAttribute("role","button"),s.setAttribute("tabindex","0"),s.textContent=`+${o.length-5} `,s.addEventListener("click",te),s.addEventListener("keydown",r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),te())}),t.appendChild(s)}e.classList.remove("hidden"),ee()}function oo(){const e=document.getElementById("notifications-list");if(!e)return;const t=Pe(),o=k(),n=Number.isFinite(o.notificationDays)?o.notificationDays:3;if(e.innerHTML="",t.length===0){const a=document.createElement("div");a.classList.add("notifications-empty"),a.textContent=n===0?"No tasks due today.":`No tasks due within the next ${n} day${n===1?"":"s"}.`,e.appendChild(a);return}t.forEach(a=>{const i=document.createElement("div");i.classList.add("notification-item"),i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.setAttribute("aria-label",`Open task: ${a.title}`);const l=document.createElement("div");l.classList.add("notification-item-content");const s=document.createElement("div");s.classList.add("notification-item-title");const r=typeof a.text=="string"?a.text:"";s.textContent=typeof a.title=="string"&&a.title.trim()?a.title:r;const d=document.createElement("div");d.classList.add("notification-item-meta");const c=Rt(a.daysUntilDue,a.dueDate,o.locale),f=document.createElement("span");f.classList.add(c.className),f.textContent=c.text;const u=typeof a.priority=="string"?a.priority:"none",m=document.createElement("span");m.classList.add("notification-item-priority",`priority-${u}`),m.textContent=u,d.appendChild(f),d.appendChild(m),l.appendChild(s),l.appendChild(d);const p=document.createElement("span");p.classList.add("notification-item-arrow"),p.dataset.lucide="chevron-right",i.appendChild(l),i.appendChild(p);const g=()=>{ue(),j(a.id)};i.addEventListener("click",g),i.addEventListener("keydown",y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),g())}),e.appendChild(i)}),ee()}function Ht(){const e=document.getElementById("notification-badge");if(!e)return;const o=Pe().length;o===0?(e.classList.add("hidden"),e.textContent=""):(e.classList.remove("hidden"),e.textContent=o>99?"99+":String(o))}function te(){Ot(),oo(),document.getElementById("notifications-modal")?.classList.remove("hidden")}function ue(){document.getElementById("notifications-modal")?.classList.add("hidden")}function Ft(){const e=document.getElementById("notifications-modal");return e&&!e.classList.contains("hidden")}function zt(){document.getElementById("notification-banner-close-btn")?.addEventListener("click",()=>{mt(!0),me()});const t=document.getElementById("notification-banner-visibility-toggle");t?.addEventListener("change",()=>{mt(!t.checked),me()}),document.getElementById("notifications-btn")?.addEventListener("click",te),document.getElementById("notifications-close-btn")?.addEventListener("click",ue),N("notifications-modal",ue),document.addEventListener("keydown",a=>{a.key==="Escape"&&Ft()&&ue()}),window.addEventListener("resize",()=>{clearTimeout(ut),ut=setTimeout(Ze,120)}),me(),Ot()}function me(){Ze(),Ht()}const ao=Object.freeze(Object.defineProperty({__proto__:null,getNotificationTasks:Pe,hideNotificationsModal:ue,initializeNotifications:zt,isNotificationsModalOpen:Ft,refreshNotifications:me,renderNotificationBanner:Ze,showNotificationsModal:te,updateNotificationBadge:Ht},Symbol.toStringTag,{value:"Module"}));let ft=!1,et="";const Ut=50,so=50;let Le=Ut;function qt(e){et=(e||"").toString()}function jt(e){return x().filter(o=>o.column===e).length}function Vt(e,t,o){if(!t)return!0;const n=typeof e?.text=="string"?e.text:"",a=typeof e?.title=="string"&&e.title.trim()!==""?e.title:n,i=typeof e?.description=="string"?e.description:"",l=typeof e?.priority=="string"?e.priority:"";if(a.toLowerCase().includes(t)||i.toLowerCase().includes(t)||l.toLowerCase().includes(t))return!0;const s=Array.isArray(e?.labels)?e.labels:[];for(const r of s){const d=o.get(r);if(d&&(d.name.includes(t)||d.group.includes(t)))return!0}return!1}function X(e=null){document.querySelectorAll(".column-menu").forEach(t=>{e&&t===e||t.classList.add("hidden")}),document.querySelectorAll(".column-submenu").forEach(t=>{t.classList.add("hidden")})}function io(e){return[...e].sort((t,o)=>{const n=(t.dueDate||"").toString().trim(),a=(o.dueDate||"").toString().trim();return!n&&!a?0:n?a?n.localeCompare(a):-1:1})}function ro(e){const t={urgent:0,high:1,medium:2,low:3,none:4};return[...e].sort((o,n)=>{const a=t[o.priority]??4,i=t[n.priority]??4;return a-i})}function pt(e,t){const o=x(),n=o.filter(r=>r.column===e),a=o.filter(r=>r.column!==e),l=(t==="dueDate"?io(n):ro(n)).map((r,d)=>({...r,order:d+1})),s=[...a,...l];q(s),O()}function lo(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=o.includes("T")?o:`${o}T00:00:00`,a=new Date(n);return Number.isNaN(a.getTime())?o:a.toLocaleDateString(t||void 0)}function co(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=new Date(o);return Number.isNaN(n.getTime())?o:n.toLocaleString(t||void 0)}function uo(e){const t=(e?.creationDate||"").toString().trim();if(!t)return"";const o=new Date(t);if(Number.isNaN(o.getTime()))return"";const n=1440*60*1e3,a=Math.max(0,Math.floor((Date.now()-o.getTime())/n));if(a<30)return`${a}d`;const i=Math.floor(a/365);let l=a%365;const s=Math.floor(l/30);l=l%30;const r=[];return i>=1&&r.push(`${i}y`),s>=1&&r.push(`${s}M`),r.push(`${l}d`),r.join(" ")}function mo(e,t,o=null,n=null){const a=document.createElement("li");a.classList.add("task"),a.draggable=!0,a.dataset.taskId=e.id,a.setAttribute("role","listitem"),a.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const i=document.createElement("div");i.classList.add("task-labels"),i.setAttribute("role","list"),i.setAttribute("aria-label","Task labels");const l=o||new Map(A().map(h=>[h.id,h]));e.labels&&e.labels.length>0&&e.labels.forEach(h=>{const v=l instanceof Map?l.get(h):l.find(C=>C.id===h);if(v){const C=document.createElement("span");C.classList.add("task-label"),C.setAttribute("role","listitem"),C.style.backgroundColor=v.color,C.textContent=v.name,i.appendChild(C)}});const s=document.createElement("div");s.classList.add("task-header");const r=t?.showPriority!==!1,d=t?.showDueDate!==!1,c=document.createElement("div");c.classList.add("task-title"),c.setAttribute("role","button"),c.setAttribute("tabindex","0");const f=typeof e.text=="string"?e.text:"";c.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:f,c.addEventListener("click",()=>j(e.id)),c.addEventListener("keydown",h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),j(e.id))});const u=document.createElement("div");if(u.classList.add("task-actions"),r){const h=typeof e.priority=="string"?e.priority.toLowerCase().trim():"",v=h==="urgent"||h==="high"||h==="medium"||h==="low"||h==="none"?h:"none",C=document.createElement("span");C.classList.add("task-priority",`priority-${v}`,"task-priority-header"),C.textContent=v,C.setAttribute("aria-label",`Priority: ${v}`),C.setAttribute("role","button"),C.setAttribute("tabindex","0"),C.title="Edit task",C.addEventListener("click",T=>{T.stopPropagation(),j(e.id)}),C.addEventListener("keydown",T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),j(e.id))}),u.appendChild(C)}const m=document.createElement("button");m.classList.add("delete-task-btn"),m.setAttribute("aria-label","Delete task"),m.type="button";const p=document.createElement("span");p.dataset.lucide="trash-2",p.setAttribute("aria-hidden","true"),m.appendChild(p),m.addEventListener("click",async h=>{h.stopPropagation(),await Z({title:"Delete Task",message:"Are you sure you want to delete this task?",confirmText:"Delete"})&&en(e.id)&&O()}),u.appendChild(m),s.appendChild(c),s.appendChild(u);const g=typeof e.description=="string"?e.description.trim():"",y=document.createElement("div");y.classList.add("task-description"),y.textContent=g,y.style.display=g?"block":"none",y.addEventListener("click",()=>j(e.id)),a.appendChild(s),a.appendChild(y),a.appendChild(i);const b=t?.showChangeDate!==!1,w=t?.showAge!==!1,L=t?.locale,E=document.createElement("div");if(E.classList.add("task-footer"),b){const h=document.createElement("span");h.classList.add("task-change-date");const v=co(e?.changeDate,L);h.textContent=v?`Updated ${v}`:"",E.appendChild(h)}const B=document.createElement("div");if(B.classList.add("task-footer-row"),d){const h=typeof e.dueDate=="string"?e.dueDate.trim():"",v=document.createElement("span");if(v.classList.add("task-date"),!h)v.textContent="No due date",v.classList.add("countdown-none");else{const C=lo(h,t?.locale),T=Ye(h,n);if(T!==null){const S=to(T),R=t?.countdownUrgentThreshold??3,H=t?.countdownWarningThreshold??10,G=no(T,R,H);v.textContent=`Due ${C} (${S})`,v.classList.add(G)}else v.textContent="Due "+C,v.classList.add("countdown-none")}B.appendChild(v)}if(w){const h=document.createElement("span");h.classList.add("task-age");const v=uo(e);h.textContent=v?`Age ${v}`:"",B.appendChild(h)}return Array.from(B.childNodes).some(h=>(h.textContent||"").trim()!=="")&&E.appendChild(B),Array.from(E.childNodes).some(h=>(h.textContent||"").trim()!=="")&&a.appendChild(E),a}function fo(e){const t=document.createElement("article");t.classList.add("task-column"),t.dataset.column=e.id,t.draggable=!1,t.setAttribute("aria-labelledby",`column-title-${e.id}`);const o=e?.collapsed===!0;o&&t.classList.add("is-collapsed"),e?.color&&t.style.setProperty("--column-accent",e.color);const n=document.createElement("button");n.classList.add("column-collapse-btn"),n.type="button",n.setAttribute("aria-label",o?`Expand ${e.name} column`:`Collapse ${e.name} column`),n.title=o?"Expand column":"Collapse column";const a=document.createElement("span");a.dataset.lucide=o?"chevron-right":"chevrons-right-left",a.setAttribute("aria-hidden","true"),n.appendChild(a),n.addEventListener("click",I=>{I.stopPropagation(),sn(e.id)&&O()});const i=document.createElement("button");i.classList.add("column-drag-handle"),i.type="button",i.setAttribute("aria-label","Drag to reorder column");const l=document.createElement("span");l.dataset.lucide="grip-vertical",l.setAttribute("aria-hidden","true"),i.appendChild(l),i.title="Drag to reorder";const s=document.createElement("header");s.classList.add("column-header");const r=document.createElement("h2");if(r.id=`column-title-${e.id}`,o){const I=jt(e.id);r.textContent=`${e.name} (${I})`}else r.textContent=e.name;const d=document.createElement("span");d.classList.add("task-counter"),d.dataset.columnId=e.id,d.textContent="0",d.setAttribute("aria-label","Task count");const c=document.createElement("div");c.classList.add("column-actions");const f=document.createElement("button");f.classList.add("add-task-btn-icon"),f.type="button",f.setAttribute("aria-label",`Add task to ${e.name}`);const u=document.createElement("span");u.dataset.lucide="plus",u.setAttribute("aria-hidden","true"),f.appendChild(u),f.title="Add task",f.addEventListener("click",()=>$n(e.id));const m=document.createElement("div");m.classList.add("column-menu-wrapper");const p=document.createElement("button");p.classList.add("column-menu-btn"),p.type="button",p.setAttribute("aria-haspopup","menu"),p.setAttribute("aria-expanded","false"),p.setAttribute("aria-label",`${e.name} column menu`);const g=document.createElement("span");g.dataset.lucide="ellipsis-vertical",g.setAttribute("aria-hidden","true"),p.appendChild(g),p.title="Column menu";const y=document.createElement("div");y.classList.add("column-menu","hidden"),y.setAttribute("role","menu");const b=document.createElement("button");b.classList.add("column-menu-item"),b.type="button",b.setAttribute("role","menuitem");const w=document.createElement("span");w.dataset.lucide="pencil",w.setAttribute("aria-hidden","true"),b.appendChild(w);const L=document.createTextNode(" Edit");b.appendChild(L),b.title="Edit column",b.addEventListener("click",I=>{I.stopPropagation(),X(),On(e.id)});const E=document.createElement("button");E.classList.add("column-menu-item","danger"),E.type="button",E.setAttribute("role","menuitem");const B=document.createElement("span");B.dataset.lucide="trash-2",B.setAttribute("aria-hidden","true"),E.appendChild(B);const ie=document.createTextNode(" Delete");E.appendChild(ie),E.title="Delete column",E.addEventListener("click",I=>{I.stopPropagation(),X(),(async()=>{if(e.id==="done"){await z({title:"Cannot Delete Column",message:"The Done column is permanent and cannot be deleted."});return}if(P().length<=1){await z({title:"Cannot Delete Column",message:"Cannot delete the last column."});return}const tt=x().filter(Yt=>Yt.column===e.id),nt=e?.name?`"${e.name}"`:"this column",Wt=tt.length>0?`Delete ${nt}? This will also delete ${tt.length} task(s).`:`Delete ${nt}?`;await Z({title:"Delete Column",message:Wt,confirmText:"Delete"})&&ln(e.id)&&O()})()});const Y=document.createElement("div");Y.classList.add("column-menu-submenu-wrapper");const h=document.createElement("button");h.classList.add("column-menu-item","has-submenu"),h.type="button",h.setAttribute("role","menuitem"),h.setAttribute("aria-haspopup","menu"),h.setAttribute("aria-expanded","false");const v=document.createElement("span");v.dataset.lucide="arrow-up-down",v.setAttribute("aria-hidden","true"),h.appendChild(v);const C=document.createTextNode(" Sort");h.appendChild(C);const T=document.createElement("span");T.dataset.lucide="chevron-left",T.classList.add("submenu-chevron"),T.setAttribute("aria-hidden","true"),h.appendChild(T),h.title="Sort tasks in column";const S=document.createElement("div");S.classList.add("column-submenu","hidden"),S.setAttribute("role","menu");const R=document.createElement("button");R.classList.add("column-menu-item"),R.type="button",R.setAttribute("role","menuitem"),R.textContent="By Due Date",R.title="Sort by due date (earliest first)",R.addEventListener("click",I=>{I.stopPropagation(),X(),pt(e.id,"dueDate")});const H=document.createElement("button");H.classList.add("column-menu-item"),H.type="button",H.setAttribute("role","menuitem"),H.textContent="By Priority",H.title="Sort by priority (urgent to none)",H.addEventListener("click",I=>{I.stopPropagation(),X(),pt(e.id,"priority")}),S.appendChild(R),S.appendChild(H),h.addEventListener("click",I=>{I.stopPropagation();const be=!S.classList.contains("hidden");S.classList.toggle("hidden"),h.setAttribute("aria-expanded",be?"false":"true")}),Y.addEventListener("mouseenter",()=>{S.classList.remove("hidden"),h.setAttribute("aria-expanded","true")}),Y.addEventListener("mouseleave",()=>{S.classList.add("hidden"),h.setAttribute("aria-expanded","false")}),Y.appendChild(h),Y.appendChild(S),y.appendChild(b),y.appendChild(Y),y.appendChild(E),p.addEventListener("click",I=>{I.stopPropagation();const be=!y.classList.contains("hidden");X(),be?p.setAttribute("aria-expanded","false"):(y.classList.remove("hidden"),p.setAttribute("aria-expanded","true"))}),m.appendChild(p),m.appendChild(y),c.appendChild(f),c.appendChild(m),s.appendChild(n),s.appendChild(i),s.appendChild(r),s.appendChild(d),s.appendChild(c);const G=document.createElement("ul");return G.classList.add("tasks"),G.setAttribute("role","list"),G.setAttribute("aria-label",`Tasks in ${e.name}`),o&&(G.classList.add("hidden"),c.classList.add("hidden"),d.classList.add("hidden")),t.appendChild(s),t.appendChild(G),t}function po(){const e=P(),t=document.getElementById("task-column");t.innerHTML="",e.forEach(o=>{const n=document.createElement("option");n.value=o.id,n.textContent=o.name,t.appendChild(n)})}function go(){const e=x(),t=new Map(A().map(n=>[n.id,{name:(n.name||"").toString().trim().toLowerCase(),group:(n.group||"").toString().trim().toLowerCase()}])),o=(et||"").toString().trim().toLowerCase();document.querySelectorAll(".task-counter").forEach(n=>{const a=n.dataset.columnId;if(!a)return;const i=e.filter(l=>l.column!==a?!1:o?Vt(l,o,t):!0);n.textContent=i.length})}function ho(){document.querySelectorAll(".task-column.is-collapsed").forEach(e=>{const t=e.dataset.column,o=e.querySelector("h2");if(!t||!o)return;const n=jt(t),a=o.textContent.replace(/\s*\(\d+\)$/,"");o.textContent=`${a} (${n})`})}function O(){const e=P(),t=x(),o=A(),n=k(),a=new Date;a.setHours(0,0,0,0);const i=new Map(o.map(f=>[f.id,f])),l=new Map(o.map(f=>[f.id,{name:(f.name||"").toString().trim().toLowerCase(),group:(f.group||"").toString().trim().toLowerCase()}])),s=(et||"").toString().trim().toLowerCase(),r=s?t.filter(f=>Vt(f,s,l)):t,d=document.getElementById("board-container");d.innerHTML="",[...e].sort((f,u)=>(f.order??0)-(u.order??0)).forEach(f=>{const u=fo(f);d.appendChild(u);const m=u.querySelector(".tasks"),p=u.querySelector(".task-counter"),g=r.filter(L=>L.column===f.id).sort((L,E)=>(L.order??0)-(E.order??0)),b=f.id==="done"&&g.length>Ut;if((b?g.slice(0,Le):g).forEach(L=>{m.appendChild(mo(L,n,i,a))}),b&&Le<g.length){const L=document.createElement("button");L.classList.add("show-more-btn"),L.type="button",L.textContent=`Show more (${g.length-Le} remaining)`,L.addEventListener("click",()=>{Le+=so,O()}),m.appendChild(L)}p.textContent=g.length}),Yn(),po(),ee(),me(),ft||(ft=!0,document.addEventListener("click",()=>X()),document.addEventListener("keydown",f=>{f.key==="Escape"&&X()}))}const U=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:O,setBoardFilterQuery:qt,syncCollapsedTitles:ho,syncTaskCounters:go},Symbol.toStringTag,{value:"Module"}));function yo(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function gt(e){const t=ae(),o=Je();e.innerHTML="",t.forEach(n=>{const a=document.createElement("option");a.value=n.id,a.textContent=yo(n),e.appendChild(a)}),o&&(e.value=o)}function ze(){const e=document.getElementById("brand-text")||document.querySelector(".brand-text");e&&(e.textContent=Te())}function bo(){const e=document.getElementById("board-create-modal"),t=document.getElementById("board-create-name");!e||!t||(t.value="",e.classList.remove("hidden"),t.focus())}function re(){const e=document.getElementById("board-create-modal");e&&e.classList.add("hidden")}function Eo(){Ae();const e=document.getElementById("board-select");if(!e)return;gt(e),ze(),document.addEventListener("kanban:open-board-create",()=>{bo()}),e.addEventListener("change",()=>{const a=e.value;if(!a)return;fe(a),ze(),O();const i=document.getElementById("board-controls-menu"),l=document.getElementById("desktop-menu-btn");i?.classList.remove("show"),l?.setAttribute("aria-expanded","false")});const t=document.getElementById("board-create-modal"),o=document.getElementById("board-create-form"),n=document.getElementById("cancel-board-create-btn");t&&(t.querySelector(".modal-backdrop")?.addEventListener("click",re),t.addEventListener("keydown",i=>{i.key==="Escape"&&re()})),n&&n.addEventListener("click",re),N("board-create-modal",re),o&&o.addEventListener("submit",async a=>{a.preventDefault();const i=document.getElementById("board-create-name"),l=(i?.value||"").trim();if(!l){await z({title:"Error",message:"Board name cannot be empty."}),i?.focus();return}const s=ht(l);fe(s.id),gt(e),ze(),O(),re(),document.dispatchEvent(new CustomEvent("kanban:boards-changed"))})}function vo(e){const t=[];for(const o of e){if(typeof o!="string")continue;const n=o.trim();n&&(t.includes(n)||t.push(n))}return t}function Lo(e){const t=typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US";return vo([e,t,"en-US","en-GB","de-DE","fr-FR","es-ES","it-IT","pt-BR","ja-JP","zh-CN"])}function Co(){document.getElementById("settings-modal")?.classList.remove("hidden")}function Ue(){document.getElementById("settings-modal")?.classList.add("hidden")}async function F(e){yt(e);const{renderBoard:t}=await _(async()=>{const{renderBoard:o}=await Promise.resolve().then(()=>U);return{renderBoard:o}},void 0,import.meta.url);t()}function wo(){const e=document.getElementById("settings-btn"),t=document.getElementById("settings-close-btn");document.querySelector("#settings-modal .modal-backdrop");const o=document.getElementById("settings-show-priority"),n=document.getElementById("settings-show-due-date"),a=document.getElementById("settings-notification-days"),i=document.getElementById("settings-countdown-urgent-threshold"),l=document.getElementById("settings-countdown-warning-threshold"),s=document.getElementById("settings-show-age"),r=document.getElementById("settings-show-change-date"),d=document.getElementById("settings-locale"),c=document.getElementById("settings-default-priority");if(!e||!t||!o||!n||!a||!i||!l||!s||!r||!d||!c)return;function f(){const u=k();o.checked=u.showPriority!==!1,n.checked=u.showDueDate!==!1,s.checked=u.showAge!==!1,r.checked=u.showChangeDate!==!1,a.value=String(Number.isFinite(u.notificationDays)?u.notificationDays:3),i.value=String(Number.isFinite(u.countdownUrgentThreshold)?u.countdownUrgentThreshold:3),l.value=String(Number.isFinite(u.countdownWarningThreshold)?u.countdownWarningThreshold:10);const m=Lo(u.locale);d.innerHTML="",m.forEach(p=>{const g=document.createElement("option");g.value=p,g.textContent=p,d.appendChild(g)}),d.value=u.locale,c.value=u.defaultPriority||"none"}e.addEventListener("click",()=>{f(),Co()}),t.addEventListener("click",Ue),N("settings-modal",Ue),document.addEventListener("keydown",u=>{const m=document.getElementById("settings-modal");!m||m.classList.contains("hidden")||u.key==="Escape"&&Ue()}),s.addEventListener("change",async()=>{const u=k();await F({...u,showAge:!!s.checked})}),r.addEventListener("change",async()=>{const u=k();await F({...u,showChangeDate:!!r.checked})}),o.addEventListener("change",async()=>{const u=k();await F({...u,showPriority:!!o.checked})}),n.addEventListener("change",async()=>{const u=k();await F({...u,showDueDate:!!n.checked})}),a.addEventListener("change",async()=>{const u=k(),m=Number.parseInt(a.value,10),p=Number.isFinite(m)?m:3;await F({...u,notificationDays:p})}),i.addEventListener("change",async()=>{const u=k(),m=Number.parseInt(i.value,10),p=Number.isFinite(m)&&m>=1?m:3;await F({...u,countdownUrgentThreshold:p})}),l.addEventListener("change",async()=>{const u=k(),m=Number.parseInt(l.value,10),p=u.countdownUrgentThreshold||3,g=Number.isFinite(m)&&m>=p?m:10;await F({...u,countdownWarningThreshold:g})}),d.addEventListener("change",async()=>{const u=k();await F({...u,locale:d.value})}),c.addEventListener("change",async()=>{const u=k();await F({...u,defaultPriority:c.value})})}document.addEventListener("DOMContentLoaded",()=>{const e=new URLSearchParams(window.location.search),t=(e.get("openTaskId")||"").trim(),o=(e.get("openTaskBoardId")||"").trim();o&&(Ae(),fe(o));const n=document.getElementById("app-version");n&&(n.textContent="v1.1.0",n.title="Version 1.1.0"),Kt(),wo();const a=document.getElementById("board-search-input");a&&a.addEventListener("input",()=>{qt(a.value),O()}),Eo(),Vn(),zt(),document.getElementById("export-btn").addEventListener("click",async()=>{await Z({title:"Export Board (Active Only)",message:`Export ONLY saves the current active board. It does NOT back up all boards.

To back up everything, export each board individually.

Continue with export?`,confirmText:"Export"})&&kn()}),document.getElementById("import-btn").addEventListener("click",async()=>{await Z({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",s=>{const r=s.target.files[0];r&&Dn(r),s.target.value=""});const i=document.getElementById("desktop-menu-btn"),l=document.getElementById("board-controls-menu");if(i&&l&&(i.addEventListener("click",s=>{s.stopPropagation();const r=i.getAttribute("aria-expanded")==="true";l.classList.toggle("show"),i.setAttribute("aria-expanded",String(!r)),document.querySelectorAll(".column-menu").forEach(d=>d.classList.add("hidden"))}),l.addEventListener("click",s=>{s.target.closest("select, option, input, textarea, label")||!s.target.closest('button, a, [role="menuitem"]')||(l.classList.remove("show"),i.setAttribute("aria-expanded","false"))}),document.addEventListener("click",s=>{!l.contains(s.target)&&!i.contains(s.target)&&(l.classList.remove("show"),i.setAttribute("aria-expanded","false"))})),O(),t){j(t);const s=`${window.location.pathname}${window.location.hash||""}`;window.history.replaceState({},"",s)}});
