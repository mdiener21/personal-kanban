import{l as D,g as Fe,s as H,a as N,b as X,c as x,d as Be,e as B,f as Ie,h as ut,i as Ee,j as mt,k as Q,r as F,m as ze,n as Ue,o as qt,p as jt}from"./storage-BcrjasBI.js";import{S as ft}from"./vendor-Dbh21kxK.js";const Vt=new Set(["low","medium","high"]);function pt(e){const t=(e||"").toString().trim().toLowerCase();return Vt.has(t)?t:"low"}function gt(e){return(e||"").toString().trim()}function Wt(e,t,o,n,a,i=[]){if(!e||e.trim()==="")return;const l=D(),s=l.filter(f=>f.column===a).slice().sort((f,m)=>(f.order??0)-(m.order??0)),r=new Map;s.forEach((f,m)=>{r.set(f.id,m+2)});const c=l.map(f=>{if(f.column!==a)return f;const m=r.get(f.id);return typeof m=="number"?{...f,order:m}:f}),d=new Date().toISOString(),u={id:Fe(),title:e.trim(),description:(t||"").toString().trim(),priority:pt(o),dueDate:gt(n),column:a,order:1,labels:[...i],creationDate:d,changeDate:d,columnHistory:[{column:a,at:d}],...a==="done"?{doneDate:d}:{}};c.push(u),H(c)}function Gt(e,t,o,n,a,i,l=[]){if(!t||t.trim()==="")return;const s=D(),r=s.findIndex(c=>c.id===e);if(r!==-1){const c=s[r].column,d=i,u=new Date().toISOString();if(!Array.isArray(s[r].columnHistory)||s[r].columnHistory.length===0){const f=s[r].creationDate||s[r].changeDate||u,m=typeof c=="string"?c:d;s[r].columnHistory=[{column:m,at:f}]}s[r].title=t.trim(),s[r].description=(o||"").toString().trim(),s[r].priority=pt(n),s[r].dueDate=gt(a),s[r].column=d,s[r].labels=[...l],c!==d&&s[r].columnHistory.push({column:d,at:u}),c!=="done"&&d==="done"?s[r].doneDate=u:c==="done"&&d!=="done"&&delete s[r].doneDate,s[r].changeDate=u,H(s)}}function Yt(e){const o=D().filter(n=>n.id!==e);return H(o),!0}function Jt(e){const t=e.item?.dataset?.taskId;if(!t)return null;const o=e.from.closest(".task-column"),n=e.to.closest(".task-column");if(!o||!n)return null;const a=o.dataset.column,i=n.dataset.column,l=a!==i,s=D(),r=new Date().toISOString(),c=s.findIndex(m=>m.id===t);if(c===-1)return null;s[c];const d=new Set([a,i]),u=new Map;d.forEach(m=>{const p=document.querySelector(`.task-column[data-column="${m}"]`);if(!p)return;const g=p.querySelectorAll(".task"),h=[];g.forEach((E,L)=>{const C=E.dataset.taskId;C&&h.push({id:C,order:L+1})}),u.set(m,h)});const f=s.map(m=>{if(m.id===t){const p={...m,column:i},h=u.get(i)?.find(E=>E.id===t);if(h&&(p.order=h.order),l){p.changeDate=r;const E=Array.isArray(m.columnHistory)&&m.columnHistory.length?[...m.columnHistory]:[{column:m.column,at:m.creationDate||m.changeDate||r}];E.push({column:i,at:r}),p.columnHistory=E,m.column!=="done"&&i==="done"?p.doneDate=r:m.column==="done"&&i!=="done"&&delete p.doneDate}return p}if(d.has(m.column)){const g=u.get(m.column)?.find(h=>h.id===m.id);if(g&&g.order!==m.order)return{...m,order:g.order}}return m});return H(f),{movedTaskId:t,fromColumn:a,toColumn:i,didChangeColumn:l}}function Kt(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function ht(e){return Kt(e)?e.trim():"#3b82f6"}function Xt(e,t){if(!e||e.trim()==="")return;const o=N(),n=o.reduce((l,s)=>Math.max(l,s.order??0),0),i={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+Fe().substring(0,8),name:e.trim(),color:ht(t),order:n-1,collapsed:!1};o.push(i),X(o)}function Qt(e){const t=typeof e=="string"?e.trim():"";if(!t)return!1;const o=N(),n=o.find(a=>a.id===t);return n?(n.collapsed=n.collapsed!==!0,X(o),!0):!1}function Zt(e,t,o){if(!t||t.trim()==="")return;const n=N(),a=n.findIndex(i=>i.id===e);a!==-1&&(n[a].name=t.trim(),n[a].color=ht(o),X(n))}function en(e){if(e==="done")return!1;const t=N();if(t.length<=1)return!1;const o=D();if(o.filter(i=>i.column===e).length>0){const i=o.filter(l=>l.column!==e);H(i)}const a=t.filter(i=>i.id!==e);return X(a),!0}function tn(){const t=document.getElementById("board-container").querySelectorAll(".task-column"),o=N();t.forEach((n,a)=>{const i=n.dataset.column,l=o.find(s=>s.id===i);l&&(l.order=a+1)}),X(o)}const nn="modulepreload",on=function(e,t){return new URL(e,t).href},Ke={},M=function(t,o,n){let a=Promise.resolve();if(o&&o.length>0){let c=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const l=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),r=s?.nonce||s?.getAttribute("nonce");a=c(o.map(d=>{if(d=on(d,n),d in Ke)return;Ke[d]=!0;const u=d.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(n)for(let p=l.length-1;p>=0;p--){const g=l[p];if(g.href===d&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":nn,u||(m.as="script"),m.crossOrigin="",m.href=d,r&&m.setAttribute("nonce",r),document.head.appendChild(m),u)return new Promise((p,g)=>{m.addEventListener("load",p),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=l,window.dispatchEvent(s),!s.defaultPrevented)throw l}return a.then(l=>{for(const s of l||[])s.status==="rejected"&&i(s.reason);return t().catch(i)})},qe=40;function je(e){return e.trim().slice(0,qe).toLowerCase().replace(/\s+/g," ")}function yt(e,t,o=null){return e.some(n=>o&&n.id===o?!1:je(n.name)===t)}function an(e,t,o=""){if(!e||e.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const n=e.trim().slice(0,qe),a=je(n),i=x();if(yt(i,a))return{success:!1,reason:"DUPLICATE_NAME",message:`Label "${n}" already exists.`};const l=a.replace(/\s+/g,"-")+"-"+Fe().substring(0,8),s=typeof o=="string"?o.trim():"",r={id:l,name:n,color:t,group:s};return i.push(r),Be(i),{success:!0,label:r}}function sn(e,t,o,n=""){if(!t||t.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const a=t.trim().slice(0,qe),i=je(a),l=x(),s=l.findIndex(r=>r.id===e);return s===-1?{success:!1,reason:"NOT_FOUND"}:yt(l,i,e)?{success:!1,reason:"DUPLICATE_NAME",message:`Another label with the name "${a}" already exists.`}:(l[s].name=a,l[s].color=o,l[s].group=typeof n=="string"?n.trim():"",Be(l),{success:!0,label:l[s]})}function rn(e){const t=x(),o=D();o.forEach(a=>{a.labels&&(a.labels=a.labels.filter(i=>i!==e))}),H(o);const n=t.filter(a=>a.id!==e);Be(n)}let ve=null;function S(e){return document.getElementById(e)}function ge(e){const t=S("dialog-modal");t&&t.classList.add("hidden");const o=ve;ve=null,typeof o=="function"&&o(!!e)}function ln(){const e=S("dialog-modal");return e&&!e.classList.contains("hidden")}function bt({title:e,message:t,confirmText:o,cancelText:n,showCancel:a}){const i=S("dialog-modal-title"),l=S("dialog-modal-message"),s=S("dialog-confirm-btn"),r=S("dialog-cancel-btn");i&&(i.textContent=e||"Confirm"),l&&(l.textContent=t||""),s&&(s.textContent=o||"OK"),r&&(r.textContent=n||"Cancel"),r&&(r.style.display=a?"inline-flex":"none")}function Et(){const e=S("dialog-modal");if(!e||e.dataset.handlersAttached==="true")return;e.dataset.handlersAttached="true";const t=S("dialog-confirm-btn"),o=S("dialog-cancel-btn");e.querySelector(".modal-backdrop"),t?.addEventListener("click",()=>ge(!0)),o?.addEventListener("click",()=>ge(!1)),T("dialog-modal",()=>ge(!1)),document.addEventListener("keydown",n=>{n.key==="Escape"&&ln()&&ge(!1)})}function vt(){const e=S("dialog-modal");if(!e)return;e.classList.remove("hidden"),S("dialog-confirm-btn")?.focus()}function G({title:e="Confirm",message:t="",confirmText:o="Delete",cancelText:n="Cancel"}={}){return Et(),bt({title:e,message:t,confirmText:o,cancelText:n,showCancel:!0}),vt(),new Promise(a=>{ve=a})}function O({title:e="Notice",message:t="",okText:o="OK"}={}){return Et(),bt({title:e,message:t,confirmText:o,cancelText:"",showCancel:!1}),vt(),new Promise(n=>{ve=()=>n(!0)})}function Te(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return Array.isArray(o)?o:null}catch{return null}}function dn(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return o&&typeof o=="object"&&!Array.isArray(o)?o:null}catch{return null}}function Lt(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function cn(e){const t=document.getElementById("brand-text")||document.querySelector(".brand-text");t&&(t.textContent=Ie());const o=document.getElementById("board-select");if(!o)return;const n=Q();o.innerHTML="",n.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=Lt(a),o.appendChild(i)}),e&&(o.value=e)}function un(e){const t=typeof e?.name=="string"?e.name.trim():"";return t?t.replace(/\.[^.]+$/,"").trim():""}function we(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const mn=new Set(["low","medium","high"]);function De(e){const t=(e||"").toString().trim().toLowerCase();return mn.has(t)?t:"low"}function fn(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},o=t.showPriority!==!1,n=t.showDueDate!==!1,a=t.showAge!==!1,i=t.showChangeDate!==!1,l=typeof t.locale=="string"&&t.locale.trim()?t.locale.trim():typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US",s=De(t.defaultPriority),r=Number.parseInt((t.notificationDays??"").toString(),10),c=Number.isFinite(r)?Math.min(365,Math.max(0,r)):3;return{showPriority:o,showDueDate:n,showAge:a,showChangeDate:i,locale:l,defaultPriority:s,notificationDays:c}}function Ct(e){const t=(e||"").toString().trim();return t.length>=10&&t.includes("T")?t.slice(0,10):t}function kt(e){const t=typeof e?.text=="string"?e.text:"",o=typeof e?.title=="string"?e.title:t,n=typeof e?.description=="string"?e.description:"",a=Ct(e?.dueDate??e?.["due-date"]),i=typeof e?.changeDate=="string"?e.changeDate:typeof e?.changedDate=="string"?e.changedDate:void 0,l=e?.column==="done",s=typeof e?.doneDate=="string"?e.doneDate.toString().trim():"",r=Array.isArray(e?.columnHistory)?e.columnHistory.map(c=>{const d=typeof c?.column=="string"?c.column.trim():"",u=typeof c?.at=="string"?c.at.trim():"";return!d||!u?null:{column:d,at:u}}).filter(Boolean):void 0;return{...e,title:o.toString().trim(),description:n.toString().trim(),priority:De(e?.priority),dueDate:a,...typeof i=="string"?{changeDate:i.toString().trim()}:{},...l&&s?{doneDate:s}:{doneDate:void 0},...r&&r.length?{columnHistory:r}:{columnHistory:void 0},changedDate:void 0}}function pn(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.text=="string"?n.text:String(n?.text??""),l=typeof n?.title=="string"?n.title:i,s=typeof n?.description=="string"?n.description:String(n?.description??""),r=De(n?.priority),c=typeof n?.dueDate=="string"?n.dueDate:typeof n?.["due-date"]=="string"?n["due-date"]:String(n?.dueDate??n?.["due-date"]??""),d=Ct(c),u=typeof n?.column=="string"?n.column:String(n?.column??""),f=Array.isArray(n?.labels)?n.labels.map(v=>typeof v=="string"?v:String(v)):[],m=Number.isFinite(n?.order)?n.order:void 0,p=typeof n?.creationDate=="string"?n.creationDate:void 0,g=typeof n?.changeDate=="string"?n.changeDate:typeof n?.changedDate=="string"?n.changedDate:void 0,h=typeof n?.doneDate=="string"?n.doneDate.trim():"",L=u.trim()==="done"&&(h||(typeof g=="string"?g.trim():"")||p)||"",C=Array.isArray(n?.columnHistory)?n.columnHistory.map(v=>{const w=typeof v?.column=="string"?v.column.trim():String(v?.column??"").trim(),ee=typeof v?.at=="string"?v.at.trim():String(v?.at??"").trim();return!w||!ee?null:{column:w,at:ee}}).filter(Boolean):void 0;return{id:a.trim(),title:l.trim(),description:s.trim(),priority:r,dueDate:d.trim(),column:u.trim(),...m!==void 0?{order:m}:{},...p?{creationDate:p}:{},...typeof g=="string"&&g.trim()?{changeDate:g.trim()}:{},...L?{doneDate:L}:{},...C&&C.length?{columnHistory:C}:{},labels:f}});return t.every(n=>n.id&&n.title&&n.column)?t:null}function gn(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),l=Number.isFinite(n?.order)?n.order:void 0,s=we(n?.color)?n.color.trim():"#3b82f6",r=n?.collapsed===!0;return{id:a.trim(),name:i.trim(),color:s,collapsed:r,...l!==void 0?{order:l}:{}}});if(!t.some(n=>n.id==="done")){const n=t.reduce((a,i)=>Math.max(a,Number.isFinite(i?.order)?i.order:0),0);t.push({id:"done",name:"Done",color:"#16a34a",order:n+1,collapsed:!1})}return t.every(n=>n.id&&n.name)?t:null}function hn(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),l=we(n?.color)?n.color.trim():"#3b82f6",s=typeof n?.group=="string"?n.group.trim():"";return{id:a.trim(),name:i.trim(),color:l,group:s}});return t.every(n=>n.id&&n.name&&n.color)?t:null}function yn(e){if(!e||typeof e!="object"||Array.isArray(e))return null;const t=e.showPriority!==!1,o=e.showDueDate!==!1,n=e.showAge!==!1,a=e.showChangeDate!==!1,i=typeof e.locale=="string"&&e.locale.trim()?e.locale.trim():void 0,l=typeof e.defaultPriority=="string"?e.defaultPriority:void 0,s=l?De(l):void 0,r=Number.parseInt((e.notificationDays??"").toString(),10),c=Number.isFinite(r)?Math.min(365,Math.max(0,r)):void 0;return{showPriority:t,showDueDate:o,showAge:n,showChangeDate:a,...i?{locale:i}:{},...s?{defaultPriority:s}:{},...c!==void 0?{notificationDays:c}:{}}}function bn(){const e=D().map(kt),t=N().map(d=>({...d,color:we(d?.color)?d.color.trim():"#3b82f6"})),o=x(),n=B(),a=Ie(),l=JSON.stringify({boardName:a,columns:t,tasks:e,labels:o,settings:n},null,2),s=new Blob([l],{type:"application/json"}),r=URL.createObjectURL(s),c=document.createElement("a");c.href=r,c.download=`${a.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(r)}function En(e){const t=typeof e=="string"?e.trim():"";if(!t)return;const o=Q().find(w=>w.id===t),n=Lt(o),a=`kanbanBoard:${t}:columns`,i=`kanbanBoard:${t}:tasks`,l=`kanbanBoard:${t}:labels`,s=`kanbanBoard:${t}:settings`,r=Te(i)||[],c=Te(a)||[],d=Te(l)||[],u=dn(s)||null,f=r.map(kt),m=c.map(w=>({...w,color:we(w?.color)?w.color.trim():"#3b82f6",collapsed:w?.collapsed===!0})),p=Array.isArray(d)?d:[],g=fn(u),E=JSON.stringify({boardName:n,columns:m,tasks:f,labels:p,settings:g},null,2),L=new Blob([E],{type:"application/json"}),C=URL.createObjectURL(L),v=document.createElement("a");v.href=C,v.download=`${n.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(C)}function vn(e){const t=new FileReader;t.onload=async o=>{try{const n=JSON.parse(o.target.result);let a,i,l,s,r;if(Array.isArray(n))a=n,i=null,l=null,s=null,r=null;else if(n.tasks&&n.columns)a=n.tasks,i=n.columns,l=Object.prototype.hasOwnProperty.call(n,"labels")?n.labels:null,s=Object.prototype.hasOwnProperty.call(n,"settings")?n.settings:null,r=typeof n.boardName=="string"?n.boardName.trim():null;else{alert("Invalid JSON file format");return}const c=pn(a),d=i?gn(i):null,u=l?hn(l):null,f=s?yn(s):null;if(!c||i&&!d||l&&!u||s&&!f){alert("Invalid data structure");return}const m=r||un(e)||"Imported board",p=ut(m);if(p?.id&&Ee(p.id),d&&X(d),H(c),u&&Be(u),f){const h=B();mt({...h,...f})}cn(p?.id);const{renderBoard:g}=await M(async()=>{const{renderBoard:h}=await Promise.resolve().then(()=>$);return{renderBoard:h}},void 0,import.meta.url);g(),document.dispatchEvent(new CustomEvent("kanban:boards-changed")),alert("Board imported successfully!")}catch(n){alert("Error parsing JSON file: "+n.message)}},t.readAsText(e)}function Bt(e,t){if(!e)return;const o=e.closest(".form-group");if(!o)return;o.classList.add("error");let n=o.querySelector(".error-message");n||(n=document.createElement("div"),n.classList.add("error-message"),o.appendChild(n)),n.textContent=t,e.focus()}function Z(e){if(!e)return;const t=e.closest(".form-group");t&&t.classList.remove("error")}function Ln(e){return(e?.trim()||"").length>0}function Cn(e){const t=e?.value?.trim()||"";return Ln(t)?(Z(e),!0):(Bt(e,"Task title is required"),!1)}function kn(e){return(e?.trim()||"").length>0}function Bn(e){const t=e?.value?.trim()||"";return kn(t)?(Z(e),!0):(Bt(e,"Column name is required"),!1)}function Xe(e,t,o,n){const a=document.createElement("div");a.classList.add("accordion");const i=document.createElement("button");i.type="button",i.classList.add("accordion-header"),i.setAttribute("aria-expanded",String(o));const l=document.createElement("span");l.dataset.lucide=o?"chevron-down":"chevron-right",l.setAttribute("aria-hidden","true");const s=document.createElement("span");s.classList.add("accordion-title"),s.textContent=e;const r=document.createElement("span");r.classList.add("accordion-count"),r.textContent=t.length,i.appendChild(l),i.appendChild(s),i.appendChild(r);const c=document.createElement("div");return c.classList.add("accordion-body"),o||c.classList.add("collapsed"),t.forEach(d=>{c.appendChild(n(d))}),i.addEventListener("click",()=>{const d=i.getAttribute("aria-expanded")==="true";i.setAttribute("aria-expanded",String(!d)),c.classList.toggle("collapsed",d),l.dataset.lucide=d?"chevron-right":"chevron-down",F()}),a.appendChild(i),a.appendChild(c),a}let Qe="todo",de=null,ce=null,ae=null,Le=null,I=[],R=!1,me=!1;const q=40;let oe=!1;function xe(e){const t=document.getElementById("task-modal");if(!t)return;t.classList.toggle("fullscreen",!!e);const o=document.getElementById("task-fullpage-btn");if(o?.setAttribute("aria-pressed",e?"true":"false"),o){const n=o.querySelector("[data-lucide]");n&&n.setAttribute("data-lucide",e?"minimize-2":"maximize-2"),o.title=e?"Exit full page":"Open in full page"}F()}function j(e){const t=document.getElementById(e);return!!t&&!t.classList.contains("hidden")}function T(e,t){const o=document.getElementById(e);if(!o)return;o.querySelector(".modal-backdrop")?.addEventListener("click",t),o.querySelectorAll('[id$="-close-btn"], [id$="-close-modal-btn"], [id$="-cancel-btn"], [id^="cancel-"]').forEach(i=>{i.addEventListener("click",t)})}function In(){const e=document.getElementById("task-modal");e&&(e.classList.remove("hidden"),K(),document.getElementById("task-label-search")?.focus(),R=!1)}function wn(){return(document.getElementById("task-label-search")?.value||"").trim().toLowerCase()}function Dn(){return(document.getElementById("labels-search")?.value||"").trim().toLowerCase()}function Ve(){const e=document.getElementById("task-active-labels");if(!e)return;const t=x(),o=[];for(const a of I)o.includes(a)||o.push(a);I=o;const n=o.map(a=>t.find(i=>i.id===a)).filter(Boolean);e.innerHTML="",e.style.display=n.length>0?"flex":"none",n.forEach(a=>{const i=document.createElement("span");i.classList.add("task-label"),i.style.backgroundColor=a.color,i.textContent=a.name;const l=document.createElement("button");l.type="button",l.classList.add("active-label-remove"),l.setAttribute("aria-label",`Remove label ${a.name}`),l.title="Remove label",l.textContent="Ã—",l.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),I=I.filter(r=>r!==a.id),Ve(),K()}),i.appendChild(l),e.appendChild(i)})}function xn(e){Qe=e||N()[0]?.id||"todo",de=null,I=[],R=!1,me=!1,xe(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden");const t=document.getElementById("task-modal"),o=document.getElementById("task-column"),n=document.getElementById("task-title"),a=document.getElementById("task-description"),i=document.getElementById("task-priority"),l=document.getElementById("task-due-date"),s=document.getElementById("task-modal-title"),r=document.getElementById("task-submit-btn");if(Z(n),s.textContent="Add New Task",r.textContent="Add Task",o.value=Qe,n.value="",a.value="",i){const d=B();i.value=d.defaultPriority||"low"}l&&(l.value="");const c=document.getElementById("task-label-search");c&&(c.value=""),K(),t.classList.remove("hidden"),n.focus()}function se(e){const o=D().find(g=>g.id===e);if(!o)return;de=e,I=o.labels||[],R=!1,me=!1,xe(!1),document.getElementById("task-fullpage-btn")?.classList.remove("hidden");const n=document.getElementById("task-modal"),a=document.getElementById("task-column"),i=document.getElementById("task-title"),l=document.getElementById("task-description"),s=document.getElementById("task-priority"),r=document.getElementById("task-due-date"),c=document.getElementById("task-modal-title"),d=document.getElementById("task-submit-btn");Z(i),c.textContent="Edit Task",d.textContent="Save Changes",a.value=o.column;const u=typeof o.text=="string"?o.text:"";i.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:u,l.value=typeof o.description=="string"?o.description:"",s&&(s.value=typeof o.priority=="string"?o.priority:"medium");const f=typeof o.dueDate=="string"?o.dueDate:"",m=f.includes("T")?f.slice(0,10):f;r&&(r.value=m);const p=document.getElementById("task-label-search");p&&(p.value=""),K(),n.classList.remove("hidden"),i.focus()}function Se(){document.getElementById("task-modal").classList.add("hidden"),de=null,R=!1,xe(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden")}function An(){ce=null;const e=document.getElementById("column-modal"),t=document.getElementById("column-name"),o=document.getElementById("column-color"),n=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");Z(t),n.textContent="Add New Column",a.textContent="Add Column",t.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),t.focus()}function Tn(e){const o=N().find(r=>r.id===e);if(!o)return;ce=e;const n=document.getElementById("column-modal"),a=document.getElementById("column-name"),i=document.getElementById("column-color"),l=document.getElementById("column-modal-title"),s=document.getElementById("column-submit-btn");Z(a),l.textContent="Edit Column",s.textContent="Save Changes",a.value=o.name,i&&(i.value=o.color||"#3b82f6"),n.classList.remove("hidden"),a.focus()}function Ne(){document.getElementById("column-modal").classList.add("hidden"),ce=null}function Sn(){const e=document.getElementById("labels-search");e&&(e.value=""),ke(),document.getElementById("labels-modal").classList.remove("hidden"),R||document.getElementById("labels-search")?.focus()}function Me(){document.getElementById("labels-modal").classList.add("hidden");const t=document.getElementById("labels-search");t&&(t.value=""),R&&In()}function Nn(){document.getElementById("help-modal").classList.remove("hidden")}function Ze(){document.getElementById("help-modal").classList.add("hidden")}const Mn=/^#[0-9a-fA-F]{6}$/;function et(e){return Mn.test(e)}function It(e){const t=document.getElementById("label-color-hex");t&&(t.value=e,t.classList.remove("invalid"))}function Pn(){const e=document.getElementById("label-group-suggestions");if(!e)return;e.innerHTML="";const t=x();[...new Set(t.map(n=>(n.group||"").trim()).filter(n=>n.length>0))].sort((n,a)=>n.localeCompare(a)).forEach(n=>{const a=document.createElement("option");a.value=n,e.appendChild(a)})}function Ce(e=null,{openedFromTaskEditor:t=!1,initialName:o=""}={}){ae=e,oe=!1,me=!!t;const n=document.getElementById("label-modal"),a=document.getElementById("label-modal-title"),i=document.getElementById("label-name"),l=document.getElementById("label-color"),s=document.getElementById("label-group"),r=document.getElementById("label-submit-btn");if(e){const d=x().find(u=>u.id===e);d&&(a.textContent="Edit Label",r.textContent="Update Label",i.value=d.name,l.value=d.color,s&&(s.value=d.group||""))}else a.textContent="Add Label",r.textContent="Add Label",i.value=o||"",l.value="#3b82f6",s&&(s.value="");Pn(),It(l.value),n.classList.remove("hidden"),i.focus()}function Pe(){document.getElementById("label-modal").classList.add("hidden"),ae=null,me=!1}function tt(e){const t=document.createElement("div");t.classList.add("label-item"),t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-between";const o=document.createElement("span");o.classList.add("task-label"),o.style.backgroundColor=e.color,o.textContent=e.name;const n=document.createElement("div");n.classList.add("label-actions"),n.style.display="flex",n.style.gap="4px";const a=document.createElement("button");a.classList.add("btn-small");const i=document.createElement("span");i.dataset.lucide="pencil",a.appendChild(i),a.title="Edit label",a.addEventListener("click",()=>Ce(e.id));const l=document.createElement("button");l.classList.add("btn-small","btn-danger");const s=document.createElement("span");return s.dataset.lucide="trash-2",l.appendChild(s),l.title="Delete label",l.addEventListener("click",async()=>{if(await G({title:"Delete Label",message:`Delete label "${e.name}"? This will remove it from all tasks.`,confirmText:"Delete"})){rn(e.id),ke();const{renderBoard:c}=await M(async()=>{const{renderBoard:d}=await Promise.resolve().then(()=>$);return{renderBoard:d}},void 0,import.meta.url);c()}}),n.appendChild(a),n.appendChild(l),t.appendChild(o),t.appendChild(n),t}function wt(e){const t=e.filter(a=>!(a.group||"").trim()),o=new Map;e.forEach(a=>{const i=(a.group||"").trim();i&&(o.has(i)||o.set(i,[]),o.get(i).push(a))});const n=[...o.keys()].sort((a,i)=>a.localeCompare(i));return{ungrouped:t,groupMap:o,sortedGroups:n}}function ke(){const e=document.getElementById("labels-list");e.innerHTML="";const t=x(),o=Dn(),n=o?t.filter(r=>{const c=(r.name||"").toLowerCase(),d=(r.id||"").toLowerCase(),u=(r.group||"").toLowerCase();return c.includes(o)||d.includes(o)||u.includes(o)}):t;if(n.length===0){const r=document.createElement("div");r.classList.add("labels-empty"),r.textContent=o?"No matching labels":"No labels yet",e.appendChild(r);return}const{ungrouped:a,groupMap:i,sortedGroups:l}=wt(n);let s=!0;a.length>0&&(e.appendChild(Xe("Ungrouped",a,s,tt)),s=!1),l.forEach(r=>{e.appendChild(Xe(r,i.get(r),s,tt)),s=!1}),F()}function Re(){const e=document.getElementById("board-select");if(!e)return;const t=Q(),o=Ue();e.innerHTML="",t.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=typeof a.name=="string"&&a.name.trim()?a.name.trim():"Untitled board",e.appendChild(i)}),o&&(e.value=o);const n=document.getElementById("brand-text")||document.querySelector(".brand-text");n&&(n.textContent=Ie())}function ue(){ze();const e=document.getElementById("boards-list");if(!e)return;e.innerHTML="";const t=Q(),o=Ue();t.forEach(n=>{const a=document.createElement("div");a.classList.add("label-item"),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="10px";const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";const l=document.createElement("span");if(l.textContent=(n.name||"").toString(),i.appendChild(l),n.id===o){const g=document.createElement("span");g.classList.add("task-label"),g.style.backgroundColor="var(--color-primary)",g.textContent="Active",i.appendChild(g)}const s=document.createElement("div");s.classList.add("label-actions"),s.style.display="flex",s.style.gap="4px";const r=document.createElement("button");r.classList.add("btn-small"),r.textContent="Open",r.title="Open board",r.addEventListener("click",async()=>{Ee(n.id),Re(),ue();const{renderBoard:g}=await M(async()=>{const{renderBoard:h}=await Promise.resolve().then(()=>$);return{renderBoard:h}},void 0,import.meta.url);g()});const c=document.createElement("button");c.classList.add("btn-small"),c.type="button",c.title="Export board",c.setAttribute("aria-label",`Export board ${String(n.name||"Untitled board")}`);const d=document.createElement("span");d.dataset.lucide="download",c.appendChild(d),c.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),En(n.id)});const u=document.createElement("button");u.classList.add("btn-small");const f=document.createElement("span");f.dataset.lucide="pencil",u.appendChild(f),u.title="Rename board",u.addEventListener("click",()=>$n(n.id));const m=document.createElement("button");m.classList.add("btn-small","btn-danger");const p=document.createElement("span");p.dataset.lucide="trash-2",m.appendChild(p),m.title="Delete board",m.addEventListener("click",async()=>{if(!await G({title:"Delete Board",message:`Do you really want to delete the board "${n.name}"? This cannot be undone.`,confirmText:"Delete"}))return;if(!qt(n.id)){await O({title:"Unable to Delete",message:"Unable to delete board (you may be trying to delete the last board)."});return}Re(),ue();const{renderBoard:E}=await M(async()=>{const{renderBoard:L}=await Promise.resolve().then(()=>$);return{renderBoard:L}},void 0,import.meta.url);E()}),s.appendChild(r),s.appendChild(c),s.appendChild(u),s.appendChild(m),a.appendChild(i),a.appendChild(s),e.appendChild(a)}),F()}function _n(){ue(),document.getElementById("boards-modal")?.classList.remove("hidden")}function nt(){document.getElementById("boards-modal")?.classList.add("hidden")}function On(){const e=document.getElementById("boards-modal");!e||e.classList.contains("hidden")||ue()}function $n(e){ze();const t=Q().find(l=>l.id===e);if(!t)return;Le=e;const o=document.getElementById("board-rename-modal"),n=document.getElementById("board-rename-name"),a=document.getElementById("board-rename-modal-title"),i=document.getElementById("board-rename-submit-btn");a&&(a.textContent="Rename Board"),i&&(i.textContent="Save"),n&&(n.value=(t.name||"").toString()),o?.classList.remove("hidden"),n?.focus()}function _e(){document.getElementById("board-rename-modal")?.classList.add("hidden"),Le=null}function ot(e){const t=document.createElement("label");t.classList.add("label-checkbox");const o=document.createElement("input");o.type="checkbox",o.value=e.id,o.checked=I.includes(e.id),o.addEventListener("change",a=>{a.target.checked?I.includes(e.id)||I.push(e.id):I=I.filter(i=>i!==e.id),Ve()});const n=document.createElement("span");return n.classList.add("task-label","label-color-swatch"),n.style.backgroundColor=e.color,n.textContent=e.name,t.appendChild(o),t.appendChild(n),t}function K(){Ve();const e=document.getElementById("task-labels-selection");e.innerHTML="";const t=wn(),o=x(),n=t?o.filter(s=>{const r=(s.name||"").toLowerCase(),c=(s.id||"").toLowerCase(),d=(s.group||"").toLowerCase();return r.includes(t)||c.includes(t)||d.includes(t)}):o;if(n.length===0){if(t){const s=document.createElement("button");s.type="button",s.classList.add("labels-empty-button"),s.textContent=`No label found "${t}" - Create label`,s.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation(),Ce(null,{openedFromTaskEditor:!0,initialName:t})}),e.appendChild(s)}else{const s=document.createElement("div");s.classList.add("labels-empty"),s.textContent="No matching labels",e.appendChild(s)}return}const{ungrouped:a,groupMap:i,sortedGroups:l}=wt(n);a.forEach(s=>{e.appendChild(ot(s))}),l.forEach(s=>{const r=document.createElement("div");r.classList.add("label-group-header","label-group-header-picker"),r.textContent=s,e.appendChild(r),i.get(s).forEach(c=>{e.appendChild(ot(c))})})}function Rn(){document.addEventListener("kanban:boards-changed",()=>{On()}),document.getElementById("task-label-search")?.addEventListener("input",K),document.getElementById("labels-search")?.addEventListener("input",ke),document.getElementById("task-add-label-btn")?.addEventListener("click",()=>{R=!1,Ce(null,{openedFromTaskEditor:!0})}),document.getElementById("task-fullpage-btn")?.addEventListener("click",()=>{const s=document.getElementById("task-modal");s&&xe(!s.classList.contains("fullscreen"))}),document.getElementById("task-form").addEventListener("submit",async s=>{s.preventDefault();const r=document.getElementById("task-title");if(!Cn(r))return;const c=r.value.trim(),d=document.getElementById("task-description").value,u=document.getElementById("task-priority")?.value,f=document.getElementById("task-due-date")?.value,m=document.getElementById("task-column").value;de?Gt(de,c,d,u,f,m,I):Wt(c,d,u,f,m,I),Se();const{renderBoard:p}=await M(async()=>{const{renderBoard:g}=await Promise.resolve().then(()=>$);return{renderBoard:g}},void 0,import.meta.url);p()}),T("task-modal",Se),document.getElementById("column-form").addEventListener("submit",async s=>{s.preventDefault();const r=document.getElementById("column-name");if(!Bn(r))return;const c=r.value.trim(),d=document.getElementById("column-color")?.value;ce?Zt(ce,c,d):Xt(c,d),Ne();const{renderBoard:u}=await M(async()=>{const{renderBoard:f}=await Promise.resolve().then(()=>$);return{renderBoard:f}},void 0,import.meta.url);u()}),T("column-modal",Ne),document.getElementById("manage-labels-btn").addEventListener("click",Sn),document.getElementById("add-label-btn").addEventListener("click",()=>Ce()),T("labels-modal",Me);const a=document.getElementById("label-name");a?.addEventListener("beforeinput",s=>{if(!s||typeof s.data!="string"||s.data.length===0)return;const r=s.target;if(!r||typeof r.value!="string")return;const c=typeof r.selectionStart=="number"?r.selectionStart:r.value.length,d=typeof r.selectionEnd=="number"?r.selectionEnd:r.value.length;(r.value.slice(0,c)+s.data+r.value.slice(d)).trim().length<=q||(s.preventDefault(),!oe&&(oe=!0,O({title:"Label Name Too Long",message:`Label names are limited to ${q} characters.`})))});const i=document.getElementById("label-color");i?.addEventListener("input",s=>{It(s.target.value)}),document.getElementById("label-color-hex")?.addEventListener("input",s=>{let r=s.target.value;r&&!r.startsWith("#")&&(r="#"+r),et(r)?(i.value=r,s.target.classList.remove("invalid")):s.target.classList.toggle("invalid",r.length>0)}),a?.addEventListener("input",s=>{const r=s.target;if(!r||typeof r.value!="string")return;const c=r.value.trim();c.length<=q||(r.value=c.slice(0,q),!oe&&(oe=!0,O({title:"Label Name Too Long",message:`Label names are limited to ${q} characters.`})))}),document.getElementById("label-form").addEventListener("submit",async s=>{s.preventDefault();const r=document.getElementById("label-name").value,c=document.getElementById("label-color-hex"),d=(c?.value||"").trim();let u;if(d&&d!==document.getElementById("label-color").value){const E=d.startsWith("#")?d:"#"+d;if(!et(E)){c?.classList.add("invalid"),await O({title:"Invalid Hex Color",message:"Please enter a valid hex color code (e.g. #3b82f6)."}),c?.focus();return}document.getElementById("label-color").value=E,u=E}else u=document.getElementById("label-color").value;const f=(r||"").trim();if(f.length>q){await O({title:"Label Name Too Long",message:`Label names are limited to ${q} characters.`});return}const m=(document.getElementById("label-group")?.value||"").trim(),p=!ae,g=ae?sn(ae,f,u,m):an(f,u,m);if(!g?.success){let E="Unable to Save Label",L="Could not save label.";g?.reason==="DUPLICATE_NAME"?(E="Label Already Exists",L=g?.message||"A label with that name already exists (case-insensitive)."):g?.reason==="EMPTY_NAME"&&(E="Label Name Required",L="Please enter a label name."),await O({title:E,message:L}),document.getElementById("label-name")?.focus();return}p&&me&&g?.label?.id&&(I.includes(g.label.id)||I.push(g.label.id),K(),document.getElementById("task-label-search")?.focus()),Pe(),ke();const{renderBoard:h}=await M(async()=>{const{renderBoard:E}=await Promise.resolve().then(()=>$);return{renderBoard:E}},void 0,import.meta.url);h(),R&&p&&Me()}),T("label-modal",Pe),document.getElementById("manage-boards-btn")?.addEventListener("click",_n),document.getElementById("add-board-btn")?.addEventListener("click",async()=>{document.dispatchEvent(new CustomEvent("kanban:open-board-create"))}),document.getElementById("boards-import-btn")?.addEventListener("click",async()=>{await G({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file")?.click()}),T("boards-modal",nt),document.getElementById("board-rename-form")?.addEventListener("submit",s=>{if(s.preventDefault(),!Le)return;const c=(document.getElementById("board-rename-name")?.value||"").trim();if(!c){alert("Board name cannot be empty.");return}if(!jt(Le,c)){alert("Unable to rename board.");return}_e(),Re(),ue(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),T("board-rename-modal",_e),document.getElementById("help-btn").addEventListener("click",Nn),T("help-modal",Ze),document.getElementById("add-column-btn").addEventListener("click",An),document.addEventListener("keydown",s=>{if(s.key==="Escape"){if(j("label-modal")){Pe();return}if(j("labels-modal")){Me();return}if(j("board-rename-modal")){_e();return}if(j("boards-modal")){nt();return}if(j("help-modal")){Ze();return}if(j("column-modal")){Ne();return}j("task-modal")&&Se()}})}let He=[],be=null,ie=null,J=0;function Hn(){const e=typeof navigator<"u"&&(navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0),t=typeof window<"u"&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer: coarse)").matches;return e||t}function Fn(){zn(),qn(),jn()}function zn(){He.forEach(e=>e.destroy()),He=[],be&&(be.destroy(),be=null),Dt()}function Un(){const e=document.getElementById("board-container");!e||ie||(ie=setInterval(()=>{if(!e)return;const t=e.getBoundingClientRect(),o=80,n=12;J>0&&(J<t.left+o&&e.scrollLeft>0?e.scrollLeft-=n:J>t.right-o&&e.scrollLeft<e.scrollWidth-e.clientWidth&&(e.scrollLeft+=n))},16))}function Dt(){ie&&(clearInterval(ie),ie=null),J=0}function he(e){e.touches&&e.touches[0]?J=e.touches[0].clientX:e.clientX&&(J=e.clientX)}function qn(){const e=document.querySelectorAll(".tasks:not(.hidden)"),t=Hn();e.forEach(o=>{const n=new ft(o,{group:{name:"tasks",pull:!0,put:!0},animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"task-ghost",chosenClass:"task-chosen",dragClass:"task-drag",draggable:".task",forceFallback:t,fallbackClass:"task-fallback",fallbackOnBody:!0,fallbackTolerance:0,swapThreshold:.65,emptyInsertThreshold:20,direction:"vertical",onStart:function(a){document.body.classList.add("dragging"),Un(),document.addEventListener("touchmove",he,{passive:!0}),document.addEventListener("mousemove",he,{passive:!0})},onEnd:async function(a){document.body.classList.remove("dragging"),Dt(),document.removeEventListener("touchmove",he),document.removeEventListener("mousemove",he);const i=Jt(a);if(i){const{syncTaskCounters:l,syncCollapsedTitles:s}=await M(async()=>{const{syncTaskCounters:c,syncCollapsedTitles:d}=await Promise.resolve().then(()=>$);return{syncTaskCounters:c,syncCollapsedTitles:d}},void 0,import.meta.url),{refreshNotifications:r}=await M(async()=>{const{refreshNotifications:c}=await Promise.resolve().then(()=>Wn);return{refreshNotifications:c}},void 0,import.meta.url);l(),i.didChangeColumn&&(s(),r())}}});He.push(n)})}function jn(){const e=document.getElementById("board-container");e&&(be=new ft(e,{animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"column-ghost",chosenClass:"column-chosen",dragClass:"column-drag",handle:".column-header",filter:"button:not(.column-drag-handle), a, input, select, textarea, [contenteditable]",preventOnFilter:!0,draggable:".task-column",scrollSensitivity:80,scrollSpeed:15,forceFallback:!1,fallbackOnBody:!0,onStart:function(t){document.body.classList.add("dragging-column")},onEnd:function(t){document.body.classList.remove("dragging-column"),tn()}}))}const xt="kanbanNotificationBannerHidden";let at;function At(){return localStorage.getItem(xt)==="true"}function st(e){localStorage.setItem(xt,e?"true":"false")}function Tt(){const e=document.getElementById("notification-banner-visibility-toggle");e&&(e.checked=!At())}function Ae(){const e=D(),t=B(),o=Number.isFinite(t.notificationDays)?t.notificationDays:3,n=new Date;return n.setHours(0,0,0,0),e.filter(a=>{if(a.column==="done")return!1;const i=(a.dueDate||"").toString().trim();if(!i)return!1;const l=new Date(i+"T00:00:00");if(Number.isNaN(l.getTime()))return!1;const s=l.getTime()-n.getTime();return Math.floor(s/(1e3*60*60*24))<=o}).map(a=>{const l=new Date(a.dueDate+"T00:00:00").getTime()-n.getTime(),s=Math.floor(l/(1e3*60*60*24));return{...a,daysUntilDue:s}}).sort((a,i)=>a.daysUntilDue-i.daysUntilDue)}function St(e,t,o){const a=new Date(t+"T00:00:00").toLocaleDateString(o||void 0);if(e<0){const i=Math.abs(e);return{text:`Overdue by ${i} day${i===1?"":"s"} (${a})`,className:"overdue"}}else return e===0?{text:`Due today (${a})`,className:"overdue"}:e===1?{text:`Due tomorrow (${a})`,className:"due-soon"}:{text:`Due in ${e} days (${a})`,className:"due-soon"}}function We(){const e=document.getElementById("notification-banner"),t=document.getElementById("notification-banner-list");if(!e||!t)return;const o=Ae(),n=B();if(o.length===0){e.classList.add("hidden");return}if(At()){e.classList.add("hidden");return}t.innerHTML="";const a=window.matchMedia("(min-width: 601px)").matches,i=l=>{const s=document.createElement("div");s.classList.add("notification-banner-item"),s.setAttribute("role","button"),s.setAttribute("tabindex","0"),s.setAttribute("aria-label",`Open task: ${l.title}`);const r=document.createElement("span");r.classList.add("task-title");const c=typeof l.text=="string"?l.text:"";r.textContent=typeof l.title=="string"&&l.title.trim()?l.title:c;const d=St(l.daysUntilDue,l.dueDate,n.locale),u=document.createElement("span");u.classList.add("due-date",d.className),u.textContent=d.text,s.appendChild(r),s.appendChild(u);const f=()=>se(l.id);return s.addEventListener("click",f),s.addEventListener("keydown",m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),f())}),s};if(a){const l=t.clientWidth||t.getBoundingClientRect().width;let s=0;for(const c of o){const d=i(c);if(t.appendChild(d),s+=1,t.scrollWidth>l&&s>1){t.removeChild(d),s-=1;break}}const r=o.length-s;if(r>0){const c=document.createElement("div");if(c.classList.add("notification-banner-item","notification-more"),c.setAttribute("role","button"),c.setAttribute("tabindex","0"),c.textContent=`+${r} `,c.addEventListener("click",Y),c.addEventListener("keydown",d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),Y())}),t.appendChild(c),t.scrollWidth>l&&s>0){t.removeChild(t.children[s-1]),s-=1;const d=o.length-s;c.textContent=`+${d} `,t.appendChild(c)}}}else if(o.slice(0,5).forEach(s=>{const r=i(s);t.appendChild(r)}),o.length>5){const s=document.createElement("div");s.classList.add("notification-banner-item","notification-more"),s.setAttribute("role","button"),s.setAttribute("tabindex","0"),s.textContent=`+${o.length-5} `,s.addEventListener("click",Y),s.addEventListener("keydown",r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),Y())}),t.appendChild(s)}e.classList.remove("hidden"),F()}function Vn(){const e=document.getElementById("notifications-list");if(!e)return;const t=Ae(),o=B(),n=Number.isFinite(o.notificationDays)?o.notificationDays:3;if(e.innerHTML="",t.length===0){const a=document.createElement("div");a.classList.add("notifications-empty"),a.textContent=n===0?"No tasks due today.":`No tasks due within the next ${n} day${n===1?"":"s"}.`,e.appendChild(a);return}t.forEach(a=>{const i=document.createElement("div");i.classList.add("notification-item"),i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.setAttribute("aria-label",`Open task: ${a.title}`);const l=document.createElement("div");l.classList.add("notification-item-content");const s=document.createElement("div");s.classList.add("notification-item-title");const r=typeof a.text=="string"?a.text:"";s.textContent=typeof a.title=="string"&&a.title.trim()?a.title:r;const c=document.createElement("div");c.classList.add("notification-item-meta");const d=St(a.daysUntilDue,a.dueDate,o.locale),u=document.createElement("span");u.classList.add(d.className),u.textContent=d.text;const f=typeof a.priority=="string"?a.priority:"low",m=document.createElement("span");m.classList.add("notification-item-priority",`priority-${f}`),m.textContent=f,c.appendChild(u),c.appendChild(m),l.appendChild(s),l.appendChild(c);const p=document.createElement("span");p.classList.add("notification-item-arrow"),p.dataset.lucide="chevron-right",i.appendChild(l),i.appendChild(p);const g=()=>{re(),se(a.id)};i.addEventListener("click",g),i.addEventListener("keydown",h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),g())}),e.appendChild(i)}),F()}function Nt(){const e=document.getElementById("notification-badge");if(!e)return;const o=Ae().length;o===0?(e.classList.add("hidden"),e.textContent=""):(e.classList.remove("hidden"),e.textContent=o>99?"99+":String(o))}function Y(){Tt(),Vn(),document.getElementById("notifications-modal")?.classList.remove("hidden")}function re(){document.getElementById("notifications-modal")?.classList.add("hidden")}function Mt(){const e=document.getElementById("notifications-modal");return e&&!e.classList.contains("hidden")}function Pt(){document.getElementById("notification-banner-close-btn")?.addEventListener("click",()=>{st(!0),le()});const t=document.getElementById("notification-banner-visibility-toggle");t?.addEventListener("change",()=>{st(!t.checked),le()}),document.getElementById("notifications-btn")?.addEventListener("click",Y),document.getElementById("notifications-close-btn")?.addEventListener("click",re),T("notifications-modal",re),document.addEventListener("keydown",a=>{a.key==="Escape"&&Mt()&&re()}),window.addEventListener("resize",()=>{clearTimeout(at),at=setTimeout(We,120)}),le(),Tt()}function le(){We(),Nt()}const Wn=Object.freeze(Object.defineProperty({__proto__:null,getNotificationTasks:Ae,hideNotificationsModal:re,initializeNotifications:Pt,isNotificationsModalOpen:Mt,refreshNotifications:le,renderNotificationBanner:We,showNotificationsModal:Y,updateNotificationBadge:Nt},Symbol.toStringTag,{value:"Module"}));let it=!1,Ge="";const _t=50,Gn=50;let ye=_t;function Ot(e){Ge=(e||"").toString()}function $t(e){return D().filter(o=>o.column===e).length}function Rt(e,t,o){if(!t)return!0;const n=typeof e?.text=="string"?e.text:"",a=typeof e?.title=="string"&&e.title.trim()!==""?e.title:n,i=typeof e?.description=="string"?e.description:"",l=typeof e?.priority=="string"?e.priority:"";if(a.toLowerCase().includes(t)||i.toLowerCase().includes(t)||l.toLowerCase().includes(t))return!0;const s=Array.isArray(e?.labels)?e.labels:[];for(const r of s){const c=o.get(r);if(c&&(c.name.includes(t)||c.group.includes(t)))return!0}return!1}function W(e=null){document.querySelectorAll(".column-menu").forEach(t=>{e&&t===e||t.classList.add("hidden")}),document.querySelectorAll(".column-submenu").forEach(t=>{t.classList.add("hidden")})}function Yn(e){return[...e].sort((t,o)=>{const n=(t.dueDate||"").toString().trim(),a=(o.dueDate||"").toString().trim();return!n&&!a?0:n?a?n.localeCompare(a):-1:1})}function Jn(e){const t={high:0,medium:1,low:2};return[...e].sort((o,n)=>{const a=t[o.priority]??2,i=t[n.priority]??2;return a-i})}function rt(e,t){const o=D(),n=o.filter(r=>r.column===e),a=o.filter(r=>r.column!==e),l=(t==="dueDate"?Yn(n):Jn(n)).map((r,c)=>({...r,order:c+1})),s=[...a,...l];H(s),P()}function Kn(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=o.includes("T")?o:`${o}T00:00:00`,a=new Date(n);return Number.isNaN(a.getTime())?o:a.toLocaleDateString(t||void 0)}function Xn(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=new Date(o);return Number.isNaN(n.getTime())?o:n.toLocaleString(t||void 0)}function Qn(e){const t=(e?.creationDate||"").toString().trim();if(!t)return"";const o=new Date(t);if(Number.isNaN(o.getTime()))return"";const n=1440*60*1e3,a=Math.max(0,Math.floor((Date.now()-o.getTime())/n));if(a<30)return`${a}d`;const i=Math.floor(a/365);let l=a%365;const s=Math.floor(l/30);l=l%30;const r=[];return i>=1&&r.push(`${i}y`),s>=1&&r.push(`${s}M`),r.push(`${l}d`),r.join(" ")}function Zn(e,t,o=null){const n=document.createElement("li");n.classList.add("task"),n.draggable=!0,n.dataset.taskId=e.id,n.setAttribute("role","listitem"),n.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const a=document.createElement("div");a.classList.add("task-labels"),a.setAttribute("role","list"),a.setAttribute("aria-label","Task labels");const i=o||new Map(x().map(y=>[y.id,y]));e.labels&&e.labels.length>0&&e.labels.forEach(y=>{const b=i instanceof Map?i.get(y):i.find(A=>A.id===y);if(b){const A=document.createElement("span");A.classList.add("task-label"),A.setAttribute("role","listitem"),A.style.backgroundColor=b.color,A.textContent=b.name,a.appendChild(A)}});const l=document.createElement("div");l.classList.add("task-header");const s=t?.showPriority!==!1,r=t?.showDueDate!==!1,c=document.createElement("div");c.classList.add("task-title"),c.setAttribute("role","button"),c.setAttribute("tabindex","0");const d=typeof e.text=="string"?e.text:"";c.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:d,c.addEventListener("click",()=>se(e.id)),c.addEventListener("keydown",y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),se(e.id))});const u=document.createElement("div");if(u.classList.add("task-actions"),s){const y=typeof e.priority=="string"?e.priority:"medium",b=document.createElement("span");b.classList.add("task-priority",`priority-${y}`,"task-priority-header"),b.textContent=y,b.setAttribute("aria-label",`Priority: ${y}`),u.appendChild(b)}const f=document.createElement("button");f.classList.add("delete-task-btn"),f.setAttribute("aria-label","Delete task"),f.type="button";const m=document.createElement("span");m.dataset.lucide="trash-2",m.setAttribute("aria-hidden","true"),f.appendChild(m),f.addEventListener("click",async y=>{y.stopPropagation(),await G({title:"Delete Task",message:"Are you sure you want to delete this task?",confirmText:"Delete"})&&Yt(e.id)&&P()}),u.appendChild(f),l.appendChild(c),l.appendChild(u);const p=typeof e.description=="string"?e.description.trim():"",g=document.createElement("div");g.classList.add("task-description"),g.textContent=p,g.style.display=p?"block":"none",g.addEventListener("click",()=>se(e.id)),n.appendChild(l),n.appendChild(g),n.appendChild(a);const h=t?.showChangeDate!==!1,E=t?.showAge!==!1,L=t?.locale,C=document.createElement("div");if(C.classList.add("task-footer"),h){const y=document.createElement("span");y.classList.add("task-change-date");const b=Xn(e?.changeDate,L);y.textContent=b?`Updated ${b}`:"",C.appendChild(y)}const v=document.createElement("div");if(v.classList.add("task-footer-row"),r){const y=typeof e.dueDate=="string"?e.dueDate.trim():"",b=document.createElement("span");b.classList.add("task-date"),y?b.textContent="Due "+Kn(y,t?.locale):b.textContent="No due date",v.appendChild(b)}if(E){const y=document.createElement("span");y.classList.add("task-age");const b=Qn(e);y.textContent=b?`Age ${b}`:"",v.appendChild(y)}return Array.from(v.childNodes).some(y=>(y.textContent||"").trim()!=="")&&C.appendChild(v),Array.from(C.childNodes).some(y=>(y.textContent||"").trim()!=="")&&n.appendChild(C),n}function eo(e){const t=document.createElement("article");t.classList.add("task-column"),t.dataset.column=e.id,t.draggable=!1,t.setAttribute("aria-labelledby",`column-title-${e.id}`);const o=e?.collapsed===!0;o&&t.classList.add("is-collapsed"),e?.color&&t.style.setProperty("--column-accent",e.color);const n=document.createElement("button");n.classList.add("column-collapse-btn"),n.type="button",n.setAttribute("aria-label",o?`Expand ${e.name} column`:`Collapse ${e.name} column`),n.title=o?"Expand column":"Collapse column";const a=document.createElement("span");a.dataset.lucide=o?"chevron-right":"chevrons-right-left",a.setAttribute("aria-hidden","true"),n.appendChild(a),n.addEventListener("click",k=>{k.stopPropagation(),Qt(e.id)&&P()});const i=document.createElement("button");i.classList.add("column-drag-handle"),i.type="button",i.setAttribute("aria-label","Drag to reorder column");const l=document.createElement("span");l.dataset.lucide="grip-vertical",l.setAttribute("aria-hidden","true"),i.appendChild(l),i.title="Drag to reorder";const s=document.createElement("header");s.classList.add("column-header");const r=document.createElement("h2");if(r.id=`column-title-${e.id}`,o){const k=$t(e.id);r.textContent=`${e.name} (${k})`}else r.textContent=e.name;const c=document.createElement("span");c.classList.add("task-counter"),c.dataset.columnId=e.id,c.textContent="0",c.setAttribute("aria-label","Task count");const d=document.createElement("div");d.classList.add("column-actions");const u=document.createElement("button");u.classList.add("add-task-btn-icon"),u.type="button",u.setAttribute("aria-label",`Add task to ${e.name}`);const f=document.createElement("span");f.dataset.lucide="plus",f.setAttribute("aria-hidden","true"),u.appendChild(f),u.title="Add task",u.addEventListener("click",()=>xn(e.id));const m=document.createElement("div");m.classList.add("column-menu-wrapper");const p=document.createElement("button");p.classList.add("column-menu-btn"),p.type="button",p.setAttribute("aria-haspopup","menu"),p.setAttribute("aria-expanded","false"),p.setAttribute("aria-label",`${e.name} column menu`);const g=document.createElement("span");g.dataset.lucide="ellipsis-vertical",g.setAttribute("aria-hidden","true"),p.appendChild(g),p.title="Column menu";const h=document.createElement("div");h.classList.add("column-menu","hidden"),h.setAttribute("role","menu");const E=document.createElement("button");E.classList.add("column-menu-item"),E.type="button",E.setAttribute("role","menuitem");const L=document.createElement("span");L.dataset.lucide="pencil",L.setAttribute("aria-hidden","true"),E.appendChild(L);const C=document.createTextNode(" Edit");E.appendChild(C),E.title="Edit column",E.addEventListener("click",k=>{k.stopPropagation(),W(),Tn(e.id)});const v=document.createElement("button");v.classList.add("column-menu-item","danger"),v.type="button",v.setAttribute("role","menuitem");const w=document.createElement("span");w.dataset.lucide="trash-2",w.setAttribute("aria-hidden","true"),v.appendChild(w);const ee=document.createTextNode(" Delete");v.appendChild(ee),v.title="Delete column",v.addEventListener("click",k=>{k.stopPropagation(),W(),(async()=>{if(e.id==="done"){await O({title:"Cannot Delete Column",message:"The Done column is permanent and cannot be deleted."});return}if(N().length<=1){await O({title:"Cannot Delete Column",message:"Cannot delete the last column."});return}const Ye=D().filter(Ut=>Ut.column===e.id),Je=e?.name?`"${e.name}"`:"this column",zt=Ye.length>0?`Delete ${Je}? This will also delete ${Ye.length} task(s).`:`Delete ${Je}?`;await G({title:"Delete Column",message:zt,confirmText:"Delete"})&&en(e.id)&&P()})()});const y=document.createElement("div");y.classList.add("column-menu-submenu-wrapper");const b=document.createElement("button");b.classList.add("column-menu-item","has-submenu"),b.type="button",b.setAttribute("role","menuitem"),b.setAttribute("aria-haspopup","menu"),b.setAttribute("aria-expanded","false");const A=document.createElement("span");A.dataset.lucide="arrow-up-down",A.setAttribute("aria-hidden","true"),b.appendChild(A);const Ft=document.createTextNode(" Sort");b.appendChild(Ft);const fe=document.createElement("span");fe.dataset.lucide="chevron-left",fe.classList.add("submenu-chevron"),fe.setAttribute("aria-hidden","true"),b.appendChild(fe),b.title="Sort tasks in column";const _=document.createElement("div");_.classList.add("column-submenu","hidden"),_.setAttribute("role","menu");const z=document.createElement("button");z.classList.add("column-menu-item"),z.type="button",z.setAttribute("role","menuitem"),z.textContent="By Due Date",z.title="Sort by due date (earliest first)",z.addEventListener("click",k=>{k.stopPropagation(),W(),rt(e.id,"dueDate")});const U=document.createElement("button");U.classList.add("column-menu-item"),U.type="button",U.setAttribute("role","menuitem"),U.textContent="By Priority",U.title="Sort by priority (high to low)",U.addEventListener("click",k=>{k.stopPropagation(),W(),rt(e.id,"priority")}),_.appendChild(z),_.appendChild(U),b.addEventListener("click",k=>{k.stopPropagation();const pe=!_.classList.contains("hidden");_.classList.toggle("hidden"),b.setAttribute("aria-expanded",pe?"false":"true")}),y.addEventListener("mouseenter",()=>{_.classList.remove("hidden"),b.setAttribute("aria-expanded","true")}),y.addEventListener("mouseleave",()=>{_.classList.add("hidden"),b.setAttribute("aria-expanded","false")}),y.appendChild(b),y.appendChild(_),h.appendChild(E),h.appendChild(y),h.appendChild(v),p.addEventListener("click",k=>{k.stopPropagation();const pe=!h.classList.contains("hidden");W(),pe?p.setAttribute("aria-expanded","false"):(h.classList.remove("hidden"),p.setAttribute("aria-expanded","true"))}),m.appendChild(p),m.appendChild(h),d.appendChild(u),d.appendChild(m),s.appendChild(n),s.appendChild(i),s.appendChild(r),s.appendChild(c),s.appendChild(d);const te=document.createElement("ul");return te.classList.add("tasks"),te.setAttribute("role","list"),te.setAttribute("aria-label",`Tasks in ${e.name}`),o&&(te.classList.add("hidden"),d.classList.add("hidden"),c.classList.add("hidden")),t.appendChild(s),t.appendChild(te),t}function to(){const e=N(),t=document.getElementById("task-column");t.innerHTML="",e.forEach(o=>{const n=document.createElement("option");n.value=o.id,n.textContent=o.name,t.appendChild(n)})}function no(){const e=D(),t=new Map(x().map(n=>[n.id,{name:(n.name||"").toString().trim().toLowerCase(),group:(n.group||"").toString().trim().toLowerCase()}])),o=(Ge||"").toString().trim().toLowerCase();document.querySelectorAll(".task-counter").forEach(n=>{const a=n.dataset.columnId;if(!a)return;const i=e.filter(l=>l.column!==a?!1:o?Rt(l,o,t):!0);n.textContent=i.length})}function oo(){document.querySelectorAll(".task-column.is-collapsed").forEach(e=>{const t=e.dataset.column,o=e.querySelector("h2");if(!t||!o)return;const n=$t(t),a=o.textContent.replace(/\s*\(\d+\)$/,"");o.textContent=`${a} (${n})`})}function P(){const e=N(),t=D(),o=x(),n=B(),a=new Map(o.map(d=>[d.id,d])),i=new Map(o.map(d=>[d.id,{name:(d.name||"").toString().trim().toLowerCase(),group:(d.group||"").toString().trim().toLowerCase()}])),l=(Ge||"").toString().trim().toLowerCase(),s=l?t.filter(d=>Rt(d,l,i)):t,r=document.getElementById("board-container");r.innerHTML="",[...e].sort((d,u)=>(d.order??0)-(u.order??0)).forEach(d=>{const u=eo(d);r.appendChild(u);const f=u.querySelector(".tasks"),m=u.querySelector(".task-counter"),p=s.filter(L=>L.column===d.id).sort((L,C)=>(L.order??0)-(C.order??0)),h=d.id==="done"&&p.length>_t;if((h?p.slice(0,ye):p).forEach(L=>{f.appendChild(Zn(L,n,a))}),h&&ye<p.length){const L=document.createElement("button");L.classList.add("show-more-btn"),L.type="button",L.textContent=`Show more (${p.length-ye} remaining)`,L.addEventListener("click",()=>{ye+=Gn,P()}),f.appendChild(L)}m.textContent=p.length}),Fn(),to(),F(),le(),it||(it=!0,document.addEventListener("click",()=>W()),document.addEventListener("keydown",d=>{d.key==="Escape"&&W()}))}const $=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:P,setBoardFilterQuery:Ot,syncCollapsedTitles:oo,syncTaskCounters:no},Symbol.toStringTag,{value:"Module"})),Ht="kanban-theme";function ao(){const e=localStorage.getItem(Ht);return e==="light"||e==="dark"?e:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function lt(e){document.documentElement.dataset.theme=e}function dt(e){const t=document.getElementById("theme-toggle-btn");if(!t)return;const o=e==="dark"?"light":"dark",n=o==="dark"?"Dark":"Light",a=o==="dark"?"moon":"sun";t.setAttribute("aria-pressed",String(e==="dark"));const i=t.querySelector("[data-lucide]");i&&i.setAttribute("data-lucide",a);const l=Array.from(t.childNodes).filter(s=>s.nodeType===Node.TEXT_NODE);for(const s of l)s.remove();t.appendChild(document.createTextNode(` ${n}`)),F()}function so(){const e=ao();lt(e),dt(e);const t=document.getElementById("theme-toggle-btn");t&&t.addEventListener("click",()=>{const n=(document.documentElement.dataset.theme==="dark"?"dark":"light")==="dark"?"light":"dark";lt(n),localStorage.setItem(Ht,n),dt(n)})}function io(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function ct(e){const t=Q(),o=Ue();e.innerHTML="",t.forEach(n=>{const a=document.createElement("option");a.value=n.id,a.textContent=io(n),e.appendChild(a)}),o&&(e.value=o)}function Oe(){const e=document.getElementById("brand-text")||document.querySelector(".brand-text");e&&(e.textContent=Ie())}function ro(){const e=document.getElementById("board-create-modal"),t=document.getElementById("board-create-name");!e||!t||(t.value="",e.classList.remove("hidden"),t.focus())}function ne(){const e=document.getElementById("board-create-modal");e&&e.classList.add("hidden")}function lo(){ze();const e=document.getElementById("board-select");if(!e)return;ct(e),Oe(),document.addEventListener("kanban:open-board-create",()=>{ro()}),e.addEventListener("change",()=>{const a=e.value;if(!a)return;Ee(a),Oe(),P();const i=document.getElementById("board-controls-menu"),l=document.getElementById("desktop-menu-btn");i?.classList.remove("show"),l?.setAttribute("aria-expanded","false")});const t=document.getElementById("board-create-modal"),o=document.getElementById("board-create-form"),n=document.getElementById("cancel-board-create-btn");t&&(t.querySelector(".modal-backdrop")?.addEventListener("click",ne),t.addEventListener("keydown",i=>{i.key==="Escape"&&ne()})),n&&n.addEventListener("click",ne),T("board-create-modal",ne),o&&o.addEventListener("submit",async a=>{a.preventDefault();const i=document.getElementById("board-create-name"),l=(i?.value||"").trim();if(!l){await O({title:"Error",message:"Board name cannot be empty."}),i?.focus();return}const s=ut(l);Ee(s.id),ct(e),Oe(),P(),ne(),document.dispatchEvent(new CustomEvent("kanban:boards-changed"))})}function co(e){const t=[];for(const o of e){if(typeof o!="string")continue;const n=o.trim();n&&(t.includes(n)||t.push(n))}return t}function uo(e){const t=typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US";return co([e,t,"en-US","en-GB","de-DE","fr-FR","es-ES","it-IT","pt-BR","ja-JP","zh-CN"])}function mo(){document.getElementById("settings-modal")?.classList.remove("hidden")}function $e(){document.getElementById("settings-modal")?.classList.add("hidden")}async function V(e){mt(e);const{renderBoard:t}=await M(async()=>{const{renderBoard:o}=await Promise.resolve().then(()=>$);return{renderBoard:o}},void 0,import.meta.url);t()}function fo(){const e=document.getElementById("settings-btn"),t=document.getElementById("settings-close-btn");document.querySelector("#settings-modal .modal-backdrop");const o=document.getElementById("settings-show-priority"),n=document.getElementById("settings-show-due-date"),a=document.getElementById("settings-notification-days"),i=document.getElementById("settings-show-age"),l=document.getElementById("settings-show-change-date"),s=document.getElementById("settings-locale"),r=document.getElementById("settings-default-priority");if(!e||!t||!o||!n||!a||!i||!l||!s||!r)return;function c(){const d=B();o.checked=d.showPriority!==!1,n.checked=d.showDueDate!==!1,i.checked=d.showAge!==!1,l.checked=d.showChangeDate!==!1,a.value=String(Number.isFinite(d.notificationDays)?d.notificationDays:3);const u=uo(d.locale);s.innerHTML="",u.forEach(f=>{const m=document.createElement("option");m.value=f,m.textContent=f,s.appendChild(m)}),s.value=d.locale,r.value=d.defaultPriority||"low"}e.addEventListener("click",()=>{c(),mo()}),t.addEventListener("click",$e),T("settings-modal",$e),document.addEventListener("keydown",d=>{const u=document.getElementById("settings-modal");!u||u.classList.contains("hidden")||d.key==="Escape"&&$e()}),i.addEventListener("change",async()=>{const d=B();await V({...d,showAge:!!i.checked})}),l.addEventListener("change",async()=>{const d=B();await V({...d,showChangeDate:!!l.checked})}),o.addEventListener("change",async()=>{const d=B();await V({...d,showPriority:!!o.checked})}),n.addEventListener("change",async()=>{const d=B();await V({...d,showDueDate:!!n.checked})}),a.addEventListener("change",async()=>{const d=B(),u=Number.parseInt(a.value,10),f=Number.isFinite(u)?u:3;await V({...d,notificationDays:f})}),s.addEventListener("change",async()=>{const d=B();await V({...d,locale:s.value})}),r.addEventListener("change",async()=>{const d=B();await V({...d,defaultPriority:r.value})})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("app-version");e&&(e.textContent="v1.0.11",e.title="Version 1.0.11"),so(),fo();const t=document.getElementById("board-search-input");t&&t.addEventListener("input",()=>{Ot(t.value),P()}),lo(),Rn(),Pt(),document.getElementById("export-btn").addEventListener("click",async()=>{await G({title:"Export Board (Active Only)",message:`Export ONLY saves the current active board. It does NOT back up all boards.

To back up everything, export each board individually.

Continue with export?`,confirmText:"Export"})&&bn()}),document.getElementById("import-btn").addEventListener("click",async()=>{await G({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",a=>{const i=a.target.files[0];i&&vn(i),a.target.value=""});const o=document.getElementById("desktop-menu-btn"),n=document.getElementById("board-controls-menu");o&&n&&(o.addEventListener("click",a=>{a.stopPropagation();const i=o.getAttribute("aria-expanded")==="true";n.classList.toggle("show"),o.setAttribute("aria-expanded",String(!i)),document.querySelectorAll(".column-menu").forEach(l=>l.classList.add("hidden"))}),n.addEventListener("click",a=>{a.target.closest("select, option, input, textarea, label")||!a.target.closest('button, a, [role="menuitem"]')||(n.classList.remove("show"),o.setAttribute("aria-expanded","false"))}),document.addEventListener("click",a=>{!n.contains(a.target)&&!o.contains(a.target)&&(n.classList.remove("show"),o.setAttribute("aria-expanded","false"))})),P()});
