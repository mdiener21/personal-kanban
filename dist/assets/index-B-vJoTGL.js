import{l as J,g as mn,s as Ee,a as ae,b as He,c as ie,d as Pt,e as X,f as Mt,h as Gn,i as It,j as qn,k as ze,r as xe,m as fn,n as pn,o as No,p as Oo}from"./storage-CAWtgQEU.js";const Po=new Set(["low","medium","high"]);function Vn(e){const t=(e||"").toString().trim().toLowerCase();return Po.has(t)?t:"low"}function Kn(e){return(e||"").toString().trim()}function Mo(e,t,o,n,a,i=[]){if(!e||e.trim()==="")return;const s=J(),r=s.filter(m=>m.column===a).slice().sort((m,f)=>(m.order??0)-(f.order??0)),l=new Map;r.forEach((m,f)=>{l.set(m.id,f+2)});const d=s.map(m=>{if(m.column!==a)return m;const f=l.get(m.id);return typeof f=="number"?{...m,order:f}:m}),c=new Date().toISOString(),u={id:mn(),title:e.trim(),description:(t||"").toString().trim(),priority:Vn(o),dueDate:Kn(n),column:a,order:1,labels:[...i],creationDate:c,changeDate:c,columnHistory:[{column:a,at:c}],...a==="done"?{doneDate:c}:{}};d.push(u),Ee(d)}function Ro(e,t,o,n,a,i,s=[]){if(!t||t.trim()==="")return;const r=J(),l=r.findIndex(d=>d.id===e);if(l!==-1){const d=r[l].column,c=i,u=new Date().toISOString();if(!Array.isArray(r[l].columnHistory)||r[l].columnHistory.length===0){const m=r[l].creationDate||r[l].changeDate||u,f=typeof d=="string"?d:c;r[l].columnHistory=[{column:f,at:m}]}r[l].title=t.trim(),r[l].description=(o||"").toString().trim(),r[l].priority=Vn(n),r[l].dueDate=Kn(a),r[l].column=c,r[l].labels=[...s],d!==c&&r[l].columnHistory.push({column:c,at:u}),d!=="done"&&c==="done"?r[l].doneDate=u:d==="done"&&c!=="done"&&delete r[l].doneDate,r[l].changeDate=u,Ee(r)}}function Fo(e){const o=J().filter(n=>n.id!==e);return Ee(o),!0}function $o(){const e=[];return document.querySelectorAll(".task-column").forEach(t=>{const o=t.dataset.column;t.querySelectorAll(".task").forEach(n=>{e.push({id:n.dataset.taskId,column:o})})}),e}function Ho(){const e=$o(),t=J(),o=new Date().toISOString(),n=t.map(a=>{const i=e.findIndex(s=>s.id===a.id);if(i!==-1){const s=e[i],r=e.filter((m,f)=>m.column===s.column&&f<=i),l=s.column,d=r.length,c=a.column!==l,u={...a,column:l,order:d,...c?{changeDate:o}:{}};if(c){const m=Array.isArray(a.columnHistory)&&a.columnHistory.length?[...a.columnHistory]:[{column:a.column,at:a.creationDate||a.changeDate||o}];m.push({column:l,at:o}),u.columnHistory=m,a.column!=="done"&&l==="done"?u.doneDate=o:a.column==="done"&&l!=="done"&&delete u.doneDate}return{...u}}return a});Ee(n)}function zo(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function Jn(e){return zo(e)?e.trim():"#3b82f6"}function Yo(e,t){if(!e||e.trim()==="")return;const o=ae(),n=o.reduce((s,r)=>Math.max(s,r.order??0),0),i={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+mn().substring(0,8),name:e.trim(),color:Jn(t),order:n-1,collapsed:!1};o.push(i),He(o)}function Uo(e){const t=typeof e=="string"?e.trim():"";if(!t)return!1;const o=ae(),n=o.find(a=>a.id===t);return n?(n.collapsed=n.collapsed!==!0,He(o),!0):!1}function Xo(e,t,o){if(!t||t.trim()==="")return;const n=ae(),a=n.findIndex(i=>i.id===e);a!==-1&&(n[a].name=t.trim(),n[a].color=Jn(o),He(n))}function jo(e){if(e==="done")return!1;const t=ae();if(t.length<=1)return!1;const o=J();if(o.filter(i=>i.column===e).length>0){const i=o.filter(s=>s.column!==e);Ee(i)}const a=t.filter(i=>i.id!==e);return He(a),!0}function Wo(){const t=document.getElementById("board-container").querySelectorAll(".task-column"),o=ae();t.forEach((n,a)=>{const i=n.dataset.column,s=o.find(r=>r.id===i);s&&(s.order=a+1)}),He(o)}const Go="modulepreload",qo=function(e,t){return new URL(e,t).href},Ln={},ce=function(t,o,n){let a=Promise.resolve();if(o&&o.length>0){let d=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const s=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),l=r?.nonce||r?.getAttribute("nonce");a=d(o.map(c=>{if(c=qo(c,n),c in Ln)return;Ln[c]=!0;const u=c.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(n)for(let p=s.length-1;p>=0;p--){const g=s[p];if(g.href===c&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Go,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((p,g)=>{f.addEventListener("load",p),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(s){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=s,window.dispatchEvent(r),!r.defaultPrevented)throw s}return a.then(s=>{for(const r of s||[])r.status==="rejected"&&i(r.reason);return t().catch(i)})},hn=40;function gn(e){return e.trim().slice(0,hn).toLowerCase().replace(/\s+/g," ")}function Qn(e,t,o=null){return e.some(n=>o&&n.id===o?!1:gn(n.name)===t)}function Vo(e,t,o=""){if(!e||e.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const n=e.trim().slice(0,hn),a=gn(n),i=ie();if(Qn(i,a))return{success:!1,reason:"DUPLICATE_NAME",message:`Label "${n}" already exists.`};const s=a.replace(/\s+/g,"-")+"-"+mn().substring(0,8),r=typeof o=="string"?o.trim():"",l={id:s,name:n,color:t,group:r};return i.push(l),Pt(i),{success:!0,label:l}}function Ko(e,t,o,n=""){if(!t||t.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const a=t.trim().slice(0,hn),i=gn(a),s=ie(),r=s.findIndex(l=>l.id===e);return r===-1?{success:!1,reason:"NOT_FOUND"}:Qn(s,i,e)?{success:!1,reason:"DUPLICATE_NAME",message:`Another label with the name "${a}" already exists.`}:(s[r].name=a,s[r].color=o,s[r].group=typeof n=="string"?n.trim():"",Pt(s),{success:!0,label:s[r]})}function Jo(e){const t=ie(),o=J();o.forEach(a=>{a.labels&&(a.labels=a.labels.filter(i=>i!==e))}),Ee(o);const n=t.filter(a=>a.id!==e);Pt(n)}let St=null;function oe(e){return document.getElementById(e)}function ut(e){const t=oe("dialog-modal");t&&t.classList.add("hidden");const o=St;St=null,typeof o=="function"&&o(!!e)}function Qo(){const e=oe("dialog-modal");return e&&!e.classList.contains("hidden")}function Zn({title:e,message:t,confirmText:o,cancelText:n,showCancel:a}){const i=oe("dialog-modal-title"),s=oe("dialog-modal-message"),r=oe("dialog-confirm-btn"),l=oe("dialog-cancel-btn");i&&(i.textContent=e||"Confirm"),s&&(s.textContent=t||""),r&&(r.textContent=o||"OK"),l&&(l.textContent=n||"Cancel"),l&&(l.style.display=a?"inline-flex":"none")}function eo(){const e=oe("dialog-modal");if(!e||e.dataset.handlersAttached==="true")return;e.dataset.handlersAttached="true";const t=oe("dialog-confirm-btn"),o=oe("dialog-cancel-btn");e.querySelector(".modal-backdrop"),t?.addEventListener("click",()=>ut(!0)),o?.addEventListener("click",()=>ut(!1)),te("dialog-modal",()=>ut(!1)),document.addEventListener("keydown",n=>{n.key==="Escape"&&Qo()&&ut(!1)})}function to(){const e=oe("dialog-modal");if(!e)return;e.classList.remove("hidden"),oe("dialog-confirm-btn")?.focus()}function Te({title:e="Confirm",message:t="",confirmText:o="Delete",cancelText:n="Cancel"}={}){return eo(),Zn({title:e,message:t,confirmText:o,cancelText:n,showCancel:!0}),to(),new Promise(a=>{St=a})}function de({title:e="Notice",message:t="",okText:o="OK"}={}){return eo(),Zn({title:e,message:t,confirmText:o,cancelText:"",showCancel:!1}),to(),new Promise(n=>{St=()=>n(!0)})}function Yt(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return Array.isArray(o)?o:null}catch{return null}}function Zo(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return o&&typeof o=="object"&&!Array.isArray(o)?o:null}catch{return null}}function no(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function ea(e){const t=document.getElementById("brand-text")||document.querySelector(".brand-text");t&&(t.textContent=Mt());const o=document.getElementById("board-select");if(!o)return;const n=ze();o.innerHTML="",n.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=no(a),o.appendChild(i)}),e&&(o.value=e)}function ta(e){const t=typeof e?.name=="string"?e.name.trim():"";return t?t.replace(/\.[^.]+$/,"").trim():""}function Rt(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const na=new Set(["low","medium","high"]);function Ft(e){const t=(e||"").toString().trim().toLowerCase();return na.has(t)?t:"low"}function oa(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},o=t.showPriority!==!1,n=t.showDueDate!==!1,a=t.showAge!==!1,i=t.showChangeDate!==!1,s=typeof t.locale=="string"&&t.locale.trim()?t.locale.trim():typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US",r=Ft(t.defaultPriority),l=Number.parseInt((t.notificationDays??"").toString(),10),d=Number.isFinite(l)?Math.min(365,Math.max(0,l)):3;return{showPriority:o,showDueDate:n,showAge:a,showChangeDate:i,locale:s,defaultPriority:r,notificationDays:d}}function oo(e){const t=(e||"").toString().trim();return t.length>=10&&t.includes("T")?t.slice(0,10):t}function ao(e){const t=typeof e?.text=="string"?e.text:"",o=typeof e?.title=="string"?e.title:t,n=typeof e?.description=="string"?e.description:"",a=oo(e?.dueDate??e?.["due-date"]),i=typeof e?.changeDate=="string"?e.changeDate:typeof e?.changedDate=="string"?e.changedDate:void 0,s=e?.column==="done",r=typeof e?.doneDate=="string"?e.doneDate.toString().trim():"",l=Array.isArray(e?.columnHistory)?e.columnHistory.map(d=>{const c=typeof d?.column=="string"?d.column.trim():"",u=typeof d?.at=="string"?d.at.trim():"";return!c||!u?null:{column:c,at:u}}).filter(Boolean):void 0;return{...e,title:o.toString().trim(),description:n.toString().trim(),priority:Ft(e?.priority),dueDate:a,...typeof i=="string"?{changeDate:i.toString().trim()}:{},...s&&r?{doneDate:r}:{doneDate:void 0},...l&&l.length?{columnHistory:l}:{columnHistory:void 0},changedDate:void 0}}function aa(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.text=="string"?n.text:String(n?.text??""),s=typeof n?.title=="string"?n.title:i,r=typeof n?.description=="string"?n.description:String(n?.description??""),l=Ft(n?.priority),d=typeof n?.dueDate=="string"?n.dueDate:typeof n?.["due-date"]=="string"?n["due-date"]:String(n?.dueDate??n?.["due-date"]??""),c=oo(d),u=typeof n?.column=="string"?n.column:String(n?.column??""),m=Array.isArray(n?.labels)?n.labels.map(w=>typeof w=="string"?w:String(w)):[],f=Number.isFinite(n?.order)?n.order:void 0,p=typeof n?.creationDate=="string"?n.creationDate:void 0,g=typeof n?.changeDate=="string"?n.changeDate:typeof n?.changedDate=="string"?n.changedDate:void 0,C=typeof n?.doneDate=="string"?n.doneDate.trim():"",B=u.trim()==="done"&&(C||(typeof g=="string"?g.trim():"")||p)||"",k=Array.isArray(n?.columnHistory)?n.columnHistory.map(w=>{const v=typeof w?.column=="string"?w.column.trim():String(w?.column??"").trim(),D=typeof w?.at=="string"?w.at.trim():String(w?.at??"").trim();return!v||!D?null:{column:v,at:D}}).filter(Boolean):void 0;return{id:a.trim(),title:s.trim(),description:r.trim(),priority:l,dueDate:c.trim(),column:u.trim(),...f!==void 0?{order:f}:{},...p?{creationDate:p}:{},...typeof g=="string"&&g.trim()?{changeDate:g.trim()}:{},...B?{doneDate:B}:{},...k&&k.length?{columnHistory:k}:{},labels:m}});return t.every(n=>n.id&&n.title&&n.column)?t:null}function ia(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),s=Number.isFinite(n?.order)?n.order:void 0,r=Rt(n?.color)?n.color.trim():"#3b82f6",l=n?.collapsed===!0;return{id:a.trim(),name:i.trim(),color:r,collapsed:l,...s!==void 0?{order:s}:{}}});if(!t.some(n=>n.id==="done")){const n=t.reduce((a,i)=>Math.max(a,Number.isFinite(i?.order)?i.order:0),0);t.push({id:"done",name:"Done",color:"#16a34a",order:n+1,collapsed:!1})}return t.every(n=>n.id&&n.name)?t:null}function ra(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),s=Rt(n?.color)?n.color.trim():"#3b82f6",r=typeof n?.group=="string"?n.group.trim():"";return{id:a.trim(),name:i.trim(),color:s,group:r}});return t.every(n=>n.id&&n.name&&n.color)?t:null}function sa(e){if(!e||typeof e!="object"||Array.isArray(e))return null;const t=e.showPriority!==!1,o=e.showDueDate!==!1,n=e.showAge!==!1,a=e.showChangeDate!==!1,i=typeof e.locale=="string"&&e.locale.trim()?e.locale.trim():void 0,s=typeof e.defaultPriority=="string"?e.defaultPriority:void 0,r=s?Ft(s):void 0,l=Number.parseInt((e.notificationDays??"").toString(),10),d=Number.isFinite(l)?Math.min(365,Math.max(0,l)):void 0;return{showPriority:t,showDueDate:o,showAge:n,showChangeDate:a,...i?{locale:i}:{},...r?{defaultPriority:r}:{},...d!==void 0?{notificationDays:d}:{}}}function la(){const e=J().map(ao),t=ae().map(c=>({...c,color:Rt(c?.color)?c.color.trim():"#3b82f6"})),o=ie(),n=X(),a=Mt(),s=JSON.stringify({boardName:a,columns:t,tasks:e,labels:o,settings:n},null,2),r=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(r),d=document.createElement("a");d.href=l,d.download=`${a.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(l)}function da(e){const t=typeof e=="string"?e.trim():"";if(!t)return;const o=ze().find(v=>v.id===t),n=no(o),a=`kanbanBoard:${t}:columns`,i=`kanbanBoard:${t}:tasks`,s=`kanbanBoard:${t}:labels`,r=`kanbanBoard:${t}:settings`,l=Yt(i)||[],d=Yt(a)||[],c=Yt(s)||[],u=Zo(r)||null,m=l.map(ao),f=d.map(v=>({...v,color:Rt(v?.color)?v.color.trim():"#3b82f6",collapsed:v?.collapsed===!0})),p=Array.isArray(c)?c:[],g=oa(u),I=JSON.stringify({boardName:n,columns:f,tasks:m,labels:p,settings:g},null,2),B=new Blob([I],{type:"application/json"}),k=URL.createObjectURL(B),w=document.createElement("a");w.href=k,w.download=`${n.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(k)}function ca(e){const t=new FileReader;t.onload=async o=>{try{const n=JSON.parse(o.target.result);let a,i,s,r,l;if(Array.isArray(n))a=n,i=null,s=null,r=null,l=null;else if(n.tasks&&n.columns)a=n.tasks,i=n.columns,s=Object.prototype.hasOwnProperty.call(n,"labels")?n.labels:null,r=Object.prototype.hasOwnProperty.call(n,"settings")?n.settings:null,l=typeof n.boardName=="string"?n.boardName.trim():null;else{alert("Invalid JSON file format");return}const d=aa(a),c=i?ia(i):null,u=s?ra(s):null,m=r?sa(r):null;if(!d||i&&!c||s&&!u||r&&!m){alert("Invalid data structure");return}const f=l||ta(e)||"Imported board",p=Gn(f);if(p?.id&&It(p.id),c&&He(c),Ee(d),u&&Pt(u),m){const C=X();qn({...C,...m})}ea(p?.id);const{renderBoard:g}=await ce(async()=>{const{renderBoard:C}=await Promise.resolve().then(()=>me);return{renderBoard:C}},void 0,import.meta.url);g(),document.dispatchEvent(new CustomEvent("kanban:boards-changed")),alert("Board imported successfully!")}catch(n){alert("Error parsing JSON file: "+n.message)}},t.readAsText(e)}function io(e,t){if(!e)return;const o=e.closest(".form-group");if(!o)return;o.classList.add("error");let n=o.querySelector(".error-message");n||(n=document.createElement("div"),n.classList.add("error-message"),o.appendChild(n)),n.textContent=t,e.focus()}function Ye(e){if(!e)return;const t=e.closest(".form-group");t&&t.classList.remove("error")}function ua(e){return(e?.trim()||"").length>0}function ma(e){const t=e?.value?.trim()||"";return ua(t)?(Ye(e),!0):(io(e,"Task title is required"),!1)}function fa(e){return(e?.trim()||"").length>0}function pa(e){const t=e?.value?.trim()||"";return fa(t)?(Ye(e),!0):(io(e,"Column name is required"),!1)}let In="todo",ot=null,at=null,Ve=null,Bt=null,j=[],ve=!1,rt=!1;const Ce=40;let Xe=!1;function $t(e){const t=document.getElementById("task-modal");if(!t)return;t.classList.toggle("fullscreen",!!e);const o=document.getElementById("task-fullpage-btn");if(o?.setAttribute("aria-pressed",e?"true":"false"),o){const n=o.querySelector("[data-lucide]");n&&n.setAttribute("data-lucide",e?"minimize-2":"maximize-2"),o.title=e?"Exit full page":"Open in full page"}xe()}function De(e){const t=document.getElementById(e);return!!t&&!t.classList.contains("hidden")}function te(e,t){const o=document.getElementById(e);if(!o)return;o.querySelector(".modal-backdrop")?.addEventListener("click",t),o.querySelectorAll('[id$="-close-btn"], [id$="-close-modal-btn"], [id$="-cancel-btn"], [id^="cancel-"]').forEach(i=>{i.addEventListener("click",t)})}function ha(){const e=document.getElementById("task-modal");e&&(e.classList.remove("hidden"),Fe(),document.getElementById("task-label-search")?.focus(),ve=!1)}function ga(){return(document.getElementById("task-label-search")?.value||"").trim().toLowerCase()}function ba(){return(document.getElementById("labels-search")?.value||"").trim().toLowerCase()}function bn(){const e=document.getElementById("task-active-labels");if(!e)return;const t=ie(),o=[];for(const a of j)o.includes(a)||o.push(a);j=o;const n=o.map(a=>t.find(i=>i.id===a)).filter(Boolean);e.innerHTML="",e.style.display=n.length>0?"flex":"none",n.forEach(a=>{const i=document.createElement("span");i.classList.add("task-label"),i.style.backgroundColor=a.color,i.textContent=a.name;const s=document.createElement("button");s.type="button",s.classList.add("active-label-remove"),s.setAttribute("aria-label",`Remove label ${a.name}`),s.title="Remove label",s.textContent="Ã—",s.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation(),j=j.filter(l=>l!==a.id),bn(),Fe()}),i.appendChild(s),e.appendChild(i)})}function ya(e){In=e||ae()[0]?.id||"todo",ot=null,j=[],ve=!1,rt=!1,$t(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden");const t=document.getElementById("task-modal"),o=document.getElementById("task-column"),n=document.getElementById("task-title"),a=document.getElementById("task-description"),i=document.getElementById("task-priority"),s=document.getElementById("task-due-date"),r=document.getElementById("task-modal-title"),l=document.getElementById("task-submit-btn");if(Ye(n),r.textContent="Add New Task",l.textContent="Add Task",o.value=In,n.value="",a.value="",i){const c=X();i.value=c.defaultPriority||"low"}s&&(s.value="");const d=document.getElementById("task-label-search");d&&(d.value=""),Fe(),t.classList.remove("hidden"),n.focus()}function Ke(e){const o=J().find(g=>g.id===e);if(!o)return;ot=e,j=o.labels||[],ve=!1,rt=!1,$t(!1),document.getElementById("task-fullpage-btn")?.classList.remove("hidden");const n=document.getElementById("task-modal"),a=document.getElementById("task-column"),i=document.getElementById("task-title"),s=document.getElementById("task-description"),r=document.getElementById("task-priority"),l=document.getElementById("task-due-date"),d=document.getElementById("task-modal-title"),c=document.getElementById("task-submit-btn");Ye(i),d.textContent="Edit Task",c.textContent="Save Changes",a.value=o.column;const u=typeof o.text=="string"?o.text:"";i.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:u,s.value=typeof o.description=="string"?o.description:"",r&&(r.value=typeof o.priority=="string"?o.priority:"medium");const m=typeof o.dueDate=="string"?o.dueDate:"",f=m.includes("T")?m.slice(0,10):m;l&&(l.value=f);const p=document.getElementById("task-label-search");p&&(p.value=""),Fe(),n.classList.remove("hidden"),i.focus()}function Ut(){document.getElementById("task-modal").classList.add("hidden"),ot=null,ve=!1,$t(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden")}function va(){at=null;const e=document.getElementById("column-modal"),t=document.getElementById("column-name"),o=document.getElementById("column-color"),n=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");Ye(t),n.textContent="Add New Column",a.textContent="Add Column",t.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),t.focus()}function Ea(e){const o=ae().find(l=>l.id===e);if(!o)return;at=e;const n=document.getElementById("column-modal"),a=document.getElementById("column-name"),i=document.getElementById("column-color"),s=document.getElementById("column-modal-title"),r=document.getElementById("column-submit-btn");Ye(a),s.textContent="Edit Column",r.textContent="Save Changes",a.value=o.name,i&&(i.value=o.color||"#3b82f6"),n.classList.remove("hidden"),a.focus()}function Xt(){document.getElementById("column-modal").classList.add("hidden"),at=null}function wa(){const e=document.getElementById("labels-search");e&&(e.value=""),Tt(),document.getElementById("labels-modal").classList.remove("hidden"),ve||document.getElementById("labels-search")?.focus()}function jt(){document.getElementById("labels-modal").classList.add("hidden");const t=document.getElementById("labels-search");t&&(t.value=""),ve&&ha()}function Ca(){document.getElementById("help-modal").classList.remove("hidden")}function Sn(){document.getElementById("help-modal").classList.add("hidden")}const Da=/^#[0-9a-fA-F]{6}$/;function Bn(e){return Da.test(e)}function ro(e){const t=document.getElementById("label-color-hex");t&&(t.value=e,t.classList.remove("invalid"))}function La(){const e=document.getElementById("label-group-suggestions");if(!e)return;e.innerHTML="";const t=ie();[...new Set(t.map(n=>(n.group||"").trim()).filter(n=>n.length>0))].sort((n,a)=>n.localeCompare(a)).forEach(n=>{const a=document.createElement("option");a.value=n,e.appendChild(a)})}function kt(e=null,{openedFromTaskEditor:t=!1,initialName:o=""}={}){Ve=e,Xe=!1,rt=!!t;const n=document.getElementById("label-modal"),a=document.getElementById("label-modal-title"),i=document.getElementById("label-name"),s=document.getElementById("label-color"),r=document.getElementById("label-group"),l=document.getElementById("label-submit-btn");if(e){const c=ie().find(u=>u.id===e);c&&(a.textContent="Edit Label",l.textContent="Update Label",i.value=c.name,s.value=c.color,r&&(r.value=c.group||""))}else a.textContent="Add Label",l.textContent="Add Label",i.value=o||"",s.value="#3b82f6",r&&(r.value="");La(),ro(s.value),n.classList.remove("hidden"),i.focus()}function Wt(){document.getElementById("label-modal").classList.add("hidden"),Ve=null,rt=!1}function kn(e){const t=document.createElement("div");t.classList.add("label-item"),t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-between";const o=document.createElement("span");o.classList.add("task-label"),o.style.backgroundColor=e.color,o.textContent=e.name;const n=document.createElement("div");n.classList.add("label-actions"),n.style.display="flex",n.style.gap="4px";const a=document.createElement("button");a.classList.add("btn-small");const i=document.createElement("span");i.dataset.lucide="pencil",a.appendChild(i),a.title="Edit label",a.addEventListener("click",()=>kt(e.id));const s=document.createElement("button");s.classList.add("btn-small","btn-danger");const r=document.createElement("span");return r.dataset.lucide="trash-2",s.appendChild(r),s.title="Delete label",s.addEventListener("click",async()=>{if(await Te({title:"Delete Label",message:`Delete label "${e.name}"? This will remove it from all tasks.`,confirmText:"Delete"})){Jo(e.id),Tt();const{renderBoard:d}=await ce(async()=>{const{renderBoard:c}=await Promise.resolve().then(()=>me);return{renderBoard:c}},void 0,import.meta.url);d()}}),n.appendChild(a),n.appendChild(s),t.appendChild(o),t.appendChild(n),t}function so(e){const t=e.filter(a=>!(a.group||"").trim()),o=new Map;e.forEach(a=>{const i=(a.group||"").trim();i&&(o.has(i)||o.set(i,[]),o.get(i).push(a))});const n=[...o.keys()].sort((a,i)=>a.localeCompare(i));return{ungrouped:t,groupMap:o,sortedGroups:n}}function Tt(){const e=document.getElementById("labels-list");e.innerHTML="";const t=ie(),o=ba(),n=o?t.filter(r=>{const l=(r.name||"").toLowerCase(),d=(r.id||"").toLowerCase(),c=(r.group||"").toLowerCase();return l.includes(o)||d.includes(o)||c.includes(o)}):t;if(n.length===0){const r=document.createElement("div");r.classList.add("labels-empty"),r.textContent=o?"No matching labels":"No labels yet",e.appendChild(r);return}const{ungrouped:a,groupMap:i,sortedGroups:s}=so(n);a.forEach(r=>{e.appendChild(kn(r))}),s.forEach(r=>{const l=document.createElement("div");l.classList.add("label-group-header"),l.textContent=r,e.appendChild(l),i.get(r).forEach(d=>{e.appendChild(kn(d))})}),xe()}function rn(){const e=document.getElementById("board-select");if(!e)return;const t=ze(),o=pn();e.innerHTML="",t.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=typeof a.name=="string"&&a.name.trim()?a.name.trim():"Untitled board",e.appendChild(i)}),o&&(e.value=o);const n=document.getElementById("brand-text")||document.querySelector(".brand-text");n&&(n.textContent=Mt())}function it(){fn();const e=document.getElementById("boards-list");if(!e)return;e.innerHTML="";const t=ze(),o=pn();t.forEach(n=>{const a=document.createElement("div");a.classList.add("label-item"),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="10px";const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";const s=document.createElement("span");if(s.textContent=(n.name||"").toString(),i.appendChild(s),n.id===o){const g=document.createElement("span");g.classList.add("task-label"),g.style.backgroundColor="var(--color-primary)",g.textContent="Active",i.appendChild(g)}const r=document.createElement("div");r.classList.add("label-actions"),r.style.display="flex",r.style.gap="4px";const l=document.createElement("button");l.classList.add("btn-small"),l.textContent="Open",l.title="Open board",l.addEventListener("click",async()=>{It(n.id),rn(),it();const{renderBoard:g}=await ce(async()=>{const{renderBoard:C}=await Promise.resolve().then(()=>me);return{renderBoard:C}},void 0,import.meta.url);g()});const d=document.createElement("button");d.classList.add("btn-small"),d.type="button",d.title="Export board",d.setAttribute("aria-label",`Export board ${String(n.name||"Untitled board")}`);const c=document.createElement("span");c.dataset.lucide="download",d.appendChild(c),d.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),da(n.id)});const u=document.createElement("button");u.classList.add("btn-small");const m=document.createElement("span");m.dataset.lucide="pencil",u.appendChild(m),u.title="Rename board",u.addEventListener("click",()=>Ba(n.id));const f=document.createElement("button");f.classList.add("btn-small","btn-danger");const p=document.createElement("span");p.dataset.lucide="trash-2",f.appendChild(p),f.title="Delete board",f.addEventListener("click",async()=>{if(!await Te({title:"Delete Board",message:`Do you really want to delete the board "${n.name}"? This cannot be undone.`,confirmText:"Delete"}))return;if(!No(n.id)){await de({title:"Unable to Delete",message:"Unable to delete board (you may be trying to delete the last board)."});return}rn(),it();const{renderBoard:I}=await ce(async()=>{const{renderBoard:B}=await Promise.resolve().then(()=>me);return{renderBoard:B}},void 0,import.meta.url);I()}),r.appendChild(l),r.appendChild(d),r.appendChild(u),r.appendChild(f),a.appendChild(i),a.appendChild(r),e.appendChild(a)}),xe()}function Ia(){it(),document.getElementById("boards-modal")?.classList.remove("hidden")}function Tn(){document.getElementById("boards-modal")?.classList.add("hidden")}function Sa(){const e=document.getElementById("boards-modal");!e||e.classList.contains("hidden")||it()}function Ba(e){fn();const t=ze().find(s=>s.id===e);if(!t)return;Bt=e;const o=document.getElementById("board-rename-modal"),n=document.getElementById("board-rename-name"),a=document.getElementById("board-rename-modal-title"),i=document.getElementById("board-rename-submit-btn");a&&(a.textContent="Rename Board"),i&&(i.textContent="Save"),n&&(n.value=(t.name||"").toString()),o?.classList.remove("hidden"),n?.focus()}function Gt(){document.getElementById("board-rename-modal")?.classList.add("hidden"),Bt=null}function xn(e){const t=document.createElement("label");t.classList.add("label-checkbox");const o=document.createElement("input");o.type="checkbox",o.value=e.id,o.checked=j.includes(e.id),o.addEventListener("change",a=>{a.target.checked?j.includes(e.id)||j.push(e.id):j=j.filter(i=>i!==e.id),bn()});const n=document.createElement("span");return n.classList.add("task-label","label-color-swatch"),n.style.backgroundColor=e.color,n.textContent=e.name,t.appendChild(o),t.appendChild(n),t}function Fe(){bn();const e=document.getElementById("task-labels-selection");e.innerHTML="";const t=ga(),o=ie(),n=t?o.filter(r=>{const l=(r.name||"").toLowerCase(),d=(r.id||"").toLowerCase(),c=(r.group||"").toLowerCase();return l.includes(t)||d.includes(t)||c.includes(t)}):o;if(n.length===0){if(t){const r=document.createElement("button");r.type="button",r.classList.add("labels-empty-button"),r.textContent=`No label found "${t}" - Create label`,r.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),kt(null,{openedFromTaskEditor:!0,initialName:t})}),e.appendChild(r)}else{const r=document.createElement("div");r.classList.add("labels-empty"),r.textContent="No matching labels",e.appendChild(r)}return}const{ungrouped:a,groupMap:i,sortedGroups:s}=so(n);a.forEach(r=>{e.appendChild(xn(r))}),s.forEach(r=>{const l=document.createElement("div");l.classList.add("label-group-header","label-group-header-picker"),l.textContent=r,e.appendChild(l),i.get(r).forEach(d=>{e.appendChild(xn(d))})})}function ka(){document.addEventListener("kanban:boards-changed",()=>{Sa()}),document.getElementById("task-label-search")?.addEventListener("input",Fe),document.getElementById("labels-search")?.addEventListener("input",Tt),document.getElementById("task-add-label-btn")?.addEventListener("click",()=>{ve=!1,kt(null,{openedFromTaskEditor:!0})}),document.getElementById("task-fullpage-btn")?.addEventListener("click",()=>{const r=document.getElementById("task-modal");r&&$t(!r.classList.contains("fullscreen"))}),document.getElementById("task-form").addEventListener("submit",async r=>{r.preventDefault();const l=document.getElementById("task-title");if(!ma(l))return;const d=l.value.trim(),c=document.getElementById("task-description").value,u=document.getElementById("task-priority")?.value,m=document.getElementById("task-due-date")?.value,f=document.getElementById("task-column").value;ot?Ro(ot,d,c,u,m,f,j):Mo(d,c,u,m,f,j),Ut();const{renderBoard:p}=await ce(async()=>{const{renderBoard:g}=await Promise.resolve().then(()=>me);return{renderBoard:g}},void 0,import.meta.url);p()}),te("task-modal",Ut),document.getElementById("column-form").addEventListener("submit",async r=>{r.preventDefault();const l=document.getElementById("column-name");if(!pa(l))return;const d=l.value.trim(),c=document.getElementById("column-color")?.value;at?Xo(at,d,c):Yo(d,c),Xt();const{renderBoard:u}=await ce(async()=>{const{renderBoard:m}=await Promise.resolve().then(()=>me);return{renderBoard:m}},void 0,import.meta.url);u()}),te("column-modal",Xt),document.getElementById("manage-labels-btn").addEventListener("click",wa),document.getElementById("add-label-btn").addEventListener("click",()=>kt()),te("labels-modal",jt);const a=document.getElementById("label-name");a?.addEventListener("beforeinput",r=>{if(!r||typeof r.data!="string"||r.data.length===0)return;const l=r.target;if(!l||typeof l.value!="string")return;const d=typeof l.selectionStart=="number"?l.selectionStart:l.value.length,c=typeof l.selectionEnd=="number"?l.selectionEnd:l.value.length;(l.value.slice(0,d)+r.data+l.value.slice(c)).trim().length<=Ce||(r.preventDefault(),!Xe&&(Xe=!0,de({title:"Label Name Too Long",message:`Label names are limited to ${Ce} characters.`})))});const i=document.getElementById("label-color");i?.addEventListener("input",r=>{ro(r.target.value)}),document.getElementById("label-color-hex")?.addEventListener("input",r=>{let l=r.target.value;l&&!l.startsWith("#")&&(l="#"+l),Bn(l)?(i.value=l,r.target.classList.remove("invalid")):r.target.classList.toggle("invalid",l.length>0)}),a?.addEventListener("input",r=>{const l=r.target;if(!l||typeof l.value!="string")return;const d=l.value.trim();d.length<=Ce||(l.value=d.slice(0,Ce),!Xe&&(Xe=!0,de({title:"Label Name Too Long",message:`Label names are limited to ${Ce} characters.`})))}),document.getElementById("label-form").addEventListener("submit",async r=>{r.preventDefault();const l=document.getElementById("label-name").value,d=document.getElementById("label-color-hex"),c=(d?.value||"").trim();let u;if(c&&c!==document.getElementById("label-color").value){const I=c.startsWith("#")?c:"#"+c;if(!Bn(I)){d?.classList.add("invalid"),await de({title:"Invalid Hex Color",message:"Please enter a valid hex color code (e.g. #3b82f6)."}),d?.focus();return}document.getElementById("label-color").value=I,u=I}else u=document.getElementById("label-color").value;const m=(l||"").trim();if(m.length>Ce){await de({title:"Label Name Too Long",message:`Label names are limited to ${Ce} characters.`});return}const f=(document.getElementById("label-group")?.value||"").trim(),p=!Ve,g=Ve?Ko(Ve,m,u,f):Vo(m,u,f);if(!g?.success){let I="Unable to Save Label",B="Could not save label.";g?.reason==="DUPLICATE_NAME"?(I="Label Already Exists",B=g?.message||"A label with that name already exists (case-insensitive)."):g?.reason==="EMPTY_NAME"&&(I="Label Name Required",B="Please enter a label name."),await de({title:I,message:B}),document.getElementById("label-name")?.focus();return}p&&rt&&g?.label?.id&&(j.includes(g.label.id)||j.push(g.label.id),Fe(),document.getElementById("task-label-search")?.focus()),Wt(),Tt();const{renderBoard:C}=await ce(async()=>{const{renderBoard:I}=await Promise.resolve().then(()=>me);return{renderBoard:I}},void 0,import.meta.url);C(),ve&&p&&jt()}),te("label-modal",Wt),document.getElementById("manage-boards-btn")?.addEventListener("click",Ia),document.getElementById("add-board-btn")?.addEventListener("click",async()=>{document.dispatchEvent(new CustomEvent("kanban:open-board-create"))}),document.getElementById("boards-import-btn")?.addEventListener("click",async()=>{await Te({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file")?.click()}),te("boards-modal",Tn),document.getElementById("board-rename-form")?.addEventListener("submit",r=>{if(r.preventDefault(),!Bt)return;const d=(document.getElementById("board-rename-name")?.value||"").trim();if(!d){alert("Board name cannot be empty.");return}if(!Oo(Bt,d)){alert("Unable to rename board.");return}Gt(),rn(),it(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),te("board-rename-modal",Gt),document.getElementById("help-btn").addEventListener("click",Ca),te("help-modal",Sn),document.getElementById("add-column-btn").addEventListener("click",va),document.addEventListener("keydown",r=>{if(r.key==="Escape"){if(De("label-modal")){Wt();return}if(De("labels-modal")){jt();return}if(De("board-rename-modal")){Gt();return}if(De("boards-modal")){Tn();return}if(De("help-modal")){Sn();return}if(De("column-modal")){Xt();return}De("task-modal")&&Ut()}})}function An(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),o.push.apply(o,n)}return o}function se(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?An(Object(o),!0).forEach(function(n){Ta(e,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):An(Object(o)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))})}return e}function bt(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bt=function(t){return typeof t}:bt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(e)}function Ta(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function fe(){return fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},fe.apply(this,arguments)}function xa(e,t){if(e==null)return{};var o={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(o[a]=e[a]);return o}function Aa(e,t){if(e==null)return{};var o=xa(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var _a="1.15.6";function ue(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var he=ue(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),st=ue(/Edge/i),_n=ue(/firefox/i),Je=ue(/safari/i)&&!ue(/chrome/i)&&!ue(/android/i),yn=ue(/iP(ad|od|hone)/i),lo=ue(/chrome/i)&&ue(/android/i),co={capture:!1,passive:!1};function S(e,t,o){e.addEventListener(t,o,!he&&co)}function L(e,t,o){e.removeEventListener(t,o,!he&&co)}function xt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function uo(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function ne(e,t,o,n){if(e){o=o||document;do{if(t!=null&&(t[0]===">"?e.parentNode===o&&xt(e,t):xt(e,t))||n&&e===o)return e;if(e===o)break}while(e=uo(e))}return null}var Nn=/\s+/g;function V(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(Nn," ").replace(" "+t+" "," ");e.className=(n+(o?" "+t:"")).replace(Nn," ")}}function y(e,t,o){var n=e&&e.style;if(n){if(o===void 0)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),t===void 0?o:o[t];!(t in n)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),n[t]=o+(typeof o=="string"?"":"px")}}function Me(e,t){var o="";if(typeof e=="string")o=e;else do{var n=y(e,"transform");n&&n!=="none"&&(o=n+" "+o)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(o)}function mo(e,t,o){if(e){var n=e.getElementsByTagName(t),a=0,i=n.length;if(o)for(;a<i;a++)o(n[a],a);return n}return[]}function re(){var e=document.scrollingElement;return e||document.documentElement}function M(e,t,o,n,a){if(!(!e.getBoundingClientRect&&e!==window)){var i,s,r,l,d,c,u;if(e!==window&&e.parentNode&&e!==re()?(i=e.getBoundingClientRect(),s=i.top,r=i.left,l=i.bottom,d=i.right,c=i.height,u=i.width):(s=0,r=0,l=window.innerHeight,d=window.innerWidth,c=window.innerHeight,u=window.innerWidth),(t||o)&&e!==window&&(a=a||e.parentNode,!he))do if(a&&a.getBoundingClientRect&&(y(a,"transform")!=="none"||o&&y(a,"position")!=="static")){var m=a.getBoundingClientRect();s-=m.top+parseInt(y(a,"border-top-width")),r-=m.left+parseInt(y(a,"border-left-width")),l=s+i.height,d=r+i.width;break}while(a=a.parentNode);if(n&&e!==window){var f=Me(a||e),p=f&&f.a,g=f&&f.d;f&&(s/=g,r/=p,u/=p,c/=g,l=s+c,d=r+u)}return{top:s,left:r,bottom:l,right:d,width:u,height:c}}}function On(e,t,o){for(var n=ye(e,!0),a=M(e)[t];n;){var i=M(n)[o],s=void 0;if(s=a>=i,!s)return n;if(n===re())break;n=ye(n,!1)}return!1}function $e(e,t,o,n){for(var a=0,i=0,s=e.children;i<s.length;){if(s[i].style.display!=="none"&&s[i]!==b.ghost&&(n||s[i]!==b.dragged)&&ne(s[i],o.draggable,e,!1)){if(a===t)return s[i];a++}i++}return null}function vn(e,t){for(var o=e.lastElementChild;o&&(o===b.ghost||y(o,"display")==="none"||t&&!xt(o,t));)o=o.previousElementSibling;return o||null}function Q(e,t){var o=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==b.clone&&(!t||xt(e,t))&&o++;return o}function Pn(e){var t=0,o=0,n=re();if(e)do{var a=Me(e),i=a.a,s=a.d;t+=e.scrollLeft*i,o+=e.scrollTop*s}while(e!==n&&(e=e.parentNode));return[t,o]}function Na(e,t){for(var o in e)if(e.hasOwnProperty(o)){for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[o][n])return Number(o)}return-1}function ye(e,t){if(!e||!e.getBoundingClientRect)return re();var o=e,n=!1;do if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var a=y(o);if(o.clientWidth<o.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||o.clientHeight<o.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!o.getBoundingClientRect||o===document.body)return re();if(n||t)return o;n=!0}}while(o=o.parentNode);return re()}function Oa(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function qt(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Qe;function fo(e,t){return function(){if(!Qe){var o=arguments,n=this;o.length===1?e.call(n,o[0]):e.apply(n,o),Qe=setTimeout(function(){Qe=void 0},t)}}}function Pa(){clearTimeout(Qe),Qe=void 0}function po(e,t,o){e.scrollLeft+=t,e.scrollTop+=o}function ho(e){var t=window.Polymer,o=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):o?o(e).clone(!0)[0]:e.cloneNode(!0)}function go(e,t,o){var n={};return Array.from(e.children).forEach(function(a){var i,s,r,l;if(!(!ne(a,t.draggable,e,!1)||a.animated||a===o)){var d=M(a);n.left=Math.min((i=n.left)!==null&&i!==void 0?i:1/0,d.left),n.top=Math.min((s=n.top)!==null&&s!==void 0?s:1/0,d.top),n.right=Math.max((r=n.right)!==null&&r!==void 0?r:-1/0,d.right),n.bottom=Math.max((l=n.bottom)!==null&&l!==void 0?l:-1/0,d.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var G="Sortable"+new Date().getTime();function Ma(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(a){if(!(y(a,"display")==="none"||a===b.ghost)){e.push({target:a,rect:M(a)});var i=se({},e[e.length-1].rect);if(a.thisAnimationDuration){var s=Me(a,!0);s&&(i.top-=s.f,i.left-=s.e)}a.fromRect=i}})}},addAnimationState:function(n){e.push(n)},removeAnimationState:function(n){e.splice(Na(e,{target:n}),1)},animateAll:function(n){var a=this;if(!this.options.animation){clearTimeout(t),typeof n=="function"&&n();return}var i=!1,s=0;e.forEach(function(r){var l=0,d=r.target,c=d.fromRect,u=M(d),m=d.prevFromRect,f=d.prevToRect,p=r.rect,g=Me(d,!0);g&&(u.top-=g.f,u.left-=g.e),d.toRect=u,d.thisAnimationDuration&&qt(m,u)&&!qt(c,u)&&(p.top-u.top)/(p.left-u.left)===(c.top-u.top)/(c.left-u.left)&&(l=Fa(p,m,f,a.options)),qt(u,c)||(d.prevFromRect=c,d.prevToRect=u,l||(l=a.options.animation),a.animate(d,p,u,l)),l&&(i=!0,s=Math.max(s,l),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},l),d.thisAnimationDuration=l)}),clearTimeout(t),i?t=setTimeout(function(){typeof n=="function"&&n()},s):typeof n=="function"&&n(),e=[]},animate:function(n,a,i,s){if(s){y(n,"transition",""),y(n,"transform","");var r=Me(this.el),l=r&&r.a,d=r&&r.d,c=(a.left-i.left)/(l||1),u=(a.top-i.top)/(d||1);n.animatingX=!!c,n.animatingY=!!u,y(n,"transform","translate3d("+c+"px,"+u+"px,0)"),this.forRepaintDummy=Ra(n),y(n,"transition","transform "+s+"ms"+(this.options.easing?" "+this.options.easing:"")),y(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){y(n,"transition",""),y(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},s)}}}}function Ra(e){return e.offsetWidth}function Fa(e,t,o,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))*n.animation}var _e=[],Vt={initializeByDefault:!0},lt={mount:function(t){for(var o in Vt)Vt.hasOwnProperty(o)&&!(o in t)&&(t[o]=Vt[o]);_e.forEach(function(n){if(n.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),_e.push(t)},pluginEvent:function(t,o,n){var a=this;this.eventCanceled=!1,n.cancel=function(){a.eventCanceled=!0};var i=t+"Global";_e.forEach(function(s){o[s.pluginName]&&(o[s.pluginName][i]&&o[s.pluginName][i](se({sortable:o},n)),o.options[s.pluginName]&&o[s.pluginName][t]&&o[s.pluginName][t](se({sortable:o},n)))})},initializePlugins:function(t,o,n,a){_e.forEach(function(r){var l=r.pluginName;if(!(!t.options[l]&&!r.initializeByDefault)){var d=new r(t,o,t.options);d.sortable=t,d.options=t.options,t[l]=d,fe(n,d.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var s=this.modifyOption(t,i,t.options[i]);typeof s<"u"&&(t.options[i]=s)}},getEventProperties:function(t,o){var n={};return _e.forEach(function(a){typeof a.eventProperties=="function"&&fe(n,a.eventProperties.call(o[a.pluginName],t))}),n},modifyOption:function(t,o,n){var a;return _e.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[o]=="function"&&(a=i.optionListeners[o].call(t[i.pluginName],n))}),a}};function $a(e){var t=e.sortable,o=e.rootEl,n=e.name,a=e.targetEl,i=e.cloneEl,s=e.toEl,r=e.fromEl,l=e.oldIndex,d=e.newIndex,c=e.oldDraggableIndex,u=e.newDraggableIndex,m=e.originalEvent,f=e.putSortable,p=e.extraEventProperties;if(t=t||o&&o[G],!!t){var g,C=t.options,I="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!he&&!st?g=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(g=document.createEvent("Event"),g.initEvent(n,!0,!0)),g.to=s||o,g.from=r||o,g.item=a||o,g.clone=i,g.oldIndex=l,g.newIndex=d,g.oldDraggableIndex=c,g.newDraggableIndex=u,g.originalEvent=m,g.pullMode=f?f.lastPutMode:void 0;var B=se(se({},p),lt.getEventProperties(n,t));for(var k in B)g[k]=B[k];o&&o.dispatchEvent(g),C[I]&&C[I].call(t,g)}}var Ha=["evt"],W=function(t,o){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=n.evt,i=Aa(n,Ha);lt.pluginEvent.bind(b)(t,o,se({dragEl:h,parentEl:N,ghostEl:E,rootEl:x,nextEl:Be,lastDownEl:yt,cloneEl:A,cloneHidden:be,dragStarted:je,putSortable:$,activeSortable:b.active,originalEvent:a,oldIndex:Pe,oldDraggableIndex:Ze,newIndex:K,newDraggableIndex:ge,hideGhostForTarget:Eo,unhideGhostForTarget:wo,cloneNowHidden:function(){be=!0},cloneNowShown:function(){be=!1},dispatchSortableEvent:function(r){U({sortable:o,name:r,originalEvent:a})}},i))};function U(e){$a(se({putSortable:$,cloneEl:A,targetEl:h,rootEl:x,oldIndex:Pe,oldDraggableIndex:Ze,newIndex:K,newDraggableIndex:ge},e))}var h,N,E,x,Be,yt,A,be,Pe,K,Ze,ge,mt,$,Oe=!1,At=!1,_t=[],Le,ee,Kt,Jt,Mn,Rn,je,Ne,et,tt=!1,ft=!1,vt,H,Qt=[],sn=!1,Nt=[],Ht=typeof document<"u",pt=yn,Fn=st||he?"cssFloat":"float",za=Ht&&!lo&&!yn&&"draggable"in document.createElement("div"),bo=(function(){if(Ht){if(he)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),yo=function(t,o){var n=y(t),a=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=$e(t,0,o),s=$e(t,1,o),r=i&&y(i),l=s&&y(s),d=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+M(i).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+M(s).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&r.float&&r.float!=="none"){var u=r.float==="left"?"left":"right";return s&&(l.clear==="both"||l.clear===u)?"vertical":"horizontal"}return i&&(r.display==="block"||r.display==="flex"||r.display==="table"||r.display==="grid"||d>=a&&n[Fn]==="none"||s&&n[Fn]==="none"&&d+c>a)?"vertical":"horizontal"},Ya=function(t,o,n){var a=n?t.left:t.top,i=n?t.right:t.bottom,s=n?t.width:t.height,r=n?o.left:o.top,l=n?o.right:o.bottom,d=n?o.width:o.height;return a===r||i===l||a+s/2===r+d/2},Ua=function(t,o){var n;return _t.some(function(a){var i=a[G].options.emptyInsertThreshold;if(!(!i||vn(a))){var s=M(a),r=t>=s.left-i&&t<=s.right+i,l=o>=s.top-i&&o<=s.bottom+i;if(r&&l)return n=a}}),n},vo=function(t){function o(i,s){return function(r,l,d,c){var u=r.options.group.name&&l.options.group.name&&r.options.group.name===l.options.group.name;if(i==null&&(s||u))return!0;if(i==null||i===!1)return!1;if(s&&i==="clone")return i;if(typeof i=="function")return o(i(r,l,d,c),s)(r,l,d,c);var m=(s?r:l).options.group.name;return i===!0||typeof i=="string"&&i===m||i.join&&i.indexOf(m)>-1}}var n={},a=t.group;(!a||bt(a)!="object")&&(a={name:a}),n.name=a.name,n.checkPull=o(a.pull,!0),n.checkPut=o(a.put),n.revertClone=a.revertClone,t.group=n},Eo=function(){!bo&&E&&y(E,"display","none")},wo=function(){!bo&&E&&y(E,"display","")};Ht&&!lo&&document.addEventListener("click",function(e){if(At)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),At=!1,!1},!0);var Ie=function(t){if(h){t=t.touches?t.touches[0]:t;var o=Ua(t.clientX,t.clientY);if(o){var n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=t[a]);n.target=n.rootEl=o,n.preventDefault=void 0,n.stopPropagation=void 0,o[G]._onDragOver(n)}}},Xa=function(t){h&&h.parentNode[G]._isOutsideThisEl(t.target)};function b(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=fe({},t),e[G]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return yo(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(s,r){s.setData("Text",r.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:b.supportPointer!==!1&&"PointerEvent"in window&&(!Je||yn),emptyInsertThreshold:5};lt.initializePlugins(this,e,o);for(var n in o)!(n in t)&&(t[n]=o[n]);vo(t);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=t.forceFallback?!1:za,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?S(e,"pointerdown",this._onTapStart):(S(e,"mousedown",this._onTapStart),S(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(S(e,"dragover",this),S(e,"dragenter",this)),_t.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),fe(this,Ma())}b.prototype={constructor:b,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Ne=null)},_getDirection:function(t,o){return typeof this.options.direction=="function"?this.options.direction.call(this,t,o,h):this.options.direction},_onTapStart:function(t){if(t.cancelable){var o=this,n=this.el,a=this.options,i=a.preventOnFilter,s=t.type,r=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,l=(r||t).target,d=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||l,c=a.filter;if(Qa(n),!h&&!(/mousedown|pointerdown/.test(s)&&t.button!==0||a.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&Je&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=ne(l,a.draggable,n,!1),!(l&&l.animated)&&yt!==l)){if(Pe=Q(l),Ze=Q(l,a.draggable),typeof c=="function"){if(c.call(this,t,l,this)){U({sortable:o,rootEl:d,name:"filter",targetEl:l,toEl:n,fromEl:n}),W("filter",o,{evt:t}),i&&t.preventDefault();return}}else if(c&&(c=c.split(",").some(function(u){if(u=ne(d,u.trim(),n,!1),u)return U({sortable:o,rootEl:u,name:"filter",targetEl:l,fromEl:n,toEl:n}),W("filter",o,{evt:t}),!0}),c)){i&&t.preventDefault();return}a.handle&&!ne(d,a.handle,n,!1)||this._prepareDragStart(t,r,l)}}},_prepareDragStart:function(t,o,n){var a=this,i=a.el,s=a.options,r=i.ownerDocument,l;if(n&&!h&&n.parentNode===i){var d=M(n);if(x=i,h=n,N=h.parentNode,Be=h.nextSibling,yt=n,mt=s.group,b.dragged=h,Le={target:h,clientX:(o||t).clientX,clientY:(o||t).clientY},Mn=Le.clientX-d.left,Rn=Le.clientY-d.top,this._lastX=(o||t).clientX,this._lastY=(o||t).clientY,h.style["will-change"]="all",l=function(){if(W("delayEnded",a,{evt:t}),b.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!_n&&a.nativeDraggable&&(h.draggable=!0),a._triggerDragStart(t,o),U({sortable:a,name:"choose",originalEvent:t}),V(h,s.chosenClass,!0)},s.ignore.split(",").forEach(function(c){mo(h,c.trim(),Zt)}),S(r,"dragover",Ie),S(r,"mousemove",Ie),S(r,"touchmove",Ie),s.supportPointer?(S(r,"pointerup",a._onDrop),!this.nativeDraggable&&S(r,"pointercancel",a._onDrop)):(S(r,"mouseup",a._onDrop),S(r,"touchend",a._onDrop),S(r,"touchcancel",a._onDrop)),_n&&this.nativeDraggable&&(this.options.touchStartThreshold=4,h.draggable=!0),W("delayStart",this,{evt:t}),s.delay&&(!s.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(st||he))){if(b.eventCanceled){this._onDrop();return}s.supportPointer?(S(r,"pointerup",a._disableDelayedDrag),S(r,"pointercancel",a._disableDelayedDrag)):(S(r,"mouseup",a._disableDelayedDrag),S(r,"touchend",a._disableDelayedDrag),S(r,"touchcancel",a._disableDelayedDrag)),S(r,"mousemove",a._delayedDragTouchMoveHandler),S(r,"touchmove",a._delayedDragTouchMoveHandler),s.supportPointer&&S(r,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(l,s.delay)}else l()}},_delayedDragTouchMoveHandler:function(t){var o=t.touches?t.touches[0]:t;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){h&&Zt(h),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;L(t,"mouseup",this._disableDelayedDrag),L(t,"touchend",this._disableDelayedDrag),L(t,"touchcancel",this._disableDelayedDrag),L(t,"pointerup",this._disableDelayedDrag),L(t,"pointercancel",this._disableDelayedDrag),L(t,"mousemove",this._delayedDragTouchMoveHandler),L(t,"touchmove",this._delayedDragTouchMoveHandler),L(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,o){o=o||t.pointerType=="touch"&&t,!this.nativeDraggable||o?this.options.supportPointer?S(document,"pointermove",this._onTouchMove):o?S(document,"touchmove",this._onTouchMove):S(document,"mousemove",this._onTouchMove):(S(h,"dragend",this),S(x,"dragstart",this._onDragStart));try{document.selection?Et(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,o){if(Oe=!1,x&&h){W("dragStarted",this,{evt:o}),this.nativeDraggable&&S(document,"dragover",Xa);var n=this.options;!t&&V(h,n.dragClass,!1),V(h,n.ghostClass,!0),b.active=this,t&&this._appendGhost(),U({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(ee){this._lastX=ee.clientX,this._lastY=ee.clientY,Eo();for(var t=document.elementFromPoint(ee.clientX,ee.clientY),o=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ee.clientX,ee.clientY),t!==o);)o=t;if(h.parentNode[G]._isOutsideThisEl(t),o)do{if(o[G]){var n=void 0;if(n=o[G]._onDragOver({clientX:ee.clientX,clientY:ee.clientY,target:t,rootEl:o}),n&&!this.options.dragoverBubble)break}t=o}while(o=uo(o));wo()}},_onTouchMove:function(t){if(Le){var o=this.options,n=o.fallbackTolerance,a=o.fallbackOffset,i=t.touches?t.touches[0]:t,s=E&&Me(E,!0),r=E&&s&&s.a,l=E&&s&&s.d,d=pt&&H&&Pn(H),c=(i.clientX-Le.clientX+a.x)/(r||1)+(d?d[0]-Qt[0]:0)/(r||1),u=(i.clientY-Le.clientY+a.y)/(l||1)+(d?d[1]-Qt[1]:0)/(l||1);if(!b.active&&!Oe){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(E){s?(s.e+=c-(Kt||0),s.f+=u-(Jt||0)):s={a:1,b:0,c:0,d:1,e:c,f:u};var m="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");y(E,"webkitTransform",m),y(E,"mozTransform",m),y(E,"msTransform",m),y(E,"transform",m),Kt=c,Jt=u,ee=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!E){var t=this.options.fallbackOnBody?document.body:x,o=M(h,!0,pt,!0,t),n=this.options;if(pt){for(H=t;y(H,"position")==="static"&&y(H,"transform")==="none"&&H!==document;)H=H.parentNode;H!==document.body&&H!==document.documentElement?(H===document&&(H=re()),o.top+=H.scrollTop,o.left+=H.scrollLeft):H=re(),Qt=Pn(H)}E=h.cloneNode(!0),V(E,n.ghostClass,!1),V(E,n.fallbackClass,!0),V(E,n.dragClass,!0),y(E,"transition",""),y(E,"transform",""),y(E,"box-sizing","border-box"),y(E,"margin",0),y(E,"top",o.top),y(E,"left",o.left),y(E,"width",o.width),y(E,"height",o.height),y(E,"opacity","0.8"),y(E,"position",pt?"absolute":"fixed"),y(E,"zIndex","100000"),y(E,"pointerEvents","none"),b.ghost=E,t.appendChild(E),y(E,"transform-origin",Mn/parseInt(E.style.width)*100+"% "+Rn/parseInt(E.style.height)*100+"%")}},_onDragStart:function(t,o){var n=this,a=t.dataTransfer,i=n.options;if(W("dragStart",this,{evt:t}),b.eventCanceled){this._onDrop();return}W("setupClone",this),b.eventCanceled||(A=ho(h),A.removeAttribute("id"),A.draggable=!1,A.style["will-change"]="",this._hideClone(),V(A,this.options.chosenClass,!1),b.clone=A),n.cloneId=Et(function(){W("clone",n),!b.eventCanceled&&(n.options.removeCloneOnHide||x.insertBefore(A,h),n._hideClone(),U({sortable:n,name:"clone"}))}),!o&&V(h,i.dragClass,!0),o?(At=!0,n._loopId=setInterval(n._emulateDragOver,50)):(L(document,"mouseup",n._onDrop),L(document,"touchend",n._onDrop),L(document,"touchcancel",n._onDrop),a&&(a.effectAllowed="move",i.setData&&i.setData.call(n,a,h)),S(document,"drop",n),y(h,"transform","translateZ(0)")),Oe=!0,n._dragStartId=Et(n._dragStarted.bind(n,o,t)),S(document,"selectstart",n),je=!0,window.getSelection().removeAllRanges(),Je&&y(document.body,"user-select","none")},_onDragOver:function(t){var o=this.el,n=t.target,a,i,s,r=this.options,l=r.group,d=b.active,c=mt===l,u=r.sort,m=$||d,f,p=this,g=!1;if(sn)return;function C(Ae,dt){W(Ae,p,se({evt:t,isOwner:c,axis:f?"vertical":"horizontal",revert:s,dragRect:a,targetRect:i,canSort:u,fromSortable:m,target:n,completed:B,onMove:function(ct,Dn){return ht(x,o,h,a,ct,M(ct),t,Dn)},changed:k},dt))}function I(){C("dragOverAnimationCapture"),p.captureAnimationState(),p!==m&&m.captureAnimationState()}function B(Ae){return C("dragOverCompleted",{insertion:Ae}),Ae&&(c?d._hideClone():d._showClone(p),p!==m&&(V(h,$?$.options.ghostClass:d.options.ghostClass,!1),V(h,r.ghostClass,!0)),$!==p&&p!==b.active?$=p:p===b.active&&$&&($=null),m===p&&(p._ignoreWhileAnimating=n),p.animateAll(function(){C("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(n===h&&!h.animated||n===o&&!n.animated)&&(Ne=null),!r.dragoverBubble&&!t.rootEl&&n!==document&&(h.parentNode[G]._isOutsideThisEl(t.target),!Ae&&Ie(t)),!r.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),g=!0}function k(){K=Q(h),ge=Q(h,r.draggable),U({sortable:p,name:"change",toEl:o,newIndex:K,newDraggableIndex:ge,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),n=ne(n,r.draggable,o,!0),C("dragOver"),b.eventCanceled)return g;if(h.contains(t.target)||n.animated&&n.animatingX&&n.animatingY||p._ignoreWhileAnimating===n)return B(!1);if(At=!1,d&&!r.disabled&&(c?u||(s=N!==x):$===this||(this.lastPutMode=mt.checkPull(this,d,h,t))&&l.checkPut(this,d,h,t))){if(f=this._getDirection(t,n)==="vertical",a=M(h),C("dragOverValid"),b.eventCanceled)return g;if(s)return N=x,I(),this._hideClone(),C("revert"),b.eventCanceled||(Be?x.insertBefore(h,Be):x.appendChild(h)),B(!0);var w=vn(o,r.draggable);if(!w||qa(t,f,this)&&!w.animated){if(w===h)return B(!1);if(w&&o===t.target&&(n=w),n&&(i=M(n)),ht(x,o,h,a,n,i,t,!!n)!==!1)return I(),w&&w.nextSibling?o.insertBefore(h,w.nextSibling):o.appendChild(h),N=o,k(),B(!0)}else if(w&&Ga(t,f,this)){var v=$e(o,0,r,!0);if(v===h)return B(!1);if(n=v,i=M(n),ht(x,o,h,a,n,i,t,!1)!==!1)return I(),o.insertBefore(h,v),N=o,k(),B(!0)}else if(n.parentNode===o){i=M(n);var D=0,_,O=h.parentNode!==o,R=!Ya(h.animated&&h.toRect||a,n.animated&&n.toRect||i,f),we=f?"top":"left",q=On(n,"top","top")||On(h,"top","top"),z=q?q.scrollTop:void 0;Ne!==n&&(_=i[we],tt=!1,ft=!R&&r.invertSwap||O),D=Va(t,n,i,f,R?1:r.swapThreshold,r.invertedSwapThreshold==null?r.swapThreshold:r.invertedSwapThreshold,ft,Ne===n);var F;if(D!==0){var Y=Q(h);do Y-=D,F=N.children[Y];while(F&&(y(F,"display")==="none"||F===E))}if(D===0||F===n)return B(!1);Ne=n,et=D;var Z=n.nextElementSibling,T=!1;T=D===1;var le=ht(x,o,h,a,n,i,t,T);if(le!==!1)return(le===1||le===-1)&&(T=le===1),sn=!0,setTimeout(Wa,30),I(),T&&!Z?o.appendChild(h):n.parentNode.insertBefore(h,T?Z:n),q&&po(q,0,z-q.scrollTop),N=h.parentNode,_!==void 0&&!ft&&(vt=Math.abs(_-M(n)[we])),k(),B(!0)}if(o.contains(h))return B(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){L(document,"mousemove",this._onTouchMove),L(document,"touchmove",this._onTouchMove),L(document,"pointermove",this._onTouchMove),L(document,"dragover",Ie),L(document,"mousemove",Ie),L(document,"touchmove",Ie)},_offUpEvents:function(){var t=this.el.ownerDocument;L(t,"mouseup",this._onDrop),L(t,"touchend",this._onDrop),L(t,"pointerup",this._onDrop),L(t,"pointercancel",this._onDrop),L(t,"touchcancel",this._onDrop),L(document,"selectstart",this)},_onDrop:function(t){var o=this.el,n=this.options;if(K=Q(h),ge=Q(h,n.draggable),W("drop",this,{evt:t}),N=h&&h.parentNode,K=Q(h),ge=Q(h,n.draggable),b.eventCanceled){this._nulling();return}Oe=!1,ft=!1,tt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ln(this.cloneId),ln(this._dragStartId),this.nativeDraggable&&(L(document,"drop",this),L(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Je&&y(document.body,"user-select",""),y(h,"transform",""),t&&(je&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),E&&E.parentNode&&E.parentNode.removeChild(E),(x===N||$&&$.lastPutMode!=="clone")&&A&&A.parentNode&&A.parentNode.removeChild(A),h&&(this.nativeDraggable&&L(h,"dragend",this),Zt(h),h.style["will-change"]="",je&&!Oe&&V(h,$?$.options.ghostClass:this.options.ghostClass,!1),V(h,this.options.chosenClass,!1),U({sortable:this,name:"unchoose",toEl:N,newIndex:null,newDraggableIndex:null,originalEvent:t}),x!==N?(K>=0&&(U({rootEl:N,name:"add",toEl:N,fromEl:x,originalEvent:t}),U({sortable:this,name:"remove",toEl:N,originalEvent:t}),U({rootEl:N,name:"sort",toEl:N,fromEl:x,originalEvent:t}),U({sortable:this,name:"sort",toEl:N,originalEvent:t})),$&&$.save()):K!==Pe&&K>=0&&(U({sortable:this,name:"update",toEl:N,originalEvent:t}),U({sortable:this,name:"sort",toEl:N,originalEvent:t})),b.active&&((K==null||K===-1)&&(K=Pe,ge=Ze),U({sortable:this,name:"end",toEl:N,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){W("nulling",this),x=h=N=E=Be=A=yt=be=Le=ee=je=K=ge=Pe=Ze=Ne=et=$=mt=b.dragged=b.ghost=b.clone=b.active=null,Nt.forEach(function(t){t.checked=!0}),Nt.length=Kt=Jt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":h&&(this._onDragOver(t),ja(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],o,n=this.el.children,a=0,i=n.length,s=this.options;a<i;a++)o=n[a],ne(o,s.draggable,this.el,!1)&&t.push(o.getAttribute(s.dataIdAttr)||Ja(o));return t},sort:function(t,o){var n={},a=this.el;this.toArray().forEach(function(i,s){var r=a.children[s];ne(r,this.options.draggable,a,!1)&&(n[i]=r)},this),o&&this.captureAnimationState(),t.forEach(function(i){n[i]&&(a.removeChild(n[i]),a.appendChild(n[i]))}),o&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,o){return ne(t,o||this.options.draggable,this.el,!1)},option:function(t,o){var n=this.options;if(o===void 0)return n[t];var a=lt.modifyOption(this,t,o);typeof a<"u"?n[t]=a:n[t]=o,t==="group"&&vo(n)},destroy:function(){W("destroy",this);var t=this.el;t[G]=null,L(t,"mousedown",this._onTapStart),L(t,"touchstart",this._onTapStart),L(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(L(t,"dragover",this),L(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),_t.splice(_t.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!be){if(W("hideClone",this),b.eventCanceled)return;y(A,"display","none"),this.options.removeCloneOnHide&&A.parentNode&&A.parentNode.removeChild(A),be=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(be){if(W("showClone",this),b.eventCanceled)return;h.parentNode==x&&!this.options.group.revertClone?x.insertBefore(A,h):Be?x.insertBefore(A,Be):x.appendChild(A),this.options.group.revertClone&&this.animate(h,A),y(A,"display",""),be=!1}}};function ja(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function ht(e,t,o,n,a,i,s,r){var l,d=e[G],c=d.options.onMove,u;return window.CustomEvent&&!he&&!st?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=t,l.from=e,l.dragged=o,l.draggedRect=n,l.related=a||t,l.relatedRect=i||M(t),l.willInsertAfter=r,l.originalEvent=s,e.dispatchEvent(l),c&&(u=c.call(d,l,s)),u}function Zt(e){e.draggable=!1}function Wa(){sn=!1}function Ga(e,t,o){var n=M($e(o.el,0,o.options,!0)),a=go(o.el,o.options,E),i=10;return t?e.clientX<a.left-i||e.clientY<n.top&&e.clientX<n.right:e.clientY<a.top-i||e.clientY<n.bottom&&e.clientX<n.left}function qa(e,t,o){var n=M(vn(o.el,o.options.draggable)),a=go(o.el,o.options,E),i=10;return t?e.clientX>a.right+i||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>a.bottom+i||e.clientX>n.right&&e.clientY>n.top}function Va(e,t,o,n,a,i,s,r){var l=n?e.clientY:e.clientX,d=n?o.height:o.width,c=n?o.top:o.left,u=n?o.bottom:o.right,m=!1;if(!s){if(r&&vt<d*a){if(!tt&&(et===1?l>c+d*i/2:l<u-d*i/2)&&(tt=!0),tt)m=!0;else if(et===1?l<c+vt:l>u-vt)return-et}else if(l>c+d*(1-a)/2&&l<u-d*(1-a)/2)return Ka(t)}return m=m||s,m&&(l<c+d*i/2||l>u-d*i/2)?l>c+d/2?1:-1:0}function Ka(e){return Q(h)<Q(e)?1:-1}function Ja(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,n=0;o--;)n+=t.charCodeAt(o);return n.toString(36)}function Qa(e){Nt.length=0;for(var t=e.getElementsByTagName("input"),o=t.length;o--;){var n=t[o];n.checked&&Nt.push(n)}}function Et(e){return setTimeout(e,0)}function ln(e){return clearTimeout(e)}Ht&&S(document,"touchmove",function(e){(b.active||Oe)&&e.cancelable&&e.preventDefault()});b.utils={on:S,off:L,css:y,find:mo,is:function(t,o){return!!ne(t,o,t,!1)},extend:Oa,throttle:fo,closest:ne,toggleClass:V,clone:ho,index:Q,nextTick:Et,cancelNextTick:ln,detectDirection:yo,getChild:$e,expando:G};b.get=function(e){return e[G]};b.mount=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];t[0].constructor===Array&&(t=t[0]),t.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(b.utils=se(se({},b.utils),n.utils)),lt.mount(n)})};b.create=function(e,t){return new b(e,t)};b.version=_a;var P=[],We,dn,cn=!1,en,tn,Ot,Ge;function Za(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(o){var n=o.originalEvent;this.sortable.nativeDraggable?S(document,"dragover",this._handleAutoScroll):this.options.supportPointer?S(document,"pointermove",this._handleFallbackAutoScroll):n.touches?S(document,"touchmove",this._handleFallbackAutoScroll):S(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var n=o.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?L(document,"dragover",this._handleAutoScroll):(L(document,"pointermove",this._handleFallbackAutoScroll),L(document,"touchmove",this._handleFallbackAutoScroll),L(document,"mousemove",this._handleFallbackAutoScroll)),$n(),wt(),Pa()},nulling:function(){Ot=dn=We=cn=Ge=en=tn=null,P.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,n){var a=this,i=(o.touches?o.touches[0]:o).clientX,s=(o.touches?o.touches[0]:o).clientY,r=document.elementFromPoint(i,s);if(Ot=o,n||this.options.forceAutoScrollFallback||st||he||Je){nn(o,this.options,r,n);var l=ye(r,!0);cn&&(!Ge||i!==en||s!==tn)&&(Ge&&$n(),Ge=setInterval(function(){var d=ye(document.elementFromPoint(i,s),!0);d!==l&&(l=d,wt()),nn(o,a.options,d,n)},10),en=i,tn=s)}else{if(!this.options.bubbleScroll||ye(r,!0)===re()){wt();return}nn(o,this.options,ye(r,!1),!1)}}},fe(e,{pluginName:"scroll",initializeByDefault:!0})}function wt(){P.forEach(function(e){clearInterval(e.pid)}),P=[]}function $n(){clearInterval(Ge)}var nn=fo(function(e,t,o,n){if(t.scroll){var a=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,r=t.scrollSpeed,l=re(),d=!1,c;dn!==o&&(dn=o,wt(),We=t.scroll,c=t.scrollFn,We===!0&&(We=ye(o,!0)));var u=0,m=We;do{var f=m,p=M(f),g=p.top,C=p.bottom,I=p.left,B=p.right,k=p.width,w=p.height,v=void 0,D=void 0,_=f.scrollWidth,O=f.scrollHeight,R=y(f),we=f.scrollLeft,q=f.scrollTop;f===l?(v=k<_&&(R.overflowX==="auto"||R.overflowX==="scroll"||R.overflowX==="visible"),D=w<O&&(R.overflowY==="auto"||R.overflowY==="scroll"||R.overflowY==="visible")):(v=k<_&&(R.overflowX==="auto"||R.overflowX==="scroll"),D=w<O&&(R.overflowY==="auto"||R.overflowY==="scroll"));var z=v&&(Math.abs(B-a)<=s&&we+k<_)-(Math.abs(I-a)<=s&&!!we),F=D&&(Math.abs(C-i)<=s&&q+w<O)-(Math.abs(g-i)<=s&&!!q);if(!P[u])for(var Y=0;Y<=u;Y++)P[Y]||(P[Y]={});(P[u].vx!=z||P[u].vy!=F||P[u].el!==f)&&(P[u].el=f,P[u].vx=z,P[u].vy=F,clearInterval(P[u].pid),(z!=0||F!=0)&&(d=!0,P[u].pid=setInterval((function(){n&&this.layer===0&&b.active._onTouchMove(Ot);var Z=P[this.layer].vy?P[this.layer].vy*r:0,T=P[this.layer].vx?P[this.layer].vx*r:0;typeof c=="function"&&c.call(b.dragged.parentNode[G],T,Z,e,Ot,P[this.layer].el)!=="continue"||po(P[this.layer].el,T,Z)}).bind({layer:u}),24))),u++}while(t.bubbleScroll&&m!==l&&(m=ye(m,!1)));cn=d}},30),Co=function(t){var o=t.originalEvent,n=t.putSortable,a=t.dragEl,i=t.activeSortable,s=t.dispatchSortableEvent,r=t.hideGhostForTarget,l=t.unhideGhostForTarget;if(o){var d=n||i;r();var c=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,u=document.elementFromPoint(c.clientX,c.clientY);l(),d&&!d.el.contains(u)&&(s("spill"),this.onSpill({dragEl:a,putSortable:n}))}};function En(){}En.prototype={startIndex:null,dragStart:function(t){var o=t.oldDraggableIndex;this.startIndex=o},onSpill:function(t){var o=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var a=$e(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(o,a):this.sortable.el.appendChild(o),this.sortable.animateAll(),n&&n.animateAll()},drop:Co};fe(En,{pluginName:"revertOnSpill"});function wn(){}wn.prototype={onSpill:function(t){var o=t.dragEl,n=t.putSortable,a=n||this.sortable;a.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),a.animateAll()},drop:Co};fe(wn,{pluginName:"removeOnSpill"});b.mount(new Za);b.mount(wn,En);let un=[],Ct=null,nt=null,Re=0;function ei(){ti(),oi(),ai()}function ti(){un.forEach(e=>e.destroy()),un=[],Ct&&(Ct.destroy(),Ct=null),Do()}function ni(){const e=document.getElementById("board-container");!e||nt||(nt=setInterval(()=>{if(!e)return;const t=e.getBoundingClientRect(),o=80,n=12;Re>0&&(Re<t.left+o&&e.scrollLeft>0?e.scrollLeft-=n:Re>t.right-o&&e.scrollLeft<e.scrollWidth-e.clientWidth&&(e.scrollLeft+=n))},16))}function Do(){nt&&(clearInterval(nt),nt=null),Re=0}function gt(e){e.touches&&e.touches[0]?Re=e.touches[0].clientX:e.clientX&&(Re=e.clientX)}function oi(){document.querySelectorAll(".tasks:not(.hidden)").forEach(t=>{const o=new b(t,{group:{name:"tasks",pull:!0,put:!0},animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"task-ghost",chosenClass:"task-chosen",dragClass:"task-drag",draggable:".task",forceFallback:!0,fallbackClass:"task-fallback",fallbackOnBody:!0,fallbackTolerance:0,swapThreshold:.65,emptyInsertThreshold:20,direction:"vertical",onStart:function(n){document.body.classList.add("dragging"),ni(),document.addEventListener("touchmove",gt,{passive:!0}),document.addEventListener("mousemove",gt,{passive:!0})},onEnd:async function(n){document.body.classList.remove("dragging"),Do(),document.removeEventListener("touchmove",gt),document.removeEventListener("mousemove",gt),Ho();const{renderBoard:a}=await ce(async()=>{const{renderBoard:i}=await Promise.resolve().then(()=>me);return{renderBoard:i}},void 0,import.meta.url);a()}});un.push(o)})}function ai(){const e=document.getElementById("board-container");e&&(Ct=new b(e,{animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"column-ghost",chosenClass:"column-chosen",dragClass:"column-drag",handle:".column-header",filter:"button:not(.column-drag-handle), a, input, select, textarea, [contenteditable]",preventOnFilter:!0,draggable:".task-column",scrollSensitivity:80,scrollSpeed:15,forceFallback:!1,fallbackOnBody:!0,onStart:function(t){document.body.classList.add("dragging-column")},onEnd:function(t){document.body.classList.remove("dragging-column"),Wo()}}))}const Lo="kanbanNotificationBannerHidden";let Hn;function Io(){return localStorage.getItem(Lo)==="true"}function zn(e){localStorage.setItem(Lo,e?"true":"false")}function So(){const e=document.getElementById("notification-banner-visibility-toggle");e&&(e.checked=!Io())}function Cn(){const e=J(),t=X(),o=Number.isFinite(t.notificationDays)?t.notificationDays:3,n=new Date;return n.setHours(0,0,0,0),e.filter(a=>{if(a.column==="done")return!1;const i=(a.dueDate||"").toString().trim();if(!i)return!1;const s=new Date(i+"T00:00:00");if(Number.isNaN(s.getTime()))return!1;const r=s.getTime()-n.getTime();return Math.floor(r/(1e3*60*60*24))<=o}).map(a=>{const s=new Date(a.dueDate+"T00:00:00").getTime()-n.getTime(),r=Math.floor(s/(1e3*60*60*24));return{...a,daysUntilDue:r}}).sort((a,i)=>a.daysUntilDue-i.daysUntilDue)}function Bo(e,t,o){const a=new Date(t+"T00:00:00").toLocaleDateString(o||void 0);if(e<0){const i=Math.abs(e);return{text:`Overdue by ${i} day${i===1?"":"s"} (${a})`,className:"overdue"}}else return e===0?{text:`Due today (${a})`,className:"overdue"}:e===1?{text:`Due tomorrow (${a})`,className:"due-soon"}:{text:`Due in ${e} days (${a})`,className:"due-soon"}}function ko(){const e=document.getElementById("notification-banner"),t=document.getElementById("notification-banner-list");if(!e||!t)return;const o=Cn(),n=X();if(o.length===0){e.classList.add("hidden");return}if(Io()){e.classList.add("hidden");return}t.innerHTML="";const a=window.matchMedia("(min-width: 601px)").matches,i=s=>{const r=document.createElement("div");r.classList.add("notification-banner-item"),r.setAttribute("role","button"),r.setAttribute("tabindex","0"),r.setAttribute("aria-label",`Open task: ${s.title}`);const l=document.createElement("span");l.classList.add("task-title");const d=typeof s.text=="string"?s.text:"";l.textContent=typeof s.title=="string"&&s.title.trim()?s.title:d;const c=Bo(s.daysUntilDue,s.dueDate,n.locale),u=document.createElement("span");u.classList.add("due-date",c.className),u.textContent=c.text,r.appendChild(l),r.appendChild(u);const m=()=>Ke(s.id);return r.addEventListener("click",m),r.addEventListener("keydown",f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),m())}),r};if(a){const s=t.clientWidth||t.getBoundingClientRect().width;let r=0;for(const d of o){const c=i(d);if(t.appendChild(c),r+=1,t.scrollWidth>s&&r>1){t.removeChild(c),r-=1;break}}const l=o.length-r;if(l>0){const d=document.createElement("div");if(d.classList.add("notification-banner-item","notification-more"),d.setAttribute("role","button"),d.setAttribute("tabindex","0"),d.textContent=`+${l} `,d.addEventListener("click",qe),d.addEventListener("keydown",c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),qe())}),t.appendChild(d),t.scrollWidth>s&&r>0){t.removeChild(t.children[r-1]),r-=1;const c=o.length-r;d.textContent=`+${c} `,t.appendChild(d)}}}else if(o.slice(0,5).forEach(r=>{const l=i(r);t.appendChild(l)}),o.length>5){const r=document.createElement("div");r.classList.add("notification-banner-item","notification-more"),r.setAttribute("role","button"),r.setAttribute("tabindex","0"),r.textContent=`+${o.length-5} `,r.addEventListener("click",qe),r.addEventListener("keydown",l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),qe())}),t.appendChild(r)}e.classList.remove("hidden"),xe()}function ii(){const e=document.getElementById("notifications-list");if(!e)return;const t=Cn(),o=X(),n=Number.isFinite(o.notificationDays)?o.notificationDays:3;if(e.innerHTML="",t.length===0){const a=document.createElement("div");a.classList.add("notifications-empty"),a.textContent=n===0?"No tasks due today.":`No tasks due within the next ${n} day${n===1?"":"s"}.`,e.appendChild(a);return}t.forEach(a=>{const i=document.createElement("div");i.classList.add("notification-item"),i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.setAttribute("aria-label",`Open task: ${a.title}`);const s=document.createElement("div");s.classList.add("notification-item-content");const r=document.createElement("div");r.classList.add("notification-item-title");const l=typeof a.text=="string"?a.text:"";r.textContent=typeof a.title=="string"&&a.title.trim()?a.title:l;const d=document.createElement("div");d.classList.add("notification-item-meta");const c=Bo(a.daysUntilDue,a.dueDate,o.locale),u=document.createElement("span");u.classList.add(c.className),u.textContent=c.text;const m=typeof a.priority=="string"?a.priority:"low",f=document.createElement("span");f.classList.add("notification-item-priority",`priority-${m}`),f.textContent=m,d.appendChild(u),d.appendChild(f),s.appendChild(r),s.appendChild(d);const p=document.createElement("span");p.classList.add("notification-item-arrow"),p.dataset.lucide="chevron-right",i.appendChild(s),i.appendChild(p);const g=()=>{Dt(),Ke(a.id)};i.addEventListener("click",g),i.addEventListener("keydown",C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),g())}),e.appendChild(i)}),xe()}function ri(){const e=document.getElementById("notification-badge");if(!e)return;const o=Cn().length;o===0?(e.classList.add("hidden"),e.textContent=""):(e.classList.remove("hidden"),e.textContent=o>99?"99+":String(o))}function qe(){So(),ii(),document.getElementById("notifications-modal")?.classList.remove("hidden")}function Dt(){document.getElementById("notifications-modal")?.classList.add("hidden")}function si(){const e=document.getElementById("notifications-modal");return e&&!e.classList.contains("hidden")}function li(){document.getElementById("notification-banner-close-btn")?.addEventListener("click",()=>{zn(!0),Lt()});const t=document.getElementById("notification-banner-visibility-toggle");t?.addEventListener("change",()=>{zn(!t.checked),Lt()}),document.getElementById("notifications-btn")?.addEventListener("click",qe),document.getElementById("notifications-close-btn")?.addEventListener("click",Dt),te("notifications-modal",Dt),document.addEventListener("keydown",a=>{a.key==="Escape"&&si()&&Dt()}),window.addEventListener("resize",()=>{clearTimeout(Hn),Hn=setTimeout(ko,120)}),Lt(),So()}function Lt(){ko(),ri()}let Yn=!1,To="";function xo(e){To=(e||"").toString()}function di(e){return J().filter(o=>o.column===e).length}function ci(e,t,o){if(!t)return!0;const n=typeof e?.text=="string"?e.text:"",a=typeof e?.title=="string"&&e.title.trim()!==""?e.title:n,i=typeof e?.description=="string"?e.description:"",s=typeof e?.priority=="string"?e.priority:"";if(a.toLowerCase().includes(t)||i.toLowerCase().includes(t)||s.toLowerCase().includes(t))return!0;const r=Array.isArray(e?.labels)?e.labels:[];for(const l of r){const d=o.get(l);if(d&&d.includes(t))return!0}return!1}function ke(e=null){document.querySelectorAll(".column-menu").forEach(t=>{e&&t===e||t.classList.add("hidden")}),document.querySelectorAll(".column-submenu").forEach(t=>{t.classList.add("hidden")})}function ui(e){return[...e].sort((t,o)=>{const n=(t.dueDate||"").toString().trim(),a=(o.dueDate||"").toString().trim();return!n&&!a?0:n?a?n.localeCompare(a):-1:1})}function mi(e){const t={high:0,medium:1,low:2};return[...e].sort((o,n)=>{const a=t[o.priority]??2,i=t[n.priority]??2;return a-i})}function Un(e,t){const o=J(),n=o.filter(l=>l.column===e),a=o.filter(l=>l.column!==e),s=(t==="dueDate"?ui(n):mi(n)).map((l,d)=>({...l,order:d+1})),r=[...a,...s];Ee(r),pe()}function fi(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=o.includes("T")?o:`${o}T00:00:00`,a=new Date(n);return Number.isNaN(a.getTime())?o:a.toLocaleDateString(t||void 0)}function pi(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=new Date(o);return Number.isNaN(n.getTime())?o:n.toLocaleString(t||void 0)}function hi(e){const t=(e?.creationDate||"").toString().trim();if(!t)return"";const o=new Date(t);if(Number.isNaN(o.getTime()))return"";const n=1440*60*1e3,a=Math.max(0,Math.floor((Date.now()-o.getTime())/n));if(a<30)return`${a}d`;const i=Math.floor(a/365);let s=a%365;const r=Math.floor(s/30);s=s%30;const l=[];return i>=1&&l.push(`${i}y`),r>=1&&l.push(`${r}M`),l.push(`${s}d`),l.join(" ")}function gi(e,t){const o=document.createElement("li");o.classList.add("task"),o.draggable=!0,o.dataset.taskId=e.id,o.setAttribute("role","listitem"),o.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const n=document.createElement("div");n.classList.add("task-labels"),n.setAttribute("role","list"),n.setAttribute("aria-label","Task labels");const a=ie();e.labels&&e.labels.length>0&&e.labels.forEach(v=>{const D=a.find(_=>_.id===v);if(D){const _=document.createElement("span");_.classList.add("task-label"),_.setAttribute("role","listitem"),_.style.backgroundColor=D.color,_.textContent=D.name,n.appendChild(_)}});const i=document.createElement("div");i.classList.add("task-header");const s=document.createElement("div");s.classList.add("task-title"),s.setAttribute("role","button"),s.setAttribute("tabindex","0");const r=typeof e.text=="string"?e.text:"";s.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:r,s.addEventListener("click",()=>Ke(e.id)),s.addEventListener("keydown",v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),Ke(e.id))});const l=document.createElement("div");l.classList.add("task-actions");const d=document.createElement("button");d.classList.add("delete-task-btn"),d.setAttribute("aria-label","Delete task"),d.type="button";const c=document.createElement("span");c.dataset.lucide="trash-2",c.setAttribute("aria-hidden","true"),d.appendChild(c),d.addEventListener("click",async v=>{v.stopPropagation(),await Te({title:"Delete Task",message:"Are you sure you want to delete this task?",confirmText:"Delete"})&&Fo(e.id)&&pe()}),l.appendChild(d),i.appendChild(s),i.appendChild(l);const u=typeof e.description=="string"?e.description.trim():"",m=document.createElement("div");m.classList.add("task-description"),m.textContent=u,m.style.display=u?"block":"none",m.addEventListener("click",()=>Ke(e.id));const f=document.createElement("div");f.classList.add("task-meta");const p=t?.showPriority!==!1,g=t?.showDueDate!==!1;if(p){const v=typeof e.priority=="string"?e.priority:"medium",D=document.createElement("span");D.classList.add("task-priority",`priority-${v}`),D.textContent=v,D.setAttribute("aria-label",`Priority: ${v}`),f.appendChild(D)}if(g){const v=typeof e.dueDate=="string"?e.dueDate.trim():"",D=document.createElement("span");D.classList.add("task-date"),v?D.textContent="Due "+fi(v,t?.locale):D.textContent="No due date",f.appendChild(D)}o.appendChild(i),o.appendChild(m),o.appendChild(n),f.childNodes.length>0&&o.appendChild(f);const C=t?.showChangeDate!==!1,I=t?.showAge!==!1,B=t?.locale,k=document.createElement("div");if(k.classList.add("task-footer"),C){const v=document.createElement("span");v.classList.add("task-change-date");const D=pi(e?.changeDate,B);v.textContent=D?`Updated ${D}`:"",k.appendChild(v)}if(I){const v=document.createElement("span");v.classList.add("task-age");const D=hi(e);v.textContent=D?`Age ${D}`:"",k.appendChild(v)}return Array.from(k.childNodes).some(v=>(v.textContent||"").trim()!=="")&&o.appendChild(k),o}function bi(e){const t=document.createElement("article");t.classList.add("task-column"),t.dataset.column=e.id,t.draggable=!1,t.setAttribute("aria-labelledby",`column-title-${e.id}`);const o=e?.collapsed===!0;o&&t.classList.add("is-collapsed"),e?.color&&t.style.setProperty("--column-accent",e.color);const n=document.createElement("button");n.classList.add("column-collapse-btn"),n.type="button",n.setAttribute("aria-label",o?`Expand ${e.name} column`:`Collapse ${e.name} column`),n.title=o?"Expand column":"Collapse column";const a=document.createElement("span");a.dataset.lucide=o?"chevron-right":"chevrons-right-left",a.setAttribute("aria-hidden","true"),n.appendChild(a),n.addEventListener("click",T=>{T.stopPropagation(),Uo(e.id)&&pe()});const i=document.createElement("button");i.classList.add("column-drag-handle"),i.type="button",i.setAttribute("aria-label","Drag to reorder column");const s=document.createElement("span");s.dataset.lucide="grip-vertical",s.setAttribute("aria-hidden","true"),i.appendChild(s),i.title="Drag to reorder";const r=document.createElement("header");r.classList.add("column-header");const l=document.createElement("h2");if(l.id=`column-title-${e.id}`,o){const T=di(e.id);l.textContent=`${e.name} (${T})`}else l.textContent=e.name;const d=document.createElement("span");d.classList.add("task-counter"),d.dataset.columnId=e.id,d.textContent="0",d.setAttribute("aria-label","Task count");const c=document.createElement("div");c.classList.add("column-actions");const u=document.createElement("button");u.classList.add("add-task-btn-icon"),u.type="button",u.setAttribute("aria-label",`Add task to ${e.name}`);const m=document.createElement("span");m.dataset.lucide="plus",m.setAttribute("aria-hidden","true"),u.appendChild(m),u.title="Add task",u.addEventListener("click",()=>ya(e.id));const f=document.createElement("div");f.classList.add("column-menu-wrapper");const p=document.createElement("button");p.classList.add("column-menu-btn"),p.type="button",p.setAttribute("aria-haspopup","menu"),p.setAttribute("aria-expanded","false"),p.setAttribute("aria-label",`${e.name} column menu`);const g=document.createElement("span");g.dataset.lucide="ellipsis-vertical",g.setAttribute("aria-hidden","true"),p.appendChild(g),p.title="Column menu";const C=document.createElement("div");C.classList.add("column-menu","hidden"),C.setAttribute("role","menu");const I=document.createElement("button");I.classList.add("column-menu-item"),I.type="button",I.setAttribute("role","menuitem");const B=document.createElement("span");B.dataset.lucide="pencil",B.setAttribute("aria-hidden","true"),I.appendChild(B);const k=document.createTextNode(" Edit");I.appendChild(k),I.title="Edit column",I.addEventListener("click",T=>{T.stopPropagation(),ke(),Ea(e.id)});const w=document.createElement("button");w.classList.add("column-menu-item","danger"),w.type="button",w.setAttribute("role","menuitem");const v=document.createElement("span");v.dataset.lucide="trash-2",v.setAttribute("aria-hidden","true"),w.appendChild(v);const D=document.createTextNode(" Delete");w.appendChild(D),w.title="Delete column",w.addEventListener("click",T=>{T.stopPropagation(),ke(),(async()=>{if(e.id==="done"){await de({title:"Cannot Delete Column",message:"The Done column is permanent and cannot be deleted."});return}if(ae().length<=1){await de({title:"Cannot Delete Column",message:"Cannot delete the last column."});return}const dt=J().filter(_o=>_o.column===e.id),zt=e?.name?`"${e.name}"`:"this column",ct=dt.length>0?`Delete ${zt}? This will also delete ${dt.length} task(s).`:`Delete ${zt}?`;await Te({title:"Delete Column",message:ct,confirmText:"Delete"})&&jo(e.id)&&pe()})()});const _=document.createElement("div");_.classList.add("column-menu-submenu-wrapper");const O=document.createElement("button");O.classList.add("column-menu-item","has-submenu"),O.type="button",O.setAttribute("role","menuitem"),O.setAttribute("aria-haspopup","menu"),O.setAttribute("aria-expanded","false");const R=document.createElement("span");R.dataset.lucide="arrow-up-down",R.setAttribute("aria-hidden","true"),O.appendChild(R);const we=document.createTextNode(" Sort");O.appendChild(we);const q=document.createElement("span");q.dataset.lucide="chevron-left",q.classList.add("submenu-chevron"),q.setAttribute("aria-hidden","true"),O.appendChild(q),O.title="Sort tasks in column";const z=document.createElement("div");z.classList.add("column-submenu","hidden"),z.setAttribute("role","menu");const F=document.createElement("button");F.classList.add("column-menu-item"),F.type="button",F.setAttribute("role","menuitem"),F.textContent="By Due Date",F.title="Sort by due date (earliest first)",F.addEventListener("click",T=>{T.stopPropagation(),ke(),Un(e.id,"dueDate")});const Y=document.createElement("button");Y.classList.add("column-menu-item"),Y.type="button",Y.setAttribute("role","menuitem"),Y.textContent="By Priority",Y.title="Sort by priority (high to low)",Y.addEventListener("click",T=>{T.stopPropagation(),ke(),Un(e.id,"priority")}),z.appendChild(F),z.appendChild(Y),O.addEventListener("click",T=>{T.stopPropagation();const le=!z.classList.contains("hidden");z.classList.toggle("hidden"),O.setAttribute("aria-expanded",le?"false":"true")}),_.addEventListener("mouseenter",()=>{z.classList.remove("hidden"),O.setAttribute("aria-expanded","true")}),_.addEventListener("mouseleave",()=>{z.classList.add("hidden"),O.setAttribute("aria-expanded","false")}),_.appendChild(O),_.appendChild(z),C.appendChild(I),C.appendChild(_),C.appendChild(w),p.addEventListener("click",T=>{T.stopPropagation();const le=!C.classList.contains("hidden");ke(),le?p.setAttribute("aria-expanded","false"):(C.classList.remove("hidden"),p.setAttribute("aria-expanded","true"))}),f.appendChild(p),f.appendChild(C),c.appendChild(u),c.appendChild(f),r.appendChild(n),r.appendChild(i),r.appendChild(l),r.appendChild(d),r.appendChild(c);const Z=document.createElement("ul");return Z.classList.add("tasks"),Z.setAttribute("role","list"),Z.setAttribute("aria-label",`Tasks in ${e.name}`),o&&(Z.classList.add("hidden"),c.classList.add("hidden"),d.classList.add("hidden")),t.appendChild(r),t.appendChild(Z),t}function yi(){const e=ae(),t=document.getElementById("task-column");t.innerHTML="",e.forEach(o=>{const n=document.createElement("option");n.value=o.id,n.textContent=o.name,t.appendChild(n)})}function pe(){const e=ae(),t=J(),o=ie(),n=X(),a=new Map(o.map(d=>[d.id,(d.name||"").toString().trim().toLowerCase()])),i=(To||"").toString().trim().toLowerCase(),s=i?t.filter(d=>ci(d,i,a)):t,r=document.getElementById("board-container");r.innerHTML="",[...e].sort((d,c)=>(d.order??0)-(c.order??0)).forEach(d=>{const c=bi(d);r.appendChild(c);const u=c.querySelector(".tasks"),m=c.querySelector(".task-counter"),f=s.filter(p=>p.column===d.id).sort((p,g)=>(p.order??0)-(g.order??0));f.forEach(p=>{u.appendChild(gi(p,n))}),m.textContent=f.length}),ei(),yi(),xe(),Lt(),Yn||(Yn=!0,document.addEventListener("click",()=>ke()),document.addEventListener("keydown",d=>{d.key==="Escape"&&ke()}))}const me=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:pe,setBoardFilterQuery:xo},Symbol.toStringTag,{value:"Module"})),Ao="kanban-theme";function vi(){const e=localStorage.getItem(Ao);return e==="light"||e==="dark"?e:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Xn(e){document.documentElement.dataset.theme=e}function jn(e){const t=document.getElementById("theme-toggle-btn");if(!t)return;const o=e==="dark"?"light":"dark",n=o==="dark"?"Dark":"Light",a=o==="dark"?"moon":"sun";t.setAttribute("aria-pressed",String(e==="dark"));const i=t.querySelector("[data-lucide]");i&&i.setAttribute("data-lucide",a);const s=Array.from(t.childNodes).filter(r=>r.nodeType===Node.TEXT_NODE);for(const r of s)r.remove();t.appendChild(document.createTextNode(` ${n}`)),xe()}function Ei(){const e=vi();Xn(e),jn(e);const t=document.getElementById("theme-toggle-btn");t&&t.addEventListener("click",()=>{const n=(document.documentElement.dataset.theme==="dark"?"dark":"light")==="dark"?"light":"dark";Xn(n),localStorage.setItem(Ao,n),jn(n)})}function wi(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function Wn(e){const t=ze(),o=pn();e.innerHTML="",t.forEach(n=>{const a=document.createElement("option");a.value=n.id,a.textContent=wi(n),e.appendChild(a)}),o&&(e.value=o)}function on(){const e=document.getElementById("brand-text")||document.querySelector(".brand-text");e&&(e.textContent=Mt())}function Ci(){const e=document.getElementById("board-create-modal"),t=document.getElementById("board-create-name");!e||!t||(t.value="",e.classList.remove("hidden"),t.focus())}function Ue(){const e=document.getElementById("board-create-modal");e&&e.classList.add("hidden")}function Di(){fn();const e=document.getElementById("board-select");if(!e)return;Wn(e),on(),document.addEventListener("kanban:open-board-create",()=>{Ci()}),e.addEventListener("change",()=>{const a=e.value;if(!a)return;It(a),on(),pe();const i=document.getElementById("board-controls-menu"),s=document.getElementById("desktop-menu-btn");i?.classList.remove("show"),s?.setAttribute("aria-expanded","false")});const t=document.getElementById("board-create-modal"),o=document.getElementById("board-create-form"),n=document.getElementById("cancel-board-create-btn");t&&(t.querySelector(".modal-backdrop")?.addEventListener("click",Ue),t.addEventListener("keydown",i=>{i.key==="Escape"&&Ue()})),n&&n.addEventListener("click",Ue),te("board-create-modal",Ue),o&&o.addEventListener("submit",async a=>{a.preventDefault();const i=document.getElementById("board-create-name"),s=(i?.value||"").trim();if(!s){await de({title:"Error",message:"Board name cannot be empty."}),i?.focus();return}const r=Gn(s);It(r.id),Wn(e),on(),pe(),Ue(),document.dispatchEvent(new CustomEvent("kanban:boards-changed"))})}function Li(e){const t=[];for(const o of e){if(typeof o!="string")continue;const n=o.trim();n&&(t.includes(n)||t.push(n))}return t}function Ii(e){const t=typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US";return Li([e,t,"en-US","en-GB","de-DE","fr-FR","es-ES","it-IT","pt-BR","ja-JP","zh-CN"])}function Si(){document.getElementById("settings-modal")?.classList.remove("hidden")}function an(){document.getElementById("settings-modal")?.classList.add("hidden")}async function Se(e){qn(e);const{renderBoard:t}=await ce(async()=>{const{renderBoard:o}=await Promise.resolve().then(()=>me);return{renderBoard:o}},void 0,import.meta.url);t()}function Bi(){const e=document.getElementById("settings-btn"),t=document.getElementById("settings-close-btn");document.querySelector("#settings-modal .modal-backdrop");const o=document.getElementById("settings-show-priority"),n=document.getElementById("settings-show-due-date"),a=document.getElementById("settings-notification-days"),i=document.getElementById("settings-show-age"),s=document.getElementById("settings-show-change-date"),r=document.getElementById("settings-locale"),l=document.getElementById("settings-default-priority");if(!e||!t||!o||!n||!a||!i||!s||!r||!l)return;function d(){const c=X();o.checked=c.showPriority!==!1,n.checked=c.showDueDate!==!1,i.checked=c.showAge!==!1,s.checked=c.showChangeDate!==!1,a.value=String(Number.isFinite(c.notificationDays)?c.notificationDays:3);const u=Ii(c.locale);r.innerHTML="",u.forEach(m=>{const f=document.createElement("option");f.value=m,f.textContent=m,r.appendChild(f)}),r.value=c.locale,l.value=c.defaultPriority||"low"}e.addEventListener("click",()=>{d(),Si()}),t.addEventListener("click",an),te("settings-modal",an),document.addEventListener("keydown",c=>{const u=document.getElementById("settings-modal");!u||u.classList.contains("hidden")||c.key==="Escape"&&an()}),i.addEventListener("change",async()=>{const c=X();await Se({...c,showAge:!!i.checked})}),s.addEventListener("change",async()=>{const c=X();await Se({...c,showChangeDate:!!s.checked})}),o.addEventListener("change",async()=>{const c=X();await Se({...c,showPriority:!!o.checked})}),n.addEventListener("change",async()=>{const c=X();await Se({...c,showDueDate:!!n.checked})}),a.addEventListener("change",async()=>{const c=X(),u=Number.parseInt(a.value,10),m=Number.isFinite(u)?u:3;await Se({...c,notificationDays:m})}),r.addEventListener("change",async()=>{const c=X();await Se({...c,locale:r.value})}),l.addEventListener("change",async()=>{const c=X();await Se({...c,defaultPriority:l.value})})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("app-version");e&&(e.textContent="v1.0.9",e.title="Version 1.0.9"),Ei(),Bi();const t=document.getElementById("board-search-input");t&&t.addEventListener("input",()=>{xo(t.value),pe()}),Di(),ka(),li(),document.getElementById("export-btn").addEventListener("click",async()=>{await Te({title:"Export Board (Active Only)",message:`Export ONLY saves the current active board. It does NOT back up all boards.

To back up everything, export each board individually.

Continue with export?`,confirmText:"Export"})&&la()}),document.getElementById("import-btn").addEventListener("click",async()=>{await Te({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",a=>{const i=a.target.files[0];i&&ca(i),a.target.value=""});const o=document.getElementById("desktop-menu-btn"),n=document.getElementById("board-controls-menu");o&&n&&(o.addEventListener("click",a=>{a.stopPropagation();const i=o.getAttribute("aria-expanded")==="true";n.classList.toggle("show"),o.setAttribute("aria-expanded",String(!i)),document.querySelectorAll(".column-menu").forEach(s=>s.classList.add("hidden"))}),n.addEventListener("click",a=>{a.target.closest("select, option, input, textarea, label")||!a.target.closest('button, a, [role="menuitem"]')||(n.classList.remove("show"),o.setAttribute("aria-expanded","false"))}),document.addEventListener("click",a=>{!n.contains(a.target)&&!o.contains(a.target)&&(n.classList.remove("show"),o.setAttribute("aria-expanded","false"))})),pe()});
