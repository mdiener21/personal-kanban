import{l as Q,g as fn,s as ve,a as oe,b as Fe,c as re,d as Mt,e as K,f as Rt,h as zn,i as St,j as Yn,k as $e,r as He,m as pn,n as hn,o as Co,p as Lo}from"./storage-gHWR1jxx.js";const Io=new Set(["low","medium","high"]);function Un(e){const t=(e||"").toString().trim().toLowerCase();return Io.has(t)?t:"low"}function Xn(e){return(e||"").toString().trim()}function ko(e,t,o,n,a,i=[]){if(!e||e.trim()==="")return;const r=Q(),l=r.filter(m=>m.column===a).slice().sort((m,f)=>(m.order??0)-(f.order??0)),s=new Map;l.forEach((m,f)=>{s.set(m.id,f+2)});const d=r.map(m=>{if(m.column!==a)return m;const f=s.get(m.id);return typeof f=="number"?{...m,order:f}:m}),c=new Date().toISOString(),u={id:fn(),title:e.trim(),description:(t||"").toString().trim(),priority:Un(o),dueDate:Xn(n),column:a,order:1,labels:[...i],creationDate:c,changeDate:c,...a==="done"?{doneDate:c}:{}};d.push(u),ve(d)}function So(e,t,o,n,a,i,r=[]){if(!t||t.trim()==="")return;const l=Q(),s=l.findIndex(d=>d.id===e);if(s!==-1){const d=l[s].column,c=i,u=new Date().toISOString();l[s].title=t.trim(),l[s].description=(o||"").toString().trim(),l[s].priority=Un(n),l[s].dueDate=Xn(a),l[s].column=c,l[s].labels=[...r],d!=="done"&&c==="done"?l[s].doneDate=u:d==="done"&&c!=="done"&&delete l[s].doneDate,l[s].changeDate=u,ve(l)}}function Bo(e){const o=Q().filter(n=>n.id!==e);return ve(o),!0}function To(){const e=[];return document.querySelectorAll(".task-column").forEach(t=>{const o=t.dataset.column;t.querySelectorAll(".task").forEach(n=>{e.push({id:n.dataset.taskId,column:o})})}),e}function Ao(){const e=To(),t=Q(),o=new Date().toISOString(),n=t.map(a=>{const i=e.findIndex(r=>r.id===a.id);if(i!==-1){const r=e[i],l=e.filter((m,f)=>m.column===r.column&&f<=i),s=r.column,d=l.length,c=a.column!==s,u={...a,column:s,order:d,...c?{changeDate:o}:{}};return c&&(a.column!=="done"&&s==="done"?u.doneDate=o:a.column==="done"&&s!=="done"&&delete u.doneDate),{...u}}return a});ve(n)}function xo(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function jn(e){return xo(e)?e.trim():"#3b82f6"}function _o(e,t){if(!e||e.trim()==="")return;const o=oe(),n=o.reduce((r,l)=>Math.max(r,l.order??0),0),i={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+fn().substring(0,8),name:e.trim(),color:jn(t),order:n-1,collapsed:!1};o.push(i),Fe(o)}function No(e){const t=typeof e=="string"?e.trim():"";if(!t)return!1;const o=oe(),n=o.find(a=>a.id===t);return n?(n.collapsed=n.collapsed!==!0,Fe(o),!0):!1}function Oo(e,t,o){if(!t||t.trim()==="")return;const n=oe(),a=n.findIndex(i=>i.id===e);a!==-1&&(n[a].name=t.trim(),n[a].color=jn(o),Fe(n))}function Po(e){if(e==="done")return!1;const t=oe();if(t.length<=1)return!1;const o=Q();if(o.filter(i=>i.column===e).length>0){const i=o.filter(r=>r.column!==e);ve(i)}const a=t.filter(i=>i.id!==e);return Fe(a),!0}function Mo(){const t=document.getElementById("board-container").querySelectorAll(".task-column"),o=oe();t.forEach((n,a)=>{const i=n.dataset.column,r=o.find(l=>l.id===i);r&&(r.order=a+1)}),Fe(o)}const Ro="modulepreload",Fo=function(e,t){return new URL(e,t).href},Ln={},se=function(t,o,n){let a=Promise.resolve();if(o&&o.length>0){let d=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const r=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),s=l?.nonce||l?.getAttribute("nonce");a=d(o.map(c=>{if(c=Fo(c,n),c in Ln)return;Ln[c]=!0;const u=c.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(n)for(let p=r.length-1;p>=0;p--){const g=r[p];if(g.href===c&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Ro,u||(f.as="script"),f.crossOrigin="",f.href=c,s&&f.setAttribute("nonce",s),document.head.appendChild(f),u)return new Promise((p,g)=>{f.addEventListener("load",p),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(r){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r}return a.then(r=>{for(const l of r||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},gn=40;function bn(e){return e.trim().slice(0,gn).toLowerCase().replace(/\s+/g," ")}function qn(e,t,o=null){return e.some(n=>o&&n.id===o?!1:bn(n.name)===t)}function $o(e,t){if(!e||e.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const o=e.trim().slice(0,gn),n=bn(o),a=re();if(qn(a,n))return{success:!1,reason:"DUPLICATE_NAME",message:`Label "${o}" already exists.`};const r={id:n.replace(/\s+/g,"-")+"-"+fn().substring(0,8),name:o,color:t};return a.push(r),Mt(a),{success:!0,label:r}}function Ho(e,t,o){if(!t||t.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const n=t.trim().slice(0,gn),a=bn(n),i=re(),r=i.findIndex(l=>l.id===e);return r===-1?{success:!1,reason:"NOT_FOUND"}:qn(i,a,e)?{success:!1,reason:"DUPLICATE_NAME",message:`Another label with the name "${n}" already exists.`}:(i[r].name=n,i[r].color=o,Mt(i),{success:!0,label:i[r]})}function zo(e){const t=re(),o=Q();o.forEach(a=>{a.labels&&(a.labels=a.labels.filter(i=>i!==e))}),ve(o);const n=t.filter(a=>a.id!==e);Mt(n)}let Bt=null;function ne(e){return document.getElementById(e)}function lt(e){const t=ne("dialog-modal");t&&t.classList.add("hidden");const o=Bt;Bt=null,typeof o=="function"&&o(!!e)}function Yo(){const e=ne("dialog-modal");return e&&!e.classList.contains("hidden")}function Wn({title:e,message:t,confirmText:o,cancelText:n,showCancel:a}){const i=ne("dialog-modal-title"),r=ne("dialog-modal-message"),l=ne("dialog-confirm-btn"),s=ne("dialog-cancel-btn");i&&(i.textContent=e||"Confirm"),r&&(r.textContent=t||""),l&&(l.textContent=o||"OK"),s&&(s.textContent=n||"Cancel"),s&&(s.style.display=a?"inline-flex":"none")}function Gn(){const e=ne("dialog-modal");if(!e||e.dataset.handlersAttached==="true")return;e.dataset.handlersAttached="true";const t=ne("dialog-confirm-btn"),o=ne("dialog-cancel-btn"),n=e.querySelector(".modal-backdrop");t?.addEventListener("click",()=>lt(!0)),o?.addEventListener("click",()=>lt(!1)),n?.addEventListener("click",()=>lt(!1)),document.addEventListener("keydown",a=>{a.key==="Escape"&&Yo()&&lt(!1)})}function Vn(){const e=ne("dialog-modal");if(!e)return;e.classList.remove("hidden"),ne("dialog-confirm-btn")?.focus()}function Se({title:e="Confirm",message:t="",confirmText:o="Delete",cancelText:n="Cancel"}={}){return Gn(),Wn({title:e,message:t,confirmText:o,cancelText:n,showCancel:!0}),Vn(),new Promise(a=>{Bt=a})}function ge({title:e="Notice",message:t="",okText:o="OK"}={}){return Gn(),Wn({title:e,message:t,confirmText:o,cancelText:"",showCancel:!1}),Vn(),new Promise(n=>{Bt=()=>n(!0)})}function Ut(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return Array.isArray(o)?o:null}catch{return null}}function Uo(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return o&&typeof o=="object"&&!Array.isArray(o)?o:null}catch{return null}}function Kn(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function Xo(e){const t=document.getElementById("brand-text")||document.querySelector(".brand-text");t&&(t.textContent=Rt());const o=document.getElementById("board-select");if(!o)return;const n=$e();o.innerHTML="",n.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=Kn(a),o.appendChild(i)}),e&&(o.value=e)}function jo(e){const t=typeof e?.name=="string"?e.name.trim():"";return t?t.replace(/\.[^.]+$/,"").trim():""}function Ft(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const qo=new Set(["low","medium","high"]);function $t(e){const t=(e||"").toString().trim().toLowerCase();return qo.has(t)?t:"low"}function Wo(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},o=t.showPriority!==!1,n=t.showDueDate!==!1,a=t.showAge!==!1,i=t.showChangeDate!==!1,r=typeof t.locale=="string"&&t.locale.trim()?t.locale.trim():typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US",l=$t(t.defaultPriority);return{showPriority:o,showDueDate:n,showAge:a,showChangeDate:i,locale:r,defaultPriority:l}}function Jn(e){const t=(e||"").toString().trim();return t.length>=10&&t.includes("T")?t.slice(0,10):t}function Qn(e){const t=typeof e?.text=="string"?e.text:"",o=typeof e?.title=="string"?e.title:t,n=typeof e?.description=="string"?e.description:"",a=Jn(e?.dueDate??e?.["due-date"]),i=typeof e?.changeDate=="string"?e.changeDate:typeof e?.changedDate=="string"?e.changedDate:void 0,r=e?.column==="done",l=typeof e?.doneDate=="string"?e.doneDate.toString().trim():"";return{...e,title:o.toString().trim(),description:n.toString().trim(),priority:$t(e?.priority),dueDate:a,...typeof i=="string"?{changeDate:i.toString().trim()}:{},...r&&l?{doneDate:l}:{doneDate:void 0},changedDate:void 0}}function Go(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.text=="string"?n.text:String(n?.text??""),r=typeof n?.title=="string"?n.title:i,l=typeof n?.description=="string"?n.description:String(n?.description??""),s=$t(n?.priority),d=typeof n?.dueDate=="string"?n.dueDate:typeof n?.["due-date"]=="string"?n["due-date"]:String(n?.dueDate??n?.["due-date"]??""),c=Jn(d),u=typeof n?.column=="string"?n.column:String(n?.column??""),m=Array.isArray(n?.labels)?n.labels.map(S=>typeof S=="string"?S:String(S)):[],f=Number.isFinite(n?.order)?n.order:void 0,p=typeof n?.creationDate=="string"?n.creationDate:void 0,g=typeof n?.changeDate=="string"?n.changeDate:typeof n?.changedDate=="string"?n.changedDate:void 0,L=typeof n?.doneDate=="string"?n.doneDate.trim():"",k=u.trim()==="done"&&(L||(typeof g=="string"?g.trim():"")||p)||"";return{id:a.trim(),title:r.trim(),description:l.trim(),priority:s,dueDate:c.trim(),column:u.trim(),...f!==void 0?{order:f}:{},...p?{creationDate:p}:{},...typeof g=="string"&&g.trim()?{changeDate:g.trim()}:{},...k?{doneDate:k}:{},labels:m}});return t.every(n=>n.id&&n.title&&n.column)?t:null}function Vo(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),r=Number.isFinite(n?.order)?n.order:void 0,l=Ft(n?.color)?n.color.trim():"#3b82f6",s=n?.collapsed===!0;return{id:a.trim(),name:i.trim(),color:l,collapsed:s,...r!==void 0?{order:r}:{}}});if(!t.some(n=>n.id==="done")){const n=t.reduce((a,i)=>Math.max(a,Number.isFinite(i?.order)?i.order:0),0);t.push({id:"done",name:"Done",color:"#16a34a",order:n+1,collapsed:!1})}return t.every(n=>n.id&&n.name)?t:null}function Ko(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),r=Ft(n?.color)?n.color.trim():"#3b82f6";return{id:a.trim(),name:i.trim(),color:r}});return t.every(n=>n.id&&n.name&&n.color)?t:null}function Jo(e){if(!e||typeof e!="object"||Array.isArray(e))return null;const t=e.showPriority!==!1,o=e.showDueDate!==!1,n=e.showAge!==!1,a=e.showChangeDate!==!1,i=typeof e.locale=="string"&&e.locale.trim()?e.locale.trim():void 0,r=typeof e.defaultPriority=="string"?e.defaultPriority:void 0,l=r?$t(r):void 0;return{showPriority:t,showDueDate:o,showAge:n,showChangeDate:a,...i?{locale:i}:{},...l?{defaultPriority:l}:{}}}function Qo(){const e=Q().map(Qn),t=oe().map(c=>({...c,color:Ft(c?.color)?c.color.trim():"#3b82f6"})),o=re(),n=K(),a=Rt(),r=JSON.stringify({boardName:a,columns:t,tasks:e,labels:o,settings:n},null,2),l=new Blob([r],{type:"application/json"}),s=URL.createObjectURL(l),d=document.createElement("a");d.href=s,d.download=`${a.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(s)}function Zo(e){const t=typeof e=="string"?e.trim():"";if(!t)return;const o=$e().find(E=>E.id===t),n=Kn(o),a=`kanbanBoard:${t}:columns`,i=`kanbanBoard:${t}:tasks`,r=`kanbanBoard:${t}:labels`,l=`kanbanBoard:${t}:settings`,s=Ut(i)||[],d=Ut(a)||[],c=Ut(r)||[],u=Uo(l)||null,m=s.map(Qn),f=d.map(E=>({...E,color:Ft(E?.color)?E.color.trim():"#3b82f6",collapsed:E?.collapsed===!0})),p=Array.isArray(c)?c:[],g=Wo(u),B=JSON.stringify({boardName:n,columns:f,tasks:m,labels:p,settings:g},null,2),k=new Blob([B],{type:"application/json"}),S=URL.createObjectURL(k),I=document.createElement("a");I.href=S,I.download=`${n.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(S)}function ea(e){const t=new FileReader;t.onload=async o=>{try{const n=JSON.parse(o.target.result);let a,i,r,l,s;if(Array.isArray(n))a=n,i=null,r=null,l=null,s=null;else if(n.tasks&&n.columns)a=n.tasks,i=n.columns,r=Object.prototype.hasOwnProperty.call(n,"labels")?n.labels:null,l=Object.prototype.hasOwnProperty.call(n,"settings")?n.settings:null,s=typeof n.boardName=="string"?n.boardName.trim():null;else{alert("Invalid JSON file format");return}const d=Go(a),c=i?Vo(i):null,u=r?Ko(r):null,m=l?Jo(l):null;if(!d||i&&!c||r&&!u||l&&!m){alert("Invalid data structure");return}const f=s||jo(e)||"Imported board",p=zn(f);if(p?.id&&St(p.id),c&&Fe(c),ve(d),u&&Mt(u),m){const L=K();Yn({...L,...m})}Xo(p?.id);const{renderBoard:g}=await se(async()=>{const{renderBoard:L}=await Promise.resolve().then(()=>ce);return{renderBoard:L}},void 0,import.meta.url);g(),document.dispatchEvent(new CustomEvent("kanban:boards-changed")),alert("Board imported successfully!")}catch(n){alert("Error parsing JSON file: "+n.message)}},t.readAsText(e)}let In="todo",Ze=null,et=null,je=null,Tt=null,X=[],ye=!1,nt=!1;const we=40;let ze=!1;function Ht(e){const t=document.getElementById("task-modal");if(!t)return;t.classList.toggle("fullscreen",!!e),document.getElementById("task-fullpage-btn")?.setAttribute("aria-pressed",e?"true":"false")}function De(e){const t=document.getElementById(e);return!!t&&!t.classList.contains("hidden")}function ta(){const e=document.getElementById("task-modal");e&&(e.classList.remove("hidden"),Me(),document.getElementById("task-label-search")?.focus(),ye=!1)}function na(){return(document.getElementById("task-label-search")?.value||"").trim().toLowerCase()}function oa(){return(document.getElementById("labels-search")?.value||"").trim().toLowerCase()}function on(){const e=document.getElementById("task-active-labels");if(!e)return;const t=re(),o=[];for(const a of X)o.includes(a)||o.push(a);X=o;const n=o.map(a=>t.find(i=>i.id===a)).filter(Boolean);e.innerHTML="",e.style.display=n.length>0?"flex":"none",n.forEach(a=>{const i=document.createElement("span");i.classList.add("task-label"),i.style.backgroundColor=a.color,i.textContent=a.name;const r=document.createElement("button");r.type="button",r.classList.add("active-label-remove"),r.setAttribute("aria-label",`Remove label ${a.name}`),r.title="Remove label",r.textContent="Ã—",r.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),X=X.filter(s=>s!==a.id),on(),Me()}),i.appendChild(r),e.appendChild(i)})}function aa(e){In=e||oe()[0]?.id||"todo",Ze=null,X=[],ye=!1,nt=!1,Ht(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden");const t=document.getElementById("task-modal"),o=document.getElementById("task-column"),n=document.getElementById("task-title"),a=document.getElementById("task-description"),i=document.getElementById("task-priority"),r=document.getElementById("task-due-date"),l=document.getElementById("task-modal-title"),s=document.getElementById("task-submit-btn");if(l.textContent="Add New Task",s.textContent="Add Task",o.value=In,n.value="",a.value="",i){const c=K();i.value=c.defaultPriority||"low"}r&&(r.value="");const d=document.getElementById("task-label-search");d&&(d.value=""),Me(),t.classList.remove("hidden"),n.focus()}function qe(e){const o=Q().find(g=>g.id===e);if(!o)return;Ze=e,X=o.labels||[],ye=!1,nt=!1,Ht(!1),document.getElementById("task-fullpage-btn")?.classList.remove("hidden");const n=document.getElementById("task-modal"),a=document.getElementById("task-column"),i=document.getElementById("task-title"),r=document.getElementById("task-description"),l=document.getElementById("task-priority"),s=document.getElementById("task-due-date"),d=document.getElementById("task-modal-title"),c=document.getElementById("task-submit-btn");d.textContent="Edit Task",c.textContent="Save Changes",a.value=o.column;const u=typeof o.text=="string"?o.text:"";i.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:u,r.value=typeof o.description=="string"?o.description:"",l&&(l.value=typeof o.priority=="string"?o.priority:"medium");const m=typeof o.dueDate=="string"?o.dueDate:"",f=m.includes("T")?m.slice(0,10):m;s&&(s.value=f);const p=document.getElementById("task-label-search");p&&(p.value=""),Me(),n.classList.remove("hidden"),i.focus()}function st(){document.getElementById("task-modal").classList.add("hidden"),Ze=null,ye=!1,Ht(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden")}function ia(){et=null;const e=document.getElementById("column-modal"),t=document.getElementById("column-name"),o=document.getElementById("column-color"),n=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");n.textContent="Add New Column",a.textContent="Add Column",t.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),t.focus()}function ra(e){const o=oe().find(s=>s.id===e);if(!o)return;et=e;const n=document.getElementById("column-modal"),a=document.getElementById("column-name"),i=document.getElementById("column-color"),r=document.getElementById("column-modal-title"),l=document.getElementById("column-submit-btn");r.textContent="Edit Column",l.textContent="Save Changes",a.value=o.name,i&&(i.value=o.color||"#3b82f6"),n.classList.remove("hidden"),a.focus()}function dt(){document.getElementById("column-modal").classList.add("hidden"),et=null}function la(){const e=document.getElementById("labels-search");e&&(e.value=""),At(),document.getElementById("labels-modal").classList.remove("hidden"),ye||document.getElementById("labels-search")?.focus()}function ct(){document.getElementById("labels-modal").classList.add("hidden");const t=document.getElementById("labels-search");t&&(t.value=""),ye&&ta()}function sa(){document.getElementById("help-modal").classList.remove("hidden")}function Xt(){document.getElementById("help-modal").classList.add("hidden")}function an(e=null,{openedFromTaskEditor:t=!1}={}){je=e,ze=!1,nt=!!t;const o=document.getElementById("label-modal"),n=document.getElementById("label-modal-title"),a=document.getElementById("label-name"),i=document.getElementById("label-color"),r=document.getElementById("label-submit-btn");if(e){const s=re().find(d=>d.id===e);s&&(n.textContent="Edit Label",r.textContent="Update Label",a.value=s.name,i.value=s.color)}else n.textContent="Add Label",r.textContent="Add Label",a.value="",i.value="#3b82f6";o.classList.remove("hidden"),a.focus()}function ut(){document.getElementById("label-modal").classList.add("hidden"),je=null,nt=!1}function At(){const e=document.getElementById("labels-list");e.innerHTML="";const t=re(),o=oa(),n=o?t.filter(a=>{const i=(a.name||"").toLowerCase(),r=(a.id||"").toLowerCase();return i.includes(o)||r.includes(o)}):t;if(n.length===0){const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent=o?"No matching labels":"No labels yet",e.appendChild(a);return}n.forEach(a=>{const i=document.createElement("div");i.classList.add("label-item"),i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="space-between";const r=document.createElement("span");r.classList.add("task-label"),r.style.backgroundColor=a.color,r.textContent=a.name;const l=document.createElement("div");l.classList.add("label-actions"),l.style.display="flex",l.style.gap="4px";const s=document.createElement("button");s.classList.add("btn-small");const d=document.createElement("span");d.dataset.lucide="pencil",s.appendChild(d),s.title="Edit label",s.addEventListener("click",()=>an(a.id));const c=document.createElement("button");c.classList.add("btn-small","btn-danger");const u=document.createElement("span");u.dataset.lucide="trash-2",c.appendChild(u),c.title="Delete label",c.addEventListener("click",async()=>{if(await Se({title:"Delete Label",message:`Delete label "${a.name}"? This will remove it from all tasks.`,confirmText:"Delete"})){zo(a.id),At();const{renderBoard:f}=await se(async()=>{const{renderBoard:p}=await Promise.resolve().then(()=>ce);return{renderBoard:p}},void 0,import.meta.url);f()}}),l.appendChild(s),l.appendChild(c),i.appendChild(r),i.appendChild(l),e.appendChild(i)}),He()}function rn(){const e=document.getElementById("board-select");if(!e)return;const t=$e(),o=hn();e.innerHTML="",t.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=typeof a.name=="string"&&a.name.trim()?a.name.trim():"Untitled board",e.appendChild(i)}),o&&(e.value=o);const n=document.getElementById("brand-text")||document.querySelector(".brand-text");n&&(n.textContent=Rt())}function tt(){pn();const e=document.getElementById("boards-list");if(!e)return;e.innerHTML="";const t=$e(),o=hn();t.forEach(n=>{const a=document.createElement("div");a.classList.add("label-item"),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="10px";const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";const r=document.createElement("span");if(r.textContent=(n.name||"").toString(),i.appendChild(r),n.id===o){const g=document.createElement("span");g.classList.add("task-label"),g.style.backgroundColor="var(--color-primary)",g.textContent="Active",i.appendChild(g)}const l=document.createElement("div");l.classList.add("label-actions"),l.style.display="flex",l.style.gap="4px";const s=document.createElement("button");s.classList.add("btn-small"),s.textContent="Open",s.title="Open board",s.addEventListener("click",async()=>{St(n.id),rn(),tt();const{renderBoard:g}=await se(async()=>{const{renderBoard:L}=await Promise.resolve().then(()=>ce);return{renderBoard:L}},void 0,import.meta.url);g()});const d=document.createElement("button");d.classList.add("btn-small"),d.type="button",d.title="Export board",d.setAttribute("aria-label",`Export board ${String(n.name||"Untitled board")}`);const c=document.createElement("span");c.dataset.lucide="download",d.appendChild(c),d.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),Zo(n.id)});const u=document.createElement("button");u.classList.add("btn-small");const m=document.createElement("span");m.dataset.lucide="pencil",u.appendChild(m),u.title="Rename board",u.addEventListener("click",()=>ua(n.id));const f=document.createElement("button");f.classList.add("btn-small","btn-danger");const p=document.createElement("span");p.dataset.lucide="trash-2",f.appendChild(p),f.title="Delete board",f.addEventListener("click",async()=>{if(!await Se({title:"Delete Board",message:`Do you really want to delete the board "${n.name}"? This cannot be undone.`,confirmText:"Delete"}))return;if(!Co(n.id)){await ge({title:"Unable to Delete",message:"Unable to delete board (you may be trying to delete the last board)."});return}rn(),tt();const{renderBoard:B}=await se(async()=>{const{renderBoard:k}=await Promise.resolve().then(()=>ce);return{renderBoard:k}},void 0,import.meta.url);B()}),l.appendChild(s),l.appendChild(d),l.appendChild(u),l.appendChild(f),a.appendChild(i),a.appendChild(l),e.appendChild(a)}),He()}function da(){tt(),document.getElementById("boards-modal")?.classList.remove("hidden")}function jt(){document.getElementById("boards-modal")?.classList.add("hidden")}function ca(){const e=document.getElementById("boards-modal");!e||e.classList.contains("hidden")||tt()}function ua(e){pn();const t=$e().find(r=>r.id===e);if(!t)return;Tt=e;const o=document.getElementById("board-rename-modal"),n=document.getElementById("board-rename-name"),a=document.getElementById("board-rename-modal-title"),i=document.getElementById("board-rename-submit-btn");a&&(a.textContent="Rename Board"),i&&(i.textContent="Save"),n&&(n.value=(t.name||"").toString()),o?.classList.remove("hidden"),n?.focus()}function mt(){document.getElementById("board-rename-modal")?.classList.add("hidden"),Tt=null}function Me(){on();const e=document.getElementById("task-labels-selection");e.innerHTML="";const t=na(),o=re(),n=t?o.filter(a=>{const i=(a.name||"").toLowerCase(),r=(a.id||"").toLowerCase();return i.includes(t)||r.includes(t)}):o;if(n.length===0){const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent="No matching labels",e.appendChild(a);return}n.forEach(a=>{const i=document.createElement("label");i.classList.add("label-checkbox");const r=document.createElement("input");r.type="checkbox",r.value=a.id,r.checked=X.includes(a.id),r.addEventListener("change",s=>{s.target.checked?X.includes(a.id)||X.push(a.id):X=X.filter(d=>d!==a.id),on()});const l=document.createElement("span");l.classList.add("task-label","label-color-swatch"),l.style.backgroundColor=a.color,l.textContent=a.name,i.appendChild(r),i.appendChild(l),e.appendChild(i)})}function ma(){document.addEventListener("kanban:boards-changed",()=>{ca()}),document.getElementById("task-label-search")?.addEventListener("input",Me),document.getElementById("labels-search")?.addEventListener("input",At),document.getElementById("task-add-label-btn")?.addEventListener("click",()=>{ye=!1,an(null,{openedFromTaskEditor:!0})}),document.getElementById("task-fullpage-btn")?.addEventListener("click",()=>{const i=document.getElementById("task-modal");i&&Ht(!i.classList.contains("fullscreen"))}),document.getElementById("task-form").addEventListener("submit",async i=>{i.preventDefault();const r=document.getElementById("task-title").value,l=document.getElementById("task-description").value,s=document.getElementById("task-priority")?.value,d=document.getElementById("task-due-date")?.value,c=document.getElementById("task-column").value;Ze?So(Ze,r,l,s,d,c,X):ko(r,l,s,d,c,X),st();const{renderBoard:u}=await se(async()=>{const{renderBoard:m}=await Promise.resolve().then(()=>ce);return{renderBoard:m}},void 0,import.meta.url);u()}),document.getElementById("cancel-task-btn").addEventListener("click",st),document.querySelector("#task-modal .modal-backdrop").addEventListener("click",st),document.getElementById("column-form").addEventListener("submit",async i=>{i.preventDefault();const r=document.getElementById("column-name").value,l=document.getElementById("column-color")?.value;et?Oo(et,r,l):_o(r,l),dt();const{renderBoard:s}=await se(async()=>{const{renderBoard:d}=await Promise.resolve().then(()=>ce);return{renderBoard:d}},void 0,import.meta.url);s()}),document.getElementById("cancel-column-btn").addEventListener("click",dt),document.querySelector("#column-modal .modal-backdrop").addEventListener("click",dt),document.getElementById("manage-labels-btn").addEventListener("click",la),document.getElementById("labels-close-btn").addEventListener("click",ct),document.getElementById("add-label-btn").addEventListener("click",()=>an());const a=document.getElementById("label-name");a?.addEventListener("beforeinput",i=>{if(!i||typeof i.data!="string"||i.data.length===0)return;const r=i.target;if(!r||typeof r.value!="string")return;const l=typeof r.selectionStart=="number"?r.selectionStart:r.value.length,s=typeof r.selectionEnd=="number"?r.selectionEnd:r.value.length;(r.value.slice(0,l)+i.data+r.value.slice(s)).trim().length<=we||(i.preventDefault(),!ze&&(ze=!0,ge({title:"Label Name Too Long",message:`Label names are limited to ${we} characters.`})))}),a?.addEventListener("input",i=>{const r=i.target;if(!r||typeof r.value!="string")return;const l=r.value.trim();l.length<=we||(r.value=l.slice(0,we),!ze&&(ze=!0,ge({title:"Label Name Too Long",message:`Label names are limited to ${we} characters.`})))}),document.getElementById("label-form").addEventListener("submit",async i=>{i.preventDefault();const r=document.getElementById("label-name").value,l=document.getElementById("label-color").value,s=(r||"").trim();if(s.length>we){await ge({title:"Label Name Too Long",message:`Label names are limited to ${we} characters.`});return}const d=!je,c=je?Ho(je,s,l):$o(s,l);if(!c?.success){let m="Unable to Save Label",f="Could not save label.";c?.reason==="DUPLICATE_NAME"?(m="Label Already Exists",f=c?.message||"A label with that name already exists (case-insensitive)."):c?.reason==="EMPTY_NAME"&&(m="Label Name Required",f="Please enter a label name."),await ge({title:m,message:f}),document.getElementById("label-name")?.focus();return}d&&nt&&c?.label?.id&&(X.includes(c.label.id)||X.push(c.label.id),Me(),document.getElementById("task-label-search")?.focus()),ut(),At();const{renderBoard:u}=await se(async()=>{const{renderBoard:m}=await Promise.resolve().then(()=>ce);return{renderBoard:m}},void 0,import.meta.url);u(),ye&&d&&ct()}),document.getElementById("cancel-label-btn").addEventListener("click",ut),document.querySelector("#labels-modal .modal-backdrop").addEventListener("click",ct),document.querySelector("#label-modal .modal-backdrop").addEventListener("click",ut),document.getElementById("manage-boards-btn")?.addEventListener("click",da),document.getElementById("add-board-btn")?.addEventListener("click",async()=>{document.dispatchEvent(new CustomEvent("kanban:open-board-create"))}),document.getElementById("boards-import-btn")?.addEventListener("click",async()=>{await Se({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file")?.click()}),document.getElementById("boards-close-btn")?.addEventListener("click",jt),document.querySelector("#boards-modal .modal-backdrop")?.addEventListener("click",jt),document.getElementById("board-rename-form")?.addEventListener("submit",i=>{if(i.preventDefault(),!Tt)return;const l=(document.getElementById("board-rename-name")?.value||"").trim();if(!l){alert("Board name cannot be empty.");return}if(!Lo(Tt,l)){alert("Unable to rename board.");return}mt(),rn(),tt(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),document.getElementById("cancel-board-rename-btn")?.addEventListener("click",mt),document.querySelector("#board-rename-modal .modal-backdrop")?.addEventListener("click",mt),document.getElementById("help-btn").addEventListener("click",sa),document.getElementById("help-close-btn").addEventListener("click",Xt),document.querySelector("#help-modal .modal-backdrop").addEventListener("click",Xt),document.getElementById("add-column-btn").addEventListener("click",ia),document.addEventListener("keydown",i=>{if(i.key==="Escape"){if(De("label-modal")){ut();return}if(De("labels-modal")){ct();return}if(De("board-rename-modal")){mt();return}if(De("boards-modal")){jt();return}if(De("help-modal")){Xt();return}if(De("column-modal")){dt();return}De("task-modal")&&st()}})}function kn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),o.push.apply(o,n)}return o}function ie(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?kn(Object(o),!0).forEach(function(n){fa(e,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):kn(Object(o)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))})}return e}function vt(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?vt=function(t){return typeof t}:vt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(e)}function fa(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ue(){return ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},ue.apply(this,arguments)}function pa(e,t){if(e==null)return{};var o={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(o[a]=e[a]);return o}function ha(e,t){if(e==null)return{};var o=pa(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var ga="1.15.6";function de(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var fe=de(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),ot=de(/Edge/i),Sn=de(/firefox/i),We=de(/safari/i)&&!de(/chrome/i)&&!de(/android/i),yn=de(/iP(ad|od|hone)/i),Zn=de(/chrome/i)&&de(/android/i),eo={capture:!1,passive:!1};function D(e,t,o){e.addEventListener(t,o,!fe&&eo)}function w(e,t,o){e.removeEventListener(t,o,!fe&&eo)}function xt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function to(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function te(e,t,o,n){if(e){o=o||document;do{if(t!=null&&(t[0]===">"?e.parentNode===o&&xt(e,t):xt(e,t))||n&&e===o)return e;if(e===o)break}while(e=to(e))}return null}var Bn=/\s+/g;function G(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(Bn," ").replace(" "+t+" "," ");e.className=(n+(o?" "+t:"")).replace(Bn," ")}}function y(e,t,o){var n=e&&e.style;if(n){if(o===void 0)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),t===void 0?o:o[t];!(t in n)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),n[t]=o+(typeof o=="string"?"":"px")}}function Oe(e,t){var o="";if(typeof e=="string")o=e;else do{var n=y(e,"transform");n&&n!=="none"&&(o=n+" "+o)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(o)}function no(e,t,o){if(e){var n=e.getElementsByTagName(t),a=0,i=n.length;if(o)for(;a<i;a++)o(n[a],a);return n}return[]}function ae(){var e=document.scrollingElement;return e||document.documentElement}function M(e,t,o,n,a){if(!(!e.getBoundingClientRect&&e!==window)){var i,r,l,s,d,c,u;if(e!==window&&e.parentNode&&e!==ae()?(i=e.getBoundingClientRect(),r=i.top,l=i.left,s=i.bottom,d=i.right,c=i.height,u=i.width):(r=0,l=0,s=window.innerHeight,d=window.innerWidth,c=window.innerHeight,u=window.innerWidth),(t||o)&&e!==window&&(a=a||e.parentNode,!fe))do if(a&&a.getBoundingClientRect&&(y(a,"transform")!=="none"||o&&y(a,"position")!=="static")){var m=a.getBoundingClientRect();r-=m.top+parseInt(y(a,"border-top-width")),l-=m.left+parseInt(y(a,"border-left-width")),s=r+i.height,d=l+i.width;break}while(a=a.parentNode);if(n&&e!==window){var f=Oe(a||e),p=f&&f.a,g=f&&f.d;f&&(r/=g,l/=p,u/=p,c/=g,s=r+c,d=l+u)}return{top:r,left:l,bottom:s,right:d,width:u,height:c}}}function Tn(e,t,o){for(var n=be(e,!0),a=M(e)[t];n;){var i=M(n)[o],r=void 0;if(r=a>=i,!r)return n;if(n===ae())break;n=be(n,!1)}return!1}function Re(e,t,o,n){for(var a=0,i=0,r=e.children;i<r.length;){if(r[i].style.display!=="none"&&r[i]!==b.ghost&&(n||r[i]!==b.dragged)&&te(r[i],o.draggable,e,!1)){if(a===t)return r[i];a++}i++}return null}function vn(e,t){for(var o=e.lastElementChild;o&&(o===b.ghost||y(o,"display")==="none"||t&&!xt(o,t));)o=o.previousElementSibling;return o||null}function J(e,t){var o=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==b.clone&&(!t||xt(e,t))&&o++;return o}function An(e){var t=0,o=0,n=ae();if(e)do{var a=Oe(e),i=a.a,r=a.d;t+=e.scrollLeft*i,o+=e.scrollTop*r}while(e!==n&&(e=e.parentNode));return[t,o]}function ba(e,t){for(var o in e)if(e.hasOwnProperty(o)){for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[o][n])return Number(o)}return-1}function be(e,t){if(!e||!e.getBoundingClientRect)return ae();var o=e,n=!1;do if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var a=y(o);if(o.clientWidth<o.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||o.clientHeight<o.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!o.getBoundingClientRect||o===document.body)return ae();if(n||t)return o;n=!0}}while(o=o.parentNode);return ae()}function ya(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function qt(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Ge;function oo(e,t){return function(){if(!Ge){var o=arguments,n=this;o.length===1?e.call(n,o[0]):e.apply(n,o),Ge=setTimeout(function(){Ge=void 0},t)}}}function va(){clearTimeout(Ge),Ge=void 0}function ao(e,t,o){e.scrollLeft+=t,e.scrollTop+=o}function io(e){var t=window.Polymer,o=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):o?o(e).clone(!0)[0]:e.cloneNode(!0)}function ro(e,t,o){var n={};return Array.from(e.children).forEach(function(a){var i,r,l,s;if(!(!te(a,t.draggable,e,!1)||a.animated||a===o)){var d=M(a);n.left=Math.min((i=n.left)!==null&&i!==void 0?i:1/0,d.left),n.top=Math.min((r=n.top)!==null&&r!==void 0?r:1/0,d.top),n.right=Math.max((l=n.right)!==null&&l!==void 0?l:-1/0,d.right),n.bottom=Math.max((s=n.bottom)!==null&&s!==void 0?s:-1/0,d.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var q="Sortable"+new Date().getTime();function Ea(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(a){if(!(y(a,"display")==="none"||a===b.ghost)){e.push({target:a,rect:M(a)});var i=ie({},e[e.length-1].rect);if(a.thisAnimationDuration){var r=Oe(a,!0);r&&(i.top-=r.f,i.left-=r.e)}a.fromRect=i}})}},addAnimationState:function(n){e.push(n)},removeAnimationState:function(n){e.splice(ba(e,{target:n}),1)},animateAll:function(n){var a=this;if(!this.options.animation){clearTimeout(t),typeof n=="function"&&n();return}var i=!1,r=0;e.forEach(function(l){var s=0,d=l.target,c=d.fromRect,u=M(d),m=d.prevFromRect,f=d.prevToRect,p=l.rect,g=Oe(d,!0);g&&(u.top-=g.f,u.left-=g.e),d.toRect=u,d.thisAnimationDuration&&qt(m,u)&&!qt(c,u)&&(p.top-u.top)/(p.left-u.left)===(c.top-u.top)/(c.left-u.left)&&(s=Da(p,m,f,a.options)),qt(u,c)||(d.prevFromRect=c,d.prevToRect=u,s||(s=a.options.animation),a.animate(d,p,u,s)),s&&(i=!0,r=Math.max(r,s),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},s),d.thisAnimationDuration=s)}),clearTimeout(t),i?t=setTimeout(function(){typeof n=="function"&&n()},r):typeof n=="function"&&n(),e=[]},animate:function(n,a,i,r){if(r){y(n,"transition",""),y(n,"transform","");var l=Oe(this.el),s=l&&l.a,d=l&&l.d,c=(a.left-i.left)/(s||1),u=(a.top-i.top)/(d||1);n.animatingX=!!c,n.animatingY=!!u,y(n,"transform","translate3d("+c+"px,"+u+"px,0)"),this.forRepaintDummy=wa(n),y(n,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),y(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){y(n,"transition",""),y(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},r)}}}}function wa(e){return e.offsetWidth}function Da(e,t,o,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))*n.animation}var Te=[],Wt={initializeByDefault:!0},at={mount:function(t){for(var o in Wt)Wt.hasOwnProperty(o)&&!(o in t)&&(t[o]=Wt[o]);Te.forEach(function(n){if(n.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Te.push(t)},pluginEvent:function(t,o,n){var a=this;this.eventCanceled=!1,n.cancel=function(){a.eventCanceled=!0};var i=t+"Global";Te.forEach(function(r){o[r.pluginName]&&(o[r.pluginName][i]&&o[r.pluginName][i](ie({sortable:o},n)),o.options[r.pluginName]&&o[r.pluginName][t]&&o[r.pluginName][t](ie({sortable:o},n)))})},initializePlugins:function(t,o,n,a){Te.forEach(function(l){var s=l.pluginName;if(!(!t.options[s]&&!l.initializeByDefault)){var d=new l(t,o,t.options);d.sortable=t,d.options=t.options,t[s]=d,ue(n,d.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var r=this.modifyOption(t,i,t.options[i]);typeof r<"u"&&(t.options[i]=r)}},getEventProperties:function(t,o){var n={};return Te.forEach(function(a){typeof a.eventProperties=="function"&&ue(n,a.eventProperties.call(o[a.pluginName],t))}),n},modifyOption:function(t,o,n){var a;return Te.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[o]=="function"&&(a=i.optionListeners[o].call(t[i.pluginName],n))}),a}};function Ca(e){var t=e.sortable,o=e.rootEl,n=e.name,a=e.targetEl,i=e.cloneEl,r=e.toEl,l=e.fromEl,s=e.oldIndex,d=e.newIndex,c=e.oldDraggableIndex,u=e.newDraggableIndex,m=e.originalEvent,f=e.putSortable,p=e.extraEventProperties;if(t=t||o&&o[q],!!t){var g,L=t.options,B="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!fe&&!ot?g=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(g=document.createEvent("Event"),g.initEvent(n,!0,!0)),g.to=r||o,g.from=l||o,g.item=a||o,g.clone=i,g.oldIndex=s,g.newIndex=d,g.oldDraggableIndex=c,g.newDraggableIndex=u,g.originalEvent=m,g.pullMode=f?f.lastPutMode:void 0;var k=ie(ie({},p),at.getEventProperties(n,t));for(var S in k)g[S]=k[S];o&&o.dispatchEvent(g),L[B]&&L[B].call(t,g)}}var La=["evt"],j=function(t,o){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=n.evt,i=ha(n,La);at.pluginEvent.bind(b)(t,o,ie({dragEl:h,parentEl:N,ghostEl:v,rootEl:T,nextEl:Ie,lastDownEl:Et,cloneEl:A,cloneHidden:he,dragStarted:Ye,putSortable:$,activeSortable:b.active,originalEvent:a,oldIndex:Ne,oldDraggableIndex:Ve,newIndex:V,newDraggableIndex:pe,hideGhostForTarget:uo,unhideGhostForTarget:mo,cloneNowHidden:function(){he=!0},cloneNowShown:function(){he=!1},dispatchSortableEvent:function(l){U({sortable:o,name:l,originalEvent:a})}},i))};function U(e){Ca(ie({putSortable:$,cloneEl:A,targetEl:h,rootEl:T,oldIndex:Ne,oldDraggableIndex:Ve,newIndex:V,newDraggableIndex:pe},e))}var h,N,v,T,Ie,Et,A,he,Ne,V,Ve,pe,ft,$,_e=!1,_t=!1,Nt=[],Ce,ee,Gt,Vt,xn,_n,Ye,Ae,Ke,Je=!1,pt=!1,wt,H,Kt=[],ln=!1,Ot=[],zt=typeof document<"u",ht=yn,Nn=ot||fe?"cssFloat":"float",Ia=zt&&!Zn&&!yn&&"draggable"in document.createElement("div"),lo=(function(){if(zt){if(fe)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),so=function(t,o){var n=y(t),a=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=Re(t,0,o),r=Re(t,1,o),l=i&&y(i),s=r&&y(r),d=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+M(i).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+M(r).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&l.float&&l.float!=="none"){var u=l.float==="left"?"left":"right";return r&&(s.clear==="both"||s.clear===u)?"vertical":"horizontal"}return i&&(l.display==="block"||l.display==="flex"||l.display==="table"||l.display==="grid"||d>=a&&n[Nn]==="none"||r&&n[Nn]==="none"&&d+c>a)?"vertical":"horizontal"},ka=function(t,o,n){var a=n?t.left:t.top,i=n?t.right:t.bottom,r=n?t.width:t.height,l=n?o.left:o.top,s=n?o.right:o.bottom,d=n?o.width:o.height;return a===l||i===s||a+r/2===l+d/2},Sa=function(t,o){var n;return Nt.some(function(a){var i=a[q].options.emptyInsertThreshold;if(!(!i||vn(a))){var r=M(a),l=t>=r.left-i&&t<=r.right+i,s=o>=r.top-i&&o<=r.bottom+i;if(l&&s)return n=a}}),n},co=function(t){function o(i,r){return function(l,s,d,c){var u=l.options.group.name&&s.options.group.name&&l.options.group.name===s.options.group.name;if(i==null&&(r||u))return!0;if(i==null||i===!1)return!1;if(r&&i==="clone")return i;if(typeof i=="function")return o(i(l,s,d,c),r)(l,s,d,c);var m=(r?l:s).options.group.name;return i===!0||typeof i=="string"&&i===m||i.join&&i.indexOf(m)>-1}}var n={},a=t.group;(!a||vt(a)!="object")&&(a={name:a}),n.name=a.name,n.checkPull=o(a.pull,!0),n.checkPut=o(a.put),n.revertClone=a.revertClone,t.group=n},uo=function(){!lo&&v&&y(v,"display","none")},mo=function(){!lo&&v&&y(v,"display","")};zt&&!Zn&&document.addEventListener("click",function(e){if(_t)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),_t=!1,!1},!0);var Le=function(t){if(h){t=t.touches?t.touches[0]:t;var o=Sa(t.clientX,t.clientY);if(o){var n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=t[a]);n.target=n.rootEl=o,n.preventDefault=void 0,n.stopPropagation=void 0,o[q]._onDragOver(n)}}},Ba=function(t){h&&h.parentNode[q]._isOutsideThisEl(t.target)};function b(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=ue({},t),e[q]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return so(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,l){r.setData("Text",l.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:b.supportPointer!==!1&&"PointerEvent"in window&&(!We||yn),emptyInsertThreshold:5};at.initializePlugins(this,e,o);for(var n in o)!(n in t)&&(t[n]=o[n]);co(t);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=t.forceFallback?!1:Ia,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?D(e,"pointerdown",this._onTapStart):(D(e,"mousedown",this._onTapStart),D(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(D(e,"dragover",this),D(e,"dragenter",this)),Nt.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),ue(this,Ea())}b.prototype={constructor:b,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Ae=null)},_getDirection:function(t,o){return typeof this.options.direction=="function"?this.options.direction.call(this,t,o,h):this.options.direction},_onTapStart:function(t){if(t.cancelable){var o=this,n=this.el,a=this.options,i=a.preventOnFilter,r=t.type,l=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,s=(l||t).target,d=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,c=a.filter;if(Ma(n),!h&&!(/mousedown|pointerdown/.test(r)&&t.button!==0||a.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&We&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=te(s,a.draggable,n,!1),!(s&&s.animated)&&Et!==s)){if(Ne=J(s),Ve=J(s,a.draggable),typeof c=="function"){if(c.call(this,t,s,this)){U({sortable:o,rootEl:d,name:"filter",targetEl:s,toEl:n,fromEl:n}),j("filter",o,{evt:t}),i&&t.preventDefault();return}}else if(c&&(c=c.split(",").some(function(u){if(u=te(d,u.trim(),n,!1),u)return U({sortable:o,rootEl:u,name:"filter",targetEl:s,fromEl:n,toEl:n}),j("filter",o,{evt:t}),!0}),c)){i&&t.preventDefault();return}a.handle&&!te(d,a.handle,n,!1)||this._prepareDragStart(t,l,s)}}},_prepareDragStart:function(t,o,n){var a=this,i=a.el,r=a.options,l=i.ownerDocument,s;if(n&&!h&&n.parentNode===i){var d=M(n);if(T=i,h=n,N=h.parentNode,Ie=h.nextSibling,Et=n,ft=r.group,b.dragged=h,Ce={target:h,clientX:(o||t).clientX,clientY:(o||t).clientY},xn=Ce.clientX-d.left,_n=Ce.clientY-d.top,this._lastX=(o||t).clientX,this._lastY=(o||t).clientY,h.style["will-change"]="all",s=function(){if(j("delayEnded",a,{evt:t}),b.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!Sn&&a.nativeDraggable&&(h.draggable=!0),a._triggerDragStart(t,o),U({sortable:a,name:"choose",originalEvent:t}),G(h,r.chosenClass,!0)},r.ignore.split(",").forEach(function(c){no(h,c.trim(),Jt)}),D(l,"dragover",Le),D(l,"mousemove",Le),D(l,"touchmove",Le),r.supportPointer?(D(l,"pointerup",a._onDrop),!this.nativeDraggable&&D(l,"pointercancel",a._onDrop)):(D(l,"mouseup",a._onDrop),D(l,"touchend",a._onDrop),D(l,"touchcancel",a._onDrop)),Sn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,h.draggable=!0),j("delayStart",this,{evt:t}),r.delay&&(!r.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(ot||fe))){if(b.eventCanceled){this._onDrop();return}r.supportPointer?(D(l,"pointerup",a._disableDelayedDrag),D(l,"pointercancel",a._disableDelayedDrag)):(D(l,"mouseup",a._disableDelayedDrag),D(l,"touchend",a._disableDelayedDrag),D(l,"touchcancel",a._disableDelayedDrag)),D(l,"mousemove",a._delayedDragTouchMoveHandler),D(l,"touchmove",a._delayedDragTouchMoveHandler),r.supportPointer&&D(l,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(s,r.delay)}else s()}},_delayedDragTouchMoveHandler:function(t){var o=t.touches?t.touches[0]:t;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){h&&Jt(h),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;w(t,"mouseup",this._disableDelayedDrag),w(t,"touchend",this._disableDelayedDrag),w(t,"touchcancel",this._disableDelayedDrag),w(t,"pointerup",this._disableDelayedDrag),w(t,"pointercancel",this._disableDelayedDrag),w(t,"mousemove",this._delayedDragTouchMoveHandler),w(t,"touchmove",this._delayedDragTouchMoveHandler),w(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,o){o=o||t.pointerType=="touch"&&t,!this.nativeDraggable||o?this.options.supportPointer?D(document,"pointermove",this._onTouchMove):o?D(document,"touchmove",this._onTouchMove):D(document,"mousemove",this._onTouchMove):(D(h,"dragend",this),D(T,"dragstart",this._onDragStart));try{document.selection?Dt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,o){if(_e=!1,T&&h){j("dragStarted",this,{evt:o}),this.nativeDraggable&&D(document,"dragover",Ba);var n=this.options;!t&&G(h,n.dragClass,!1),G(h,n.ghostClass,!0),b.active=this,t&&this._appendGhost(),U({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(ee){this._lastX=ee.clientX,this._lastY=ee.clientY,uo();for(var t=document.elementFromPoint(ee.clientX,ee.clientY),o=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ee.clientX,ee.clientY),t!==o);)o=t;if(h.parentNode[q]._isOutsideThisEl(t),o)do{if(o[q]){var n=void 0;if(n=o[q]._onDragOver({clientX:ee.clientX,clientY:ee.clientY,target:t,rootEl:o}),n&&!this.options.dragoverBubble)break}t=o}while(o=to(o));mo()}},_onTouchMove:function(t){if(Ce){var o=this.options,n=o.fallbackTolerance,a=o.fallbackOffset,i=t.touches?t.touches[0]:t,r=v&&Oe(v,!0),l=v&&r&&r.a,s=v&&r&&r.d,d=ht&&H&&An(H),c=(i.clientX-Ce.clientX+a.x)/(l||1)+(d?d[0]-Kt[0]:0)/(l||1),u=(i.clientY-Ce.clientY+a.y)/(s||1)+(d?d[1]-Kt[1]:0)/(s||1);if(!b.active&&!_e){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(v){r?(r.e+=c-(Gt||0),r.f+=u-(Vt||0)):r={a:1,b:0,c:0,d:1,e:c,f:u};var m="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");y(v,"webkitTransform",m),y(v,"mozTransform",m),y(v,"msTransform",m),y(v,"transform",m),Gt=c,Vt=u,ee=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!v){var t=this.options.fallbackOnBody?document.body:T,o=M(h,!0,ht,!0,t),n=this.options;if(ht){for(H=t;y(H,"position")==="static"&&y(H,"transform")==="none"&&H!==document;)H=H.parentNode;H!==document.body&&H!==document.documentElement?(H===document&&(H=ae()),o.top+=H.scrollTop,o.left+=H.scrollLeft):H=ae(),Kt=An(H)}v=h.cloneNode(!0),G(v,n.ghostClass,!1),G(v,n.fallbackClass,!0),G(v,n.dragClass,!0),y(v,"transition",""),y(v,"transform",""),y(v,"box-sizing","border-box"),y(v,"margin",0),y(v,"top",o.top),y(v,"left",o.left),y(v,"width",o.width),y(v,"height",o.height),y(v,"opacity","0.8"),y(v,"position",ht?"absolute":"fixed"),y(v,"zIndex","100000"),y(v,"pointerEvents","none"),b.ghost=v,t.appendChild(v),y(v,"transform-origin",xn/parseInt(v.style.width)*100+"% "+_n/parseInt(v.style.height)*100+"%")}},_onDragStart:function(t,o){var n=this,a=t.dataTransfer,i=n.options;if(j("dragStart",this,{evt:t}),b.eventCanceled){this._onDrop();return}j("setupClone",this),b.eventCanceled||(A=io(h),A.removeAttribute("id"),A.draggable=!1,A.style["will-change"]="",this._hideClone(),G(A,this.options.chosenClass,!1),b.clone=A),n.cloneId=Dt(function(){j("clone",n),!b.eventCanceled&&(n.options.removeCloneOnHide||T.insertBefore(A,h),n._hideClone(),U({sortable:n,name:"clone"}))}),!o&&G(h,i.dragClass,!0),o?(_t=!0,n._loopId=setInterval(n._emulateDragOver,50)):(w(document,"mouseup",n._onDrop),w(document,"touchend",n._onDrop),w(document,"touchcancel",n._onDrop),a&&(a.effectAllowed="move",i.setData&&i.setData.call(n,a,h)),D(document,"drop",n),y(h,"transform","translateZ(0)")),_e=!0,n._dragStartId=Dt(n._dragStarted.bind(n,o,t)),D(document,"selectstart",n),Ye=!0,window.getSelection().removeAllRanges(),We&&y(document.body,"user-select","none")},_onDragOver:function(t){var o=this.el,n=t.target,a,i,r,l=this.options,s=l.group,d=b.active,c=ft===s,u=l.sort,m=$||d,f,p=this,g=!1;if(ln)return;function L(Be,it){j(Be,p,ie({evt:t,isOwner:c,axis:f?"vertical":"horizontal",revert:r,dragRect:a,targetRect:i,canSort:u,fromSortable:m,target:n,completed:k,onMove:function(rt,Cn){return gt(T,o,h,a,rt,M(rt),t,Cn)},changed:S},it))}function B(){L("dragOverAnimationCapture"),p.captureAnimationState(),p!==m&&m.captureAnimationState()}function k(Be){return L("dragOverCompleted",{insertion:Be}),Be&&(c?d._hideClone():d._showClone(p),p!==m&&(G(h,$?$.options.ghostClass:d.options.ghostClass,!1),G(h,l.ghostClass,!0)),$!==p&&p!==b.active?$=p:p===b.active&&$&&($=null),m===p&&(p._ignoreWhileAnimating=n),p.animateAll(function(){L("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(n===h&&!h.animated||n===o&&!n.animated)&&(Ae=null),!l.dragoverBubble&&!t.rootEl&&n!==document&&(h.parentNode[q]._isOutsideThisEl(t.target),!Be&&Le(t)),!l.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),g=!0}function S(){V=J(h),pe=J(h,l.draggable),U({sortable:p,name:"change",toEl:o,newIndex:V,newDraggableIndex:pe,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),n=te(n,l.draggable,o,!0),L("dragOver"),b.eventCanceled)return g;if(h.contains(t.target)||n.animated&&n.animatingX&&n.animatingY||p._ignoreWhileAnimating===n)return k(!1);if(_t=!1,d&&!l.disabled&&(c?u||(r=N!==T):$===this||(this.lastPutMode=ft.checkPull(this,d,h,t))&&s.checkPut(this,d,h,t))){if(f=this._getDirection(t,n)==="vertical",a=M(h),L("dragOverValid"),b.eventCanceled)return g;if(r)return N=T,B(),this._hideClone(),L("revert"),b.eventCanceled||(Ie?T.insertBefore(h,Ie):T.appendChild(h)),k(!0);var I=vn(o,l.draggable);if(!I||_a(t,f,this)&&!I.animated){if(I===h)return k(!1);if(I&&o===t.target&&(n=I),n&&(i=M(n)),gt(T,o,h,a,n,i,t,!!n)!==!1)return B(),I&&I.nextSibling?o.insertBefore(h,I.nextSibling):o.appendChild(h),N=o,S(),k(!0)}else if(I&&xa(t,f,this)){var E=Re(o,0,l,!0);if(E===h)return k(!1);if(n=E,i=M(n),gt(T,o,h,a,n,i,t,!1)!==!1)return B(),o.insertBefore(h,E),N=o,S(),k(!0)}else if(n.parentNode===o){i=M(n);var C=0,x,O=h.parentNode!==o,R=!ka(h.animated&&h.toRect||a,n.animated&&n.toRect||i,f),Ee=f?"top":"left",W=Tn(n,"top","top")||Tn(h,"top","top"),z=W?W.scrollTop:void 0;Ae!==n&&(x=i[Ee],Je=!1,pt=!R&&l.invertSwap||O),C=Na(t,n,i,f,R?1:l.swapThreshold,l.invertedSwapThreshold==null?l.swapThreshold:l.invertedSwapThreshold,pt,Ae===n);var F;if(C!==0){var Y=J(h);do Y-=C,F=N.children[Y];while(F&&(y(F,"display")==="none"||F===v))}if(C===0||F===n)return k(!1);Ae=n,Ke=C;var Z=n.nextElementSibling,_=!1;_=C===1;var le=gt(T,o,h,a,n,i,t,_);if(le!==!1)return(le===1||le===-1)&&(_=le===1),ln=!0,setTimeout(Aa,30),B(),_&&!Z?o.appendChild(h):n.parentNode.insertBefore(h,_?Z:n),W&&ao(W,0,z-W.scrollTop),N=h.parentNode,x!==void 0&&!pt&&(wt=Math.abs(x-M(n)[Ee])),S(),k(!0)}if(o.contains(h))return k(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){w(document,"mousemove",this._onTouchMove),w(document,"touchmove",this._onTouchMove),w(document,"pointermove",this._onTouchMove),w(document,"dragover",Le),w(document,"mousemove",Le),w(document,"touchmove",Le)},_offUpEvents:function(){var t=this.el.ownerDocument;w(t,"mouseup",this._onDrop),w(t,"touchend",this._onDrop),w(t,"pointerup",this._onDrop),w(t,"pointercancel",this._onDrop),w(t,"touchcancel",this._onDrop),w(document,"selectstart",this)},_onDrop:function(t){var o=this.el,n=this.options;if(V=J(h),pe=J(h,n.draggable),j("drop",this,{evt:t}),N=h&&h.parentNode,V=J(h),pe=J(h,n.draggable),b.eventCanceled){this._nulling();return}_e=!1,pt=!1,Je=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),sn(this.cloneId),sn(this._dragStartId),this.nativeDraggable&&(w(document,"drop",this),w(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),We&&y(document.body,"user-select",""),y(h,"transform",""),t&&(Ye&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),v&&v.parentNode&&v.parentNode.removeChild(v),(T===N||$&&$.lastPutMode!=="clone")&&A&&A.parentNode&&A.parentNode.removeChild(A),h&&(this.nativeDraggable&&w(h,"dragend",this),Jt(h),h.style["will-change"]="",Ye&&!_e&&G(h,$?$.options.ghostClass:this.options.ghostClass,!1),G(h,this.options.chosenClass,!1),U({sortable:this,name:"unchoose",toEl:N,newIndex:null,newDraggableIndex:null,originalEvent:t}),T!==N?(V>=0&&(U({rootEl:N,name:"add",toEl:N,fromEl:T,originalEvent:t}),U({sortable:this,name:"remove",toEl:N,originalEvent:t}),U({rootEl:N,name:"sort",toEl:N,fromEl:T,originalEvent:t}),U({sortable:this,name:"sort",toEl:N,originalEvent:t})),$&&$.save()):V!==Ne&&V>=0&&(U({sortable:this,name:"update",toEl:N,originalEvent:t}),U({sortable:this,name:"sort",toEl:N,originalEvent:t})),b.active&&((V==null||V===-1)&&(V=Ne,pe=Ve),U({sortable:this,name:"end",toEl:N,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){j("nulling",this),T=h=N=v=Ie=A=Et=he=Ce=ee=Ye=V=pe=Ne=Ve=Ae=Ke=$=ft=b.dragged=b.ghost=b.clone=b.active=null,Ot.forEach(function(t){t.checked=!0}),Ot.length=Gt=Vt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":h&&(this._onDragOver(t),Ta(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],o,n=this.el.children,a=0,i=n.length,r=this.options;a<i;a++)o=n[a],te(o,r.draggable,this.el,!1)&&t.push(o.getAttribute(r.dataIdAttr)||Pa(o));return t},sort:function(t,o){var n={},a=this.el;this.toArray().forEach(function(i,r){var l=a.children[r];te(l,this.options.draggable,a,!1)&&(n[i]=l)},this),o&&this.captureAnimationState(),t.forEach(function(i){n[i]&&(a.removeChild(n[i]),a.appendChild(n[i]))}),o&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,o){return te(t,o||this.options.draggable,this.el,!1)},option:function(t,o){var n=this.options;if(o===void 0)return n[t];var a=at.modifyOption(this,t,o);typeof a<"u"?n[t]=a:n[t]=o,t==="group"&&co(n)},destroy:function(){j("destroy",this);var t=this.el;t[q]=null,w(t,"mousedown",this._onTapStart),w(t,"touchstart",this._onTapStart),w(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(w(t,"dragover",this),w(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Nt.splice(Nt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!he){if(j("hideClone",this),b.eventCanceled)return;y(A,"display","none"),this.options.removeCloneOnHide&&A.parentNode&&A.parentNode.removeChild(A),he=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(he){if(j("showClone",this),b.eventCanceled)return;h.parentNode==T&&!this.options.group.revertClone?T.insertBefore(A,h):Ie?T.insertBefore(A,Ie):T.appendChild(A),this.options.group.revertClone&&this.animate(h,A),y(A,"display",""),he=!1}}};function Ta(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function gt(e,t,o,n,a,i,r,l){var s,d=e[q],c=d.options.onMove,u;return window.CustomEvent&&!fe&&!ot?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=t,s.from=e,s.dragged=o,s.draggedRect=n,s.related=a||t,s.relatedRect=i||M(t),s.willInsertAfter=l,s.originalEvent=r,e.dispatchEvent(s),c&&(u=c.call(d,s,r)),u}function Jt(e){e.draggable=!1}function Aa(){ln=!1}function xa(e,t,o){var n=M(Re(o.el,0,o.options,!0)),a=ro(o.el,o.options,v),i=10;return t?e.clientX<a.left-i||e.clientY<n.top&&e.clientX<n.right:e.clientY<a.top-i||e.clientY<n.bottom&&e.clientX<n.left}function _a(e,t,o){var n=M(vn(o.el,o.options.draggable)),a=ro(o.el,o.options,v),i=10;return t?e.clientX>a.right+i||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>a.bottom+i||e.clientX>n.right&&e.clientY>n.top}function Na(e,t,o,n,a,i,r,l){var s=n?e.clientY:e.clientX,d=n?o.height:o.width,c=n?o.top:o.left,u=n?o.bottom:o.right,m=!1;if(!r){if(l&&wt<d*a){if(!Je&&(Ke===1?s>c+d*i/2:s<u-d*i/2)&&(Je=!0),Je)m=!0;else if(Ke===1?s<c+wt:s>u-wt)return-Ke}else if(s>c+d*(1-a)/2&&s<u-d*(1-a)/2)return Oa(t)}return m=m||r,m&&(s<c+d*i/2||s>u-d*i/2)?s>c+d/2?1:-1:0}function Oa(e){return J(h)<J(e)?1:-1}function Pa(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,n=0;o--;)n+=t.charCodeAt(o);return n.toString(36)}function Ma(e){Ot.length=0;for(var t=e.getElementsByTagName("input"),o=t.length;o--;){var n=t[o];n.checked&&Ot.push(n)}}function Dt(e){return setTimeout(e,0)}function sn(e){return clearTimeout(e)}zt&&D(document,"touchmove",function(e){(b.active||_e)&&e.cancelable&&e.preventDefault()});b.utils={on:D,off:w,css:y,find:no,is:function(t,o){return!!te(t,o,t,!1)},extend:ya,throttle:oo,closest:te,toggleClass:G,clone:io,index:J,nextTick:Dt,cancelNextTick:sn,detectDirection:so,getChild:Re,expando:q};b.get=function(e){return e[q]};b.mount=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];t[0].constructor===Array&&(t=t[0]),t.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(b.utils=ie(ie({},b.utils),n.utils)),at.mount(n)})};b.create=function(e,t){return new b(e,t)};b.version=ga;var P=[],Ue,dn,cn=!1,Qt,Zt,Pt,Xe;function Ra(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(o){var n=o.originalEvent;this.sortable.nativeDraggable?D(document,"dragover",this._handleAutoScroll):this.options.supportPointer?D(document,"pointermove",this._handleFallbackAutoScroll):n.touches?D(document,"touchmove",this._handleFallbackAutoScroll):D(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var n=o.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?w(document,"dragover",this._handleAutoScroll):(w(document,"pointermove",this._handleFallbackAutoScroll),w(document,"touchmove",this._handleFallbackAutoScroll),w(document,"mousemove",this._handleFallbackAutoScroll)),On(),Ct(),va()},nulling:function(){Pt=dn=Ue=cn=Xe=Qt=Zt=null,P.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,n){var a=this,i=(o.touches?o.touches[0]:o).clientX,r=(o.touches?o.touches[0]:o).clientY,l=document.elementFromPoint(i,r);if(Pt=o,n||this.options.forceAutoScrollFallback||ot||fe||We){en(o,this.options,l,n);var s=be(l,!0);cn&&(!Xe||i!==Qt||r!==Zt)&&(Xe&&On(),Xe=setInterval(function(){var d=be(document.elementFromPoint(i,r),!0);d!==s&&(s=d,Ct()),en(o,a.options,d,n)},10),Qt=i,Zt=r)}else{if(!this.options.bubbleScroll||be(l,!0)===ae()){Ct();return}en(o,this.options,be(l,!1),!1)}}},ue(e,{pluginName:"scroll",initializeByDefault:!0})}function Ct(){P.forEach(function(e){clearInterval(e.pid)}),P=[]}function On(){clearInterval(Xe)}var en=oo(function(e,t,o,n){if(t.scroll){var a=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,r=t.scrollSensitivity,l=t.scrollSpeed,s=ae(),d=!1,c;dn!==o&&(dn=o,Ct(),Ue=t.scroll,c=t.scrollFn,Ue===!0&&(Ue=be(o,!0)));var u=0,m=Ue;do{var f=m,p=M(f),g=p.top,L=p.bottom,B=p.left,k=p.right,S=p.width,I=p.height,E=void 0,C=void 0,x=f.scrollWidth,O=f.scrollHeight,R=y(f),Ee=f.scrollLeft,W=f.scrollTop;f===s?(E=S<x&&(R.overflowX==="auto"||R.overflowX==="scroll"||R.overflowX==="visible"),C=I<O&&(R.overflowY==="auto"||R.overflowY==="scroll"||R.overflowY==="visible")):(E=S<x&&(R.overflowX==="auto"||R.overflowX==="scroll"),C=I<O&&(R.overflowY==="auto"||R.overflowY==="scroll"));var z=E&&(Math.abs(k-a)<=r&&Ee+S<x)-(Math.abs(B-a)<=r&&!!Ee),F=C&&(Math.abs(L-i)<=r&&W+I<O)-(Math.abs(g-i)<=r&&!!W);if(!P[u])for(var Y=0;Y<=u;Y++)P[Y]||(P[Y]={});(P[u].vx!=z||P[u].vy!=F||P[u].el!==f)&&(P[u].el=f,P[u].vx=z,P[u].vy=F,clearInterval(P[u].pid),(z!=0||F!=0)&&(d=!0,P[u].pid=setInterval((function(){n&&this.layer===0&&b.active._onTouchMove(Pt);var Z=P[this.layer].vy?P[this.layer].vy*l:0,_=P[this.layer].vx?P[this.layer].vx*l:0;typeof c=="function"&&c.call(b.dragged.parentNode[q],_,Z,e,Pt,P[this.layer].el)!=="continue"||ao(P[this.layer].el,_,Z)}).bind({layer:u}),24))),u++}while(t.bubbleScroll&&m!==s&&(m=be(m,!1)));cn=d}},30),fo=function(t){var o=t.originalEvent,n=t.putSortable,a=t.dragEl,i=t.activeSortable,r=t.dispatchSortableEvent,l=t.hideGhostForTarget,s=t.unhideGhostForTarget;if(o){var d=n||i;l();var c=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,u=document.elementFromPoint(c.clientX,c.clientY);s(),d&&!d.el.contains(u)&&(r("spill"),this.onSpill({dragEl:a,putSortable:n}))}};function En(){}En.prototype={startIndex:null,dragStart:function(t){var o=t.oldDraggableIndex;this.startIndex=o},onSpill:function(t){var o=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var a=Re(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(o,a):this.sortable.el.appendChild(o),this.sortable.animateAll(),n&&n.animateAll()},drop:fo};ue(En,{pluginName:"revertOnSpill"});function wn(){}wn.prototype={onSpill:function(t){var o=t.dragEl,n=t.putSortable,a=n||this.sortable;a.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),a.animateAll()},drop:fo};ue(wn,{pluginName:"removeOnSpill"});b.mount(new Ra);b.mount(wn,En);let un=[],Lt=null,Qe=null,Pe=0;function Fa(){$a(),za(),Ya()}function $a(){un.forEach(e=>e.destroy()),un=[],Lt&&(Lt.destroy(),Lt=null),po()}function Ha(){const e=document.getElementById("board-container");!e||Qe||(Qe=setInterval(()=>{if(!e)return;const t=e.getBoundingClientRect(),o=80,n=12;Pe>0&&(Pe<t.left+o&&e.scrollLeft>0?e.scrollLeft-=n:Pe>t.right-o&&e.scrollLeft<e.scrollWidth-e.clientWidth&&(e.scrollLeft+=n))},16))}function po(){Qe&&(clearInterval(Qe),Qe=null),Pe=0}function bt(e){e.touches&&e.touches[0]?Pe=e.touches[0].clientX:e.clientX&&(Pe=e.clientX)}function za(){document.querySelectorAll(".tasks:not(.hidden)").forEach(t=>{const o=new b(t,{group:{name:"tasks",pull:!0,put:!0},animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"task-ghost",chosenClass:"task-chosen",dragClass:"task-drag",draggable:".task",forceFallback:!0,fallbackClass:"task-fallback",fallbackOnBody:!0,fallbackTolerance:0,swapThreshold:.65,emptyInsertThreshold:20,direction:"vertical",onStart:function(n){document.body.classList.add("dragging"),Ha(),document.addEventListener("touchmove",bt,{passive:!0}),document.addEventListener("mousemove",bt,{passive:!0})},onEnd:async function(n){document.body.classList.remove("dragging"),po(),document.removeEventListener("touchmove",bt),document.removeEventListener("mousemove",bt),Ao();const{renderBoard:a}=await se(async()=>{const{renderBoard:i}=await Promise.resolve().then(()=>ce);return{renderBoard:i}},void 0,import.meta.url);a()}});un.push(o)})}function Ya(){const e=document.getElementById("board-container");e&&(Lt=new b(e,{animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"column-ghost",chosenClass:"column-chosen",dragClass:"column-drag",handle:".column-header",filter:"button:not(.column-drag-handle), a, input, select, textarea, [contenteditable]",preventOnFilter:!0,draggable:".task-column",scrollSensitivity:80,scrollSpeed:15,forceFallback:!1,fallbackOnBody:!0,onStart:function(t){document.body.classList.add("dragging-column")},onEnd:function(t){document.body.classList.remove("dragging-column"),Mo()}}))}const Ua=2,ho="kanbanNotificationBannerHidden";function go(){return localStorage.getItem(ho)==="true"}function Pn(e){localStorage.setItem(ho,e?"true":"false")}function bo(){const e=document.getElementById("notification-banner-visibility-toggle");e&&(e.checked=!go())}function Dn(){const e=Q(),t=new Date;return t.setHours(0,0,0,0),e.filter(o=>{if(o.column==="done")return!1;const n=(o.dueDate||"").toString().trim();if(!n)return!1;const a=new Date(n+"T00:00:00");if(Number.isNaN(a.getTime()))return!1;const i=a.getTime()-t.getTime();return Math.floor(i/(1e3*60*60*24))<=Ua}).map(o=>{const a=new Date(o.dueDate+"T00:00:00").getTime()-t.getTime(),i=Math.floor(a/(1e3*60*60*24));return{...o,daysUntilDue:i}}).sort((o,n)=>o.daysUntilDue-n.daysUntilDue)}function yo(e,t,o){const a=new Date(t+"T00:00:00").toLocaleDateString(o||void 0);if(e<0){const i=Math.abs(e);return{text:`Overdue by ${i} day${i===1?"":"s"} (${a})`,className:"overdue"}}else return e===0?{text:`Due today (${a})`,className:"overdue"}:e===1?{text:`Due tomorrow (${a})`,className:"due-soon"}:{text:`Due in ${e} days (${a})`,className:"due-soon"}}function Xa(){const e=document.getElementById("notification-banner"),t=document.getElementById("notification-banner-list");if(!e||!t)return;const o=Dn(),n=K();if(o.length===0){e.classList.add("hidden");return}if(go()){e.classList.add("hidden");return}if(t.innerHTML="",o.slice(0,5).forEach(i=>{const r=document.createElement("div");r.classList.add("notification-banner-item"),r.setAttribute("role","button"),r.setAttribute("tabindex","0"),r.setAttribute("aria-label",`Open task: ${i.title}`);const l=document.createElement("span");l.classList.add("task-title");const s=typeof i.text=="string"?i.text:"";l.textContent=typeof i.title=="string"&&i.title.trim()?i.title:s;const d=yo(i.daysUntilDue,i.dueDate,n.locale),c=document.createElement("span");c.classList.add("due-date",d.className),c.textContent=d.text;const u=typeof i.priority=="string"?i.priority:"low",m=document.createElement("span");m.classList.add("priority-badge",`priority-${u}`),m.textContent=u,r.appendChild(l),r.appendChild(c),r.appendChild(m);const f=()=>qe(i.id);r.addEventListener("click",f),r.addEventListener("keydown",p=>{(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),f())}),t.appendChild(r)}),o.length>5){const i=document.createElement("div");i.classList.add("notification-banner-item","notification-more"),i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.textContent=`+${o.length-5} `,i.addEventListener("click",mn),i.addEventListener("keydown",r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),mn())}),t.appendChild(i)}e.classList.remove("hidden"),He()}function ja(){const e=document.getElementById("notifications-list");if(!e)return;const t=Dn(),o=K();if(e.innerHTML="",t.length===0){const n=document.createElement("div");n.classList.add("notifications-empty"),n.textContent="No tasks due within the next 2 days.",e.appendChild(n);return}t.forEach(n=>{const a=document.createElement("div");a.classList.add("notification-item"),a.setAttribute("role","button"),a.setAttribute("tabindex","0"),a.setAttribute("aria-label",`Open task: ${n.title}`);const i=document.createElement("div");i.classList.add("notification-item-content");const r=document.createElement("div");r.classList.add("notification-item-title");const l=typeof n.text=="string"?n.text:"";r.textContent=typeof n.title=="string"&&n.title.trim()?n.title:l;const s=document.createElement("div");s.classList.add("notification-item-meta");const d=yo(n.daysUntilDue,n.dueDate,o.locale),c=document.createElement("span");c.classList.add(d.className),c.textContent=d.text;const u=typeof n.priority=="string"?n.priority:"low",m=document.createElement("span");m.classList.add("notification-item-priority",`priority-${u}`),m.textContent=u,s.appendChild(c),s.appendChild(m),i.appendChild(r),i.appendChild(s);const f=document.createElement("span");f.classList.add("notification-item-arrow"),f.dataset.lucide="chevron-right",a.appendChild(i),a.appendChild(f);const p=()=>{It(),qe(n.id)};a.addEventListener("click",p),a.addEventListener("keydown",g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),p())}),e.appendChild(a)}),He()}function qa(){const e=document.getElementById("notification-badge");if(!e)return;const o=Dn().length;o===0?(e.classList.add("hidden"),e.textContent=""):(e.classList.remove("hidden"),e.textContent=o>99?"99+":String(o))}function mn(){bo(),ja(),document.getElementById("notifications-modal")?.classList.remove("hidden")}function It(){document.getElementById("notifications-modal")?.classList.add("hidden")}function Wa(){const e=document.getElementById("notifications-modal");return e&&!e.classList.contains("hidden")}function Ga(){document.getElementById("notification-banner-close-btn")?.addEventListener("click",()=>{Pn(!0),kt()});const t=document.getElementById("notification-banner-visibility-toggle");t?.addEventListener("change",()=>{Pn(!t.checked),kt()}),document.getElementById("notifications-btn")?.addEventListener("click",mn),document.getElementById("notifications-close-btn")?.addEventListener("click",It),document.querySelector("#notifications-modal .modal-backdrop")?.addEventListener("click",It),document.addEventListener("keydown",i=>{i.key==="Escape"&&Wa()&&It()}),kt(),bo()}function kt(){Xa(),qa()}let Mn=!1,vo="";function Eo(e){vo=(e||"").toString()}function Va(e,t,o){if(!t)return!0;const n=typeof e?.text=="string"?e.text:"",a=typeof e?.title=="string"&&e.title.trim()!==""?e.title:n,i=typeof e?.description=="string"?e.description:"",r=typeof e?.priority=="string"?e.priority:"";if(a.toLowerCase().includes(t)||i.toLowerCase().includes(t)||r.toLowerCase().includes(t))return!0;const l=Array.isArray(e?.labels)?e.labels:[];for(const s of l){const d=o.get(s);if(d&&d.includes(t))return!0}return!1}function ke(e=null){document.querySelectorAll(".column-menu").forEach(t=>{e&&t===e||t.classList.add("hidden")}),document.querySelectorAll(".column-submenu").forEach(t=>{t.classList.add("hidden")})}function Ka(e){return[...e].sort((t,o)=>{const n=(t.dueDate||"").toString().trim(),a=(o.dueDate||"").toString().trim();return!n&&!a?0:n?a?n.localeCompare(a):-1:1})}function Ja(e){const t={high:0,medium:1,low:2};return[...e].sort((o,n)=>{const a=t[o.priority]??2,i=t[n.priority]??2;return a-i})}function Rn(e,t){const o=Q(),n=o.filter(s=>s.column===e),a=o.filter(s=>s.column!==e),r=(t==="dueDate"?Ka(n):Ja(n)).map((s,d)=>({...s,order:d+1})),l=[...a,...r];ve(l),me()}function Qa(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=o.includes("T")?o:`${o}T00:00:00`,a=new Date(n);return Number.isNaN(a.getTime())?o:a.toLocaleDateString(t||void 0)}function Za(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=new Date(o);return Number.isNaN(n.getTime())?o:n.toLocaleString(t||void 0)}function ei(e){const t=(e?.creationDate||"").toString().trim();if(!t)return"";const o=new Date(t);if(Number.isNaN(o.getTime()))return"";const n=1440*60*1e3,a=Math.max(0,Math.floor((Date.now()-o.getTime())/n));if(a<30)return`${a}d`;const i=Math.floor(a/365);let r=a%365;const l=Math.floor(r/30);r=r%30;const s=[];return i>=1&&s.push(`${i}y`),l>=1&&s.push(`${l}M`),s.push(`${r}d`),s.join(" ")}function ti(e,t){const o=document.createElement("li");o.classList.add("task"),o.draggable=!0,o.dataset.taskId=e.id,o.setAttribute("role","listitem"),o.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const n=document.createElement("div");n.classList.add("task-labels"),n.setAttribute("role","list"),n.setAttribute("aria-label","Task labels");const a=re();e.labels&&e.labels.length>0&&e.labels.forEach(E=>{const C=a.find(x=>x.id===E);if(C){const x=document.createElement("span");x.classList.add("task-label"),x.setAttribute("role","listitem"),x.style.backgroundColor=C.color,x.textContent=C.name,n.appendChild(x)}});const i=document.createElement("div");i.classList.add("task-header");const r=document.createElement("div");r.classList.add("task-title"),r.setAttribute("role","button"),r.setAttribute("tabindex","0");const l=typeof e.text=="string"?e.text:"";r.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:l,r.addEventListener("click",()=>qe(e.id)),r.addEventListener("keydown",E=>{(E.key==="Enter"||E.key===" ")&&(E.preventDefault(),qe(e.id))});const s=document.createElement("div");s.classList.add("task-actions");const d=document.createElement("button");d.classList.add("delete-task-btn"),d.setAttribute("aria-label","Delete task"),d.type="button";const c=document.createElement("span");c.dataset.lucide="trash-2",c.setAttribute("aria-hidden","true"),d.appendChild(c),d.addEventListener("click",async E=>{E.stopPropagation(),await Se({title:"Delete Task",message:"Are you sure you want to delete this task?",confirmText:"Delete"})&&Bo(e.id)&&me()}),s.appendChild(d),i.appendChild(r),i.appendChild(s);const u=typeof e.description=="string"?e.description.trim():"",m=document.createElement("div");m.classList.add("task-description"),m.textContent=u,m.style.display=u?"block":"none",m.addEventListener("click",()=>qe(e.id));const f=document.createElement("div");f.classList.add("task-meta");const p=t?.showPriority!==!1,g=t?.showDueDate!==!1;if(p){const E=typeof e.priority=="string"?e.priority:"medium",C=document.createElement("span");C.classList.add("task-priority",`priority-${E}`),C.textContent=E,C.setAttribute("aria-label",`Priority: ${E}`),f.appendChild(C)}if(g){const E=typeof e.dueDate=="string"?e.dueDate.trim():"",C=document.createElement("span");C.classList.add("task-date"),E?C.textContent="Due "+Qa(E,t?.locale):C.textContent="No due date",f.appendChild(C)}o.appendChild(i),o.appendChild(m),o.appendChild(n),f.childNodes.length>0&&o.appendChild(f);const L=t?.showChangeDate!==!1,B=t?.showAge!==!1,k=t?.locale,S=document.createElement("div");if(S.classList.add("task-footer"),L){const E=document.createElement("span");E.classList.add("task-change-date");const C=Za(e?.changeDate,k);E.textContent=C?`Updated ${C}`:"",S.appendChild(E)}if(B){const E=document.createElement("span");E.classList.add("task-age");const C=ei(e);E.textContent=C?`Age ${C}`:"",S.appendChild(E)}return Array.from(S.childNodes).some(E=>(E.textContent||"").trim()!=="")&&o.appendChild(S),o}function ni(e){const t=document.createElement("article");t.classList.add("task-column"),t.dataset.column=e.id,t.draggable=!1,t.setAttribute("aria-labelledby",`column-title-${e.id}`);const o=e?.collapsed===!0;o&&t.classList.add("is-collapsed"),e?.color&&t.style.setProperty("--column-accent",e.color);const n=document.createElement("button");n.classList.add("column-collapse-btn"),n.type="button",n.setAttribute("aria-label",o?`Expand ${e.name} column`:`Collapse ${e.name} column`),n.title=o?"Expand column":"Collapse column";const a=document.createElement("span");a.dataset.lucide=o?"chevron-right":"chevrons-right-left",a.setAttribute("aria-hidden","true"),n.appendChild(a),n.addEventListener("click",_=>{_.stopPropagation(),No(e.id)&&me()});const i=document.createElement("button");i.classList.add("column-drag-handle"),i.type="button",i.setAttribute("aria-label","Drag to reorder column");const r=document.createElement("span");r.dataset.lucide="grip-vertical",r.setAttribute("aria-hidden","true"),i.appendChild(r),i.title="Drag to reorder";const l=document.createElement("header");l.classList.add("column-header");const s=document.createElement("h2");s.id=`column-title-${e.id}`,s.textContent=e.name;const d=document.createElement("span");d.classList.add("task-counter"),d.dataset.columnId=e.id,d.textContent="0",d.setAttribute("aria-label","Task count");const c=document.createElement("div");c.classList.add("column-actions");const u=document.createElement("button");u.classList.add("add-task-btn-icon"),u.type="button",u.setAttribute("aria-label",`Add task to ${e.name}`);const m=document.createElement("span");m.dataset.lucide="plus",m.setAttribute("aria-hidden","true"),u.appendChild(m),u.title="Add task",u.addEventListener("click",()=>aa(e.id));const f=document.createElement("div");f.classList.add("column-menu-wrapper");const p=document.createElement("button");p.classList.add("column-menu-btn"),p.type="button",p.setAttribute("aria-haspopup","menu"),p.setAttribute("aria-expanded","false"),p.setAttribute("aria-label",`${e.name} column menu`);const g=document.createElement("span");g.dataset.lucide="ellipsis-vertical",g.setAttribute("aria-hidden","true"),p.appendChild(g),p.title="Column menu";const L=document.createElement("div");L.classList.add("column-menu","hidden"),L.setAttribute("role","menu");const B=document.createElement("button");B.classList.add("column-menu-item"),B.type="button",B.setAttribute("role","menuitem");const k=document.createElement("span");k.dataset.lucide="pencil",k.setAttribute("aria-hidden","true"),B.appendChild(k);const S=document.createTextNode(" Edit");B.appendChild(S),B.title="Edit column",B.addEventListener("click",_=>{_.stopPropagation(),ke(),ra(e.id)});const I=document.createElement("button");I.classList.add("column-menu-item","danger"),I.type="button",I.setAttribute("role","menuitem");const E=document.createElement("span");E.dataset.lucide="trash-2",E.setAttribute("aria-hidden","true"),I.appendChild(E);const C=document.createTextNode(" Delete");I.appendChild(C),I.title="Delete column",I.addEventListener("click",_=>{_.stopPropagation(),ke(),(async()=>{if(e.id==="done"){await ge({title:"Cannot Delete Column",message:"The Done column is permanent and cannot be deleted."});return}if(oe().length<=1){await ge({title:"Cannot Delete Column",message:"Cannot delete the last column."});return}const it=Q().filter(Do=>Do.column===e.id),Yt=e?.name?`"${e.name}"`:"this column",rt=it.length>0?`Delete ${Yt}? This will also delete ${it.length} task(s).`:`Delete ${Yt}?`;await Se({title:"Delete Column",message:rt,confirmText:"Delete"})&&Po(e.id)&&me()})()});const x=document.createElement("div");x.classList.add("column-menu-submenu-wrapper");const O=document.createElement("button");O.classList.add("column-menu-item","has-submenu"),O.type="button",O.setAttribute("role","menuitem"),O.setAttribute("aria-haspopup","menu"),O.setAttribute("aria-expanded","false");const R=document.createElement("span");R.dataset.lucide="arrow-up-down",R.setAttribute("aria-hidden","true"),O.appendChild(R);const Ee=document.createTextNode(" Sort");O.appendChild(Ee);const W=document.createElement("span");W.dataset.lucide="chevron-left",W.classList.add("submenu-chevron"),W.setAttribute("aria-hidden","true"),O.appendChild(W),O.title="Sort tasks in column";const z=document.createElement("div");z.classList.add("column-submenu","hidden"),z.setAttribute("role","menu");const F=document.createElement("button");F.classList.add("column-menu-item"),F.type="button",F.setAttribute("role","menuitem"),F.textContent="By Due Date",F.title="Sort by due date (earliest first)",F.addEventListener("click",_=>{_.stopPropagation(),ke(),Rn(e.id,"dueDate")});const Y=document.createElement("button");Y.classList.add("column-menu-item"),Y.type="button",Y.setAttribute("role","menuitem"),Y.textContent="By Priority",Y.title="Sort by priority (high to low)",Y.addEventListener("click",_=>{_.stopPropagation(),ke(),Rn(e.id,"priority")}),z.appendChild(F),z.appendChild(Y),O.addEventListener("click",_=>{_.stopPropagation();const le=!z.classList.contains("hidden");z.classList.toggle("hidden"),O.setAttribute("aria-expanded",le?"false":"true")}),x.addEventListener("mouseenter",()=>{z.classList.remove("hidden"),O.setAttribute("aria-expanded","true")}),x.addEventListener("mouseleave",()=>{z.classList.add("hidden"),O.setAttribute("aria-expanded","false")}),x.appendChild(O),x.appendChild(z),L.appendChild(B),L.appendChild(x),L.appendChild(I),p.addEventListener("click",_=>{_.stopPropagation();const le=!L.classList.contains("hidden");ke(),le?p.setAttribute("aria-expanded","false"):(L.classList.remove("hidden"),p.setAttribute("aria-expanded","true"))}),f.appendChild(p),f.appendChild(L),c.appendChild(u),c.appendChild(f),l.appendChild(n),l.appendChild(i),l.appendChild(s),l.appendChild(d),l.appendChild(c);const Z=document.createElement("ul");return Z.classList.add("tasks"),Z.setAttribute("role","list"),Z.setAttribute("aria-label",`Tasks in ${e.name}`),o&&(Z.classList.add("hidden"),c.classList.add("hidden"),d.classList.add("hidden")),t.appendChild(l),t.appendChild(Z),t}function oi(){const e=oe(),t=document.getElementById("task-column");t.innerHTML="",e.forEach(o=>{const n=document.createElement("option");n.value=o.id,n.textContent=o.name,t.appendChild(n)})}function me(){const e=oe(),t=Q(),o=re(),n=K(),a=new Map(o.map(d=>[d.id,(d.name||"").toString().trim().toLowerCase()])),i=(vo||"").toString().trim().toLowerCase(),r=i?t.filter(d=>Va(d,i,a)):t,l=document.getElementById("board-container");l.innerHTML="",[...e].sort((d,c)=>(d.order??0)-(c.order??0)).forEach(d=>{const c=ni(d);l.appendChild(c);const u=c.querySelector(".tasks"),m=c.querySelector(".task-counter"),f=r.filter(p=>p.column===d.id).sort((p,g)=>(p.order??0)-(g.order??0));f.forEach(p=>{u.appendChild(ti(p,n))}),m.textContent=f.length}),Fa(),oi(),He(),kt(),Mn||(Mn=!0,document.addEventListener("click",()=>ke()),document.addEventListener("keydown",d=>{d.key==="Escape"&&ke()}))}const ce=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:me,setBoardFilterQuery:Eo},Symbol.toStringTag,{value:"Module"})),wo="kanban-theme";function ai(){const e=localStorage.getItem(wo);return e==="light"||e==="dark"?e:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Fn(e){document.documentElement.dataset.theme=e}function $n(e){const t=document.getElementById("theme-toggle-btn");if(!t)return;const o=e==="dark"?"light":"dark",n=o==="dark"?"Dark":"Light",a=o==="dark"?"moon":"sun";t.setAttribute("aria-pressed",String(e==="dark"));const i=t.querySelector("span[data-lucide]");i&&i.setAttribute("data-lucide",a);const r=Array.from(t.childNodes).filter(l=>l.nodeType===Node.TEXT_NODE);for(const l of r)l.remove();t.appendChild(document.createTextNode(` ${n}`)),He()}function ii(){const e=ai();Fn(e),$n(e);const t=document.getElementById("theme-toggle-btn");t&&t.addEventListener("click",()=>{const n=(document.documentElement.dataset.theme==="dark"?"dark":"light")==="dark"?"light":"dark";Fn(n),localStorage.setItem(wo,n),$n(n)})}function ri(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function Hn(e){const t=$e(),o=hn();e.innerHTML="",t.forEach(n=>{const a=document.createElement("option");a.value=n.id,a.textContent=ri(n),e.appendChild(a)}),o&&(e.value=o)}function tn(){const e=document.getElementById("brand-text")||document.querySelector(".brand-text");e&&(e.textContent=Rt())}function li(){const e=document.getElementById("board-create-modal"),t=document.getElementById("board-create-name");!e||!t||(t.value="",e.classList.remove("hidden"),t.focus())}function yt(){const e=document.getElementById("board-create-modal");e&&e.classList.add("hidden")}function si(){pn();const e=document.getElementById("board-select");if(!e)return;Hn(e),tn(),document.addEventListener("kanban:open-board-create",()=>{li()}),e.addEventListener("change",()=>{const a=e.value;if(!a)return;St(a),tn(),me();const i=document.getElementById("board-controls-menu"),r=document.getElementById("desktop-menu-btn");i?.classList.remove("show"),r?.setAttribute("aria-expanded","false")});const t=document.getElementById("board-create-modal"),o=document.getElementById("board-create-form"),n=document.getElementById("cancel-board-create-btn");t&&(t.querySelector(".modal-backdrop")?.addEventListener("click",yt),t.addEventListener("keydown",i=>{i.key==="Escape"&&yt()})),n&&n.addEventListener("click",yt),o&&o.addEventListener("submit",async a=>{a.preventDefault();const i=document.getElementById("board-create-name"),r=(i?.value||"").trim();if(!r){await ge({title:"Error",message:"Board name cannot be empty."}),i?.focus();return}const l=zn(r);St(l.id),Hn(e),tn(),me(),yt(),document.dispatchEvent(new CustomEvent("kanban:boards-changed"))})}function di(e){const t=[];for(const o of e){if(typeof o!="string")continue;const n=o.trim();n&&(t.includes(n)||t.push(n))}return t}function ci(e){const t=typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US";return di([e,t,"en-US","en-GB","de-DE","fr-FR","es-ES","it-IT","pt-BR","ja-JP","zh-CN"])}function ui(){document.getElementById("settings-modal")?.classList.remove("hidden")}function nn(){document.getElementById("settings-modal")?.classList.add("hidden")}async function xe(e){Yn(e);const{renderBoard:t}=await se(async()=>{const{renderBoard:o}=await Promise.resolve().then(()=>ce);return{renderBoard:o}},void 0,import.meta.url);t()}function mi(){const e=document.getElementById("settings-btn"),t=document.getElementById("settings-close-btn"),o=document.querySelector("#settings-modal .modal-backdrop"),n=document.getElementById("settings-show-priority"),a=document.getElementById("settings-show-due-date"),i=document.getElementById("settings-show-age"),r=document.getElementById("settings-show-change-date"),l=document.getElementById("settings-locale"),s=document.getElementById("settings-default-priority");if(!e||!t||!n||!a||!i||!r||!l||!s)return;function d(){const c=K();n.checked=c.showPriority!==!1,a.checked=c.showDueDate!==!1,i.checked=c.showAge!==!1,r.checked=c.showChangeDate!==!1;const u=ci(c.locale);l.innerHTML="",u.forEach(m=>{const f=document.createElement("option");f.value=m,f.textContent=m,l.appendChild(f)}),l.value=c.locale,s.value=c.defaultPriority||"low"}e.addEventListener("click",()=>{d(),ui()}),t.addEventListener("click",nn),o?.addEventListener("click",nn),document.addEventListener("keydown",c=>{const u=document.getElementById("settings-modal");!u||u.classList.contains("hidden")||c.key==="Escape"&&nn()}),i.addEventListener("change",async()=>{const c=K();await xe({...c,showAge:!!i.checked})}),r.addEventListener("change",async()=>{const c=K();await xe({...c,showChangeDate:!!r.checked})}),n.addEventListener("change",async()=>{const c=K();await xe({...c,showPriority:!!n.checked})}),a.addEventListener("change",async()=>{const c=K();await xe({...c,showDueDate:!!a.checked})}),l.addEventListener("change",async()=>{const c=K();await xe({...c,locale:l.value})}),s.addEventListener("change",async()=>{const c=K();await xe({...c,defaultPriority:s.value})})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("app-version");e&&(e.textContent="v1.0.5",e.title="Version 1.0.5"),ii(),mi();const t=document.getElementById("board-search-input");t&&t.addEventListener("input",()=>{Eo(t.value),me()}),si(),ma(),Ga(),document.getElementById("export-btn").addEventListener("click",async()=>{await Se({title:"Export Board (Active Only)",message:`Export ONLY saves the current active board. It does NOT back up all boards.

To back up everything, export each board individually.

Continue with export?`,confirmText:"Export"})&&Qo()}),document.getElementById("import-btn").addEventListener("click",async()=>{await Se({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",a=>{const i=a.target.files[0];i&&ea(i),a.target.value=""});const o=document.getElementById("desktop-menu-btn"),n=document.getElementById("board-controls-menu");o&&n&&(o.addEventListener("click",a=>{a.stopPropagation();const i=o.getAttribute("aria-expanded")==="true";n.classList.toggle("show"),o.setAttribute("aria-expanded",String(!i)),document.querySelectorAll(".column-menu").forEach(r=>r.classList.add("hidden"))}),n.addEventListener("click",a=>{a.target.closest("select, option, input, textarea, label")||!a.target.closest('button, a, [role="menuitem"]')||(n.classList.remove("show"),o.setAttribute("aria-expanded","false"))}),document.addEventListener("click",a=>{!n.contains(a.target)&&!o.contains(a.target)&&(n.classList.remove("show"),o.setAttribute("aria-expanded","false"))})),me()});
