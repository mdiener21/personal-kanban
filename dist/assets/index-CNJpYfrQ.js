import{l as x,g as ze,s as F,a as N,b as Z,c as A,d as we,e as w,f as Ie,h as ct,i as ce,j as ut,k as ee,r as Y,m as De,n as qe,o as Ft,p as Ut,q as zt}from"./theme-i8PqWue1.js";import{S as mt}from"./vendor-pJTqpwCg.js";const qt=new Set(["urgent","high","medium","low","none"]);function ft(e){const t=(e||"").toString().trim().toLowerCase();return qt.has(t)?t:"none"}function pt(e){return(e||"").toString().trim()}function jt(e,t,o,n,s,i=[]){if(!e||e.trim()==="")return;const l=x(),a=l.filter(f=>f.column===s).slice().sort((f,m)=>(f.order??0)-(m.order??0)),r=new Map;a.forEach((f,m)=>{r.set(f.id,m+2)});const c=l.map(f=>{if(f.column!==s)return f;const m=r.get(f.id);return typeof m=="number"?{...f,order:m}:f}),d=new Date().toISOString(),u={id:ze(),title:e.trim(),description:(t||"").toString().trim(),priority:ft(o),dueDate:pt(n),column:s,order:1,labels:[...i],creationDate:d,changeDate:d,columnHistory:[{column:s,at:d}],...s==="done"?{doneDate:d}:{}};c.push(u),F(c)}function Vt(e,t,o,n,s,i,l=[]){if(!t||t.trim()==="")return;const a=x(),r=a.findIndex(c=>c.id===e);if(r!==-1){const c=a[r].column,d=i,u=new Date().toISOString();if(!Array.isArray(a[r].columnHistory)||a[r].columnHistory.length===0){const f=a[r].creationDate||a[r].changeDate||u,m=typeof c=="string"?c:d;a[r].columnHistory=[{column:m,at:f}]}a[r].title=t.trim(),a[r].description=(o||"").toString().trim(),a[r].priority=ft(n),a[r].dueDate=pt(s),a[r].column=d,a[r].labels=[...l],c!==d&&a[r].columnHistory.push({column:d,at:u}),c!=="done"&&d==="done"?a[r].doneDate=u:c==="done"&&d!=="done"&&delete a[r].doneDate,a[r].changeDate=u,F(a)}}function Wt(e){const o=x().filter(n=>n.id!==e);return F(o),!0}function Gt(e){const t=e.item?.dataset?.taskId;if(!t)return null;const o=e.from.closest(".task-column"),n=e.to.closest(".task-column");if(!o||!n)return null;const s=o.dataset.column,i=n.dataset.column,l=s!==i,a=x(),r=new Date().toISOString(),c=a.findIndex(m=>m.id===t);if(c===-1)return null;a[c];const d=new Set([s,i]),u=new Map;d.forEach(m=>{const p=document.querySelector(`.task-column[data-column="${m}"]`);if(!p)return;const g=p.querySelectorAll(".task"),y=[];g.forEach((E,L)=>{const B=E.dataset.taskId;B&&y.push({id:B,order:L+1})}),u.set(m,y)});const f=a.map(m=>{if(m.id===t){const p={...m,column:i},y=u.get(i)?.find(E=>E.id===t);if(y&&(p.order=y.order),l){p.changeDate=r;const E=Array.isArray(m.columnHistory)&&m.columnHistory.length?[...m.columnHistory]:[{column:m.column,at:m.creationDate||m.changeDate||r}];E.push({column:i,at:r}),p.columnHistory=E,m.column!=="done"&&i==="done"?p.doneDate=r:m.column==="done"&&i!=="done"&&delete p.doneDate}return p}if(d.has(m.column)){const g=u.get(m.column)?.find(y=>y.id===m.id);if(g&&g.order!==m.order)return{...m,order:g.order}}return m});return F(f),{movedTaskId:t,fromColumn:s,toColumn:i,didChangeColumn:l}}function Jt(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function gt(e){return Jt(e)?e.trim():"#3b82f6"}function Yt(e,t){if(!e||e.trim()==="")return;const o=N(),n=o.reduce((l,a)=>Math.max(l,a.order??0),0),i={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+ze().substring(0,8),name:e.trim(),color:gt(t),order:n-1,collapsed:!1};o.push(i),Z(o)}function Kt(e){const t=typeof e=="string"?e.trim():"";if(!t)return!1;const o=N(),n=o.find(s=>s.id===t);return n?(n.collapsed=n.collapsed!==!0,Z(o),!0):!1}function Xt(e,t,o){if(!t||t.trim()==="")return;const n=N(),s=n.findIndex(i=>i.id===e);s!==-1&&(n[s].name=t.trim(),n[s].color=gt(o),Z(n))}function Qt(e){if(e==="done")return!1;const t=N();if(t.length<=1)return!1;const o=x();if(o.filter(i=>i.column===e).length>0){const i=o.filter(l=>l.column!==e);F(i)}const s=t.filter(i=>i.id!==e);return Z(s),!0}function Zt(){const t=document.getElementById("board-container").querySelectorAll(".task-column"),o=N();t.forEach((n,s)=>{const i=n.dataset.column,l=o.find(a=>a.id===i);l&&(l.order=s+1)}),Z(o)}const en="modulepreload",tn=function(e,t){return new URL(e,t).href},Xe={},M=function(t,o,n){let s=Promise.resolve();if(o&&o.length>0){let c=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const l=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),r=a?.nonce||a?.getAttribute("nonce");s=c(o.map(d=>{if(d=tn(d,n),d in Xe)return;Xe[d]=!0;const u=d.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(n)for(let p=l.length-1;p>=0;p--){const g=l[p];if(g.href===d&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":en,u||(m.as="script"),m.crossOrigin="",m.href=d,r&&m.setAttribute("nonce",r),document.head.appendChild(m),u)return new Promise((p,g)=>{m.addEventListener("load",p),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=l,window.dispatchEvent(a),!a.defaultPrevented)throw l}return s.then(l=>{for(const a of l||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})},je=40;function Ve(e){return e.trim().slice(0,je).toLowerCase().replace(/\s+/g," ")}function ht(e,t,o=null){return e.some(n=>o&&n.id===o?!1:Ve(n.name)===t)}function nn(e,t,o=""){if(!e||e.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const n=e.trim().slice(0,je),s=Ve(n),i=A();if(ht(i,s))return{success:!1,reason:"DUPLICATE_NAME",message:`Label "${n}" already exists.`};const l=s.replace(/\s+/g,"-")+"-"+ze().substring(0,8),a=typeof o=="string"?o.trim():"",r={id:l,name:n,color:t,group:a};return i.push(r),we(i),{success:!0,label:r}}function on(e,t,o,n=""){if(!t||t.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const s=t.trim().slice(0,je),i=Ve(s),l=A(),a=l.findIndex(r=>r.id===e);return a===-1?{success:!1,reason:"NOT_FOUND"}:ht(l,i,e)?{success:!1,reason:"DUPLICATE_NAME",message:`Another label with the name "${s}" already exists.`}:(l[a].name=s,l[a].color=o,l[a].group=typeof n=="string"?n.trim():"",we(l),{success:!0,label:l[a]})}function an(e){const t=A(),o=x();o.forEach(s=>{s.labels&&(s.labels=s.labels.filter(i=>i!==e))}),F(o);const n=t.filter(s=>s.id!==e);we(n)}let Le=null;function S(e){return document.getElementById(e)}function ye(e){const t=S("dialog-modal");t&&t.classList.add("hidden");const o=Le;Le=null,typeof o=="function"&&o(!!e)}function sn(){const e=S("dialog-modal");return e&&!e.classList.contains("hidden")}function yt({title:e,message:t,confirmText:o,cancelText:n,showCancel:s}){const i=S("dialog-modal-title"),l=S("dialog-modal-message"),a=S("dialog-confirm-btn"),r=S("dialog-cancel-btn");i&&(i.textContent=e||"Confirm"),l&&(l.textContent=t||""),a&&(a.textContent=o||"OK"),r&&(r.textContent=n||"Cancel"),r&&(r.style.display=s?"inline-flex":"none")}function bt(){const e=S("dialog-modal");if(!e||e.dataset.handlersAttached==="true")return;e.dataset.handlersAttached="true";const t=S("dialog-confirm-btn"),o=S("dialog-cancel-btn");e.querySelector(".modal-backdrop"),t?.addEventListener("click",()=>ye(!0)),o?.addEventListener("click",()=>ye(!1)),T("dialog-modal",()=>ye(!1)),document.addEventListener("keydown",n=>{n.key==="Escape"&&sn()&&ye(!1)})}function Et(){const e=S("dialog-modal");if(!e)return;e.classList.remove("hidden"),S("dialog-confirm-btn")?.focus()}function J({title:e="Confirm",message:t="",confirmText:o="Delete",cancelText:n="Cancel"}={}){return bt(),yt({title:e,message:t,confirmText:o,cancelText:n,showCancel:!0}),Et(),new Promise(s=>{Le=s})}function O({title:e="Notice",message:t="",okText:o="OK"}={}){return bt(),yt({title:e,message:t,confirmText:o,cancelText:"",showCancel:!1}),Et(),new Promise(n=>{Le=()=>n(!0)})}function Ne(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return Array.isArray(o)?o:null}catch{return null}}function rn(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return o&&typeof o=="object"&&!Array.isArray(o)?o:null}catch{return null}}function vt(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function ln(e){const t=document.getElementById("brand-text")||document.querySelector(".brand-text");t&&(t.textContent=Ie());const o=document.getElementById("board-select");if(!o)return;const n=ee();o.innerHTML="",n.forEach(s=>{const i=document.createElement("option");i.value=s.id,i.textContent=vt(s),o.appendChild(i)}),e&&(o.value=e)}function dn(e){const t=typeof e?.name=="string"?e.name.trim():"";return t?t.replace(/\.[^.]+$/,"").trim():""}function xe(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const cn=new Set(["urgent","high","medium","low","none"]);function Ae(e){const t=(e||"").toString().trim().toLowerCase();return cn.has(t)?t:"none"}function un(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},o=t.showPriority!==!1,n=t.showDueDate!==!1,s=t.showAge!==!1,i=t.showChangeDate!==!1,l=typeof t.locale=="string"&&t.locale.trim()?t.locale.trim():typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US",a=Ae(t.defaultPriority),r=Number.parseInt((t.notificationDays??"").toString(),10),c=Number.isFinite(r)?Math.min(365,Math.max(0,r)):3;return{showPriority:o,showDueDate:n,showAge:s,showChangeDate:i,locale:l,defaultPriority:a,notificationDays:c}}function Lt(e){const t=(e||"").toString().trim();return t.length>=10&&t.includes("T")?t.slice(0,10):t}function Ct(e){const t=typeof e?.text=="string"?e.text:"",o=typeof e?.title=="string"?e.title:t,n=typeof e?.description=="string"?e.description:"",s=Lt(e?.dueDate??e?.["due-date"]),i=typeof e?.changeDate=="string"?e.changeDate:typeof e?.changedDate=="string"?e.changedDate:void 0,l=e?.column==="done",a=typeof e?.doneDate=="string"?e.doneDate.toString().trim():"",r=Array.isArray(e?.columnHistory)?e.columnHistory.map(c=>{const d=typeof c?.column=="string"?c.column.trim():"",u=typeof c?.at=="string"?c.at.trim():"";return!d||!u?null:{column:d,at:u}}).filter(Boolean):void 0;return{...e,title:o.toString().trim(),description:n.toString().trim(),priority:Ae(e?.priority),dueDate:s,...typeof i=="string"?{changeDate:i.toString().trim()}:{},...l&&a?{doneDate:a}:{doneDate:void 0},...r&&r.length?{columnHistory:r}:{columnHistory:void 0},changedDate:void 0}}function mn(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const s=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.text=="string"?n.text:String(n?.text??""),l=typeof n?.title=="string"?n.title:i,a=typeof n?.description=="string"?n.description:String(n?.description??""),r=Ae(n?.priority),c=typeof n?.dueDate=="string"?n.dueDate:typeof n?.["due-date"]=="string"?n["due-date"]:String(n?.dueDate??n?.["due-date"]??""),d=Lt(c),u=typeof n?.column=="string"?n.column:String(n?.column??""),f=Array.isArray(n?.labels)?n.labels.map(v=>typeof v=="string"?v:String(v)):[],m=Number.isFinite(n?.order)?n.order:void 0,p=typeof n?.creationDate=="string"?n.creationDate:void 0,g=typeof n?.changeDate=="string"?n.changeDate:typeof n?.changedDate=="string"?n.changedDate:void 0,y=typeof n?.doneDate=="string"?n.doneDate.trim():"",L=u.trim()==="done"&&(y||(typeof g=="string"?g.trim():"")||p)||"",B=Array.isArray(n?.columnHistory)?n.columnHistory.map(v=>{const D=typeof v?.column=="string"?v.column.trim():String(v?.column??"").trim(),ne=typeof v?.at=="string"?v.at.trim():String(v?.at??"").trim();return!D||!ne?null:{column:D,at:ne}}).filter(Boolean):void 0;return{id:s.trim(),title:l.trim(),description:a.trim(),priority:r,dueDate:d.trim(),column:u.trim(),...m!==void 0?{order:m}:{},...p?{creationDate:p}:{},...typeof g=="string"&&g.trim()?{changeDate:g.trim()}:{},...L?{doneDate:L}:{},...B&&B.length?{columnHistory:B}:{},labels:f}});return t.every(n=>n.id&&n.title&&n.column)?t:null}function fn(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const s=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),l=Number.isFinite(n?.order)?n.order:void 0,a=xe(n?.color)?n.color.trim():"#3b82f6",r=n?.collapsed===!0;return{id:s.trim(),name:i.trim(),color:a,collapsed:r,...l!==void 0?{order:l}:{}}});if(!t.some(n=>n.id==="done")){const n=t.reduce((s,i)=>Math.max(s,Number.isFinite(i?.order)?i.order:0),0);t.push({id:"done",name:"Done",color:"#16a34a",order:n+1,collapsed:!1})}return t.every(n=>n.id&&n.name)?t:null}function pn(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const s=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),l=xe(n?.color)?n.color.trim():"#3b82f6",a=typeof n?.group=="string"?n.group.trim():"";return{id:s.trim(),name:i.trim(),color:l,group:a}});return t.every(n=>n.id&&n.name&&n.color)?t:null}function gn(e){if(!e||typeof e!="object"||Array.isArray(e))return null;const t=e.showPriority!==!1,o=e.showDueDate!==!1,n=e.showAge!==!1,s=e.showChangeDate!==!1,i=typeof e.locale=="string"&&e.locale.trim()?e.locale.trim():void 0,l=typeof e.defaultPriority=="string"?e.defaultPriority:void 0,a=l?Ae(l):void 0,r=Number.parseInt((e.notificationDays??"").toString(),10),c=Number.isFinite(r)?Math.min(365,Math.max(0,r)):void 0;return{showPriority:t,showDueDate:o,showAge:n,showChangeDate:s,...i?{locale:i}:{},...a?{defaultPriority:a}:{},...c!==void 0?{notificationDays:c}:{}}}function hn(){const e=x().map(Ct),t=N().map(d=>({...d,color:xe(d?.color)?d.color.trim():"#3b82f6"})),o=A(),n=w(),s=Ie(),l=JSON.stringify({boardName:s,columns:t,tasks:e,labels:o,settings:n},null,2),a=new Blob([l],{type:"application/json"}),r=URL.createObjectURL(a),c=document.createElement("a");c.href=r,c.download=`${s.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(r)}function yn(e){const t=typeof e=="string"?e.trim():"";if(!t)return;const o=ee().find(D=>D.id===t),n=vt(o),s=`kanbanBoard:${t}:columns`,i=`kanbanBoard:${t}:tasks`,l=`kanbanBoard:${t}:labels`,a=`kanbanBoard:${t}:settings`,r=Ne(i)||[],c=Ne(s)||[],d=Ne(l)||[],u=rn(a)||null,f=r.map(Ct),m=c.map(D=>({...D,color:xe(D?.color)?D.color.trim():"#3b82f6",collapsed:D?.collapsed===!0})),p=Array.isArray(d)?d:[],g=un(u),E=JSON.stringify({boardName:n,columns:m,tasks:f,labels:p,settings:g},null,2),L=new Blob([E],{type:"application/json"}),B=URL.createObjectURL(L),v=document.createElement("a");v.href=B,v.download=`${n.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(B)}function bn(e){const t=new FileReader;t.onload=async o=>{try{const n=JSON.parse(o.target.result);let s,i,l,a,r;if(Array.isArray(n))s=n,i=null,l=null,a=null,r=null;else if(n.tasks&&n.columns)s=n.tasks,i=n.columns,l=Object.prototype.hasOwnProperty.call(n,"labels")?n.labels:null,a=Object.prototype.hasOwnProperty.call(n,"settings")?n.settings:null,r=typeof n.boardName=="string"?n.boardName.trim():null;else{alert("Invalid JSON file format");return}const c=mn(s),d=i?fn(i):null,u=l?pn(l):null,f=a?gn(a):null;if(!c||i&&!d||l&&!u||a&&!f){alert("Invalid data structure");return}const m=r||dn(e)||"Imported board",p=ct(m);if(p?.id&&ce(p.id),d&&Z(d),F(c),u&&we(u),f){const y=w();ut({...y,...f})}ln(p?.id);const{renderBoard:g}=await M(async()=>{const{renderBoard:y}=await Promise.resolve().then(()=>$);return{renderBoard:y}},void 0,import.meta.url);g(),document.dispatchEvent(new CustomEvent("kanban:boards-changed")),alert("Board imported successfully!")}catch(n){alert("Error parsing JSON file: "+n.message)}},t.readAsText(e)}function Bt(e,t){if(!e)return;const o=e.closest(".form-group");if(!o)return;o.classList.add("error");let n=o.querySelector(".error-message");n||(n=document.createElement("div"),n.classList.add("error-message"),o.appendChild(n)),n.textContent=t,e.focus()}function te(e){if(!e)return;const t=e.closest(".form-group");t&&t.classList.remove("error")}function En(e){return(e?.trim()||"").length>0}function vn(e){const t=e?.value?.trim()||"";return En(t)?(te(e),!0):(Bt(e,"Task title is required"),!1)}function Ln(e){return(e?.trim()||"").length>0}function Cn(e){const t=e?.value?.trim()||"";return Ln(t)?(te(e),!0):(Bt(e,"Column name is required"),!1)}function Qe(e,t,o,n){const s=document.createElement("div");s.classList.add("accordion");const i=document.createElement("button");i.type="button",i.classList.add("accordion-header"),i.setAttribute("aria-expanded",String(o));const l=document.createElement("span");l.dataset.lucide=o?"chevron-down":"chevron-right",l.setAttribute("aria-hidden","true");const a=document.createElement("span");a.classList.add("accordion-title"),a.textContent=e;const r=document.createElement("span");r.classList.add("accordion-count"),r.textContent=t.length,i.appendChild(l),i.appendChild(a),i.appendChild(r);const c=document.createElement("div");return c.classList.add("accordion-body"),o||c.classList.add("collapsed"),t.forEach(d=>{c.appendChild(n(d))}),i.addEventListener("click",()=>{const d=i.getAttribute("aria-expanded")==="true";i.setAttribute("aria-expanded",String(!d)),c.classList.toggle("collapsed",d),l.dataset.lucide=d?"chevron-right":"chevron-down",Y()}),s.appendChild(i),s.appendChild(c),s}let Ze="todo",ue=null,me=null,ie=null,Ce=null,I=[],H=!1,pe=!1;const j=40;let se=!1;function Te(e){const t=document.getElementById("task-modal");if(!t)return;t.classList.toggle("fullscreen",!!e);const o=document.getElementById("task-fullpage-btn");if(o?.setAttribute("aria-pressed",e?"true":"false"),o){const n=o.querySelector("[data-lucide]");n&&n.setAttribute("data-lucide",e?"minimize-2":"maximize-2"),o.title=e?"Exit full page":"Open in full page"}Y()}function V(e){const t=document.getElementById(e);return!!t&&!t.classList.contains("hidden")}function T(e,t){const o=document.getElementById(e);if(!o)return;o.querySelector(".modal-backdrop")?.addEventListener("click",t),o.querySelectorAll('[id$="-close-btn"], [id$="-close-modal-btn"], [id$="-cancel-btn"], [id^="cancel-"]').forEach(i=>{i.addEventListener("click",t)})}function Bn(){const e=document.getElementById("task-modal");e&&(e.classList.remove("hidden"),Q(),document.getElementById("task-label-search")?.focus(),H=!1)}function kn(){return(document.getElementById("task-label-search")?.value||"").trim().toLowerCase()}function wn(){return(document.getElementById("labels-search")?.value||"").trim().toLowerCase()}function We(){const e=document.getElementById("task-active-labels");if(!e)return;const t=A(),o=[];for(const s of I)o.includes(s)||o.push(s);I=o;const n=o.map(s=>t.find(i=>i.id===s)).filter(Boolean);e.innerHTML="",e.style.display=n.length>0?"flex":"none",n.forEach(s=>{const i=document.createElement("span");i.classList.add("task-label"),i.style.backgroundColor=s.color,i.textContent=s.name;const l=document.createElement("button");l.type="button",l.classList.add("active-label-remove"),l.setAttribute("aria-label",`Remove label ${s.name}`),l.title="Remove label",l.textContent="Ã—",l.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),I=I.filter(r=>r!==s.id),We(),Q()}),i.appendChild(l),e.appendChild(i)})}function In(e){Ze=e||N()[0]?.id||"todo",ue=null,I=[],H=!1,pe=!1,Te(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden");const t=document.getElementById("task-modal"),o=document.getElementById("task-column"),n=document.getElementById("task-title"),s=document.getElementById("task-description"),i=document.getElementById("task-priority"),l=document.getElementById("task-due-date"),a=document.getElementById("task-modal-title"),r=document.getElementById("task-submit-btn");if(te(n),a.textContent="Add New Task",r.textContent="Add Task",o.value=Ze,n.value="",s.value="",i){const d=w();i.value=d.defaultPriority||"none"}l&&(l.value="");const c=document.getElementById("task-label-search");c&&(c.value=""),Q(),t.classList.remove("hidden"),n.focus()}function R(e){const o=x().find(g=>g.id===e);if(!o)return;ue=e,I=o.labels||[],H=!1,pe=!1,Te(!1),document.getElementById("task-fullpage-btn")?.classList.remove("hidden");const n=document.getElementById("task-modal"),s=document.getElementById("task-column"),i=document.getElementById("task-title"),l=document.getElementById("task-description"),a=document.getElementById("task-priority"),r=document.getElementById("task-due-date"),c=document.getElementById("task-modal-title"),d=document.getElementById("task-submit-btn");te(i),c.textContent="Edit Task",d.textContent="Save Changes",s.value=o.column;const u=typeof o.text=="string"?o.text:"";i.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:u,l.value=typeof o.description=="string"?o.description:"",a&&(a.value=typeof o.priority=="string"?o.priority:"none");const f=typeof o.dueDate=="string"?o.dueDate:"",m=f.includes("T")?f.slice(0,10):f;r&&(r.value=m);const p=document.getElementById("task-label-search");p&&(p.value=""),Q(),n.classList.remove("hidden"),i.focus()}function Me(){document.getElementById("task-modal").classList.add("hidden"),ue=null,H=!1,Te(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden")}function Dn(){me=null;const e=document.getElementById("column-modal"),t=document.getElementById("column-name"),o=document.getElementById("column-color"),n=document.getElementById("column-modal-title"),s=document.getElementById("column-submit-btn");te(t),n.textContent="Add New Column",s.textContent="Add Column",t.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),t.focus()}function xn(e){const o=N().find(r=>r.id===e);if(!o)return;me=e;const n=document.getElementById("column-modal"),s=document.getElementById("column-name"),i=document.getElementById("column-color"),l=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");te(s),l.textContent="Edit Column",a.textContent="Save Changes",s.value=o.name,i&&(i.value=o.color||"#3b82f6"),n.classList.remove("hidden"),s.focus()}function Pe(){document.getElementById("column-modal").classList.add("hidden"),me=null}function An(){const e=document.getElementById("labels-search");e&&(e.value=""),ke(),document.getElementById("labels-modal").classList.remove("hidden"),H||document.getElementById("labels-search")?.focus()}function _e(){document.getElementById("labels-modal").classList.add("hidden");const t=document.getElementById("labels-search");t&&(t.value=""),H&&Bn()}function Tn(){document.getElementById("help-modal").classList.remove("hidden")}function et(){document.getElementById("help-modal").classList.add("hidden")}const Sn=/^#[0-9a-fA-F]{6}$/;function tt(e){return Sn.test(e)}function kt(e){const t=document.getElementById("label-color-hex");t&&(t.value=e,t.classList.remove("invalid"))}function Nn(){const e=document.getElementById("label-group-suggestions");if(!e)return;e.innerHTML="";const t=A();[...new Set(t.map(n=>(n.group||"").trim()).filter(n=>n.length>0))].sort((n,s)=>n.localeCompare(s)).forEach(n=>{const s=document.createElement("option");s.value=n,e.appendChild(s)})}function Be(e=null,{openedFromTaskEditor:t=!1,initialName:o=""}={}){ie=e,se=!1,pe=!!t;const n=document.getElementById("label-modal"),s=document.getElementById("label-modal-title"),i=document.getElementById("label-name"),l=document.getElementById("label-color"),a=document.getElementById("label-group"),r=document.getElementById("label-submit-btn");if(e){const d=A().find(u=>u.id===e);d&&(s.textContent="Edit Label",r.textContent="Update Label",i.value=d.name,l.value=d.color,a&&(a.value=d.group||""))}else s.textContent="Add Label",r.textContent="Add Label",i.value=o||"",l.value="#3b82f6",a&&(a.value="");Nn(),kt(l.value),n.classList.remove("hidden"),i.focus()}function Oe(){document.getElementById("label-modal").classList.add("hidden"),ie=null,pe=!1}function nt(e){const t=document.createElement("div");t.classList.add("label-item"),t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-between";const o=document.createElement("span");o.classList.add("task-label"),o.style.backgroundColor=e.color,o.textContent=e.name;const n=document.createElement("div");n.classList.add("label-actions"),n.style.display="flex",n.style.gap="4px";const s=document.createElement("button");s.classList.add("btn-small");const i=document.createElement("span");i.dataset.lucide="pencil",s.appendChild(i),s.title="Edit label",s.addEventListener("click",()=>Be(e.id));const l=document.createElement("button");l.classList.add("btn-small","btn-danger");const a=document.createElement("span");return a.dataset.lucide="trash-2",l.appendChild(a),l.title="Delete label",l.addEventListener("click",async()=>{if(await J({title:"Delete Label",message:`Delete label "${e.name}"? This will remove it from all tasks.`,confirmText:"Delete"})){an(e.id),ke();const{renderBoard:c}=await M(async()=>{const{renderBoard:d}=await Promise.resolve().then(()=>$);return{renderBoard:d}},void 0,import.meta.url);c()}}),n.appendChild(s),n.appendChild(l),t.appendChild(o),t.appendChild(n),t}function wt(e){const t=e.filter(s=>!(s.group||"").trim()),o=new Map;e.forEach(s=>{const i=(s.group||"").trim();i&&(o.has(i)||o.set(i,[]),o.get(i).push(s))});const n=[...o.keys()].sort((s,i)=>s.localeCompare(i));return{ungrouped:t,groupMap:o,sortedGroups:n}}function ke(){const e=document.getElementById("labels-list");e.innerHTML="";const t=A(),o=wn(),n=o?t.filter(r=>{const c=(r.name||"").toLowerCase(),d=(r.id||"").toLowerCase(),u=(r.group||"").toLowerCase();return c.includes(o)||d.includes(o)||u.includes(o)}):t;if(n.length===0){const r=document.createElement("div");r.classList.add("labels-empty"),r.textContent=o?"No matching labels":"No labels yet",e.appendChild(r);return}const{ungrouped:s,groupMap:i,sortedGroups:l}=wt(n);let a=!0;s.length>0&&(e.appendChild(Qe("Ungrouped",s,a,nt)),a=!1),l.forEach(r=>{e.appendChild(Qe(r,i.get(r),a,nt)),a=!1}),Y()}function Fe(){const e=document.getElementById("board-select");if(!e)return;const t=ee(),o=qe();e.innerHTML="",t.forEach(s=>{const i=document.createElement("option");i.value=s.id,i.textContent=typeof s.name=="string"&&s.name.trim()?s.name.trim():"Untitled board",e.appendChild(i)}),o&&(e.value=o);const n=document.getElementById("brand-text")||document.querySelector(".brand-text");n&&(n.textContent=Ie())}function fe(){De();const e=document.getElementById("boards-list");if(!e)return;e.innerHTML="";const t=ee(),o=qe();t.forEach(n=>{const s=document.createElement("div");s.classList.add("label-item"),s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="space-between",s.style.gap="10px";const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";const l=document.createElement("span");if(l.textContent=(n.name||"").toString(),i.appendChild(l),n.id===o){const g=document.createElement("span");g.classList.add("task-label"),g.style.backgroundColor="var(--color-primary)",g.textContent="Active",i.appendChild(g)}const a=document.createElement("div");a.classList.add("label-actions"),a.style.display="flex",a.style.gap="4px";const r=document.createElement("button");r.classList.add("btn-small"),r.textContent="Open",r.title="Open board",r.addEventListener("click",async()=>{ce(n.id),Fe(),fe();const{renderBoard:g}=await M(async()=>{const{renderBoard:y}=await Promise.resolve().then(()=>$);return{renderBoard:y}},void 0,import.meta.url);g()});const c=document.createElement("button");c.classList.add("btn-small"),c.type="button",c.title="Export board",c.setAttribute("aria-label",`Export board ${String(n.name||"Untitled board")}`);const d=document.createElement("span");d.dataset.lucide="download",c.appendChild(d),c.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),yn(n.id)});const u=document.createElement("button");u.classList.add("btn-small");const f=document.createElement("span");f.dataset.lucide="pencil",u.appendChild(f),u.title="Rename board",u.addEventListener("click",()=>_n(n.id));const m=document.createElement("button");m.classList.add("btn-small","btn-danger");const p=document.createElement("span");p.dataset.lucide="trash-2",m.appendChild(p),m.title="Delete board",m.addEventListener("click",async()=>{if(!await J({title:"Delete Board",message:`Do you really want to delete the board "${n.name}"? This cannot be undone.`,confirmText:"Delete"}))return;if(!Ft(n.id)){await O({title:"Unable to Delete",message:"Unable to delete board (you may be trying to delete the last board)."});return}Fe(),fe();const{renderBoard:E}=await M(async()=>{const{renderBoard:L}=await Promise.resolve().then(()=>$);return{renderBoard:L}},void 0,import.meta.url);E()}),a.appendChild(r),a.appendChild(c),a.appendChild(u),a.appendChild(m),s.appendChild(i),s.appendChild(a),e.appendChild(s)}),Y()}function Mn(){fe(),document.getElementById("boards-modal")?.classList.remove("hidden")}function ot(){document.getElementById("boards-modal")?.classList.add("hidden")}function Pn(){const e=document.getElementById("boards-modal");!e||e.classList.contains("hidden")||fe()}function _n(e){De();const t=ee().find(l=>l.id===e);if(!t)return;Ce=e;const o=document.getElementById("board-rename-modal"),n=document.getElementById("board-rename-name"),s=document.getElementById("board-rename-modal-title"),i=document.getElementById("board-rename-submit-btn");s&&(s.textContent="Rename Board"),i&&(i.textContent="Save"),n&&(n.value=(t.name||"").toString()),o?.classList.remove("hidden"),n?.focus()}function $e(){document.getElementById("board-rename-modal")?.classList.add("hidden"),Ce=null}function at(e){const t=document.createElement("label");t.classList.add("label-checkbox");const o=document.createElement("input");o.type="checkbox",o.value=e.id,o.checked=I.includes(e.id),o.addEventListener("change",s=>{s.target.checked?I.includes(e.id)||I.push(e.id):I=I.filter(i=>i!==e.id),We()});const n=document.createElement("span");return n.classList.add("task-label","label-color-swatch"),n.style.backgroundColor=e.color,n.textContent=e.name,t.appendChild(o),t.appendChild(n),t}function Q(){We();const e=document.getElementById("task-labels-selection");e.innerHTML="";const t=kn(),o=A(),n=t?o.filter(a=>{const r=(a.name||"").toLowerCase(),c=(a.id||"").toLowerCase(),d=(a.group||"").toLowerCase();return r.includes(t)||c.includes(t)||d.includes(t)}):o;if(n.length===0){if(t){const a=document.createElement("button");a.type="button",a.classList.add("labels-empty-button"),a.textContent=`No label found "${t}" - Create label`,a.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation(),Be(null,{openedFromTaskEditor:!0,initialName:t})}),e.appendChild(a)}else{const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent="No matching labels",e.appendChild(a)}return}const{ungrouped:s,groupMap:i,sortedGroups:l}=wt(n);s.forEach(a=>{e.appendChild(at(a))}),l.forEach(a=>{const r=document.createElement("div");r.classList.add("label-group-header","label-group-header-picker"),r.textContent=a,e.appendChild(r),i.get(a).forEach(c=>{e.appendChild(at(c))})})}function On(){document.addEventListener("kanban:boards-changed",()=>{Pn()}),document.getElementById("task-label-search")?.addEventListener("input",Q),document.getElementById("labels-search")?.addEventListener("input",ke),document.getElementById("task-add-label-btn")?.addEventListener("click",()=>{H=!1,Be(null,{openedFromTaskEditor:!0})}),document.getElementById("task-fullpage-btn")?.addEventListener("click",()=>{const a=document.getElementById("task-modal");a&&Te(!a.classList.contains("fullscreen"))}),document.getElementById("task-form").addEventListener("submit",async a=>{a.preventDefault();const r=document.getElementById("task-title");if(!vn(r))return;const c=r.value.trim(),d=document.getElementById("task-description").value,u=document.getElementById("task-priority")?.value,f=document.getElementById("task-due-date")?.value,m=document.getElementById("task-column").value;ue?Vt(ue,c,d,u,f,m,I):jt(c,d,u,f,m,I),Me();const{renderBoard:p}=await M(async()=>{const{renderBoard:g}=await Promise.resolve().then(()=>$);return{renderBoard:g}},void 0,import.meta.url);p()}),T("task-modal",Me),document.getElementById("column-form").addEventListener("submit",async a=>{a.preventDefault();const r=document.getElementById("column-name");if(!Cn(r))return;const c=r.value.trim(),d=document.getElementById("column-color")?.value;me?Xt(me,c,d):Yt(c,d),Pe();const{renderBoard:u}=await M(async()=>{const{renderBoard:f}=await Promise.resolve().then(()=>$);return{renderBoard:f}},void 0,import.meta.url);u()}),T("column-modal",Pe),document.getElementById("manage-labels-btn").addEventListener("click",An),document.getElementById("add-label-btn").addEventListener("click",()=>Be()),T("labels-modal",_e);const s=document.getElementById("label-name");s?.addEventListener("beforeinput",a=>{if(!a||typeof a.data!="string"||a.data.length===0)return;const r=a.target;if(!r||typeof r.value!="string")return;const c=typeof r.selectionStart=="number"?r.selectionStart:r.value.length,d=typeof r.selectionEnd=="number"?r.selectionEnd:r.value.length;(r.value.slice(0,c)+a.data+r.value.slice(d)).trim().length<=j||(a.preventDefault(),!se&&(se=!0,O({title:"Label Name Too Long",message:`Label names are limited to ${j} characters.`})))});const i=document.getElementById("label-color");i?.addEventListener("input",a=>{kt(a.target.value)}),document.getElementById("label-color-hex")?.addEventListener("input",a=>{let r=a.target.value;r&&!r.startsWith("#")&&(r="#"+r),tt(r)?(i.value=r,a.target.classList.remove("invalid")):a.target.classList.toggle("invalid",r.length>0)}),s?.addEventListener("input",a=>{const r=a.target;if(!r||typeof r.value!="string")return;const c=r.value.trim();c.length<=j||(r.value=c.slice(0,j),!se&&(se=!0,O({title:"Label Name Too Long",message:`Label names are limited to ${j} characters.`})))}),document.getElementById("label-form").addEventListener("submit",async a=>{a.preventDefault();const r=document.getElementById("label-name").value,c=document.getElementById("label-color-hex"),d=(c?.value||"").trim();let u;if(d&&d!==document.getElementById("label-color").value){const E=d.startsWith("#")?d:"#"+d;if(!tt(E)){c?.classList.add("invalid"),await O({title:"Invalid Hex Color",message:"Please enter a valid hex color code (e.g. #3b82f6)."}),c?.focus();return}document.getElementById("label-color").value=E,u=E}else u=document.getElementById("label-color").value;const f=(r||"").trim();if(f.length>j){await O({title:"Label Name Too Long",message:`Label names are limited to ${j} characters.`});return}const m=(document.getElementById("label-group")?.value||"").trim(),p=!ie,g=ie?on(ie,f,u,m):nn(f,u,m);if(!g?.success){let E="Unable to Save Label",L="Could not save label.";g?.reason==="DUPLICATE_NAME"?(E="Label Already Exists",L=g?.message||"A label with that name already exists (case-insensitive)."):g?.reason==="EMPTY_NAME"&&(E="Label Name Required",L="Please enter a label name."),await O({title:E,message:L}),document.getElementById("label-name")?.focus();return}p&&pe&&g?.label?.id&&(I.includes(g.label.id)||I.push(g.label.id),Q(),document.getElementById("task-label-search")?.focus()),Oe(),ke();const{renderBoard:y}=await M(async()=>{const{renderBoard:E}=await Promise.resolve().then(()=>$);return{renderBoard:E}},void 0,import.meta.url);y(),H&&p&&_e()}),T("label-modal",Oe),document.getElementById("manage-boards-btn")?.addEventListener("click",Mn),document.getElementById("add-board-btn")?.addEventListener("click",async()=>{document.dispatchEvent(new CustomEvent("kanban:open-board-create"))}),document.getElementById("boards-import-btn")?.addEventListener("click",async()=>{await J({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file")?.click()}),T("boards-modal",ot),document.getElementById("board-rename-form")?.addEventListener("submit",a=>{if(a.preventDefault(),!Ce)return;const c=(document.getElementById("board-rename-name")?.value||"").trim();if(!c){alert("Board name cannot be empty.");return}if(!Ut(Ce,c)){alert("Unable to rename board.");return}$e(),Fe(),fe(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),T("board-rename-modal",$e),document.getElementById("help-btn").addEventListener("click",Tn),T("help-modal",et),document.getElementById("add-column-btn").addEventListener("click",Dn),document.addEventListener("keydown",a=>{if(a.key==="Escape"){if(V("label-modal")){Oe();return}if(V("labels-modal")){_e();return}if(V("board-rename-modal")){$e();return}if(V("boards-modal")){ot();return}if(V("help-modal")){et();return}if(V("column-modal")){Pe();return}V("task-modal")&&Me()}})}let Ue=[],ve=null,re=null,X=0;function $n(){const e=typeof navigator<"u"&&(navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0),t=typeof window<"u"&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer: coarse)").matches;return e||t}function Rn(){Hn(),Un(),zn()}function Hn(){Ue.forEach(e=>e.destroy()),Ue=[],ve&&(ve.destroy(),ve=null),It()}function Fn(){const e=document.getElementById("board-container");!e||re||(re=setInterval(()=>{if(!e)return;const t=e.getBoundingClientRect(),o=80,n=12;X>0&&(X<t.left+o&&e.scrollLeft>0?e.scrollLeft-=n:X>t.right-o&&e.scrollLeft<e.scrollWidth-e.clientWidth&&(e.scrollLeft+=n))},16))}function It(){re&&(clearInterval(re),re=null),X=0}function be(e){e.touches&&e.touches[0]?X=e.touches[0].clientX:e.clientX&&(X=e.clientX)}function Un(){const e=document.querySelectorAll(".tasks:not(.hidden)"),t=$n();e.forEach(o=>{const n=new mt(o,{group:{name:"tasks",pull:!0,put:!0},animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"task-ghost",chosenClass:"task-chosen",dragClass:"task-drag",draggable:".task",forceFallback:t,fallbackClass:"task-fallback",fallbackOnBody:!0,fallbackTolerance:0,swapThreshold:.65,emptyInsertThreshold:20,direction:"vertical",onStart:function(s){document.body.classList.add("dragging"),Fn(),document.addEventListener("touchmove",be,{passive:!0}),document.addEventListener("mousemove",be,{passive:!0})},onEnd:async function(s){document.body.classList.remove("dragging"),It(),document.removeEventListener("touchmove",be),document.removeEventListener("mousemove",be);const i=Gt(s);if(i){const{syncTaskCounters:l,syncCollapsedTitles:a}=await M(async()=>{const{syncTaskCounters:c,syncCollapsedTitles:d}=await Promise.resolve().then(()=>$);return{syncTaskCounters:c,syncCollapsedTitles:d}},void 0,import.meta.url),{refreshNotifications:r}=await M(async()=>{const{refreshNotifications:c}=await Promise.resolve().then(()=>jn);return{refreshNotifications:c}},void 0,import.meta.url);l(),i.didChangeColumn&&(a(),r())}}});Ue.push(n)})}function zn(){const e=document.getElementById("board-container");e&&(ve=new mt(e,{animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"column-ghost",chosenClass:"column-chosen",dragClass:"column-drag",handle:".column-header",filter:"button:not(.column-drag-handle), a, input, select, textarea, [contenteditable]",preventOnFilter:!0,draggable:".task-column",scrollSensitivity:80,scrollSpeed:15,forceFallback:!1,fallbackOnBody:!0,onStart:function(t){document.body.classList.add("dragging-column")},onEnd:function(t){document.body.classList.remove("dragging-column"),Zt()}}))}const Dt="kanbanNotificationBannerHidden";let st;function xt(){return localStorage.getItem(Dt)==="true"}function it(e){localStorage.setItem(Dt,e?"true":"false")}function At(){const e=document.getElementById("notification-banner-visibility-toggle");e&&(e.checked=!xt())}function Se(){const e=x(),t=w(),o=Number.isFinite(t.notificationDays)?t.notificationDays:3,n=new Date;return n.setHours(0,0,0,0),e.filter(s=>{if(s.column==="done")return!1;const i=(s.dueDate||"").toString().trim();if(!i)return!1;const l=new Date(i+"T00:00:00");if(Number.isNaN(l.getTime()))return!1;const a=l.getTime()-n.getTime();return Math.floor(a/(1e3*60*60*24))<=o}).map(s=>{const l=new Date(s.dueDate+"T00:00:00").getTime()-n.getTime(),a=Math.floor(l/(1e3*60*60*24));return{...s,daysUntilDue:a}}).sort((s,i)=>s.daysUntilDue-i.daysUntilDue)}function Tt(e,t,o){const s=new Date(t+"T00:00:00").toLocaleDateString(o||void 0);if(e<0){const i=Math.abs(e);return{text:`Overdue by ${i} day${i===1?"":"s"} (${s})`,className:"overdue"}}else return e===0?{text:`Due today (${s})`,className:"overdue"}:e===1?{text:`Due tomorrow (${s})`,className:"due-soon"}:{text:`Due in ${e} days (${s})`,className:"due-soon"}}function Ge(){const e=document.getElementById("notification-banner"),t=document.getElementById("notification-banner-list");if(!e||!t)return;const o=Se(),n=w();if(o.length===0){e.classList.add("hidden");return}if(xt()){e.classList.add("hidden");return}t.innerHTML="";const s=window.matchMedia("(min-width: 601px)").matches,i=l=>{const a=document.createElement("div");a.classList.add("notification-banner-item"),a.setAttribute("role","button"),a.setAttribute("tabindex","0"),a.setAttribute("aria-label",`Open task: ${l.title}`);const r=document.createElement("span");r.classList.add("task-title");const c=typeof l.text=="string"?l.text:"";r.textContent=typeof l.title=="string"&&l.title.trim()?l.title:c;const d=Tt(l.daysUntilDue,l.dueDate,n.locale),u=document.createElement("span");u.classList.add("due-date",d.className),u.textContent=d.text,a.appendChild(r),a.appendChild(u);const f=()=>R(l.id);return a.addEventListener("click",f),a.addEventListener("keydown",m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),f())}),a};if(s){const l=t.clientWidth||t.getBoundingClientRect().width;let a=0;for(const c of o){const d=i(c);if(t.appendChild(d),a+=1,t.scrollWidth>l&&a>1){t.removeChild(d),a-=1;break}}const r=o.length-a;if(r>0){const c=document.createElement("div");if(c.classList.add("notification-banner-item","notification-more"),c.setAttribute("role","button"),c.setAttribute("tabindex","0"),c.textContent=`+${r} `,c.addEventListener("click",K),c.addEventListener("keydown",d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),K())}),t.appendChild(c),t.scrollWidth>l&&a>0){t.removeChild(t.children[a-1]),a-=1;const d=o.length-a;c.textContent=`+${d} `,t.appendChild(c)}}}else if(o.slice(0,5).forEach(a=>{const r=i(a);t.appendChild(r)}),o.length>5){const a=document.createElement("div");a.classList.add("notification-banner-item","notification-more"),a.setAttribute("role","button"),a.setAttribute("tabindex","0"),a.textContent=`+${o.length-5} `,a.addEventListener("click",K),a.addEventListener("keydown",r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),K())}),t.appendChild(a)}e.classList.remove("hidden"),Y()}function qn(){const e=document.getElementById("notifications-list");if(!e)return;const t=Se(),o=w(),n=Number.isFinite(o.notificationDays)?o.notificationDays:3;if(e.innerHTML="",t.length===0){const s=document.createElement("div");s.classList.add("notifications-empty"),s.textContent=n===0?"No tasks due today.":`No tasks due within the next ${n} day${n===1?"":"s"}.`,e.appendChild(s);return}t.forEach(s=>{const i=document.createElement("div");i.classList.add("notification-item"),i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.setAttribute("aria-label",`Open task: ${s.title}`);const l=document.createElement("div");l.classList.add("notification-item-content");const a=document.createElement("div");a.classList.add("notification-item-title");const r=typeof s.text=="string"?s.text:"";a.textContent=typeof s.title=="string"&&s.title.trim()?s.title:r;const c=document.createElement("div");c.classList.add("notification-item-meta");const d=Tt(s.daysUntilDue,s.dueDate,o.locale),u=document.createElement("span");u.classList.add(d.className),u.textContent=d.text;const f=typeof s.priority=="string"?s.priority:"none",m=document.createElement("span");m.classList.add("notification-item-priority",`priority-${f}`),m.textContent=f,c.appendChild(u),c.appendChild(m),l.appendChild(a),l.appendChild(c);const p=document.createElement("span");p.classList.add("notification-item-arrow"),p.dataset.lucide="chevron-right",i.appendChild(l),i.appendChild(p);const g=()=>{le(),R(s.id)};i.addEventListener("click",g),i.addEventListener("keydown",y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),g())}),e.appendChild(i)}),Y()}function St(){const e=document.getElementById("notification-badge");if(!e)return;const o=Se().length;o===0?(e.classList.add("hidden"),e.textContent=""):(e.classList.remove("hidden"),e.textContent=o>99?"99+":String(o))}function K(){At(),qn(),document.getElementById("notifications-modal")?.classList.remove("hidden")}function le(){document.getElementById("notifications-modal")?.classList.add("hidden")}function Nt(){const e=document.getElementById("notifications-modal");return e&&!e.classList.contains("hidden")}function Mt(){document.getElementById("notification-banner-close-btn")?.addEventListener("click",()=>{it(!0),de()});const t=document.getElementById("notification-banner-visibility-toggle");t?.addEventListener("change",()=>{it(!t.checked),de()}),document.getElementById("notifications-btn")?.addEventListener("click",K),document.getElementById("notifications-close-btn")?.addEventListener("click",le),T("notifications-modal",le),document.addEventListener("keydown",s=>{s.key==="Escape"&&Nt()&&le()}),window.addEventListener("resize",()=>{clearTimeout(st),st=setTimeout(Ge,120)}),de(),At()}function de(){Ge(),St()}const jn=Object.freeze(Object.defineProperty({__proto__:null,getNotificationTasks:Se,hideNotificationsModal:le,initializeNotifications:Mt,isNotificationsModalOpen:Nt,refreshNotifications:de,renderNotificationBanner:Ge,showNotificationsModal:K,updateNotificationBadge:St},Symbol.toStringTag,{value:"Module"}));let rt=!1,Je="";const Pt=50,Vn=50;let Ee=Pt;function _t(e){Je=(e||"").toString()}function Ot(e){return x().filter(o=>o.column===e).length}function $t(e,t,o){if(!t)return!0;const n=typeof e?.text=="string"?e.text:"",s=typeof e?.title=="string"&&e.title.trim()!==""?e.title:n,i=typeof e?.description=="string"?e.description:"",l=typeof e?.priority=="string"?e.priority:"";if(s.toLowerCase().includes(t)||i.toLowerCase().includes(t)||l.toLowerCase().includes(t))return!0;const a=Array.isArray(e?.labels)?e.labels:[];for(const r of a){const c=o.get(r);if(c&&(c.name.includes(t)||c.group.includes(t)))return!0}return!1}function G(e=null){document.querySelectorAll(".column-menu").forEach(t=>{e&&t===e||t.classList.add("hidden")}),document.querySelectorAll(".column-submenu").forEach(t=>{t.classList.add("hidden")})}function Wn(e){return[...e].sort((t,o)=>{const n=(t.dueDate||"").toString().trim(),s=(o.dueDate||"").toString().trim();return!n&&!s?0:n?s?n.localeCompare(s):-1:1})}function Gn(e){const t={urgent:0,high:1,medium:2,low:3,none:4};return[...e].sort((o,n)=>{const s=t[o.priority]??4,i=t[n.priority]??4;return s-i})}function lt(e,t){const o=x(),n=o.filter(r=>r.column===e),s=o.filter(r=>r.column!==e),l=(t==="dueDate"?Wn(n):Gn(n)).map((r,c)=>({...r,order:c+1})),a=[...s,...l];F(a),P()}function Jn(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=o.includes("T")?o:`${o}T00:00:00`,s=new Date(n);return Number.isNaN(s.getTime())?o:s.toLocaleDateString(t||void 0)}function Yn(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=new Date(o);return Number.isNaN(n.getTime())?o:n.toLocaleString(t||void 0)}function Kn(e){const t=(e?.creationDate||"").toString().trim();if(!t)return"";const o=new Date(t);if(Number.isNaN(o.getTime()))return"";const n=1440*60*1e3,s=Math.max(0,Math.floor((Date.now()-o.getTime())/n));if(s<30)return`${s}d`;const i=Math.floor(s/365);let l=s%365;const a=Math.floor(l/30);l=l%30;const r=[];return i>=1&&r.push(`${i}y`),a>=1&&r.push(`${a}M`),r.push(`${l}d`),r.join(" ")}function Xn(e,t,o=null){const n=document.createElement("li");n.classList.add("task"),n.draggable=!0,n.dataset.taskId=e.id,n.setAttribute("role","listitem"),n.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const s=document.createElement("div");s.classList.add("task-labels"),s.setAttribute("role","list"),s.setAttribute("aria-label","Task labels");const i=o||new Map(A().map(h=>[h.id,h]));e.labels&&e.labels.length>0&&e.labels.forEach(h=>{const b=i instanceof Map?i.get(h):i.find(C=>C.id===h);if(b){const C=document.createElement("span");C.classList.add("task-label"),C.setAttribute("role","listitem"),C.style.backgroundColor=b.color,C.textContent=b.name,s.appendChild(C)}});const l=document.createElement("div");l.classList.add("task-header");const a=t?.showPriority!==!1,r=t?.showDueDate!==!1,c=document.createElement("div");c.classList.add("task-title"),c.setAttribute("role","button"),c.setAttribute("tabindex","0");const d=typeof e.text=="string"?e.text:"";c.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:d,c.addEventListener("click",()=>R(e.id)),c.addEventListener("keydown",h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),R(e.id))});const u=document.createElement("div");if(u.classList.add("task-actions"),a){const h=typeof e.priority=="string"?e.priority.toLowerCase().trim():"",b=h==="urgent"||h==="high"||h==="medium"||h==="low"||h==="none"?h:"none",C=document.createElement("span");C.classList.add("task-priority",`priority-${b}`,"task-priority-header"),C.textContent=b,C.setAttribute("aria-label",`Priority: ${b}`),C.setAttribute("role","button"),C.setAttribute("tabindex","0"),C.title="Edit task",C.addEventListener("click",U=>{U.stopPropagation(),R(e.id)}),C.addEventListener("keydown",U=>{(U.key==="Enter"||U.key===" ")&&(U.preventDefault(),R(e.id))}),u.appendChild(C)}const f=document.createElement("button");f.classList.add("delete-task-btn"),f.setAttribute("aria-label","Delete task"),f.type="button";const m=document.createElement("span");m.dataset.lucide="trash-2",m.setAttribute("aria-hidden","true"),f.appendChild(m),f.addEventListener("click",async h=>{h.stopPropagation(),await J({title:"Delete Task",message:"Are you sure you want to delete this task?",confirmText:"Delete"})&&Wt(e.id)&&P()}),u.appendChild(f),l.appendChild(c),l.appendChild(u);const p=typeof e.description=="string"?e.description.trim():"",g=document.createElement("div");g.classList.add("task-description"),g.textContent=p,g.style.display=p?"block":"none",g.addEventListener("click",()=>R(e.id)),n.appendChild(l),n.appendChild(g),n.appendChild(s);const y=t?.showChangeDate!==!1,E=t?.showAge!==!1,L=t?.locale,B=document.createElement("div");if(B.classList.add("task-footer"),y){const h=document.createElement("span");h.classList.add("task-change-date");const b=Yn(e?.changeDate,L);h.textContent=b?`Updated ${b}`:"",B.appendChild(h)}const v=document.createElement("div");if(v.classList.add("task-footer-row"),r){const h=typeof e.dueDate=="string"?e.dueDate.trim():"",b=document.createElement("span");b.classList.add("task-date"),h?b.textContent="Due "+Jn(h,t?.locale):b.textContent="No due date",v.appendChild(b)}if(E){const h=document.createElement("span");h.classList.add("task-age");const b=Kn(e);h.textContent=b?`Age ${b}`:"",v.appendChild(h)}return Array.from(v.childNodes).some(h=>(h.textContent||"").trim()!=="")&&B.appendChild(v),Array.from(B.childNodes).some(h=>(h.textContent||"").trim()!=="")&&n.appendChild(B),n}function Qn(e){const t=document.createElement("article");t.classList.add("task-column"),t.dataset.column=e.id,t.draggable=!1,t.setAttribute("aria-labelledby",`column-title-${e.id}`);const o=e?.collapsed===!0;o&&t.classList.add("is-collapsed"),e?.color&&t.style.setProperty("--column-accent",e.color);const n=document.createElement("button");n.classList.add("column-collapse-btn"),n.type="button",n.setAttribute("aria-label",o?`Expand ${e.name} column`:`Collapse ${e.name} column`),n.title=o?"Expand column":"Collapse column";const s=document.createElement("span");s.dataset.lucide=o?"chevron-right":"chevrons-right-left",s.setAttribute("aria-hidden","true"),n.appendChild(s),n.addEventListener("click",k=>{k.stopPropagation(),Kt(e.id)&&P()});const i=document.createElement("button");i.classList.add("column-drag-handle"),i.type="button",i.setAttribute("aria-label","Drag to reorder column");const l=document.createElement("span");l.dataset.lucide="grip-vertical",l.setAttribute("aria-hidden","true"),i.appendChild(l),i.title="Drag to reorder";const a=document.createElement("header");a.classList.add("column-header");const r=document.createElement("h2");if(r.id=`column-title-${e.id}`,o){const k=Ot(e.id);r.textContent=`${e.name} (${k})`}else r.textContent=e.name;const c=document.createElement("span");c.classList.add("task-counter"),c.dataset.columnId=e.id,c.textContent="0",c.setAttribute("aria-label","Task count");const d=document.createElement("div");d.classList.add("column-actions");const u=document.createElement("button");u.classList.add("add-task-btn-icon"),u.type="button",u.setAttribute("aria-label",`Add task to ${e.name}`);const f=document.createElement("span");f.dataset.lucide="plus",f.setAttribute("aria-hidden","true"),u.appendChild(f),u.title="Add task",u.addEventListener("click",()=>In(e.id));const m=document.createElement("div");m.classList.add("column-menu-wrapper");const p=document.createElement("button");p.classList.add("column-menu-btn"),p.type="button",p.setAttribute("aria-haspopup","menu"),p.setAttribute("aria-expanded","false"),p.setAttribute("aria-label",`${e.name} column menu`);const g=document.createElement("span");g.dataset.lucide="ellipsis-vertical",g.setAttribute("aria-hidden","true"),p.appendChild(g),p.title="Column menu";const y=document.createElement("div");y.classList.add("column-menu","hidden"),y.setAttribute("role","menu");const E=document.createElement("button");E.classList.add("column-menu-item"),E.type="button",E.setAttribute("role","menuitem");const L=document.createElement("span");L.dataset.lucide="pencil",L.setAttribute("aria-hidden","true"),E.appendChild(L);const B=document.createTextNode(" Edit");E.appendChild(B),E.title="Edit column",E.addEventListener("click",k=>{k.stopPropagation(),G(),xn(e.id)});const v=document.createElement("button");v.classList.add("column-menu-item","danger"),v.type="button",v.setAttribute("role","menuitem");const D=document.createElement("span");D.dataset.lucide="trash-2",D.setAttribute("aria-hidden","true"),v.appendChild(D);const ne=document.createTextNode(" Delete");v.appendChild(ne),v.title="Delete column",v.addEventListener("click",k=>{k.stopPropagation(),G(),(async()=>{if(e.id==="done"){await O({title:"Cannot Delete Column",message:"The Done column is permanent and cannot be deleted."});return}if(N().length<=1){await O({title:"Cannot Delete Column",message:"Cannot delete the last column."});return}const Ye=x().filter(Ht=>Ht.column===e.id),Ke=e?.name?`"${e.name}"`:"this column",Rt=Ye.length>0?`Delete ${Ke}? This will also delete ${Ye.length} task(s).`:`Delete ${Ke}?`;await J({title:"Delete Column",message:Rt,confirmText:"Delete"})&&Qt(e.id)&&P()})()});const h=document.createElement("div");h.classList.add("column-menu-submenu-wrapper");const b=document.createElement("button");b.classList.add("column-menu-item","has-submenu"),b.type="button",b.setAttribute("role","menuitem"),b.setAttribute("aria-haspopup","menu"),b.setAttribute("aria-expanded","false");const C=document.createElement("span");C.dataset.lucide="arrow-up-down",C.setAttribute("aria-hidden","true"),b.appendChild(C);const U=document.createTextNode(" Sort");b.appendChild(U);const ge=document.createElement("span");ge.dataset.lucide="chevron-left",ge.classList.add("submenu-chevron"),ge.setAttribute("aria-hidden","true"),b.appendChild(ge),b.title="Sort tasks in column";const _=document.createElement("div");_.classList.add("column-submenu","hidden"),_.setAttribute("role","menu");const z=document.createElement("button");z.classList.add("column-menu-item"),z.type="button",z.setAttribute("role","menuitem"),z.textContent="By Due Date",z.title="Sort by due date (earliest first)",z.addEventListener("click",k=>{k.stopPropagation(),G(),lt(e.id,"dueDate")});const q=document.createElement("button");q.classList.add("column-menu-item"),q.type="button",q.setAttribute("role","menuitem"),q.textContent="By Priority",q.title="Sort by priority (urgent to none)",q.addEventListener("click",k=>{k.stopPropagation(),G(),lt(e.id,"priority")}),_.appendChild(z),_.appendChild(q),b.addEventListener("click",k=>{k.stopPropagation();const he=!_.classList.contains("hidden");_.classList.toggle("hidden"),b.setAttribute("aria-expanded",he?"false":"true")}),h.addEventListener("mouseenter",()=>{_.classList.remove("hidden"),b.setAttribute("aria-expanded","true")}),h.addEventListener("mouseleave",()=>{_.classList.add("hidden"),b.setAttribute("aria-expanded","false")}),h.appendChild(b),h.appendChild(_),y.appendChild(E),y.appendChild(h),y.appendChild(v),p.addEventListener("click",k=>{k.stopPropagation();const he=!y.classList.contains("hidden");G(),he?p.setAttribute("aria-expanded","false"):(y.classList.remove("hidden"),p.setAttribute("aria-expanded","true"))}),m.appendChild(p),m.appendChild(y),d.appendChild(u),d.appendChild(m),a.appendChild(n),a.appendChild(i),a.appendChild(r),a.appendChild(c),a.appendChild(d);const oe=document.createElement("ul");return oe.classList.add("tasks"),oe.setAttribute("role","list"),oe.setAttribute("aria-label",`Tasks in ${e.name}`),o&&(oe.classList.add("hidden"),d.classList.add("hidden"),c.classList.add("hidden")),t.appendChild(a),t.appendChild(oe),t}function Zn(){const e=N(),t=document.getElementById("task-column");t.innerHTML="",e.forEach(o=>{const n=document.createElement("option");n.value=o.id,n.textContent=o.name,t.appendChild(n)})}function eo(){const e=x(),t=new Map(A().map(n=>[n.id,{name:(n.name||"").toString().trim().toLowerCase(),group:(n.group||"").toString().trim().toLowerCase()}])),o=(Je||"").toString().trim().toLowerCase();document.querySelectorAll(".task-counter").forEach(n=>{const s=n.dataset.columnId;if(!s)return;const i=e.filter(l=>l.column!==s?!1:o?$t(l,o,t):!0);n.textContent=i.length})}function to(){document.querySelectorAll(".task-column.is-collapsed").forEach(e=>{const t=e.dataset.column,o=e.querySelector("h2");if(!t||!o)return;const n=Ot(t),s=o.textContent.replace(/\s*\(\d+\)$/,"");o.textContent=`${s} (${n})`})}function P(){const e=N(),t=x(),o=A(),n=w(),s=new Map(o.map(d=>[d.id,d])),i=new Map(o.map(d=>[d.id,{name:(d.name||"").toString().trim().toLowerCase(),group:(d.group||"").toString().trim().toLowerCase()}])),l=(Je||"").toString().trim().toLowerCase(),a=l?t.filter(d=>$t(d,l,i)):t,r=document.getElementById("board-container");r.innerHTML="",[...e].sort((d,u)=>(d.order??0)-(u.order??0)).forEach(d=>{const u=Qn(d);r.appendChild(u);const f=u.querySelector(".tasks"),m=u.querySelector(".task-counter"),p=a.filter(L=>L.column===d.id).sort((L,B)=>(L.order??0)-(B.order??0)),y=d.id==="done"&&p.length>Pt;if((y?p.slice(0,Ee):p).forEach(L=>{f.appendChild(Xn(L,n,s))}),y&&Ee<p.length){const L=document.createElement("button");L.classList.add("show-more-btn"),L.type="button",L.textContent=`Show more (${p.length-Ee} remaining)`,L.addEventListener("click",()=>{Ee+=Vn,P()}),f.appendChild(L)}m.textContent=p.length}),Rn(),Zn(),Y(),de(),rt||(rt=!0,document.addEventListener("click",()=>G()),document.addEventListener("keydown",d=>{d.key==="Escape"&&G()}))}const $=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:P,setBoardFilterQuery:_t,syncCollapsedTitles:to,syncTaskCounters:eo},Symbol.toStringTag,{value:"Module"}));function no(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function dt(e){const t=ee(),o=qe();e.innerHTML="",t.forEach(n=>{const s=document.createElement("option");s.value=n.id,s.textContent=no(n),e.appendChild(s)}),o&&(e.value=o)}function Re(){const e=document.getElementById("brand-text")||document.querySelector(".brand-text");e&&(e.textContent=Ie())}function oo(){const e=document.getElementById("board-create-modal"),t=document.getElementById("board-create-name");!e||!t||(t.value="",e.classList.remove("hidden"),t.focus())}function ae(){const e=document.getElementById("board-create-modal");e&&e.classList.add("hidden")}function ao(){De();const e=document.getElementById("board-select");if(!e)return;dt(e),Re(),document.addEventListener("kanban:open-board-create",()=>{oo()}),e.addEventListener("change",()=>{const s=e.value;if(!s)return;ce(s),Re(),P();const i=document.getElementById("board-controls-menu"),l=document.getElementById("desktop-menu-btn");i?.classList.remove("show"),l?.setAttribute("aria-expanded","false")});const t=document.getElementById("board-create-modal"),o=document.getElementById("board-create-form"),n=document.getElementById("cancel-board-create-btn");t&&(t.querySelector(".modal-backdrop")?.addEventListener("click",ae),t.addEventListener("keydown",i=>{i.key==="Escape"&&ae()})),n&&n.addEventListener("click",ae),T("board-create-modal",ae),o&&o.addEventListener("submit",async s=>{s.preventDefault();const i=document.getElementById("board-create-name"),l=(i?.value||"").trim();if(!l){await O({title:"Error",message:"Board name cannot be empty."}),i?.focus();return}const a=ct(l);ce(a.id),dt(e),Re(),P(),ae(),document.dispatchEvent(new CustomEvent("kanban:boards-changed"))})}function so(e){const t=[];for(const o of e){if(typeof o!="string")continue;const n=o.trim();n&&(t.includes(n)||t.push(n))}return t}function io(e){const t=typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US";return so([e,t,"en-US","en-GB","de-DE","fr-FR","es-ES","it-IT","pt-BR","ja-JP","zh-CN"])}function ro(){document.getElementById("settings-modal")?.classList.remove("hidden")}function He(){document.getElementById("settings-modal")?.classList.add("hidden")}async function W(e){ut(e);const{renderBoard:t}=await M(async()=>{const{renderBoard:o}=await Promise.resolve().then(()=>$);return{renderBoard:o}},void 0,import.meta.url);t()}function lo(){const e=document.getElementById("settings-btn"),t=document.getElementById("settings-close-btn");document.querySelector("#settings-modal .modal-backdrop");const o=document.getElementById("settings-show-priority"),n=document.getElementById("settings-show-due-date"),s=document.getElementById("settings-notification-days"),i=document.getElementById("settings-show-age"),l=document.getElementById("settings-show-change-date"),a=document.getElementById("settings-locale"),r=document.getElementById("settings-default-priority");if(!e||!t||!o||!n||!s||!i||!l||!a||!r)return;function c(){const d=w();o.checked=d.showPriority!==!1,n.checked=d.showDueDate!==!1,i.checked=d.showAge!==!1,l.checked=d.showChangeDate!==!1,s.value=String(Number.isFinite(d.notificationDays)?d.notificationDays:3);const u=io(d.locale);a.innerHTML="",u.forEach(f=>{const m=document.createElement("option");m.value=f,m.textContent=f,a.appendChild(m)}),a.value=d.locale,r.value=d.defaultPriority||"none"}e.addEventListener("click",()=>{c(),ro()}),t.addEventListener("click",He),T("settings-modal",He),document.addEventListener("keydown",d=>{const u=document.getElementById("settings-modal");!u||u.classList.contains("hidden")||d.key==="Escape"&&He()}),i.addEventListener("change",async()=>{const d=w();await W({...d,showAge:!!i.checked})}),l.addEventListener("change",async()=>{const d=w();await W({...d,showChangeDate:!!l.checked})}),o.addEventListener("change",async()=>{const d=w();await W({...d,showPriority:!!o.checked})}),n.addEventListener("change",async()=>{const d=w();await W({...d,showDueDate:!!n.checked})}),s.addEventListener("change",async()=>{const d=w(),u=Number.parseInt(s.value,10),f=Number.isFinite(u)?u:3;await W({...d,notificationDays:f})}),a.addEventListener("change",async()=>{const d=w();await W({...d,locale:a.value})}),r.addEventListener("change",async()=>{const d=w();await W({...d,defaultPriority:r.value})})}document.addEventListener("DOMContentLoaded",()=>{const e=new URLSearchParams(window.location.search),t=(e.get("openTaskId")||"").trim(),o=(e.get("openTaskBoardId")||"").trim();o&&(De(),ce(o));const n=document.getElementById("app-version");n&&(n.textContent="v1.0.13",n.title="Version 1.0.13"),zt(),lo();const s=document.getElementById("board-search-input");s&&s.addEventListener("input",()=>{_t(s.value),P()}),ao(),On(),Mt(),document.getElementById("export-btn").addEventListener("click",async()=>{await J({title:"Export Board (Active Only)",message:`Export ONLY saves the current active board. It does NOT back up all boards.

To back up everything, export each board individually.

Continue with export?`,confirmText:"Export"})&&hn()}),document.getElementById("import-btn").addEventListener("click",async()=>{await J({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",a=>{const r=a.target.files[0];r&&bn(r),a.target.value=""});const i=document.getElementById("desktop-menu-btn"),l=document.getElementById("board-controls-menu");if(i&&l&&(i.addEventListener("click",a=>{a.stopPropagation();const r=i.getAttribute("aria-expanded")==="true";l.classList.toggle("show"),i.setAttribute("aria-expanded",String(!r)),document.querySelectorAll(".column-menu").forEach(c=>c.classList.add("hidden"))}),l.addEventListener("click",a=>{a.target.closest("select, option, input, textarea, label")||!a.target.closest('button, a, [role="menuitem"]')||(l.classList.remove("show"),i.setAttribute("aria-expanded","false"))}),document.addEventListener("click",a=>{!l.contains(a.target)&&!i.contains(a.target)&&(l.classList.remove("show"),i.setAttribute("aria-expanded","false"))})),P(),t){R(t);const a=`${window.location.pathname}${window.location.hash||""}`;window.history.replaceState({},"",a)}});
