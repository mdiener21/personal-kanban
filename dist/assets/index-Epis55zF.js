import{l as J,g as fn,s as Ee,a as ae,b as He,c as se,d as Pt,e as X,f as Mt,h as Xn,i as It,j as jn,k as ze,r as Ae,m as pn,n as hn,o as Bo,p as To}from"./storage-DkIqoUsv.js";const Ao=new Set(["low","medium","high"]);function Wn(e){const t=(e||"").toString().trim().toLowerCase();return Ao.has(t)?t:"low"}function qn(e){return(e||"").toString().trim()}function xo(e,t,o,n,a,i=[]){if(!e||e.trim()==="")return;const r=J(),s=r.filter(m=>m.column===a).slice().sort((m,f)=>(m.order??0)-(f.order??0)),l=new Map;s.forEach((m,f)=>{l.set(m.id,f+2)});const d=r.map(m=>{if(m.column!==a)return m;const f=l.get(m.id);return typeof f=="number"?{...m,order:f}:m}),c=new Date().toISOString(),u={id:fn(),title:e.trim(),description:(t||"").toString().trim(),priority:Wn(o),dueDate:qn(n),column:a,order:1,labels:[...i],creationDate:c,changeDate:c,columnHistory:[{column:a,at:c}],...a==="done"?{doneDate:c}:{}};d.push(u),Ee(d)}function _o(e,t,o,n,a,i,r=[]){if(!t||t.trim()==="")return;const s=J(),l=s.findIndex(d=>d.id===e);if(l!==-1){const d=s[l].column,c=i,u=new Date().toISOString();if(!Array.isArray(s[l].columnHistory)||s[l].columnHistory.length===0){const m=s[l].creationDate||s[l].changeDate||u,f=typeof d=="string"?d:c;s[l].columnHistory=[{column:f,at:m}]}s[l].title=t.trim(),s[l].description=(o||"").toString().trim(),s[l].priority=Wn(n),s[l].dueDate=qn(a),s[l].column=c,s[l].labels=[...r],d!==c&&s[l].columnHistory.push({column:c,at:u}),d!=="done"&&c==="done"?s[l].doneDate=u:d==="done"&&c!=="done"&&delete s[l].doneDate,s[l].changeDate=u,Ee(s)}}function No(e){const o=J().filter(n=>n.id!==e);return Ee(o),!0}function Oo(){const e=[];return document.querySelectorAll(".task-column").forEach(t=>{const o=t.dataset.column;t.querySelectorAll(".task").forEach(n=>{e.push({id:n.dataset.taskId,column:o})})}),e}function Po(){const e=Oo(),t=J(),o=new Date().toISOString(),n=t.map(a=>{const i=e.findIndex(r=>r.id===a.id);if(i!==-1){const r=e[i],s=e.filter((m,f)=>m.column===r.column&&f<=i),l=r.column,d=s.length,c=a.column!==l,u={...a,column:l,order:d,...c?{changeDate:o}:{}};if(c){const m=Array.isArray(a.columnHistory)&&a.columnHistory.length?[...a.columnHistory]:[{column:a.column,at:a.creationDate||a.changeDate||o}];m.push({column:l,at:o}),u.columnHistory=m,a.column!=="done"&&l==="done"?u.doneDate=o:a.column==="done"&&l!=="done"&&delete u.doneDate}return{...u}}return a});Ee(n)}function Mo(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function Gn(e){return Mo(e)?e.trim():"#3b82f6"}function Ro(e,t){if(!e||e.trim()==="")return;const o=ae(),n=o.reduce((r,s)=>Math.max(r,s.order??0),0),i={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+fn().substring(0,8),name:e.trim(),color:Gn(t),order:n-1,collapsed:!1};o.push(i),He(o)}function Fo(e){const t=typeof e=="string"?e.trim():"";if(!t)return!1;const o=ae(),n=o.find(a=>a.id===t);return n?(n.collapsed=n.collapsed!==!0,He(o),!0):!1}function $o(e,t,o){if(!t||t.trim()==="")return;const n=ae(),a=n.findIndex(i=>i.id===e);a!==-1&&(n[a].name=t.trim(),n[a].color=Gn(o),He(n))}function Ho(e){if(e==="done")return!1;const t=ae();if(t.length<=1)return!1;const o=J();if(o.filter(i=>i.column===e).length>0){const i=o.filter(r=>r.column!==e);Ee(i)}const a=t.filter(i=>i.id!==e);return He(a),!0}function zo(){const t=document.getElementById("board-container").querySelectorAll(".task-column"),o=ae();t.forEach((n,a)=>{const i=n.dataset.column,r=o.find(s=>s.id===i);r&&(r.order=a+1)}),He(o)}const Yo="modulepreload",Uo=function(e,t){return new URL(e,t).href},Ln={},de=function(t,o,n){let a=Promise.resolve();if(o&&o.length>0){let d=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const r=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),l=s?.nonce||s?.getAttribute("nonce");a=d(o.map(c=>{if(c=Uo(c,n),c in Ln)return;Ln[c]=!0;const u=c.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(n)for(let h=r.length-1;h>=0;h--){const g=r[h];if(g.href===c&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Yo,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((h,g)=>{f.addEventListener("load",h),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(r){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=r,window.dispatchEvent(s),!s.defaultPrevented)throw r}return a.then(r=>{for(const s of r||[])s.status==="rejected"&&i(s.reason);return t().catch(i)})},gn=40;function bn(e){return e.trim().slice(0,gn).toLowerCase().replace(/\s+/g," ")}function Vn(e,t,o=null){return e.some(n=>o&&n.id===o?!1:bn(n.name)===t)}function Xo(e,t){if(!e||e.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const o=e.trim().slice(0,gn),n=bn(o),a=se();if(Vn(a,n))return{success:!1,reason:"DUPLICATE_NAME",message:`Label "${o}" already exists.`};const r={id:n.replace(/\s+/g,"-")+"-"+fn().substring(0,8),name:o,color:t};return a.push(r),Pt(a),{success:!0,label:r}}function jo(e,t,o){if(!t||t.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const n=t.trim().slice(0,gn),a=bn(n),i=se(),r=i.findIndex(s=>s.id===e);return r===-1?{success:!1,reason:"NOT_FOUND"}:Vn(i,a,e)?{success:!1,reason:"DUPLICATE_NAME",message:`Another label with the name "${n}" already exists.`}:(i[r].name=n,i[r].color=o,Pt(i),{success:!0,label:i[r]})}function Wo(e){const t=se(),o=J();o.forEach(a=>{a.labels&&(a.labels=a.labels.filter(i=>i!==e))}),Ee(o);const n=t.filter(a=>a.id!==e);Pt(n)}let St=null;function oe(e){return document.getElementById(e)}function ut(e){const t=oe("dialog-modal");t&&t.classList.add("hidden");const o=St;St=null,typeof o=="function"&&o(!!e)}function qo(){const e=oe("dialog-modal");return e&&!e.classList.contains("hidden")}function Kn({title:e,message:t,confirmText:o,cancelText:n,showCancel:a}){const i=oe("dialog-modal-title"),r=oe("dialog-modal-message"),s=oe("dialog-confirm-btn"),l=oe("dialog-cancel-btn");i&&(i.textContent=e||"Confirm"),r&&(r.textContent=t||""),s&&(s.textContent=o||"OK"),l&&(l.textContent=n||"Cancel"),l&&(l.style.display=a?"inline-flex":"none")}function Jn(){const e=oe("dialog-modal");if(!e||e.dataset.handlersAttached==="true")return;e.dataset.handlersAttached="true";const t=oe("dialog-confirm-btn"),o=oe("dialog-cancel-btn");e.querySelector(".modal-backdrop"),t?.addEventListener("click",()=>ut(!0)),o?.addEventListener("click",()=>ut(!1)),te("dialog-modal",()=>ut(!1)),document.addEventListener("keydown",n=>{n.key==="Escape"&&qo()&&ut(!1)})}function Qn(){const e=oe("dialog-modal");if(!e)return;e.classList.remove("hidden"),oe("dialog-confirm-btn")?.focus()}function Te({title:e="Confirm",message:t="",confirmText:o="Delete",cancelText:n="Cancel"}={}){return Jn(),Kn({title:e,message:t,confirmText:o,cancelText:n,showCancel:!0}),Qn(),new Promise(a=>{St=a})}function be({title:e="Notice",message:t="",okText:o="OK"}={}){return Jn(),Kn({title:e,message:t,confirmText:o,cancelText:"",showCancel:!1}),Qn(),new Promise(n=>{St=()=>n(!0)})}function Yt(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return Array.isArray(o)?o:null}catch{return null}}function Go(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return o&&typeof o=="object"&&!Array.isArray(o)?o:null}catch{return null}}function Zn(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function Vo(e){const t=document.getElementById("brand-text")||document.querySelector(".brand-text");t&&(t.textContent=Mt());const o=document.getElementById("board-select");if(!o)return;const n=ze();o.innerHTML="",n.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=Zn(a),o.appendChild(i)}),e&&(o.value=e)}function Ko(e){const t=typeof e?.name=="string"?e.name.trim():"";return t?t.replace(/\.[^.]+$/,"").trim():""}function Rt(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const Jo=new Set(["low","medium","high"]);function Ft(e){const t=(e||"").toString().trim().toLowerCase();return Jo.has(t)?t:"low"}function Qo(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},o=t.showPriority!==!1,n=t.showDueDate!==!1,a=t.showAge!==!1,i=t.showChangeDate!==!1,r=typeof t.locale=="string"&&t.locale.trim()?t.locale.trim():typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US",s=Ft(t.defaultPriority),l=Number.parseInt((t.notificationDays??"").toString(),10),d=Number.isFinite(l)?Math.min(365,Math.max(0,l)):3;return{showPriority:o,showDueDate:n,showAge:a,showChangeDate:i,locale:r,defaultPriority:s,notificationDays:d}}function eo(e){const t=(e||"").toString().trim();return t.length>=10&&t.includes("T")?t.slice(0,10):t}function to(e){const t=typeof e?.text=="string"?e.text:"",o=typeof e?.title=="string"?e.title:t,n=typeof e?.description=="string"?e.description:"",a=eo(e?.dueDate??e?.["due-date"]),i=typeof e?.changeDate=="string"?e.changeDate:typeof e?.changedDate=="string"?e.changedDate:void 0,r=e?.column==="done",s=typeof e?.doneDate=="string"?e.doneDate.toString().trim():"",l=Array.isArray(e?.columnHistory)?e.columnHistory.map(d=>{const c=typeof d?.column=="string"?d.column.trim():"",u=typeof d?.at=="string"?d.at.trim():"";return!c||!u?null:{column:c,at:u}}).filter(Boolean):void 0;return{...e,title:o.toString().trim(),description:n.toString().trim(),priority:Ft(e?.priority),dueDate:a,...typeof i=="string"?{changeDate:i.toString().trim()}:{},...r&&s?{doneDate:s}:{doneDate:void 0},...l&&l.length?{columnHistory:l}:{columnHistory:void 0},changedDate:void 0}}function Zo(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.text=="string"?n.text:String(n?.text??""),r=typeof n?.title=="string"?n.title:i,s=typeof n?.description=="string"?n.description:String(n?.description??""),l=Ft(n?.priority),d=typeof n?.dueDate=="string"?n.dueDate:typeof n?.["due-date"]=="string"?n["due-date"]:String(n?.dueDate??n?.["due-date"]??""),c=eo(d),u=typeof n?.column=="string"?n.column:String(n?.column??""),m=Array.isArray(n?.labels)?n.labels.map(w=>typeof w=="string"?w:String(w)):[],f=Number.isFinite(n?.order)?n.order:void 0,h=typeof n?.creationDate=="string"?n.creationDate:void 0,g=typeof n?.changeDate=="string"?n.changeDate:typeof n?.changedDate=="string"?n.changedDate:void 0,D=typeof n?.doneDate=="string"?n.doneDate.trim():"",S=u.trim()==="done"&&(D||(typeof g=="string"?g.trim():"")||h)||"",k=Array.isArray(n?.columnHistory)?n.columnHistory.map(w=>{const v=typeof w?.column=="string"?w.column.trim():String(w?.column??"").trim(),C=typeof w?.at=="string"?w.at.trim():String(w?.at??"").trim();return!v||!C?null:{column:v,at:C}}).filter(Boolean):void 0;return{id:a.trim(),title:r.trim(),description:s.trim(),priority:l,dueDate:c.trim(),column:u.trim(),...f!==void 0?{order:f}:{},...h?{creationDate:h}:{},...typeof g=="string"&&g.trim()?{changeDate:g.trim()}:{},...S?{doneDate:S}:{},...k&&k.length?{columnHistory:k}:{},labels:m}});return t.every(n=>n.id&&n.title&&n.column)?t:null}function ea(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),r=Number.isFinite(n?.order)?n.order:void 0,s=Rt(n?.color)?n.color.trim():"#3b82f6",l=n?.collapsed===!0;return{id:a.trim(),name:i.trim(),color:s,collapsed:l,...r!==void 0?{order:r}:{}}});if(!t.some(n=>n.id==="done")){const n=t.reduce((a,i)=>Math.max(a,Number.isFinite(i?.order)?i.order:0),0);t.push({id:"done",name:"Done",color:"#16a34a",order:n+1,collapsed:!1})}return t.every(n=>n.id&&n.name)?t:null}function ta(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),i=typeof n?.name=="string"?n.name:String(n?.name??""),r=Rt(n?.color)?n.color.trim():"#3b82f6";return{id:a.trim(),name:i.trim(),color:r}});return t.every(n=>n.id&&n.name&&n.color)?t:null}function na(e){if(!e||typeof e!="object"||Array.isArray(e))return null;const t=e.showPriority!==!1,o=e.showDueDate!==!1,n=e.showAge!==!1,a=e.showChangeDate!==!1,i=typeof e.locale=="string"&&e.locale.trim()?e.locale.trim():void 0,r=typeof e.defaultPriority=="string"?e.defaultPriority:void 0,s=r?Ft(r):void 0,l=Number.parseInt((e.notificationDays??"").toString(),10),d=Number.isFinite(l)?Math.min(365,Math.max(0,l)):void 0;return{showPriority:t,showDueDate:o,showAge:n,showChangeDate:a,...i?{locale:i}:{},...s?{defaultPriority:s}:{},...d!==void 0?{notificationDays:d}:{}}}function oa(){const e=J().map(to),t=ae().map(c=>({...c,color:Rt(c?.color)?c.color.trim():"#3b82f6"})),o=se(),n=X(),a=Mt(),r=JSON.stringify({boardName:a,columns:t,tasks:e,labels:o,settings:n},null,2),s=new Blob([r],{type:"application/json"}),l=URL.createObjectURL(s),d=document.createElement("a");d.href=l,d.download=`${a.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(l)}function aa(e){const t=typeof e=="string"?e.trim():"";if(!t)return;const o=ze().find(v=>v.id===t),n=Zn(o),a=`kanbanBoard:${t}:columns`,i=`kanbanBoard:${t}:tasks`,r=`kanbanBoard:${t}:labels`,s=`kanbanBoard:${t}:settings`,l=Yt(i)||[],d=Yt(a)||[],c=Yt(r)||[],u=Go(s)||null,m=l.map(to),f=d.map(v=>({...v,color:Rt(v?.color)?v.color.trim():"#3b82f6",collapsed:v?.collapsed===!0})),h=Array.isArray(c)?c:[],g=Qo(u),B=JSON.stringify({boardName:n,columns:f,tasks:m,labels:h,settings:g},null,2),S=new Blob([B],{type:"application/json"}),k=URL.createObjectURL(S),w=document.createElement("a");w.href=k,w.download=`${n.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(k)}function ia(e){const t=new FileReader;t.onload=async o=>{try{const n=JSON.parse(o.target.result);let a,i,r,s,l;if(Array.isArray(n))a=n,i=null,r=null,s=null,l=null;else if(n.tasks&&n.columns)a=n.tasks,i=n.columns,r=Object.prototype.hasOwnProperty.call(n,"labels")?n.labels:null,s=Object.prototype.hasOwnProperty.call(n,"settings")?n.settings:null,l=typeof n.boardName=="string"?n.boardName.trim():null;else{alert("Invalid JSON file format");return}const d=Zo(a),c=i?ea(i):null,u=r?ta(r):null,m=s?na(s):null;if(!d||i&&!c||r&&!u||s&&!m){alert("Invalid data structure");return}const f=l||Ko(e)||"Imported board",h=Xn(f);if(h?.id&&It(h.id),c&&He(c),Ee(d),u&&Pt(u),m){const D=X();jn({...D,...m})}Vo(h?.id);const{renderBoard:g}=await de(async()=>{const{renderBoard:D}=await Promise.resolve().then(()=>ue);return{renderBoard:D}},void 0,import.meta.url);g(),document.dispatchEvent(new CustomEvent("kanban:boards-changed")),alert("Board imported successfully!")}catch(n){alert("Error parsing JSON file: "+n.message)}},t.readAsText(e)}function no(e,t){if(!e)return;const o=e.closest(".form-group");if(!o)return;o.classList.add("error");let n=o.querySelector(".error-message");n||(n=document.createElement("div"),n.classList.add("error-message"),o.appendChild(n)),n.textContent=t,e.focus()}function Ye(e){if(!e)return;const t=e.closest(".form-group");t&&t.classList.remove("error")}function ra(e){return(e?.trim()||"").length>0}function sa(e){const t=e?.value?.trim()||"";return ra(t)?(Ye(e),!0):(no(e,"Task title is required"),!1)}function la(e){return(e?.trim()||"").length>0}function da(e){const t=e?.value?.trim()||"";return la(t)?(Ye(e),!0):(no(e,"Column name is required"),!1)}let In="todo",ot=null,at=null,Ve=null,kt=null,j=[],ve=!1,rt=!1;const De=40;let Xe=!1;function $t(e){const t=document.getElementById("task-modal");if(!t)return;t.classList.toggle("fullscreen",!!e);const o=document.getElementById("task-fullpage-btn");if(o?.setAttribute("aria-pressed",e?"true":"false"),o){const n=o.querySelector("[data-lucide]");n&&n.setAttribute("data-lucide",e?"minimize-2":"maximize-2"),o.title=e?"Exit full page":"Open in full page"}Ae()}function Ce(e){const t=document.getElementById(e);return!!t&&!t.classList.contains("hidden")}function te(e,t){const o=document.getElementById(e);if(!o)return;o.querySelector(".modal-backdrop")?.addEventListener("click",t),o.querySelectorAll('[id$="-close-btn"], [id$="-close-modal-btn"], [id$="-cancel-btn"], [id^="cancel-"]').forEach(i=>{i.addEventListener("click",t)})}function ca(){const e=document.getElementById("task-modal");e&&(e.classList.remove("hidden"),Fe(),document.getElementById("task-label-search")?.focus(),ve=!1)}function ua(){return(document.getElementById("task-label-search")?.value||"").trim().toLowerCase()}function ma(){return(document.getElementById("labels-search")?.value||"").trim().toLowerCase()}function rn(){const e=document.getElementById("task-active-labels");if(!e)return;const t=se(),o=[];for(const a of j)o.includes(a)||o.push(a);j=o;const n=o.map(a=>t.find(i=>i.id===a)).filter(Boolean);e.innerHTML="",e.style.display=n.length>0?"flex":"none",n.forEach(a=>{const i=document.createElement("span");i.classList.add("task-label"),i.style.backgroundColor=a.color,i.textContent=a.name;const r=document.createElement("button");r.type="button",r.classList.add("active-label-remove"),r.setAttribute("aria-label",`Remove label ${a.name}`),r.title="Remove label",r.textContent="Ã—",r.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),j=j.filter(l=>l!==a.id),rn(),Fe()}),i.appendChild(r),e.appendChild(i)})}function fa(e){In=e||ae()[0]?.id||"todo",ot=null,j=[],ve=!1,rt=!1,$t(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden");const t=document.getElementById("task-modal"),o=document.getElementById("task-column"),n=document.getElementById("task-title"),a=document.getElementById("task-description"),i=document.getElementById("task-priority"),r=document.getElementById("task-due-date"),s=document.getElementById("task-modal-title"),l=document.getElementById("task-submit-btn");if(Ye(n),s.textContent="Add New Task",l.textContent="Add Task",o.value=In,n.value="",a.value="",i){const c=X();i.value=c.defaultPriority||"low"}r&&(r.value="");const d=document.getElementById("task-label-search");d&&(d.value=""),Fe(),t.classList.remove("hidden"),n.focus()}function Ke(e){const o=J().find(g=>g.id===e);if(!o)return;ot=e,j=o.labels||[],ve=!1,rt=!1,$t(!1),document.getElementById("task-fullpage-btn")?.classList.remove("hidden");const n=document.getElementById("task-modal"),a=document.getElementById("task-column"),i=document.getElementById("task-title"),r=document.getElementById("task-description"),s=document.getElementById("task-priority"),l=document.getElementById("task-due-date"),d=document.getElementById("task-modal-title"),c=document.getElementById("task-submit-btn");Ye(i),d.textContent="Edit Task",c.textContent="Save Changes",a.value=o.column;const u=typeof o.text=="string"?o.text:"";i.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:u,r.value=typeof o.description=="string"?o.description:"",s&&(s.value=typeof o.priority=="string"?o.priority:"medium");const m=typeof o.dueDate=="string"?o.dueDate:"",f=m.includes("T")?m.slice(0,10):m;l&&(l.value=f);const h=document.getElementById("task-label-search");h&&(h.value=""),Fe(),n.classList.remove("hidden"),i.focus()}function Ut(){document.getElementById("task-modal").classList.add("hidden"),ot=null,ve=!1,$t(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden")}function pa(){at=null;const e=document.getElementById("column-modal"),t=document.getElementById("column-name"),o=document.getElementById("column-color"),n=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");Ye(t),n.textContent="Add New Column",a.textContent="Add Column",t.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),t.focus()}function ha(e){const o=ae().find(l=>l.id===e);if(!o)return;at=e;const n=document.getElementById("column-modal"),a=document.getElementById("column-name"),i=document.getElementById("column-color"),r=document.getElementById("column-modal-title"),s=document.getElementById("column-submit-btn");Ye(a),r.textContent="Edit Column",s.textContent="Save Changes",a.value=o.name,i&&(i.value=o.color||"#3b82f6"),n.classList.remove("hidden"),a.focus()}function Xt(){document.getElementById("column-modal").classList.add("hidden"),at=null}function ga(){const e=document.getElementById("labels-search");e&&(e.value=""),Tt(),document.getElementById("labels-modal").classList.remove("hidden"),ve||document.getElementById("labels-search")?.focus()}function jt(){document.getElementById("labels-modal").classList.add("hidden");const t=document.getElementById("labels-search");t&&(t.value=""),ve&&ca()}function ba(){document.getElementById("help-modal").classList.remove("hidden")}function Sn(){document.getElementById("help-modal").classList.add("hidden")}function Bt(e=null,{openedFromTaskEditor:t=!1,initialName:o=""}={}){Ve=e,Xe=!1,rt=!!t;const n=document.getElementById("label-modal"),a=document.getElementById("label-modal-title"),i=document.getElementById("label-name"),r=document.getElementById("label-color"),s=document.getElementById("label-submit-btn");if(e){const d=se().find(c=>c.id===e);d&&(a.textContent="Edit Label",s.textContent="Update Label",i.value=d.name,r.value=d.color)}else a.textContent="Add Label",s.textContent="Add Label",i.value=o||"",r.value="#3b82f6";n.classList.remove("hidden"),i.focus()}function Wt(){document.getElementById("label-modal").classList.add("hidden"),Ve=null,rt=!1}function Tt(){const e=document.getElementById("labels-list");e.innerHTML="";const t=se(),o=ma(),n=o?t.filter(a=>{const i=(a.name||"").toLowerCase(),r=(a.id||"").toLowerCase();return i.includes(o)||r.includes(o)}):t;if(n.length===0){const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent=o?"No matching labels":"No labels yet",e.appendChild(a);return}n.forEach(a=>{const i=document.createElement("div");i.classList.add("label-item"),i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="space-between";const r=document.createElement("span");r.classList.add("task-label"),r.style.backgroundColor=a.color,r.textContent=a.name;const s=document.createElement("div");s.classList.add("label-actions"),s.style.display="flex",s.style.gap="4px";const l=document.createElement("button");l.classList.add("btn-small");const d=document.createElement("span");d.dataset.lucide="pencil",l.appendChild(d),l.title="Edit label",l.addEventListener("click",()=>Bt(a.id));const c=document.createElement("button");c.classList.add("btn-small","btn-danger");const u=document.createElement("span");u.dataset.lucide="trash-2",c.appendChild(u),c.title="Delete label",c.addEventListener("click",async()=>{if(await Te({title:"Delete Label",message:`Delete label "${a.name}"? This will remove it from all tasks.`,confirmText:"Delete"})){Wo(a.id),Tt();const{renderBoard:f}=await de(async()=>{const{renderBoard:h}=await Promise.resolve().then(()=>ue);return{renderBoard:h}},void 0,import.meta.url);f()}}),s.appendChild(l),s.appendChild(c),i.appendChild(r),i.appendChild(s),e.appendChild(i)}),Ae()}function sn(){const e=document.getElementById("board-select");if(!e)return;const t=ze(),o=hn();e.innerHTML="",t.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=typeof a.name=="string"&&a.name.trim()?a.name.trim():"Untitled board",e.appendChild(i)}),o&&(e.value=o);const n=document.getElementById("brand-text")||document.querySelector(".brand-text");n&&(n.textContent=Mt())}function it(){pn();const e=document.getElementById("boards-list");if(!e)return;e.innerHTML="";const t=ze(),o=hn();t.forEach(n=>{const a=document.createElement("div");a.classList.add("label-item"),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="10px";const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";const r=document.createElement("span");if(r.textContent=(n.name||"").toString(),i.appendChild(r),n.id===o){const g=document.createElement("span");g.classList.add("task-label"),g.style.backgroundColor="var(--color-primary)",g.textContent="Active",i.appendChild(g)}const s=document.createElement("div");s.classList.add("label-actions"),s.style.display="flex",s.style.gap="4px";const l=document.createElement("button");l.classList.add("btn-small"),l.textContent="Open",l.title="Open board",l.addEventListener("click",async()=>{It(n.id),sn(),it();const{renderBoard:g}=await de(async()=>{const{renderBoard:D}=await Promise.resolve().then(()=>ue);return{renderBoard:D}},void 0,import.meta.url);g()});const d=document.createElement("button");d.classList.add("btn-small"),d.type="button",d.title="Export board",d.setAttribute("aria-label",`Export board ${String(n.name||"Untitled board")}`);const c=document.createElement("span");c.dataset.lucide="download",d.appendChild(c),d.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),aa(n.id)});const u=document.createElement("button");u.classList.add("btn-small");const m=document.createElement("span");m.dataset.lucide="pencil",u.appendChild(m),u.title="Rename board",u.addEventListener("click",()=>Ea(n.id));const f=document.createElement("button");f.classList.add("btn-small","btn-danger");const h=document.createElement("span");h.dataset.lucide="trash-2",f.appendChild(h),f.title="Delete board",f.addEventListener("click",async()=>{if(!await Te({title:"Delete Board",message:`Do you really want to delete the board "${n.name}"? This cannot be undone.`,confirmText:"Delete"}))return;if(!Bo(n.id)){await be({title:"Unable to Delete",message:"Unable to delete board (you may be trying to delete the last board)."});return}sn(),it();const{renderBoard:B}=await de(async()=>{const{renderBoard:S}=await Promise.resolve().then(()=>ue);return{renderBoard:S}},void 0,import.meta.url);B()}),s.appendChild(l),s.appendChild(d),s.appendChild(u),s.appendChild(f),a.appendChild(i),a.appendChild(s),e.appendChild(a)}),Ae()}function ya(){it(),document.getElementById("boards-modal")?.classList.remove("hidden")}function kn(){document.getElementById("boards-modal")?.classList.add("hidden")}function va(){const e=document.getElementById("boards-modal");!e||e.classList.contains("hidden")||it()}function Ea(e){pn();const t=ze().find(r=>r.id===e);if(!t)return;kt=e;const o=document.getElementById("board-rename-modal"),n=document.getElementById("board-rename-name"),a=document.getElementById("board-rename-modal-title"),i=document.getElementById("board-rename-submit-btn");a&&(a.textContent="Rename Board"),i&&(i.textContent="Save"),n&&(n.value=(t.name||"").toString()),o?.classList.remove("hidden"),n?.focus()}function qt(){document.getElementById("board-rename-modal")?.classList.add("hidden"),kt=null}function Fe(){rn();const e=document.getElementById("task-labels-selection");e.innerHTML="";const t=ua(),o=se(),n=t?o.filter(a=>{const i=(a.name||"").toLowerCase(),r=(a.id||"").toLowerCase();return i.includes(t)||r.includes(t)}):o;if(n.length===0){if(t){const a=document.createElement("button");a.type="button",a.classList.add("labels-empty-button"),a.textContent=`No label found "${t}" - Create label`,a.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),Bt(null,{openedFromTaskEditor:!0,initialName:t})}),e.appendChild(a)}else{const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent="No matching labels",e.appendChild(a)}return}n.forEach(a=>{const i=document.createElement("label");i.classList.add("label-checkbox");const r=document.createElement("input");r.type="checkbox",r.value=a.id,r.checked=j.includes(a.id),r.addEventListener("change",l=>{l.target.checked?j.includes(a.id)||j.push(a.id):j=j.filter(d=>d!==a.id),rn()});const s=document.createElement("span");s.classList.add("task-label","label-color-swatch"),s.style.backgroundColor=a.color,s.textContent=a.name,i.appendChild(r),i.appendChild(s),e.appendChild(i)})}function wa(){document.addEventListener("kanban:boards-changed",()=>{va()}),document.getElementById("task-label-search")?.addEventListener("input",Fe),document.getElementById("labels-search")?.addEventListener("input",Tt),document.getElementById("task-add-label-btn")?.addEventListener("click",()=>{ve=!1,Bt(null,{openedFromTaskEditor:!0})}),document.getElementById("task-fullpage-btn")?.addEventListener("click",()=>{const i=document.getElementById("task-modal");i&&$t(!i.classList.contains("fullscreen"))}),document.getElementById("task-form").addEventListener("submit",async i=>{i.preventDefault();const r=document.getElementById("task-title");if(!sa(r))return;const s=r.value.trim(),l=document.getElementById("task-description").value,d=document.getElementById("task-priority")?.value,c=document.getElementById("task-due-date")?.value,u=document.getElementById("task-column").value;ot?_o(ot,s,l,d,c,u,j):xo(s,l,d,c,u,j),Ut();const{renderBoard:m}=await de(async()=>{const{renderBoard:f}=await Promise.resolve().then(()=>ue);return{renderBoard:f}},void 0,import.meta.url);m()}),te("task-modal",Ut),document.getElementById("column-form").addEventListener("submit",async i=>{i.preventDefault();const r=document.getElementById("column-name");if(!da(r))return;const s=r.value.trim(),l=document.getElementById("column-color")?.value;at?$o(at,s,l):Ro(s,l),Xt();const{renderBoard:d}=await de(async()=>{const{renderBoard:c}=await Promise.resolve().then(()=>ue);return{renderBoard:c}},void 0,import.meta.url);d()}),te("column-modal",Xt),document.getElementById("manage-labels-btn").addEventListener("click",ga),document.getElementById("add-label-btn").addEventListener("click",()=>Bt()),te("labels-modal",jt);const a=document.getElementById("label-name");a?.addEventListener("beforeinput",i=>{if(!i||typeof i.data!="string"||i.data.length===0)return;const r=i.target;if(!r||typeof r.value!="string")return;const s=typeof r.selectionStart=="number"?r.selectionStart:r.value.length,l=typeof r.selectionEnd=="number"?r.selectionEnd:r.value.length;(r.value.slice(0,s)+i.data+r.value.slice(l)).trim().length<=De||(i.preventDefault(),!Xe&&(Xe=!0,be({title:"Label Name Too Long",message:`Label names are limited to ${De} characters.`})))}),a?.addEventListener("input",i=>{const r=i.target;if(!r||typeof r.value!="string")return;const s=r.value.trim();s.length<=De||(r.value=s.slice(0,De),!Xe&&(Xe=!0,be({title:"Label Name Too Long",message:`Label names are limited to ${De} characters.`})))}),document.getElementById("label-form").addEventListener("submit",async i=>{i.preventDefault();const r=document.getElementById("label-name").value,s=document.getElementById("label-color").value,l=(r||"").trim();if(l.length>De){await be({title:"Label Name Too Long",message:`Label names are limited to ${De} characters.`});return}const d=!Ve,c=Ve?jo(Ve,l,s):Xo(l,s);if(!c?.success){let m="Unable to Save Label",f="Could not save label.";c?.reason==="DUPLICATE_NAME"?(m="Label Already Exists",f=c?.message||"A label with that name already exists (case-insensitive)."):c?.reason==="EMPTY_NAME"&&(m="Label Name Required",f="Please enter a label name."),await be({title:m,message:f}),document.getElementById("label-name")?.focus();return}d&&rt&&c?.label?.id&&(j.includes(c.label.id)||j.push(c.label.id),Fe(),document.getElementById("task-label-search")?.focus()),Wt(),Tt();const{renderBoard:u}=await de(async()=>{const{renderBoard:m}=await Promise.resolve().then(()=>ue);return{renderBoard:m}},void 0,import.meta.url);u(),ve&&d&&jt()}),te("label-modal",Wt),document.getElementById("manage-boards-btn")?.addEventListener("click",ya),document.getElementById("add-board-btn")?.addEventListener("click",async()=>{document.dispatchEvent(new CustomEvent("kanban:open-board-create"))}),document.getElementById("boards-import-btn")?.addEventListener("click",async()=>{await Te({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file")?.click()}),te("boards-modal",kn),document.getElementById("board-rename-form")?.addEventListener("submit",i=>{if(i.preventDefault(),!kt)return;const s=(document.getElementById("board-rename-name")?.value||"").trim();if(!s){alert("Board name cannot be empty.");return}if(!To(kt,s)){alert("Unable to rename board.");return}qt(),sn(),it(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),te("board-rename-modal",qt),document.getElementById("help-btn").addEventListener("click",ba),te("help-modal",Sn),document.getElementById("add-column-btn").addEventListener("click",pa),document.addEventListener("keydown",i=>{if(i.key==="Escape"){if(Ce("label-modal")){Wt();return}if(Ce("labels-modal")){jt();return}if(Ce("board-rename-modal")){qt();return}if(Ce("boards-modal")){kn();return}if(Ce("help-modal")){Sn();return}if(Ce("column-modal")){Xt();return}Ce("task-modal")&&Ut()}})}function Bn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),o.push.apply(o,n)}return o}function re(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Bn(Object(o),!0).forEach(function(n){Da(e,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Bn(Object(o)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))})}return e}function bt(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bt=function(t){return typeof t}:bt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(e)}function Da(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function me(){return me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},me.apply(this,arguments)}function Ca(e,t){if(e==null)return{};var o={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(o[a]=e[a]);return o}function La(e,t){if(e==null)return{};var o=Ca(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ia="1.15.6";function ce(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var pe=ce(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),st=ce(/Edge/i),Tn=ce(/firefox/i),Je=ce(/safari/i)&&!ce(/chrome/i)&&!ce(/android/i),yn=ce(/iP(ad|od|hone)/i),oo=ce(/chrome/i)&&ce(/android/i),ao={capture:!1,passive:!1};function I(e,t,o){e.addEventListener(t,o,!pe&&ao)}function L(e,t,o){e.removeEventListener(t,o,!pe&&ao)}function At(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function io(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function ne(e,t,o,n){if(e){o=o||document;do{if(t!=null&&(t[0]===">"?e.parentNode===o&&At(e,t):At(e,t))||n&&e===o)return e;if(e===o)break}while(e=io(e))}return null}var An=/\s+/g;function V(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(An," ").replace(" "+t+" "," ");e.className=(n+(o?" "+t:"")).replace(An," ")}}function y(e,t,o){var n=e&&e.style;if(n){if(o===void 0)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),t===void 0?o:o[t];!(t in n)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),n[t]=o+(typeof o=="string"?"":"px")}}function Me(e,t){var o="";if(typeof e=="string")o=e;else do{var n=y(e,"transform");n&&n!=="none"&&(o=n+" "+o)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(o)}function ro(e,t,o){if(e){var n=e.getElementsByTagName(t),a=0,i=n.length;if(o)for(;a<i;a++)o(n[a],a);return n}return[]}function ie(){var e=document.scrollingElement;return e||document.documentElement}function M(e,t,o,n,a){if(!(!e.getBoundingClientRect&&e!==window)){var i,r,s,l,d,c,u;if(e!==window&&e.parentNode&&e!==ie()?(i=e.getBoundingClientRect(),r=i.top,s=i.left,l=i.bottom,d=i.right,c=i.height,u=i.width):(r=0,s=0,l=window.innerHeight,d=window.innerWidth,c=window.innerHeight,u=window.innerWidth),(t||o)&&e!==window&&(a=a||e.parentNode,!pe))do if(a&&a.getBoundingClientRect&&(y(a,"transform")!=="none"||o&&y(a,"position")!=="static")){var m=a.getBoundingClientRect();r-=m.top+parseInt(y(a,"border-top-width")),s-=m.left+parseInt(y(a,"border-left-width")),l=r+i.height,d=s+i.width;break}while(a=a.parentNode);if(n&&e!==window){var f=Me(a||e),h=f&&f.a,g=f&&f.d;f&&(r/=g,s/=h,u/=h,c/=g,l=r+c,d=s+u)}return{top:r,left:s,bottom:l,right:d,width:u,height:c}}}function xn(e,t,o){for(var n=ye(e,!0),a=M(e)[t];n;){var i=M(n)[o],r=void 0;if(r=a>=i,!r)return n;if(n===ie())break;n=ye(n,!1)}return!1}function $e(e,t,o,n){for(var a=0,i=0,r=e.children;i<r.length;){if(r[i].style.display!=="none"&&r[i]!==b.ghost&&(n||r[i]!==b.dragged)&&ne(r[i],o.draggable,e,!1)){if(a===t)return r[i];a++}i++}return null}function vn(e,t){for(var o=e.lastElementChild;o&&(o===b.ghost||y(o,"display")==="none"||t&&!At(o,t));)o=o.previousElementSibling;return o||null}function Q(e,t){var o=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==b.clone&&(!t||At(e,t))&&o++;return o}function _n(e){var t=0,o=0,n=ie();if(e)do{var a=Me(e),i=a.a,r=a.d;t+=e.scrollLeft*i,o+=e.scrollTop*r}while(e!==n&&(e=e.parentNode));return[t,o]}function Sa(e,t){for(var o in e)if(e.hasOwnProperty(o)){for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[o][n])return Number(o)}return-1}function ye(e,t){if(!e||!e.getBoundingClientRect)return ie();var o=e,n=!1;do if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var a=y(o);if(o.clientWidth<o.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||o.clientHeight<o.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!o.getBoundingClientRect||o===document.body)return ie();if(n||t)return o;n=!0}}while(o=o.parentNode);return ie()}function ka(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function Gt(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Qe;function so(e,t){return function(){if(!Qe){var o=arguments,n=this;o.length===1?e.call(n,o[0]):e.apply(n,o),Qe=setTimeout(function(){Qe=void 0},t)}}}function Ba(){clearTimeout(Qe),Qe=void 0}function lo(e,t,o){e.scrollLeft+=t,e.scrollTop+=o}function co(e){var t=window.Polymer,o=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):o?o(e).clone(!0)[0]:e.cloneNode(!0)}function uo(e,t,o){var n={};return Array.from(e.children).forEach(function(a){var i,r,s,l;if(!(!ne(a,t.draggable,e,!1)||a.animated||a===o)){var d=M(a);n.left=Math.min((i=n.left)!==null&&i!==void 0?i:1/0,d.left),n.top=Math.min((r=n.top)!==null&&r!==void 0?r:1/0,d.top),n.right=Math.max((s=n.right)!==null&&s!==void 0?s:-1/0,d.right),n.bottom=Math.max((l=n.bottom)!==null&&l!==void 0?l:-1/0,d.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var q="Sortable"+new Date().getTime();function Ta(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(a){if(!(y(a,"display")==="none"||a===b.ghost)){e.push({target:a,rect:M(a)});var i=re({},e[e.length-1].rect);if(a.thisAnimationDuration){var r=Me(a,!0);r&&(i.top-=r.f,i.left-=r.e)}a.fromRect=i}})}},addAnimationState:function(n){e.push(n)},removeAnimationState:function(n){e.splice(Sa(e,{target:n}),1)},animateAll:function(n){var a=this;if(!this.options.animation){clearTimeout(t),typeof n=="function"&&n();return}var i=!1,r=0;e.forEach(function(s){var l=0,d=s.target,c=d.fromRect,u=M(d),m=d.prevFromRect,f=d.prevToRect,h=s.rect,g=Me(d,!0);g&&(u.top-=g.f,u.left-=g.e),d.toRect=u,d.thisAnimationDuration&&Gt(m,u)&&!Gt(c,u)&&(h.top-u.top)/(h.left-u.left)===(c.top-u.top)/(c.left-u.left)&&(l=xa(h,m,f,a.options)),Gt(u,c)||(d.prevFromRect=c,d.prevToRect=u,l||(l=a.options.animation),a.animate(d,h,u,l)),l&&(i=!0,r=Math.max(r,l),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},l),d.thisAnimationDuration=l)}),clearTimeout(t),i?t=setTimeout(function(){typeof n=="function"&&n()},r):typeof n=="function"&&n(),e=[]},animate:function(n,a,i,r){if(r){y(n,"transition",""),y(n,"transform","");var s=Me(this.el),l=s&&s.a,d=s&&s.d,c=(a.left-i.left)/(l||1),u=(a.top-i.top)/(d||1);n.animatingX=!!c,n.animatingY=!!u,y(n,"transform","translate3d("+c+"px,"+u+"px,0)"),this.forRepaintDummy=Aa(n),y(n,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),y(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){y(n,"transition",""),y(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},r)}}}}function Aa(e){return e.offsetWidth}function xa(e,t,o,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))*n.animation}var _e=[],Vt={initializeByDefault:!0},lt={mount:function(t){for(var o in Vt)Vt.hasOwnProperty(o)&&!(o in t)&&(t[o]=Vt[o]);_e.forEach(function(n){if(n.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),_e.push(t)},pluginEvent:function(t,o,n){var a=this;this.eventCanceled=!1,n.cancel=function(){a.eventCanceled=!0};var i=t+"Global";_e.forEach(function(r){o[r.pluginName]&&(o[r.pluginName][i]&&o[r.pluginName][i](re({sortable:o},n)),o.options[r.pluginName]&&o[r.pluginName][t]&&o[r.pluginName][t](re({sortable:o},n)))})},initializePlugins:function(t,o,n,a){_e.forEach(function(s){var l=s.pluginName;if(!(!t.options[l]&&!s.initializeByDefault)){var d=new s(t,o,t.options);d.sortable=t,d.options=t.options,t[l]=d,me(n,d.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var r=this.modifyOption(t,i,t.options[i]);typeof r<"u"&&(t.options[i]=r)}},getEventProperties:function(t,o){var n={};return _e.forEach(function(a){typeof a.eventProperties=="function"&&me(n,a.eventProperties.call(o[a.pluginName],t))}),n},modifyOption:function(t,o,n){var a;return _e.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[o]=="function"&&(a=i.optionListeners[o].call(t[i.pluginName],n))}),a}};function _a(e){var t=e.sortable,o=e.rootEl,n=e.name,a=e.targetEl,i=e.cloneEl,r=e.toEl,s=e.fromEl,l=e.oldIndex,d=e.newIndex,c=e.oldDraggableIndex,u=e.newDraggableIndex,m=e.originalEvent,f=e.putSortable,h=e.extraEventProperties;if(t=t||o&&o[q],!!t){var g,D=t.options,B="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!pe&&!st?g=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(g=document.createEvent("Event"),g.initEvent(n,!0,!0)),g.to=r||o,g.from=s||o,g.item=a||o,g.clone=i,g.oldIndex=l,g.newIndex=d,g.oldDraggableIndex=c,g.newDraggableIndex=u,g.originalEvent=m,g.pullMode=f?f.lastPutMode:void 0;var S=re(re({},h),lt.getEventProperties(n,t));for(var k in S)g[k]=S[k];o&&o.dispatchEvent(g),D[B]&&D[B].call(t,g)}}var Na=["evt"],W=function(t,o){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=n.evt,i=La(n,Na);lt.pluginEvent.bind(b)(t,o,re({dragEl:p,parentEl:N,ghostEl:E,rootEl:A,nextEl:ke,lastDownEl:yt,cloneEl:x,cloneHidden:ge,dragStarted:je,putSortable:$,activeSortable:b.active,originalEvent:a,oldIndex:Pe,oldDraggableIndex:Ze,newIndex:K,newDraggableIndex:he,hideGhostForTarget:ho,unhideGhostForTarget:go,cloneNowHidden:function(){ge=!0},cloneNowShown:function(){ge=!1},dispatchSortableEvent:function(s){U({sortable:o,name:s,originalEvent:a})}},i))};function U(e){_a(re({putSortable:$,cloneEl:x,targetEl:p,rootEl:A,oldIndex:Pe,oldDraggableIndex:Ze,newIndex:K,newDraggableIndex:he},e))}var p,N,E,A,ke,yt,x,ge,Pe,K,Ze,he,mt,$,Oe=!1,xt=!1,_t=[],Le,ee,Kt,Jt,Nn,On,je,Ne,et,tt=!1,ft=!1,vt,H,Qt=[],ln=!1,Nt=[],Ht=typeof document<"u",pt=yn,Pn=st||pe?"cssFloat":"float",Oa=Ht&&!oo&&!yn&&"draggable"in document.createElement("div"),mo=(function(){if(Ht){if(pe)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),fo=function(t,o){var n=y(t),a=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=$e(t,0,o),r=$e(t,1,o),s=i&&y(i),l=r&&y(r),d=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+M(i).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+M(r).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&s.float&&s.float!=="none"){var u=s.float==="left"?"left":"right";return r&&(l.clear==="both"||l.clear===u)?"vertical":"horizontal"}return i&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||d>=a&&n[Pn]==="none"||r&&n[Pn]==="none"&&d+c>a)?"vertical":"horizontal"},Pa=function(t,o,n){var a=n?t.left:t.top,i=n?t.right:t.bottom,r=n?t.width:t.height,s=n?o.left:o.top,l=n?o.right:o.bottom,d=n?o.width:o.height;return a===s||i===l||a+r/2===s+d/2},Ma=function(t,o){var n;return _t.some(function(a){var i=a[q].options.emptyInsertThreshold;if(!(!i||vn(a))){var r=M(a),s=t>=r.left-i&&t<=r.right+i,l=o>=r.top-i&&o<=r.bottom+i;if(s&&l)return n=a}}),n},po=function(t){function o(i,r){return function(s,l,d,c){var u=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(i==null&&(r||u))return!0;if(i==null||i===!1)return!1;if(r&&i==="clone")return i;if(typeof i=="function")return o(i(s,l,d,c),r)(s,l,d,c);var m=(r?s:l).options.group.name;return i===!0||typeof i=="string"&&i===m||i.join&&i.indexOf(m)>-1}}var n={},a=t.group;(!a||bt(a)!="object")&&(a={name:a}),n.name=a.name,n.checkPull=o(a.pull,!0),n.checkPut=o(a.put),n.revertClone=a.revertClone,t.group=n},ho=function(){!mo&&E&&y(E,"display","none")},go=function(){!mo&&E&&y(E,"display","")};Ht&&!oo&&document.addEventListener("click",function(e){if(xt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),xt=!1,!1},!0);var Ie=function(t){if(p){t=t.touches?t.touches[0]:t;var o=Ma(t.clientX,t.clientY);if(o){var n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=t[a]);n.target=n.rootEl=o,n.preventDefault=void 0,n.stopPropagation=void 0,o[q]._onDragOver(n)}}},Ra=function(t){p&&p.parentNode[q]._isOutsideThisEl(t.target)};function b(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=me({},t),e[q]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return fo(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,s){r.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:b.supportPointer!==!1&&"PointerEvent"in window&&(!Je||yn),emptyInsertThreshold:5};lt.initializePlugins(this,e,o);for(var n in o)!(n in t)&&(t[n]=o[n]);po(t);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=t.forceFallback?!1:Oa,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?I(e,"pointerdown",this._onTapStart):(I(e,"mousedown",this._onTapStart),I(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(I(e,"dragover",this),I(e,"dragenter",this)),_t.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),me(this,Ta())}b.prototype={constructor:b,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Ne=null)},_getDirection:function(t,o){return typeof this.options.direction=="function"?this.options.direction.call(this,t,o,p):this.options.direction},_onTapStart:function(t){if(t.cancelable){var o=this,n=this.el,a=this.options,i=a.preventOnFilter,r=t.type,s=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,l=(s||t).target,d=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||l,c=a.filter;if(ja(n),!p&&!(/mousedown|pointerdown/.test(r)&&t.button!==0||a.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&Je&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=ne(l,a.draggable,n,!1),!(l&&l.animated)&&yt!==l)){if(Pe=Q(l),Ze=Q(l,a.draggable),typeof c=="function"){if(c.call(this,t,l,this)){U({sortable:o,rootEl:d,name:"filter",targetEl:l,toEl:n,fromEl:n}),W("filter",o,{evt:t}),i&&t.preventDefault();return}}else if(c&&(c=c.split(",").some(function(u){if(u=ne(d,u.trim(),n,!1),u)return U({sortable:o,rootEl:u,name:"filter",targetEl:l,fromEl:n,toEl:n}),W("filter",o,{evt:t}),!0}),c)){i&&t.preventDefault();return}a.handle&&!ne(d,a.handle,n,!1)||this._prepareDragStart(t,s,l)}}},_prepareDragStart:function(t,o,n){var a=this,i=a.el,r=a.options,s=i.ownerDocument,l;if(n&&!p&&n.parentNode===i){var d=M(n);if(A=i,p=n,N=p.parentNode,ke=p.nextSibling,yt=n,mt=r.group,b.dragged=p,Le={target:p,clientX:(o||t).clientX,clientY:(o||t).clientY},Nn=Le.clientX-d.left,On=Le.clientY-d.top,this._lastX=(o||t).clientX,this._lastY=(o||t).clientY,p.style["will-change"]="all",l=function(){if(W("delayEnded",a,{evt:t}),b.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!Tn&&a.nativeDraggable&&(p.draggable=!0),a._triggerDragStart(t,o),U({sortable:a,name:"choose",originalEvent:t}),V(p,r.chosenClass,!0)},r.ignore.split(",").forEach(function(c){ro(p,c.trim(),Zt)}),I(s,"dragover",Ie),I(s,"mousemove",Ie),I(s,"touchmove",Ie),r.supportPointer?(I(s,"pointerup",a._onDrop),!this.nativeDraggable&&I(s,"pointercancel",a._onDrop)):(I(s,"mouseup",a._onDrop),I(s,"touchend",a._onDrop),I(s,"touchcancel",a._onDrop)),Tn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,p.draggable=!0),W("delayStart",this,{evt:t}),r.delay&&(!r.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(st||pe))){if(b.eventCanceled){this._onDrop();return}r.supportPointer?(I(s,"pointerup",a._disableDelayedDrag),I(s,"pointercancel",a._disableDelayedDrag)):(I(s,"mouseup",a._disableDelayedDrag),I(s,"touchend",a._disableDelayedDrag),I(s,"touchcancel",a._disableDelayedDrag)),I(s,"mousemove",a._delayedDragTouchMoveHandler),I(s,"touchmove",a._delayedDragTouchMoveHandler),r.supportPointer&&I(s,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(l,r.delay)}else l()}},_delayedDragTouchMoveHandler:function(t){var o=t.touches?t.touches[0]:t;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){p&&Zt(p),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;L(t,"mouseup",this._disableDelayedDrag),L(t,"touchend",this._disableDelayedDrag),L(t,"touchcancel",this._disableDelayedDrag),L(t,"pointerup",this._disableDelayedDrag),L(t,"pointercancel",this._disableDelayedDrag),L(t,"mousemove",this._delayedDragTouchMoveHandler),L(t,"touchmove",this._delayedDragTouchMoveHandler),L(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,o){o=o||t.pointerType=="touch"&&t,!this.nativeDraggable||o?this.options.supportPointer?I(document,"pointermove",this._onTouchMove):o?I(document,"touchmove",this._onTouchMove):I(document,"mousemove",this._onTouchMove):(I(p,"dragend",this),I(A,"dragstart",this._onDragStart));try{document.selection?Et(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,o){if(Oe=!1,A&&p){W("dragStarted",this,{evt:o}),this.nativeDraggable&&I(document,"dragover",Ra);var n=this.options;!t&&V(p,n.dragClass,!1),V(p,n.ghostClass,!0),b.active=this,t&&this._appendGhost(),U({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(ee){this._lastX=ee.clientX,this._lastY=ee.clientY,ho();for(var t=document.elementFromPoint(ee.clientX,ee.clientY),o=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ee.clientX,ee.clientY),t!==o);)o=t;if(p.parentNode[q]._isOutsideThisEl(t),o)do{if(o[q]){var n=void 0;if(n=o[q]._onDragOver({clientX:ee.clientX,clientY:ee.clientY,target:t,rootEl:o}),n&&!this.options.dragoverBubble)break}t=o}while(o=io(o));go()}},_onTouchMove:function(t){if(Le){var o=this.options,n=o.fallbackTolerance,a=o.fallbackOffset,i=t.touches?t.touches[0]:t,r=E&&Me(E,!0),s=E&&r&&r.a,l=E&&r&&r.d,d=pt&&H&&_n(H),c=(i.clientX-Le.clientX+a.x)/(s||1)+(d?d[0]-Qt[0]:0)/(s||1),u=(i.clientY-Le.clientY+a.y)/(l||1)+(d?d[1]-Qt[1]:0)/(l||1);if(!b.active&&!Oe){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(E){r?(r.e+=c-(Kt||0),r.f+=u-(Jt||0)):r={a:1,b:0,c:0,d:1,e:c,f:u};var m="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");y(E,"webkitTransform",m),y(E,"mozTransform",m),y(E,"msTransform",m),y(E,"transform",m),Kt=c,Jt=u,ee=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!E){var t=this.options.fallbackOnBody?document.body:A,o=M(p,!0,pt,!0,t),n=this.options;if(pt){for(H=t;y(H,"position")==="static"&&y(H,"transform")==="none"&&H!==document;)H=H.parentNode;H!==document.body&&H!==document.documentElement?(H===document&&(H=ie()),o.top+=H.scrollTop,o.left+=H.scrollLeft):H=ie(),Qt=_n(H)}E=p.cloneNode(!0),V(E,n.ghostClass,!1),V(E,n.fallbackClass,!0),V(E,n.dragClass,!0),y(E,"transition",""),y(E,"transform",""),y(E,"box-sizing","border-box"),y(E,"margin",0),y(E,"top",o.top),y(E,"left",o.left),y(E,"width",o.width),y(E,"height",o.height),y(E,"opacity","0.8"),y(E,"position",pt?"absolute":"fixed"),y(E,"zIndex","100000"),y(E,"pointerEvents","none"),b.ghost=E,t.appendChild(E),y(E,"transform-origin",Nn/parseInt(E.style.width)*100+"% "+On/parseInt(E.style.height)*100+"%")}},_onDragStart:function(t,o){var n=this,a=t.dataTransfer,i=n.options;if(W("dragStart",this,{evt:t}),b.eventCanceled){this._onDrop();return}W("setupClone",this),b.eventCanceled||(x=co(p),x.removeAttribute("id"),x.draggable=!1,x.style["will-change"]="",this._hideClone(),V(x,this.options.chosenClass,!1),b.clone=x),n.cloneId=Et(function(){W("clone",n),!b.eventCanceled&&(n.options.removeCloneOnHide||A.insertBefore(x,p),n._hideClone(),U({sortable:n,name:"clone"}))}),!o&&V(p,i.dragClass,!0),o?(xt=!0,n._loopId=setInterval(n._emulateDragOver,50)):(L(document,"mouseup",n._onDrop),L(document,"touchend",n._onDrop),L(document,"touchcancel",n._onDrop),a&&(a.effectAllowed="move",i.setData&&i.setData.call(n,a,p)),I(document,"drop",n),y(p,"transform","translateZ(0)")),Oe=!0,n._dragStartId=Et(n._dragStarted.bind(n,o,t)),I(document,"selectstart",n),je=!0,window.getSelection().removeAllRanges(),Je&&y(document.body,"user-select","none")},_onDragOver:function(t){var o=this.el,n=t.target,a,i,r,s=this.options,l=s.group,d=b.active,c=mt===l,u=s.sort,m=$||d,f,h=this,g=!1;if(ln)return;function D(xe,dt){W(xe,h,re({evt:t,isOwner:c,axis:f?"vertical":"horizontal",revert:r,dragRect:a,targetRect:i,canSort:u,fromSortable:m,target:n,completed:S,onMove:function(ct,Cn){return ht(A,o,p,a,ct,M(ct),t,Cn)},changed:k},dt))}function B(){D("dragOverAnimationCapture"),h.captureAnimationState(),h!==m&&m.captureAnimationState()}function S(xe){return D("dragOverCompleted",{insertion:xe}),xe&&(c?d._hideClone():d._showClone(h),h!==m&&(V(p,$?$.options.ghostClass:d.options.ghostClass,!1),V(p,s.ghostClass,!0)),$!==h&&h!==b.active?$=h:h===b.active&&$&&($=null),m===h&&(h._ignoreWhileAnimating=n),h.animateAll(function(){D("dragOverAnimationComplete"),h._ignoreWhileAnimating=null}),h!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(n===p&&!p.animated||n===o&&!n.animated)&&(Ne=null),!s.dragoverBubble&&!t.rootEl&&n!==document&&(p.parentNode[q]._isOutsideThisEl(t.target),!xe&&Ie(t)),!s.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),g=!0}function k(){K=Q(p),he=Q(p,s.draggable),U({sortable:h,name:"change",toEl:o,newIndex:K,newDraggableIndex:he,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),n=ne(n,s.draggable,o,!0),D("dragOver"),b.eventCanceled)return g;if(p.contains(t.target)||n.animated&&n.animatingX&&n.animatingY||h._ignoreWhileAnimating===n)return S(!1);if(xt=!1,d&&!s.disabled&&(c?u||(r=N!==A):$===this||(this.lastPutMode=mt.checkPull(this,d,p,t))&&l.checkPut(this,d,p,t))){if(f=this._getDirection(t,n)==="vertical",a=M(p),D("dragOverValid"),b.eventCanceled)return g;if(r)return N=A,B(),this._hideClone(),D("revert"),b.eventCanceled||(ke?A.insertBefore(p,ke):A.appendChild(p)),S(!0);var w=vn(o,s.draggable);if(!w||za(t,f,this)&&!w.animated){if(w===p)return S(!1);if(w&&o===t.target&&(n=w),n&&(i=M(n)),ht(A,o,p,a,n,i,t,!!n)!==!1)return B(),w&&w.nextSibling?o.insertBefore(p,w.nextSibling):o.appendChild(p),N=o,k(),S(!0)}else if(w&&Ha(t,f,this)){var v=$e(o,0,s,!0);if(v===p)return S(!1);if(n=v,i=M(n),ht(A,o,p,a,n,i,t,!1)!==!1)return B(),o.insertBefore(p,v),N=o,k(),S(!0)}else if(n.parentNode===o){i=M(n);var C=0,_,O=p.parentNode!==o,R=!Pa(p.animated&&p.toRect||a,n.animated&&n.toRect||i,f),we=f?"top":"left",G=xn(n,"top","top")||xn(p,"top","top"),z=G?G.scrollTop:void 0;Ne!==n&&(_=i[we],tt=!1,ft=!R&&s.invertSwap||O),C=Ya(t,n,i,f,R?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,ft,Ne===n);var F;if(C!==0){var Y=Q(p);do Y-=C,F=N.children[Y];while(F&&(y(F,"display")==="none"||F===E))}if(C===0||F===n)return S(!1);Ne=n,et=C;var Z=n.nextElementSibling,T=!1;T=C===1;var le=ht(A,o,p,a,n,i,t,T);if(le!==!1)return(le===1||le===-1)&&(T=le===1),ln=!0,setTimeout($a,30),B(),T&&!Z?o.appendChild(p):n.parentNode.insertBefore(p,T?Z:n),G&&lo(G,0,z-G.scrollTop),N=p.parentNode,_!==void 0&&!ft&&(vt=Math.abs(_-M(n)[we])),k(),S(!0)}if(o.contains(p))return S(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){L(document,"mousemove",this._onTouchMove),L(document,"touchmove",this._onTouchMove),L(document,"pointermove",this._onTouchMove),L(document,"dragover",Ie),L(document,"mousemove",Ie),L(document,"touchmove",Ie)},_offUpEvents:function(){var t=this.el.ownerDocument;L(t,"mouseup",this._onDrop),L(t,"touchend",this._onDrop),L(t,"pointerup",this._onDrop),L(t,"pointercancel",this._onDrop),L(t,"touchcancel",this._onDrop),L(document,"selectstart",this)},_onDrop:function(t){var o=this.el,n=this.options;if(K=Q(p),he=Q(p,n.draggable),W("drop",this,{evt:t}),N=p&&p.parentNode,K=Q(p),he=Q(p,n.draggable),b.eventCanceled){this._nulling();return}Oe=!1,ft=!1,tt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),dn(this.cloneId),dn(this._dragStartId),this.nativeDraggable&&(L(document,"drop",this),L(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Je&&y(document.body,"user-select",""),y(p,"transform",""),t&&(je&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),E&&E.parentNode&&E.parentNode.removeChild(E),(A===N||$&&$.lastPutMode!=="clone")&&x&&x.parentNode&&x.parentNode.removeChild(x),p&&(this.nativeDraggable&&L(p,"dragend",this),Zt(p),p.style["will-change"]="",je&&!Oe&&V(p,$?$.options.ghostClass:this.options.ghostClass,!1),V(p,this.options.chosenClass,!1),U({sortable:this,name:"unchoose",toEl:N,newIndex:null,newDraggableIndex:null,originalEvent:t}),A!==N?(K>=0&&(U({rootEl:N,name:"add",toEl:N,fromEl:A,originalEvent:t}),U({sortable:this,name:"remove",toEl:N,originalEvent:t}),U({rootEl:N,name:"sort",toEl:N,fromEl:A,originalEvent:t}),U({sortable:this,name:"sort",toEl:N,originalEvent:t})),$&&$.save()):K!==Pe&&K>=0&&(U({sortable:this,name:"update",toEl:N,originalEvent:t}),U({sortable:this,name:"sort",toEl:N,originalEvent:t})),b.active&&((K==null||K===-1)&&(K=Pe,he=Ze),U({sortable:this,name:"end",toEl:N,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){W("nulling",this),A=p=N=E=ke=x=yt=ge=Le=ee=je=K=he=Pe=Ze=Ne=et=$=mt=b.dragged=b.ghost=b.clone=b.active=null,Nt.forEach(function(t){t.checked=!0}),Nt.length=Kt=Jt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":p&&(this._onDragOver(t),Fa(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],o,n=this.el.children,a=0,i=n.length,r=this.options;a<i;a++)o=n[a],ne(o,r.draggable,this.el,!1)&&t.push(o.getAttribute(r.dataIdAttr)||Xa(o));return t},sort:function(t,o){var n={},a=this.el;this.toArray().forEach(function(i,r){var s=a.children[r];ne(s,this.options.draggable,a,!1)&&(n[i]=s)},this),o&&this.captureAnimationState(),t.forEach(function(i){n[i]&&(a.removeChild(n[i]),a.appendChild(n[i]))}),o&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,o){return ne(t,o||this.options.draggable,this.el,!1)},option:function(t,o){var n=this.options;if(o===void 0)return n[t];var a=lt.modifyOption(this,t,o);typeof a<"u"?n[t]=a:n[t]=o,t==="group"&&po(n)},destroy:function(){W("destroy",this);var t=this.el;t[q]=null,L(t,"mousedown",this._onTapStart),L(t,"touchstart",this._onTapStart),L(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(L(t,"dragover",this),L(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),_t.splice(_t.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!ge){if(W("hideClone",this),b.eventCanceled)return;y(x,"display","none"),this.options.removeCloneOnHide&&x.parentNode&&x.parentNode.removeChild(x),ge=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(ge){if(W("showClone",this),b.eventCanceled)return;p.parentNode==A&&!this.options.group.revertClone?A.insertBefore(x,p):ke?A.insertBefore(x,ke):A.appendChild(x),this.options.group.revertClone&&this.animate(p,x),y(x,"display",""),ge=!1}}};function Fa(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function ht(e,t,o,n,a,i,r,s){var l,d=e[q],c=d.options.onMove,u;return window.CustomEvent&&!pe&&!st?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=t,l.from=e,l.dragged=o,l.draggedRect=n,l.related=a||t,l.relatedRect=i||M(t),l.willInsertAfter=s,l.originalEvent=r,e.dispatchEvent(l),c&&(u=c.call(d,l,r)),u}function Zt(e){e.draggable=!1}function $a(){ln=!1}function Ha(e,t,o){var n=M($e(o.el,0,o.options,!0)),a=uo(o.el,o.options,E),i=10;return t?e.clientX<a.left-i||e.clientY<n.top&&e.clientX<n.right:e.clientY<a.top-i||e.clientY<n.bottom&&e.clientX<n.left}function za(e,t,o){var n=M(vn(o.el,o.options.draggable)),a=uo(o.el,o.options,E),i=10;return t?e.clientX>a.right+i||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>a.bottom+i||e.clientX>n.right&&e.clientY>n.top}function Ya(e,t,o,n,a,i,r,s){var l=n?e.clientY:e.clientX,d=n?o.height:o.width,c=n?o.top:o.left,u=n?o.bottom:o.right,m=!1;if(!r){if(s&&vt<d*a){if(!tt&&(et===1?l>c+d*i/2:l<u-d*i/2)&&(tt=!0),tt)m=!0;else if(et===1?l<c+vt:l>u-vt)return-et}else if(l>c+d*(1-a)/2&&l<u-d*(1-a)/2)return Ua(t)}return m=m||r,m&&(l<c+d*i/2||l>u-d*i/2)?l>c+d/2?1:-1:0}function Ua(e){return Q(p)<Q(e)?1:-1}function Xa(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,n=0;o--;)n+=t.charCodeAt(o);return n.toString(36)}function ja(e){Nt.length=0;for(var t=e.getElementsByTagName("input"),o=t.length;o--;){var n=t[o];n.checked&&Nt.push(n)}}function Et(e){return setTimeout(e,0)}function dn(e){return clearTimeout(e)}Ht&&I(document,"touchmove",function(e){(b.active||Oe)&&e.cancelable&&e.preventDefault()});b.utils={on:I,off:L,css:y,find:ro,is:function(t,o){return!!ne(t,o,t,!1)},extend:ka,throttle:so,closest:ne,toggleClass:V,clone:co,index:Q,nextTick:Et,cancelNextTick:dn,detectDirection:fo,getChild:$e,expando:q};b.get=function(e){return e[q]};b.mount=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];t[0].constructor===Array&&(t=t[0]),t.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(b.utils=re(re({},b.utils),n.utils)),lt.mount(n)})};b.create=function(e,t){return new b(e,t)};b.version=Ia;var P=[],We,cn,un=!1,en,tn,Ot,qe;function Wa(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(o){var n=o.originalEvent;this.sortable.nativeDraggable?I(document,"dragover",this._handleAutoScroll):this.options.supportPointer?I(document,"pointermove",this._handleFallbackAutoScroll):n.touches?I(document,"touchmove",this._handleFallbackAutoScroll):I(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var n=o.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?L(document,"dragover",this._handleAutoScroll):(L(document,"pointermove",this._handleFallbackAutoScroll),L(document,"touchmove",this._handleFallbackAutoScroll),L(document,"mousemove",this._handleFallbackAutoScroll)),Mn(),wt(),Ba()},nulling:function(){Ot=cn=We=un=qe=en=tn=null,P.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,n){var a=this,i=(o.touches?o.touches[0]:o).clientX,r=(o.touches?o.touches[0]:o).clientY,s=document.elementFromPoint(i,r);if(Ot=o,n||this.options.forceAutoScrollFallback||st||pe||Je){nn(o,this.options,s,n);var l=ye(s,!0);un&&(!qe||i!==en||r!==tn)&&(qe&&Mn(),qe=setInterval(function(){var d=ye(document.elementFromPoint(i,r),!0);d!==l&&(l=d,wt()),nn(o,a.options,d,n)},10),en=i,tn=r)}else{if(!this.options.bubbleScroll||ye(s,!0)===ie()){wt();return}nn(o,this.options,ye(s,!1),!1)}}},me(e,{pluginName:"scroll",initializeByDefault:!0})}function wt(){P.forEach(function(e){clearInterval(e.pid)}),P=[]}function Mn(){clearInterval(qe)}var nn=so(function(e,t,o,n){if(t.scroll){var a=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,r=t.scrollSensitivity,s=t.scrollSpeed,l=ie(),d=!1,c;cn!==o&&(cn=o,wt(),We=t.scroll,c=t.scrollFn,We===!0&&(We=ye(o,!0)));var u=0,m=We;do{var f=m,h=M(f),g=h.top,D=h.bottom,B=h.left,S=h.right,k=h.width,w=h.height,v=void 0,C=void 0,_=f.scrollWidth,O=f.scrollHeight,R=y(f),we=f.scrollLeft,G=f.scrollTop;f===l?(v=k<_&&(R.overflowX==="auto"||R.overflowX==="scroll"||R.overflowX==="visible"),C=w<O&&(R.overflowY==="auto"||R.overflowY==="scroll"||R.overflowY==="visible")):(v=k<_&&(R.overflowX==="auto"||R.overflowX==="scroll"),C=w<O&&(R.overflowY==="auto"||R.overflowY==="scroll"));var z=v&&(Math.abs(S-a)<=r&&we+k<_)-(Math.abs(B-a)<=r&&!!we),F=C&&(Math.abs(D-i)<=r&&G+w<O)-(Math.abs(g-i)<=r&&!!G);if(!P[u])for(var Y=0;Y<=u;Y++)P[Y]||(P[Y]={});(P[u].vx!=z||P[u].vy!=F||P[u].el!==f)&&(P[u].el=f,P[u].vx=z,P[u].vy=F,clearInterval(P[u].pid),(z!=0||F!=0)&&(d=!0,P[u].pid=setInterval((function(){n&&this.layer===0&&b.active._onTouchMove(Ot);var Z=P[this.layer].vy?P[this.layer].vy*s:0,T=P[this.layer].vx?P[this.layer].vx*s:0;typeof c=="function"&&c.call(b.dragged.parentNode[q],T,Z,e,Ot,P[this.layer].el)!=="continue"||lo(P[this.layer].el,T,Z)}).bind({layer:u}),24))),u++}while(t.bubbleScroll&&m!==l&&(m=ye(m,!1)));un=d}},30),bo=function(t){var o=t.originalEvent,n=t.putSortable,a=t.dragEl,i=t.activeSortable,r=t.dispatchSortableEvent,s=t.hideGhostForTarget,l=t.unhideGhostForTarget;if(o){var d=n||i;s();var c=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,u=document.elementFromPoint(c.clientX,c.clientY);l(),d&&!d.el.contains(u)&&(r("spill"),this.onSpill({dragEl:a,putSortable:n}))}};function En(){}En.prototype={startIndex:null,dragStart:function(t){var o=t.oldDraggableIndex;this.startIndex=o},onSpill:function(t){var o=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var a=$e(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(o,a):this.sortable.el.appendChild(o),this.sortable.animateAll(),n&&n.animateAll()},drop:bo};me(En,{pluginName:"revertOnSpill"});function wn(){}wn.prototype={onSpill:function(t){var o=t.dragEl,n=t.putSortable,a=n||this.sortable;a.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),a.animateAll()},drop:bo};me(wn,{pluginName:"removeOnSpill"});b.mount(new Wa);b.mount(wn,En);let mn=[],Dt=null,nt=null,Re=0;function qa(){Ga(),Ka(),Ja()}function Ga(){mn.forEach(e=>e.destroy()),mn=[],Dt&&(Dt.destroy(),Dt=null),yo()}function Va(){const e=document.getElementById("board-container");!e||nt||(nt=setInterval(()=>{if(!e)return;const t=e.getBoundingClientRect(),o=80,n=12;Re>0&&(Re<t.left+o&&e.scrollLeft>0?e.scrollLeft-=n:Re>t.right-o&&e.scrollLeft<e.scrollWidth-e.clientWidth&&(e.scrollLeft+=n))},16))}function yo(){nt&&(clearInterval(nt),nt=null),Re=0}function gt(e){e.touches&&e.touches[0]?Re=e.touches[0].clientX:e.clientX&&(Re=e.clientX)}function Ka(){document.querySelectorAll(".tasks:not(.hidden)").forEach(t=>{const o=new b(t,{group:{name:"tasks",pull:!0,put:!0},animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"task-ghost",chosenClass:"task-chosen",dragClass:"task-drag",draggable:".task",forceFallback:!0,fallbackClass:"task-fallback",fallbackOnBody:!0,fallbackTolerance:0,swapThreshold:.65,emptyInsertThreshold:20,direction:"vertical",onStart:function(n){document.body.classList.add("dragging"),Va(),document.addEventListener("touchmove",gt,{passive:!0}),document.addEventListener("mousemove",gt,{passive:!0})},onEnd:async function(n){document.body.classList.remove("dragging"),yo(),document.removeEventListener("touchmove",gt),document.removeEventListener("mousemove",gt),Po();const{renderBoard:a}=await de(async()=>{const{renderBoard:i}=await Promise.resolve().then(()=>ue);return{renderBoard:i}},void 0,import.meta.url);a()}});mn.push(o)})}function Ja(){const e=document.getElementById("board-container");e&&(Dt=new b(e,{animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"column-ghost",chosenClass:"column-chosen",dragClass:"column-drag",handle:".column-header",filter:"button:not(.column-drag-handle), a, input, select, textarea, [contenteditable]",preventOnFilter:!0,draggable:".task-column",scrollSensitivity:80,scrollSpeed:15,forceFallback:!1,fallbackOnBody:!0,onStart:function(t){document.body.classList.add("dragging-column")},onEnd:function(t){document.body.classList.remove("dragging-column"),zo()}}))}const vo="kanbanNotificationBannerHidden";let Rn;function Eo(){return localStorage.getItem(vo)==="true"}function Fn(e){localStorage.setItem(vo,e?"true":"false")}function wo(){const e=document.getElementById("notification-banner-visibility-toggle");e&&(e.checked=!Eo())}function Dn(){const e=J(),t=X(),o=Number.isFinite(t.notificationDays)?t.notificationDays:3,n=new Date;return n.setHours(0,0,0,0),e.filter(a=>{if(a.column==="done")return!1;const i=(a.dueDate||"").toString().trim();if(!i)return!1;const r=new Date(i+"T00:00:00");if(Number.isNaN(r.getTime()))return!1;const s=r.getTime()-n.getTime();return Math.floor(s/(1e3*60*60*24))<=o}).map(a=>{const r=new Date(a.dueDate+"T00:00:00").getTime()-n.getTime(),s=Math.floor(r/(1e3*60*60*24));return{...a,daysUntilDue:s}}).sort((a,i)=>a.daysUntilDue-i.daysUntilDue)}function Do(e,t,o){const a=new Date(t+"T00:00:00").toLocaleDateString(o||void 0);if(e<0){const i=Math.abs(e);return{text:`Overdue by ${i} day${i===1?"":"s"} (${a})`,className:"overdue"}}else return e===0?{text:`Due today (${a})`,className:"overdue"}:e===1?{text:`Due tomorrow (${a})`,className:"due-soon"}:{text:`Due in ${e} days (${a})`,className:"due-soon"}}function Co(){const e=document.getElementById("notification-banner"),t=document.getElementById("notification-banner-list");if(!e||!t)return;const o=Dn(),n=X();if(o.length===0){e.classList.add("hidden");return}if(Eo()){e.classList.add("hidden");return}t.innerHTML="";const a=window.matchMedia("(min-width: 601px)").matches,i=r=>{const s=document.createElement("div");s.classList.add("notification-banner-item"),s.setAttribute("role","button"),s.setAttribute("tabindex","0"),s.setAttribute("aria-label",`Open task: ${r.title}`);const l=document.createElement("span");l.classList.add("task-title");const d=typeof r.text=="string"?r.text:"";l.textContent=typeof r.title=="string"&&r.title.trim()?r.title:d;const c=Do(r.daysUntilDue,r.dueDate,n.locale),u=document.createElement("span");u.classList.add("due-date",c.className),u.textContent=c.text,s.appendChild(l),s.appendChild(u);const m=()=>Ke(r.id);return s.addEventListener("click",m),s.addEventListener("keydown",f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),m())}),s};if(a){const r=t.clientWidth||t.getBoundingClientRect().width;let s=0;for(const d of o){const c=i(d);if(t.appendChild(c),s+=1,t.scrollWidth>r&&s>1){t.removeChild(c),s-=1;break}}const l=o.length-s;if(l>0){const d=document.createElement("div");if(d.classList.add("notification-banner-item","notification-more"),d.setAttribute("role","button"),d.setAttribute("tabindex","0"),d.textContent=`+${l} `,d.addEventListener("click",Ge),d.addEventListener("keydown",c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),Ge())}),t.appendChild(d),t.scrollWidth>r&&s>0){t.removeChild(t.children[s-1]),s-=1;const c=o.length-s;d.textContent=`+${c} `,t.appendChild(d)}}}else if(o.slice(0,5).forEach(s=>{const l=i(s);t.appendChild(l)}),o.length>5){const s=document.createElement("div");s.classList.add("notification-banner-item","notification-more"),s.setAttribute("role","button"),s.setAttribute("tabindex","0"),s.textContent=`+${o.length-5} `,s.addEventListener("click",Ge),s.addEventListener("keydown",l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),Ge())}),t.appendChild(s)}e.classList.remove("hidden"),Ae()}function Qa(){const e=document.getElementById("notifications-list");if(!e)return;const t=Dn(),o=X(),n=Number.isFinite(o.notificationDays)?o.notificationDays:3;if(e.innerHTML="",t.length===0){const a=document.createElement("div");a.classList.add("notifications-empty"),a.textContent=n===0?"No tasks due today.":`No tasks due within the next ${n} day${n===1?"":"s"}.`,e.appendChild(a);return}t.forEach(a=>{const i=document.createElement("div");i.classList.add("notification-item"),i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.setAttribute("aria-label",`Open task: ${a.title}`);const r=document.createElement("div");r.classList.add("notification-item-content");const s=document.createElement("div");s.classList.add("notification-item-title");const l=typeof a.text=="string"?a.text:"";s.textContent=typeof a.title=="string"&&a.title.trim()?a.title:l;const d=document.createElement("div");d.classList.add("notification-item-meta");const c=Do(a.daysUntilDue,a.dueDate,o.locale),u=document.createElement("span");u.classList.add(c.className),u.textContent=c.text;const m=typeof a.priority=="string"?a.priority:"low",f=document.createElement("span");f.classList.add("notification-item-priority",`priority-${m}`),f.textContent=m,d.appendChild(u),d.appendChild(f),r.appendChild(s),r.appendChild(d);const h=document.createElement("span");h.classList.add("notification-item-arrow"),h.dataset.lucide="chevron-right",i.appendChild(r),i.appendChild(h);const g=()=>{Ct(),Ke(a.id)};i.addEventListener("click",g),i.addEventListener("keydown",D=>{(D.key==="Enter"||D.key===" ")&&(D.preventDefault(),g())}),e.appendChild(i)}),Ae()}function Za(){const e=document.getElementById("notification-badge");if(!e)return;const o=Dn().length;o===0?(e.classList.add("hidden"),e.textContent=""):(e.classList.remove("hidden"),e.textContent=o>99?"99+":String(o))}function Ge(){wo(),Qa(),document.getElementById("notifications-modal")?.classList.remove("hidden")}function Ct(){document.getElementById("notifications-modal")?.classList.add("hidden")}function ei(){const e=document.getElementById("notifications-modal");return e&&!e.classList.contains("hidden")}function ti(){document.getElementById("notification-banner-close-btn")?.addEventListener("click",()=>{Fn(!0),Lt()});const t=document.getElementById("notification-banner-visibility-toggle");t?.addEventListener("change",()=>{Fn(!t.checked),Lt()}),document.getElementById("notifications-btn")?.addEventListener("click",Ge),document.getElementById("notifications-close-btn")?.addEventListener("click",Ct),te("notifications-modal",Ct),document.addEventListener("keydown",a=>{a.key==="Escape"&&ei()&&Ct()}),window.addEventListener("resize",()=>{clearTimeout(Rn),Rn=setTimeout(Co,120)}),Lt(),wo()}function Lt(){Co(),Za()}let $n=!1,Lo="";function Io(e){Lo=(e||"").toString()}function ni(e){return J().filter(o=>o.column===e).length}function oi(e,t,o){if(!t)return!0;const n=typeof e?.text=="string"?e.text:"",a=typeof e?.title=="string"&&e.title.trim()!==""?e.title:n,i=typeof e?.description=="string"?e.description:"",r=typeof e?.priority=="string"?e.priority:"";if(a.toLowerCase().includes(t)||i.toLowerCase().includes(t)||r.toLowerCase().includes(t))return!0;const s=Array.isArray(e?.labels)?e.labels:[];for(const l of s){const d=o.get(l);if(d&&d.includes(t))return!0}return!1}function Be(e=null){document.querySelectorAll(".column-menu").forEach(t=>{e&&t===e||t.classList.add("hidden")}),document.querySelectorAll(".column-submenu").forEach(t=>{t.classList.add("hidden")})}function ai(e){return[...e].sort((t,o)=>{const n=(t.dueDate||"").toString().trim(),a=(o.dueDate||"").toString().trim();return!n&&!a?0:n?a?n.localeCompare(a):-1:1})}function ii(e){const t={high:0,medium:1,low:2};return[...e].sort((o,n)=>{const a=t[o.priority]??2,i=t[n.priority]??2;return a-i})}function Hn(e,t){const o=J(),n=o.filter(l=>l.column===e),a=o.filter(l=>l.column!==e),r=(t==="dueDate"?ai(n):ii(n)).map((l,d)=>({...l,order:d+1})),s=[...a,...r];Ee(s),fe()}function ri(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=o.includes("T")?o:`${o}T00:00:00`,a=new Date(n);return Number.isNaN(a.getTime())?o:a.toLocaleDateString(t||void 0)}function si(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=new Date(o);return Number.isNaN(n.getTime())?o:n.toLocaleString(t||void 0)}function li(e){const t=(e?.creationDate||"").toString().trim();if(!t)return"";const o=new Date(t);if(Number.isNaN(o.getTime()))return"";const n=1440*60*1e3,a=Math.max(0,Math.floor((Date.now()-o.getTime())/n));if(a<30)return`${a}d`;const i=Math.floor(a/365);let r=a%365;const s=Math.floor(r/30);r=r%30;const l=[];return i>=1&&l.push(`${i}y`),s>=1&&l.push(`${s}M`),l.push(`${r}d`),l.join(" ")}function di(e,t){const o=document.createElement("li");o.classList.add("task"),o.draggable=!0,o.dataset.taskId=e.id,o.setAttribute("role","listitem"),o.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const n=document.createElement("div");n.classList.add("task-labels"),n.setAttribute("role","list"),n.setAttribute("aria-label","Task labels");const a=se();e.labels&&e.labels.length>0&&e.labels.forEach(v=>{const C=a.find(_=>_.id===v);if(C){const _=document.createElement("span");_.classList.add("task-label"),_.setAttribute("role","listitem"),_.style.backgroundColor=C.color,_.textContent=C.name,n.appendChild(_)}});const i=document.createElement("div");i.classList.add("task-header");const r=document.createElement("div");r.classList.add("task-title"),r.setAttribute("role","button"),r.setAttribute("tabindex","0");const s=typeof e.text=="string"?e.text:"";r.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:s,r.addEventListener("click",()=>Ke(e.id)),r.addEventListener("keydown",v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),Ke(e.id))});const l=document.createElement("div");l.classList.add("task-actions");const d=document.createElement("button");d.classList.add("delete-task-btn"),d.setAttribute("aria-label","Delete task"),d.type="button";const c=document.createElement("span");c.dataset.lucide="trash-2",c.setAttribute("aria-hidden","true"),d.appendChild(c),d.addEventListener("click",async v=>{v.stopPropagation(),await Te({title:"Delete Task",message:"Are you sure you want to delete this task?",confirmText:"Delete"})&&No(e.id)&&fe()}),l.appendChild(d),i.appendChild(r),i.appendChild(l);const u=typeof e.description=="string"?e.description.trim():"",m=document.createElement("div");m.classList.add("task-description"),m.textContent=u,m.style.display=u?"block":"none",m.addEventListener("click",()=>Ke(e.id));const f=document.createElement("div");f.classList.add("task-meta");const h=t?.showPriority!==!1,g=t?.showDueDate!==!1;if(h){const v=typeof e.priority=="string"?e.priority:"medium",C=document.createElement("span");C.classList.add("task-priority",`priority-${v}`),C.textContent=v,C.setAttribute("aria-label",`Priority: ${v}`),f.appendChild(C)}if(g){const v=typeof e.dueDate=="string"?e.dueDate.trim():"",C=document.createElement("span");C.classList.add("task-date"),v?C.textContent="Due "+ri(v,t?.locale):C.textContent="No due date",f.appendChild(C)}o.appendChild(i),o.appendChild(m),o.appendChild(n),f.childNodes.length>0&&o.appendChild(f);const D=t?.showChangeDate!==!1,B=t?.showAge!==!1,S=t?.locale,k=document.createElement("div");if(k.classList.add("task-footer"),D){const v=document.createElement("span");v.classList.add("task-change-date");const C=si(e?.changeDate,S);v.textContent=C?`Updated ${C}`:"",k.appendChild(v)}if(B){const v=document.createElement("span");v.classList.add("task-age");const C=li(e);v.textContent=C?`Age ${C}`:"",k.appendChild(v)}return Array.from(k.childNodes).some(v=>(v.textContent||"").trim()!=="")&&o.appendChild(k),o}function ci(e){const t=document.createElement("article");t.classList.add("task-column"),t.dataset.column=e.id,t.draggable=!1,t.setAttribute("aria-labelledby",`column-title-${e.id}`);const o=e?.collapsed===!0;o&&t.classList.add("is-collapsed"),e?.color&&t.style.setProperty("--column-accent",e.color);const n=document.createElement("button");n.classList.add("column-collapse-btn"),n.type="button",n.setAttribute("aria-label",o?`Expand ${e.name} column`:`Collapse ${e.name} column`),n.title=o?"Expand column":"Collapse column";const a=document.createElement("span");a.dataset.lucide=o?"chevron-right":"chevrons-right-left",a.setAttribute("aria-hidden","true"),n.appendChild(a),n.addEventListener("click",T=>{T.stopPropagation(),Fo(e.id)&&fe()});const i=document.createElement("button");i.classList.add("column-drag-handle"),i.type="button",i.setAttribute("aria-label","Drag to reorder column");const r=document.createElement("span");r.dataset.lucide="grip-vertical",r.setAttribute("aria-hidden","true"),i.appendChild(r),i.title="Drag to reorder";const s=document.createElement("header");s.classList.add("column-header");const l=document.createElement("h2");if(l.id=`column-title-${e.id}`,o){const T=ni(e.id);l.textContent=`${e.name} (${T})`}else l.textContent=e.name;const d=document.createElement("span");d.classList.add("task-counter"),d.dataset.columnId=e.id,d.textContent="0",d.setAttribute("aria-label","Task count");const c=document.createElement("div");c.classList.add("column-actions");const u=document.createElement("button");u.classList.add("add-task-btn-icon"),u.type="button",u.setAttribute("aria-label",`Add task to ${e.name}`);const m=document.createElement("span");m.dataset.lucide="plus",m.setAttribute("aria-hidden","true"),u.appendChild(m),u.title="Add task",u.addEventListener("click",()=>fa(e.id));const f=document.createElement("div");f.classList.add("column-menu-wrapper");const h=document.createElement("button");h.classList.add("column-menu-btn"),h.type="button",h.setAttribute("aria-haspopup","menu"),h.setAttribute("aria-expanded","false"),h.setAttribute("aria-label",`${e.name} column menu`);const g=document.createElement("span");g.dataset.lucide="ellipsis-vertical",g.setAttribute("aria-hidden","true"),h.appendChild(g),h.title="Column menu";const D=document.createElement("div");D.classList.add("column-menu","hidden"),D.setAttribute("role","menu");const B=document.createElement("button");B.classList.add("column-menu-item"),B.type="button",B.setAttribute("role","menuitem");const S=document.createElement("span");S.dataset.lucide="pencil",S.setAttribute("aria-hidden","true"),B.appendChild(S);const k=document.createTextNode(" Edit");B.appendChild(k),B.title="Edit column",B.addEventListener("click",T=>{T.stopPropagation(),Be(),ha(e.id)});const w=document.createElement("button");w.classList.add("column-menu-item","danger"),w.type="button",w.setAttribute("role","menuitem");const v=document.createElement("span");v.dataset.lucide="trash-2",v.setAttribute("aria-hidden","true"),w.appendChild(v);const C=document.createTextNode(" Delete");w.appendChild(C),w.title="Delete column",w.addEventListener("click",T=>{T.stopPropagation(),Be(),(async()=>{if(e.id==="done"){await be({title:"Cannot Delete Column",message:"The Done column is permanent and cannot be deleted."});return}if(ae().length<=1){await be({title:"Cannot Delete Column",message:"Cannot delete the last column."});return}const dt=J().filter(ko=>ko.column===e.id),zt=e?.name?`"${e.name}"`:"this column",ct=dt.length>0?`Delete ${zt}? This will also delete ${dt.length} task(s).`:`Delete ${zt}?`;await Te({title:"Delete Column",message:ct,confirmText:"Delete"})&&Ho(e.id)&&fe()})()});const _=document.createElement("div");_.classList.add("column-menu-submenu-wrapper");const O=document.createElement("button");O.classList.add("column-menu-item","has-submenu"),O.type="button",O.setAttribute("role","menuitem"),O.setAttribute("aria-haspopup","menu"),O.setAttribute("aria-expanded","false");const R=document.createElement("span");R.dataset.lucide="arrow-up-down",R.setAttribute("aria-hidden","true"),O.appendChild(R);const we=document.createTextNode(" Sort");O.appendChild(we);const G=document.createElement("span");G.dataset.lucide="chevron-left",G.classList.add("submenu-chevron"),G.setAttribute("aria-hidden","true"),O.appendChild(G),O.title="Sort tasks in column";const z=document.createElement("div");z.classList.add("column-submenu","hidden"),z.setAttribute("role","menu");const F=document.createElement("button");F.classList.add("column-menu-item"),F.type="button",F.setAttribute("role","menuitem"),F.textContent="By Due Date",F.title="Sort by due date (earliest first)",F.addEventListener("click",T=>{T.stopPropagation(),Be(),Hn(e.id,"dueDate")});const Y=document.createElement("button");Y.classList.add("column-menu-item"),Y.type="button",Y.setAttribute("role","menuitem"),Y.textContent="By Priority",Y.title="Sort by priority (high to low)",Y.addEventListener("click",T=>{T.stopPropagation(),Be(),Hn(e.id,"priority")}),z.appendChild(F),z.appendChild(Y),O.addEventListener("click",T=>{T.stopPropagation();const le=!z.classList.contains("hidden");z.classList.toggle("hidden"),O.setAttribute("aria-expanded",le?"false":"true")}),_.addEventListener("mouseenter",()=>{z.classList.remove("hidden"),O.setAttribute("aria-expanded","true")}),_.addEventListener("mouseleave",()=>{z.classList.add("hidden"),O.setAttribute("aria-expanded","false")}),_.appendChild(O),_.appendChild(z),D.appendChild(B),D.appendChild(_),D.appendChild(w),h.addEventListener("click",T=>{T.stopPropagation();const le=!D.classList.contains("hidden");Be(),le?h.setAttribute("aria-expanded","false"):(D.classList.remove("hidden"),h.setAttribute("aria-expanded","true"))}),f.appendChild(h),f.appendChild(D),c.appendChild(u),c.appendChild(f),s.appendChild(n),s.appendChild(i),s.appendChild(l),s.appendChild(d),s.appendChild(c);const Z=document.createElement("ul");return Z.classList.add("tasks"),Z.setAttribute("role","list"),Z.setAttribute("aria-label",`Tasks in ${e.name}`),o&&(Z.classList.add("hidden"),c.classList.add("hidden"),d.classList.add("hidden")),t.appendChild(s),t.appendChild(Z),t}function ui(){const e=ae(),t=document.getElementById("task-column");t.innerHTML="",e.forEach(o=>{const n=document.createElement("option");n.value=o.id,n.textContent=o.name,t.appendChild(n)})}function fe(){const e=ae(),t=J(),o=se(),n=X(),a=new Map(o.map(d=>[d.id,(d.name||"").toString().trim().toLowerCase()])),i=(Lo||"").toString().trim().toLowerCase(),r=i?t.filter(d=>oi(d,i,a)):t,s=document.getElementById("board-container");s.innerHTML="",[...e].sort((d,c)=>(d.order??0)-(c.order??0)).forEach(d=>{const c=ci(d);s.appendChild(c);const u=c.querySelector(".tasks"),m=c.querySelector(".task-counter"),f=r.filter(h=>h.column===d.id).sort((h,g)=>(h.order??0)-(g.order??0));f.forEach(h=>{u.appendChild(di(h,n))}),m.textContent=f.length}),qa(),ui(),Ae(),Lt(),$n||($n=!0,document.addEventListener("click",()=>Be()),document.addEventListener("keydown",d=>{d.key==="Escape"&&Be()}))}const ue=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:fe,setBoardFilterQuery:Io},Symbol.toStringTag,{value:"Module"})),So="kanban-theme";function mi(){const e=localStorage.getItem(So);return e==="light"||e==="dark"?e:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function zn(e){document.documentElement.dataset.theme=e}function Yn(e){const t=document.getElementById("theme-toggle-btn");if(!t)return;const o=e==="dark"?"light":"dark",n=o==="dark"?"Dark":"Light",a=o==="dark"?"moon":"sun";t.setAttribute("aria-pressed",String(e==="dark"));const i=t.querySelector("[data-lucide]");i&&i.setAttribute("data-lucide",a);const r=Array.from(t.childNodes).filter(s=>s.nodeType===Node.TEXT_NODE);for(const s of r)s.remove();t.appendChild(document.createTextNode(` ${n}`)),Ae()}function fi(){const e=mi();zn(e),Yn(e);const t=document.getElementById("theme-toggle-btn");t&&t.addEventListener("click",()=>{const n=(document.documentElement.dataset.theme==="dark"?"dark":"light")==="dark"?"light":"dark";zn(n),localStorage.setItem(So,n),Yn(n)})}function pi(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function Un(e){const t=ze(),o=hn();e.innerHTML="",t.forEach(n=>{const a=document.createElement("option");a.value=n.id,a.textContent=pi(n),e.appendChild(a)}),o&&(e.value=o)}function on(){const e=document.getElementById("brand-text")||document.querySelector(".brand-text");e&&(e.textContent=Mt())}function hi(){const e=document.getElementById("board-create-modal"),t=document.getElementById("board-create-name");!e||!t||(t.value="",e.classList.remove("hidden"),t.focus())}function Ue(){const e=document.getElementById("board-create-modal");e&&e.classList.add("hidden")}function gi(){pn();const e=document.getElementById("board-select");if(!e)return;Un(e),on(),document.addEventListener("kanban:open-board-create",()=>{hi()}),e.addEventListener("change",()=>{const a=e.value;if(!a)return;It(a),on(),fe();const i=document.getElementById("board-controls-menu"),r=document.getElementById("desktop-menu-btn");i?.classList.remove("show"),r?.setAttribute("aria-expanded","false")});const t=document.getElementById("board-create-modal"),o=document.getElementById("board-create-form"),n=document.getElementById("cancel-board-create-btn");t&&(t.querySelector(".modal-backdrop")?.addEventListener("click",Ue),t.addEventListener("keydown",i=>{i.key==="Escape"&&Ue()})),n&&n.addEventListener("click",Ue),te("board-create-modal",Ue),o&&o.addEventListener("submit",async a=>{a.preventDefault();const i=document.getElementById("board-create-name"),r=(i?.value||"").trim();if(!r){await be({title:"Error",message:"Board name cannot be empty."}),i?.focus();return}const s=Xn(r);It(s.id),Un(e),on(),fe(),Ue(),document.dispatchEvent(new CustomEvent("kanban:boards-changed"))})}function bi(e){const t=[];for(const o of e){if(typeof o!="string")continue;const n=o.trim();n&&(t.includes(n)||t.push(n))}return t}function yi(e){const t=typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US";return bi([e,t,"en-US","en-GB","de-DE","fr-FR","es-ES","it-IT","pt-BR","ja-JP","zh-CN"])}function vi(){document.getElementById("settings-modal")?.classList.remove("hidden")}function an(){document.getElementById("settings-modal")?.classList.add("hidden")}async function Se(e){jn(e);const{renderBoard:t}=await de(async()=>{const{renderBoard:o}=await Promise.resolve().then(()=>ue);return{renderBoard:o}},void 0,import.meta.url);t()}function Ei(){const e=document.getElementById("settings-btn"),t=document.getElementById("settings-close-btn");document.querySelector("#settings-modal .modal-backdrop");const o=document.getElementById("settings-show-priority"),n=document.getElementById("settings-show-due-date"),a=document.getElementById("settings-notification-days"),i=document.getElementById("settings-show-age"),r=document.getElementById("settings-show-change-date"),s=document.getElementById("settings-locale"),l=document.getElementById("settings-default-priority");if(!e||!t||!o||!n||!a||!i||!r||!s||!l)return;function d(){const c=X();o.checked=c.showPriority!==!1,n.checked=c.showDueDate!==!1,i.checked=c.showAge!==!1,r.checked=c.showChangeDate!==!1,a.value=String(Number.isFinite(c.notificationDays)?c.notificationDays:3);const u=yi(c.locale);s.innerHTML="",u.forEach(m=>{const f=document.createElement("option");f.value=m,f.textContent=m,s.appendChild(f)}),s.value=c.locale,l.value=c.defaultPriority||"low"}e.addEventListener("click",()=>{d(),vi()}),t.addEventListener("click",an),te("settings-modal",an),document.addEventListener("keydown",c=>{const u=document.getElementById("settings-modal");!u||u.classList.contains("hidden")||c.key==="Escape"&&an()}),i.addEventListener("change",async()=>{const c=X();await Se({...c,showAge:!!i.checked})}),r.addEventListener("change",async()=>{const c=X();await Se({...c,showChangeDate:!!r.checked})}),o.addEventListener("change",async()=>{const c=X();await Se({...c,showPriority:!!o.checked})}),n.addEventListener("change",async()=>{const c=X();await Se({...c,showDueDate:!!n.checked})}),a.addEventListener("change",async()=>{const c=X(),u=Number.parseInt(a.value,10),m=Number.isFinite(u)?u:3;await Se({...c,notificationDays:m})}),s.addEventListener("change",async()=>{const c=X();await Se({...c,locale:s.value})}),l.addEventListener("change",async()=>{const c=X();await Se({...c,defaultPriority:l.value})})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("app-version");e&&(e.textContent="v1.0.7",e.title="Version 1.0.7"),fi(),Ei();const t=document.getElementById("board-search-input");t&&t.addEventListener("input",()=>{Io(t.value),fe()}),gi(),wa(),ti(),document.getElementById("export-btn").addEventListener("click",async()=>{await Te({title:"Export Board (Active Only)",message:`Export ONLY saves the current active board. It does NOT back up all boards.

To back up everything, export each board individually.

Continue with export?`,confirmText:"Export"})&&oa()}),document.getElementById("import-btn").addEventListener("click",async()=>{await Te({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",a=>{const i=a.target.files[0];i&&ia(i),a.target.value=""});const o=document.getElementById("desktop-menu-btn"),n=document.getElementById("board-controls-menu");o&&n&&(o.addEventListener("click",a=>{a.stopPropagation();const i=o.getAttribute("aria-expanded")==="true";n.classList.toggle("show"),o.setAttribute("aria-expanded",String(!i)),document.querySelectorAll(".column-menu").forEach(r=>r.classList.add("hidden"))}),n.addEventListener("click",a=>{a.target.closest("select, option, input, textarea, label")||!a.target.closest('button, a, [role="menuitem"]')||(n.classList.remove("show"),o.setAttribute("aria-expanded","false"))}),document.addEventListener("click",a=>{!n.contains(a.target)&&!o.contains(a.target)&&(n.classList.remove("show"),o.setAttribute("aria-expanded","false"))})),fe()});
