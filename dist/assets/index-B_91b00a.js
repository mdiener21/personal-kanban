import{l as te,g as ln,s as Ie,a as Q,b as Ne,c as ne,d as _t,e as V,f as At,h as xn,i as wt,j as On,k as Me,r as xt,m as sn,n as dn,o as uo,p as mo}from"./storage-zmOQFfzu.js";const fo=new Set(["low","medium","high"]);function Pn(e){const t=(e||"").toString().trim().toLowerCase();return fo.has(t)?t:"low"}function Nn(e){return(e||"").toString().trim()}function po(e,t,o,n,a,r=[]){if(!e||e.trim()==="")return;const i=te(),l=i.filter(m=>m.column===a).slice().sort((m,f)=>(m.order??0)-(f.order??0)),s=new Map;l.forEach((m,f)=>{s.set(m.id,f+2)});const d=i.map(m=>{if(m.column!==a)return m;const f=s.get(m.id);return typeof f=="number"?{...m,order:f}:m}),c=new Date().toISOString(),u={id:ln(),title:e.trim(),description:(t||"").toString().trim(),priority:Pn(o),dueDate:Nn(n),column:a,order:1,labels:[...r],creationDate:c,changeDate:c,...a==="done"?{doneDate:c}:{}};d.push(u),Ie(d)}function ho(e,t,o,n,a,r,i=[]){if(!t||t.trim()==="")return;const l=te(),s=l.findIndex(d=>d.id===e);if(s!==-1){const d=l[s].column,c=r,u=new Date().toISOString();l[s].title=t.trim(),l[s].description=(o||"").toString().trim(),l[s].priority=Pn(n),l[s].dueDate=Nn(a),l[s].column=c,l[s].labels=[...i],d!=="done"&&c==="done"?l[s].doneDate=u:d==="done"&&c!=="done"&&delete l[s].doneDate,l[s].changeDate=u,Ie(l)}}function go(e){const o=te().filter(n=>n.id!==e);return Ie(o),!0}function bo(){const e=[];return document.querySelectorAll(".task-column").forEach(t=>{const o=t.dataset.column;t.querySelectorAll(".task").forEach(n=>{e.push({id:n.dataset.taskId,column:o})})}),e}function yo(){const e=bo(),t=te(),o=new Date().toISOString(),n=t.map(a=>{const r=e.findIndex(i=>i.id===a.id);if(r!==-1){const i=e[r],l=e.filter((m,f)=>m.column===i.column&&f<=r),s=i.column,d=l.length,c=a.column!==s,u={...a,column:s,order:d,...c?{changeDate:o}:{}};return c&&(a.column!=="done"&&s==="done"?u.doneDate=o:a.column==="done"&&s!=="done"&&delete u.doneDate),{...u}}return a});Ie(n)}function vo(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function Mn(e){return vo(e)?e.trim():"#3b82f6"}function Eo(e,t){if(!e||e.trim()==="")return;const o=Q(),n=o.reduce((i,l)=>Math.max(i,l.order??0),0),r={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+ln().substring(0,8),name:e.trim(),color:Mn(t),order:n+1,collapsed:!1};o.push(r),Ne(o)}function wo(e){const t=typeof e=="string"?e.trim():"";if(!t)return!1;const o=Q(),n=o.find(a=>a.id===t);return n?(n.collapsed=n.collapsed!==!0,Ne(o),!0):!1}function Do(e,t,o){if(!t||t.trim()==="")return;const n=Q(),a=n.findIndex(r=>r.id===e);a!==-1&&(n[a].name=t.trim(),n[a].color=Mn(o),Ne(n))}function Co(e){if(e==="done")return!1;const t=Q();if(t.length<=1)return!1;const o=te();if(o.filter(r=>r.column===e).length>0){const r=o.filter(i=>i.column!==e);Ie(r)}const a=t.filter(r=>r.id!==e);return Ne(a),!0}function Io(){const t=document.getElementById("board-container").querySelectorAll(".task-column"),o=Q();t.forEach((n,a)=>{const r=n.dataset.column,i=o.find(l=>l.id===r);i&&(i.order=a+1)}),Ne(o)}const Lo="modulepreload",So=function(e,t){return new URL(e,t).href},bn={},oe=function(t,o,n){let a=Promise.resolve();if(o&&o.length>0){let d=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const i=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),s=l?.nonce||l?.getAttribute("nonce");a=d(o.map(c=>{if(c=So(c,n),c in bn)return;bn[c]=!0;const u=c.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(n)for(let h=i.length-1;h>=0;h--){const g=i[h];if(g.href===c&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Lo,u||(f.as="script"),f.crossOrigin="",f.href=c,s&&f.setAttribute("nonce",s),document.head.appendChild(f),u)return new Promise((h,g)=>{f.addEventListener("load",h),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&r(l.reason);return t().catch(r)})},cn=40;function un(e){return e.trim().slice(0,cn).toLowerCase().replace(/\s+/g," ")}function Rn(e,t,o=null){return e.some(n=>o&&n.id===o?!1:un(n.name)===t)}function ko(e,t){if(!e||e.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const o=e.trim().slice(0,cn),n=un(o),a=ne();if(Rn(a,n))return{success:!1,reason:"DUPLICATE_NAME",message:`Label "${o}" already exists.`};const i={id:n.replace(/\s+/g,"-")+"-"+ln().substring(0,8),name:o,color:t};return a.push(i),_t(a),{success:!0,label:i}}function Bo(e,t,o){if(!t||t.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const n=t.trim().slice(0,cn),a=un(n),r=ne(),i=r.findIndex(l=>l.id===e);return i===-1?{success:!1,reason:"NOT_FOUND"}:Rn(r,a,e)?{success:!1,reason:"DUPLICATE_NAME",message:`Another label with the name "${n}" already exists.`}:(r[i].name=n,r[i].color=o,_t(r),{success:!0,label:r[i]})}function To(e){const t=ne(),o=te();o.forEach(a=>{a.labels&&(a.labels=a.labels.filter(r=>r!==e))}),Ie(o);const n=t.filter(a=>a.id!==e);_t(n)}let Dt=null;function J(e){return document.getElementById(e)}function ot(e){const t=J("dialog-modal");t&&t.classList.add("hidden");const o=Dt;Dt=null,typeof o=="function"&&o(!!e)}function _o(){const e=J("dialog-modal");return e&&!e.classList.contains("hidden")}function Fn({title:e,message:t,confirmText:o,cancelText:n,showCancel:a}){const r=J("dialog-modal-title"),i=J("dialog-modal-message"),l=J("dialog-confirm-btn"),s=J("dialog-cancel-btn");r&&(r.textContent=e||"Confirm"),i&&(i.textContent=t||""),l&&(l.textContent=o||"OK"),s&&(s.textContent=n||"Cancel"),s&&(s.style.display=a?"inline-flex":"none")}function $n(){const e=J("dialog-modal");if(!e||e.dataset.handlersAttached==="true")return;e.dataset.handlersAttached="true";const t=J("dialog-confirm-btn"),o=J("dialog-cancel-btn"),n=e.querySelector(".modal-backdrop");t?.addEventListener("click",()=>ot(!0)),o?.addEventListener("click",()=>ot(!1)),n?.addEventListener("click",()=>ot(!1)),document.addEventListener("keydown",a=>{a.key==="Escape"&&_o()&&ot(!1)})}function zn(){const e=J("dialog-modal");if(!e)return;e.classList.remove("hidden"),J("dialog-confirm-btn")?.focus()}function Ce({title:e="Confirm",message:t="",confirmText:o="Delete",cancelText:n="Cancel"}={}){return $n(),Fn({title:e,message:t,confirmText:o,cancelText:n,showCancel:!0}),zn(),new Promise(a=>{Dt=a})}function fe({title:e="Notice",message:t="",okText:o="OK"}={}){return $n(),Fn({title:e,message:t,confirmText:o,cancelText:"",showCancel:!1}),zn(),new Promise(n=>{Dt=()=>n(!0)})}function Rt(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return Array.isArray(o)?o:null}catch{return null}}function Ao(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return o&&typeof o=="object"&&!Array.isArray(o)?o:null}catch{return null}}function Hn(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function xo(e){const t=document.getElementById("brand-text")||document.querySelector(".brand-text");t&&(t.textContent=At());const o=document.getElementById("board-select");if(!o)return;const n=Me();o.innerHTML="",n.forEach(a=>{const r=document.createElement("option");r.value=a.id,r.textContent=Hn(a),o.appendChild(r)}),e&&(o.value=e)}function Oo(e){const t=typeof e?.name=="string"?e.name.trim():"";return t?t.replace(/\.[^.]+$/,"").trim():""}function Ot(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const Po=new Set(["low","medium","high"]);function Pt(e){const t=(e||"").toString().trim().toLowerCase();return Po.has(t)?t:"low"}function No(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},o=t.showPriority!==!1,n=t.showDueDate!==!1,a=t.showAge!==!1,r=t.showChangeDate!==!1,i=typeof t.locale=="string"&&t.locale.trim()?t.locale.trim():typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US",l=Pt(t.defaultPriority);return{showPriority:o,showDueDate:n,showAge:a,showChangeDate:r,locale:i,defaultPriority:l}}function Xn(e){const t=(e||"").toString().trim();return t.length>=10&&t.includes("T")?t.slice(0,10):t}function Yn(e){const t=typeof e?.text=="string"?e.text:"",o=typeof e?.title=="string"?e.title:t,n=typeof e?.description=="string"?e.description:"",a=Xn(e?.dueDate??e?.["due-date"]),r=typeof e?.changeDate=="string"?e.changeDate:typeof e?.changedDate=="string"?e.changedDate:void 0,i=e?.column==="done",l=typeof e?.doneDate=="string"?e.doneDate.toString().trim():"";return{...e,title:o.toString().trim(),description:n.toString().trim(),priority:Pt(e?.priority),dueDate:a,...typeof r=="string"?{changeDate:r.toString().trim()}:{},...i&&l?{doneDate:l}:{doneDate:void 0},changedDate:void 0}}function Mo(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),r=typeof n?.text=="string"?n.text:String(n?.text??""),i=typeof n?.title=="string"?n.title:r,l=typeof n?.description=="string"?n.description:String(n?.description??""),s=Pt(n?.priority),d=typeof n?.dueDate=="string"?n.dueDate:typeof n?.["due-date"]=="string"?n["due-date"]:String(n?.dueDate??n?.["due-date"]??""),c=Xn(d),u=typeof n?.column=="string"?n.column:String(n?.column??""),m=Array.isArray(n?.labels)?n.labels.map(k=>typeof k=="string"?k:String(k)):[],f=Number.isFinite(n?.order)?n.order:void 0,h=typeof n?.creationDate=="string"?n.creationDate:void 0,g=typeof n?.changeDate=="string"?n.changeDate:typeof n?.changedDate=="string"?n.changedDate:void 0,I=typeof n?.doneDate=="string"?n.doneDate.trim():"",S=u.trim()==="done"&&(I||(typeof g=="string"?g.trim():"")||h)||"";return{id:a.trim(),title:i.trim(),description:l.trim(),priority:s,dueDate:c.trim(),column:u.trim(),...f!==void 0?{order:f}:{},...h?{creationDate:h}:{},...typeof g=="string"&&g.trim()?{changeDate:g.trim()}:{},...S?{doneDate:S}:{},labels:m}});return t.every(n=>n.id&&n.title&&n.column)?t:null}function Ro(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),r=typeof n?.name=="string"?n.name:String(n?.name??""),i=Number.isFinite(n?.order)?n.order:void 0,l=Ot(n?.color)?n.color.trim():"#3b82f6",s=n?.collapsed===!0;return{id:a.trim(),name:r.trim(),color:l,collapsed:s,...i!==void 0?{order:i}:{}}});if(!t.some(n=>n.id==="done")){const n=t.reduce((a,r)=>Math.max(a,Number.isFinite(r?.order)?r.order:0),0);t.push({id:"done",name:"Done",color:"#16a34a",order:n+1,collapsed:!1})}return t.every(n=>n.id&&n.name)?t:null}function Fo(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),r=typeof n?.name=="string"?n.name:String(n?.name??""),i=Ot(n?.color)?n.color.trim():"#3b82f6";return{id:a.trim(),name:r.trim(),color:i}});return t.every(n=>n.id&&n.name&&n.color)?t:null}function $o(e){if(!e||typeof e!="object"||Array.isArray(e))return null;const t=e.showPriority!==!1,o=e.showDueDate!==!1,n=e.showAge!==!1,a=e.showChangeDate!==!1,r=typeof e.locale=="string"&&e.locale.trim()?e.locale.trim():void 0,i=typeof e.defaultPriority=="string"?e.defaultPriority:void 0,l=i?Pt(i):void 0;return{showPriority:t,showDueDate:o,showAge:n,showChangeDate:a,...r?{locale:r}:{},...l?{defaultPriority:l}:{}}}function zo(){const e=te().map(Yn),t=Q().map(c=>({...c,color:Ot(c?.color)?c.color.trim():"#3b82f6"})),o=ne(),n=V(),a=At(),i=JSON.stringify({boardName:a,columns:t,tasks:e,labels:o,settings:n},null,2),l=new Blob([i],{type:"application/json"}),s=URL.createObjectURL(l),d=document.createElement("a");d.href=s,d.download=`${a.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(s)}function Ho(e){const t=typeof e=="string"?e.trim():"";if(!t)return;const o=Me().find(E=>E.id===t),n=Hn(o),a=`kanbanBoard:${t}:columns`,r=`kanbanBoard:${t}:tasks`,i=`kanbanBoard:${t}:labels`,l=`kanbanBoard:${t}:settings`,s=Rt(r)||[],d=Rt(a)||[],c=Rt(i)||[],u=Ao(l)||null,m=s.map(Yn),f=d.map(E=>({...E,color:Ot(E?.color)?E.color.trim():"#3b82f6",collapsed:E?.collapsed===!0})),h=Array.isArray(c)?c:[],g=No(u),B=JSON.stringify({boardName:n,columns:f,tasks:m,labels:h,settings:g},null,2),S=new Blob([B],{type:"application/json"}),k=URL.createObjectURL(S),L=document.createElement("a");L.href=k,L.download=`${n.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(k)}function Xo(e){const t=new FileReader;t.onload=async o=>{try{const n=JSON.parse(o.target.result);let a,r,i,l,s;if(Array.isArray(n))a=n,r=null,i=null,l=null,s=null;else if(n.tasks&&n.columns)a=n.tasks,r=n.columns,i=Object.prototype.hasOwnProperty.call(n,"labels")?n.labels:null,l=Object.prototype.hasOwnProperty.call(n,"settings")?n.settings:null,s=typeof n.boardName=="string"?n.boardName.trim():null;else{alert("Invalid JSON file format");return}const d=Mo(a),c=r?Ro(r):null,u=i?Fo(i):null,m=l?$o(l):null;if(!d||r&&!c||i&&!u||l&&!m){alert("Invalid data structure");return}const f=s||Oo(e)||"Imported board",h=xn(f);if(h?.id&&wt(h.id),c&&Ne(c),Ie(d),u&&_t(u),m){const I=V();On({...I,...m})}xo(h?.id);const{renderBoard:g}=await oe(async()=>{const{renderBoard:I}=await Promise.resolve().then(()=>re);return{renderBoard:I}},void 0,import.meta.url);g(),document.dispatchEvent(new CustomEvent("kanban:boards-changed")),alert("Board imported successfully!")}catch(n){alert("Error parsing JSON file: "+n.message)}},t.readAsText(e)}let yn="todo",Ke=null,Je=null,Xe=null,Ct=null,$=[],he=!1,Ze=!1;const ye=40;let Fe=!1;function Nt(e){const t=document.getElementById("task-modal");if(!t)return;t.classList.toggle("fullscreen",!!e),document.getElementById("task-fullpage-btn")?.setAttribute("aria-pressed",e?"true":"false")}function ve(e){const t=document.getElementById(e);return!!t&&!t.classList.contains("hidden")}function Yo(){const e=document.getElementById("task-modal");e&&(e.classList.remove("hidden"),Oe(),document.getElementById("task-label-search")?.focus(),he=!1)}function Uo(){return(document.getElementById("task-label-search")?.value||"").trim().toLowerCase()}function jo(){return(document.getElementById("labels-search")?.value||"").trim().toLowerCase()}function Qt(){const e=document.getElementById("task-active-labels");if(!e)return;const t=ne(),o=[];for(const a of $)o.includes(a)||o.push(a);$=o;const n=o.map(a=>t.find(r=>r.id===a)).filter(Boolean);e.innerHTML="",e.style.display=n.length>0?"flex":"none",n.forEach(a=>{const r=document.createElement("span");r.classList.add("task-label"),r.style.backgroundColor=a.color,r.textContent=a.name;const i=document.createElement("button");i.type="button",i.classList.add("active-label-remove"),i.setAttribute("aria-label",`Remove label ${a.name}`),i.title="Remove label",i.textContent="Ã—",i.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),$=$.filter(s=>s!==a.id),Qt(),Oe()}),r.appendChild(i),e.appendChild(r)})}function qo(e){yn=e||Q()[0]?.id||"todo",Ke=null,$=[],he=!1,Ze=!1,Nt(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden");const t=document.getElementById("task-modal"),o=document.getElementById("task-column"),n=document.getElementById("task-title"),a=document.getElementById("task-description"),r=document.getElementById("task-priority"),i=document.getElementById("task-due-date"),l=document.getElementById("task-modal-title"),s=document.getElementById("task-submit-btn");if(l.textContent="Add New Task",s.textContent="Add Task",o.value=yn,n.value="",a.value="",r){const c=V();r.value=c.defaultPriority||"low"}i&&(i.value="");const d=document.getElementById("task-label-search");d&&(d.value=""),Oe(),t.classList.remove("hidden"),n.focus()}function Ft(e){const o=te().find(g=>g.id===e);if(!o)return;Ke=e,$=o.labels||[],he=!1,Ze=!1,Nt(!1),document.getElementById("task-fullpage-btn")?.classList.remove("hidden");const n=document.getElementById("task-modal"),a=document.getElementById("task-column"),r=document.getElementById("task-title"),i=document.getElementById("task-description"),l=document.getElementById("task-priority"),s=document.getElementById("task-due-date"),d=document.getElementById("task-modal-title"),c=document.getElementById("task-submit-btn");d.textContent="Edit Task",c.textContent="Save Changes",a.value=o.column;const u=typeof o.text=="string"?o.text:"";r.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:u,i.value=typeof o.description=="string"?o.description:"",l&&(l.value=typeof o.priority=="string"?o.priority:"medium");const m=typeof o.dueDate=="string"?o.dueDate:"",f=m.includes("T")?m.slice(0,10):m;s&&(s.value=f);const h=document.getElementById("task-label-search");h&&(h.value=""),Oe(),n.classList.remove("hidden"),r.focus()}function at(){document.getElementById("task-modal").classList.add("hidden"),Ke=null,he=!1,Nt(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden")}function Wo(){Je=null;const e=document.getElementById("column-modal"),t=document.getElementById("column-name"),o=document.getElementById("column-color"),n=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");n.textContent="Add New Column",a.textContent="Add Column",t.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),t.focus()}function Go(e){const o=Q().find(s=>s.id===e);if(!o)return;Je=e;const n=document.getElementById("column-modal"),a=document.getElementById("column-name"),r=document.getElementById("column-color"),i=document.getElementById("column-modal-title"),l=document.getElementById("column-submit-btn");i.textContent="Edit Column",l.textContent="Save Changes",a.value=o.name,r&&(r.value=o.color||"#3b82f6"),n.classList.remove("hidden"),a.focus()}function rt(){document.getElementById("column-modal").classList.add("hidden"),Je=null}function Vo(){const e=document.getElementById("labels-search");e&&(e.value=""),It(),document.getElementById("labels-modal").classList.remove("hidden"),he||document.getElementById("labels-search")?.focus()}function it(){document.getElementById("labels-modal").classList.add("hidden");const t=document.getElementById("labels-search");t&&(t.value=""),he&&Yo()}function Ko(){document.getElementById("help-modal").classList.remove("hidden")}function $t(){document.getElementById("help-modal").classList.add("hidden")}function Zt(e=null,{openedFromTaskEditor:t=!1}={}){Xe=e,Fe=!1,Ze=!!t;const o=document.getElementById("label-modal"),n=document.getElementById("label-modal-title"),a=document.getElementById("label-name"),r=document.getElementById("label-color"),i=document.getElementById("label-submit-btn");if(e){const s=ne().find(d=>d.id===e);s&&(n.textContent="Edit Label",i.textContent="Update Label",a.value=s.name,r.value=s.color)}else n.textContent="Add Label",i.textContent="Add Label",a.value="",r.value="#3b82f6";o.classList.remove("hidden"),a.focus()}function lt(){document.getElementById("label-modal").classList.add("hidden"),Xe=null,Ze=!1}function It(){const e=document.getElementById("labels-list");e.innerHTML="";const t=ne(),o=jo(),n=o?t.filter(a=>{const r=(a.name||"").toLowerCase(),i=(a.id||"").toLowerCase();return r.includes(o)||i.includes(o)}):t;if(n.length===0){const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent=o?"No matching labels":"No labels yet",e.appendChild(a);return}n.forEach(a=>{const r=document.createElement("div");r.classList.add("label-item"),r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="space-between";const i=document.createElement("span");i.classList.add("task-label"),i.style.backgroundColor=a.color,i.textContent=a.name;const l=document.createElement("div");l.classList.add("label-actions"),l.style.display="flex",l.style.gap="4px";const s=document.createElement("button");s.classList.add("btn-small");const d=document.createElement("span");d.dataset.lucide="pencil",s.appendChild(d),s.title="Edit label",s.addEventListener("click",()=>Zt(a.id));const c=document.createElement("button");c.classList.add("btn-small","btn-danger");const u=document.createElement("span");u.dataset.lucide="trash-2",c.appendChild(u),c.title="Delete label",c.addEventListener("click",async()=>{if(await Ce({title:"Delete Label",message:`Delete label "${a.name}"? This will remove it from all tasks.`,confirmText:"Delete"})){To(a.id),It();const{renderBoard:f}=await oe(async()=>{const{renderBoard:h}=await Promise.resolve().then(()=>re);return{renderBoard:h}},void 0,import.meta.url);f()}}),l.appendChild(s),l.appendChild(c),r.appendChild(i),r.appendChild(l),e.appendChild(r)}),xt()}function en(){const e=document.getElementById("board-select");if(!e)return;const t=Me(),o=dn();e.innerHTML="",t.forEach(a=>{const r=document.createElement("option");r.value=a.id,r.textContent=typeof a.name=="string"&&a.name.trim()?a.name.trim():"Untitled board",e.appendChild(r)}),o&&(e.value=o);const n=document.getElementById("brand-text")||document.querySelector(".brand-text");n&&(n.textContent=At())}function Qe(){sn();const e=document.getElementById("boards-list");if(!e)return;e.innerHTML="";const t=Me(),o=dn();t.forEach(n=>{const a=document.createElement("div");a.classList.add("label-item"),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="10px";const r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.gap="8px";const i=document.createElement("span");if(i.textContent=(n.name||"").toString(),r.appendChild(i),n.id===o){const g=document.createElement("span");g.classList.add("task-label"),g.style.backgroundColor="var(--color-primary)",g.textContent="Active",r.appendChild(g)}const l=document.createElement("div");l.classList.add("label-actions"),l.style.display="flex",l.style.gap="4px";const s=document.createElement("button");s.classList.add("btn-small"),s.textContent="Open",s.title="Open board",s.addEventListener("click",async()=>{wt(n.id),en(),Qe();const{renderBoard:g}=await oe(async()=>{const{renderBoard:I}=await Promise.resolve().then(()=>re);return{renderBoard:I}},void 0,import.meta.url);g()});const d=document.createElement("button");d.classList.add("btn-small"),d.type="button",d.title="Export board",d.setAttribute("aria-label",`Export board ${String(n.name||"Untitled board")}`);const c=document.createElement("span");c.dataset.lucide="download",d.appendChild(c),d.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),Ho(n.id)});const u=document.createElement("button");u.classList.add("btn-small");const m=document.createElement("span");m.dataset.lucide="pencil",u.appendChild(m),u.title="Rename board",u.addEventListener("click",()=>Zo(n.id));const f=document.createElement("button");f.classList.add("btn-small","btn-danger");const h=document.createElement("span");h.dataset.lucide="trash-2",f.appendChild(h),f.title="Delete board",f.addEventListener("click",async()=>{if(!await Ce({title:"Delete Board",message:`Do you really want to delete the board "${n.name}"? This cannot be undone.`,confirmText:"Delete"}))return;if(!uo(n.id)){await fe({title:"Unable to Delete",message:"Unable to delete board (you may be trying to delete the last board)."});return}en(),Qe();const{renderBoard:B}=await oe(async()=>{const{renderBoard:S}=await Promise.resolve().then(()=>re);return{renderBoard:S}},void 0,import.meta.url);B()}),l.appendChild(s),l.appendChild(d),l.appendChild(u),l.appendChild(f),a.appendChild(r),a.appendChild(l),e.appendChild(a)}),xt()}function Jo(){Qe(),document.getElementById("boards-modal")?.classList.remove("hidden")}function zt(){document.getElementById("boards-modal")?.classList.add("hidden")}function Qo(){const e=document.getElementById("boards-modal");!e||e.classList.contains("hidden")||Qe()}function Zo(e){sn();const t=Me().find(i=>i.id===e);if(!t)return;Ct=e;const o=document.getElementById("board-rename-modal"),n=document.getElementById("board-rename-name"),a=document.getElementById("board-rename-modal-title"),r=document.getElementById("board-rename-submit-btn");a&&(a.textContent="Rename Board"),r&&(r.textContent="Save"),n&&(n.value=(t.name||"").toString()),o?.classList.remove("hidden"),n?.focus()}function st(){document.getElementById("board-rename-modal")?.classList.add("hidden"),Ct=null}function Oe(){Qt();const e=document.getElementById("task-labels-selection");e.innerHTML="";const t=Uo(),o=ne(),n=t?o.filter(a=>{const r=(a.name||"").toLowerCase(),i=(a.id||"").toLowerCase();return r.includes(t)||i.includes(t)}):o;if(n.length===0){const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent="No matching labels",e.appendChild(a);return}n.forEach(a=>{const r=document.createElement("label");r.classList.add("label-checkbox");const i=document.createElement("input");i.type="checkbox",i.value=a.id,i.checked=$.includes(a.id),i.addEventListener("change",s=>{s.target.checked?$.includes(a.id)||$.push(a.id):$=$.filter(d=>d!==a.id),Qt()});const l=document.createElement("span");l.classList.add("task-label","label-color-swatch"),l.style.backgroundColor=a.color,l.textContent=a.name,r.appendChild(i),r.appendChild(l),e.appendChild(r)})}function ea(){document.addEventListener("kanban:boards-changed",()=>{Qo()}),document.getElementById("task-label-search")?.addEventListener("input",Oe),document.getElementById("labels-search")?.addEventListener("input",It),document.getElementById("task-add-label-btn")?.addEventListener("click",()=>{he=!1,Zt(null,{openedFromTaskEditor:!0})}),document.getElementById("task-fullpage-btn")?.addEventListener("click",()=>{const r=document.getElementById("task-modal");r&&Nt(!r.classList.contains("fullscreen"))}),document.getElementById("task-form").addEventListener("submit",async r=>{r.preventDefault();const i=document.getElementById("task-title").value,l=document.getElementById("task-description").value,s=document.getElementById("task-priority")?.value,d=document.getElementById("task-due-date")?.value,c=document.getElementById("task-column").value;Ke?ho(Ke,i,l,s,d,c,$):po(i,l,s,d,c,$),at();const{renderBoard:u}=await oe(async()=>{const{renderBoard:m}=await Promise.resolve().then(()=>re);return{renderBoard:m}},void 0,import.meta.url);u()}),document.getElementById("cancel-task-btn").addEventListener("click",at),document.querySelector("#task-modal .modal-backdrop").addEventListener("click",at),document.getElementById("column-form").addEventListener("submit",async r=>{r.preventDefault();const i=document.getElementById("column-name").value,l=document.getElementById("column-color")?.value;Je?Do(Je,i,l):Eo(i,l),rt();const{renderBoard:s}=await oe(async()=>{const{renderBoard:d}=await Promise.resolve().then(()=>re);return{renderBoard:d}},void 0,import.meta.url);s()}),document.getElementById("cancel-column-btn").addEventListener("click",rt),document.querySelector("#column-modal .modal-backdrop").addEventListener("click",rt),document.getElementById("manage-labels-btn").addEventListener("click",Vo),document.getElementById("labels-close-btn").addEventListener("click",it),document.getElementById("add-label-btn").addEventListener("click",()=>Zt());const a=document.getElementById("label-name");a?.addEventListener("beforeinput",r=>{if(!r||typeof r.data!="string"||r.data.length===0)return;const i=r.target;if(!i||typeof i.value!="string")return;const l=typeof i.selectionStart=="number"?i.selectionStart:i.value.length,s=typeof i.selectionEnd=="number"?i.selectionEnd:i.value.length;(i.value.slice(0,l)+r.data+i.value.slice(s)).trim().length<=ye||(r.preventDefault(),!Fe&&(Fe=!0,fe({title:"Label Name Too Long",message:`Label names are limited to ${ye} characters.`})))}),a?.addEventListener("input",r=>{const i=r.target;if(!i||typeof i.value!="string")return;const l=i.value.trim();l.length<=ye||(i.value=l.slice(0,ye),!Fe&&(Fe=!0,fe({title:"Label Name Too Long",message:`Label names are limited to ${ye} characters.`})))}),document.getElementById("label-form").addEventListener("submit",async r=>{r.preventDefault();const i=document.getElementById("label-name").value,l=document.getElementById("label-color").value,s=(i||"").trim();if(s.length>ye){await fe({title:"Label Name Too Long",message:`Label names are limited to ${ye} characters.`});return}const d=!Xe,c=Xe?Bo(Xe,s,l):ko(s,l);if(!c?.success){let m="Unable to Save Label",f="Could not save label.";c?.reason==="DUPLICATE_NAME"?(m="Label Already Exists",f=c?.message||"A label with that name already exists (case-insensitive)."):c?.reason==="EMPTY_NAME"&&(m="Label Name Required",f="Please enter a label name."),await fe({title:m,message:f}),document.getElementById("label-name")?.focus();return}d&&Ze&&c?.label?.id&&($.includes(c.label.id)||$.push(c.label.id),Oe(),document.getElementById("task-label-search")?.focus()),lt(),It();const{renderBoard:u}=await oe(async()=>{const{renderBoard:m}=await Promise.resolve().then(()=>re);return{renderBoard:m}},void 0,import.meta.url);u(),he&&d&&it()}),document.getElementById("cancel-label-btn").addEventListener("click",lt),document.querySelector("#labels-modal .modal-backdrop").addEventListener("click",it),document.querySelector("#label-modal .modal-backdrop").addEventListener("click",lt),document.getElementById("manage-boards-btn")?.addEventListener("click",Jo),document.getElementById("add-board-btn")?.addEventListener("click",async()=>{document.dispatchEvent(new CustomEvent("kanban:open-board-create"))}),document.getElementById("boards-import-btn")?.addEventListener("click",async()=>{await Ce({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file")?.click()}),document.getElementById("boards-close-btn")?.addEventListener("click",zt),document.querySelector("#boards-modal .modal-backdrop")?.addEventListener("click",zt),document.getElementById("board-rename-form")?.addEventListener("submit",r=>{if(r.preventDefault(),!Ct)return;const l=(document.getElementById("board-rename-name")?.value||"").trim();if(!l){alert("Board name cannot be empty.");return}if(!mo(Ct,l)){alert("Unable to rename board.");return}st(),en(),Qe(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),document.getElementById("cancel-board-rename-btn")?.addEventListener("click",st),document.querySelector("#board-rename-modal .modal-backdrop")?.addEventListener("click",st),document.getElementById("help-btn").addEventListener("click",Ko),document.getElementById("help-close-btn").addEventListener("click",$t),document.querySelector("#help-modal .modal-backdrop").addEventListener("click",$t),document.getElementById("add-column-btn").addEventListener("click",Wo),document.addEventListener("keydown",r=>{if(r.key==="Escape"){if(ve("label-modal")){lt();return}if(ve("labels-modal")){it();return}if(ve("board-rename-modal")){st();return}if(ve("boards-modal")){zt();return}if(ve("help-modal")){$t();return}if(ve("column-modal")){rt();return}ve("task-modal")&&at()}})}function vn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),o.push.apply(o,n)}return o}function ee(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?vn(Object(o),!0).forEach(function(n){ta(e,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):vn(Object(o)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))})}return e}function ht(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ht=function(t){return typeof t}:ht=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(e)}function ta(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ie(){return ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},ie.apply(this,arguments)}function na(e,t){if(e==null)return{};var o={},n=Object.keys(e),a,r;for(r=0;r<n.length;r++)a=n[r],!(t.indexOf(a)>=0)&&(o[a]=e[a]);return o}function oa(e,t){if(e==null)return{};var o=na(e,t),n,a;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var aa="1.15.6";function ae(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var le=ae(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),et=ae(/Edge/i),En=ae(/firefox/i),Ye=ae(/safari/i)&&!ae(/chrome/i)&&!ae(/android/i),mn=ae(/iP(ad|od|hone)/i),Un=ae(/chrome/i)&&ae(/android/i),jn={capture:!1,passive:!1};function D(e,t,o){e.addEventListener(t,o,!le&&jn)}function w(e,t,o){e.removeEventListener(t,o,!le&&jn)}function Lt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function qn(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function K(e,t,o,n){if(e){o=o||document;do{if(t!=null&&(t[0]===">"?e.parentNode===o&&Lt(e,t):Lt(e,t))||n&&e===o)return e;if(e===o)break}while(e=qn(e))}return null}var wn=/\s+/g;function Y(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(wn," ").replace(" "+t+" "," ");e.className=(n+(o?" "+t:"")).replace(wn," ")}}function y(e,t,o){var n=e&&e.style;if(n){if(o===void 0)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),t===void 0?o:o[t];!(t in n)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),n[t]=o+(typeof o=="string"?"":"px")}}function Ae(e,t){var o="";if(typeof e=="string")o=e;else do{var n=y(e,"transform");n&&n!=="none"&&(o=n+" "+o)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(o)}function Wn(e,t,o){if(e){var n=e.getElementsByTagName(t),a=0,r=n.length;if(o)for(;a<r;a++)o(n[a],a);return n}return[]}function Z(){var e=document.scrollingElement;return e||document.documentElement}function P(e,t,o,n,a){if(!(!e.getBoundingClientRect&&e!==window)){var r,i,l,s,d,c,u;if(e!==window&&e.parentNode&&e!==Z()?(r=e.getBoundingClientRect(),i=r.top,l=r.left,s=r.bottom,d=r.right,c=r.height,u=r.width):(i=0,l=0,s=window.innerHeight,d=window.innerWidth,c=window.innerHeight,u=window.innerWidth),(t||o)&&e!==window&&(a=a||e.parentNode,!le))do if(a&&a.getBoundingClientRect&&(y(a,"transform")!=="none"||o&&y(a,"position")!=="static")){var m=a.getBoundingClientRect();i-=m.top+parseInt(y(a,"border-top-width")),l-=m.left+parseInt(y(a,"border-left-width")),s=i+r.height,d=l+r.width;break}while(a=a.parentNode);if(n&&e!==window){var f=Ae(a||e),h=f&&f.a,g=f&&f.d;f&&(i/=g,l/=h,u/=h,c/=g,s=i+c,d=l+u)}return{top:i,left:l,bottom:s,right:d,width:u,height:c}}}function Dn(e,t,o){for(var n=pe(e,!0),a=P(e)[t];n;){var r=P(n)[o],i=void 0;if(i=a>=r,!i)return n;if(n===Z())break;n=pe(n,!1)}return!1}function Pe(e,t,o,n){for(var a=0,r=0,i=e.children;r<i.length;){if(i[r].style.display!=="none"&&i[r]!==b.ghost&&(n||i[r]!==b.dragged)&&K(i[r],o.draggable,e,!1)){if(a===t)return i[r];a++}r++}return null}function fn(e,t){for(var o=e.lastElementChild;o&&(o===b.ghost||y(o,"display")==="none"||t&&!Lt(o,t));)o=o.previousElementSibling;return o||null}function j(e,t){var o=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==b.clone&&(!t||Lt(e,t))&&o++;return o}function Cn(e){var t=0,o=0,n=Z();if(e)do{var a=Ae(e),r=a.a,i=a.d;t+=e.scrollLeft*r,o+=e.scrollTop*i}while(e!==n&&(e=e.parentNode));return[t,o]}function ra(e,t){for(var o in e)if(e.hasOwnProperty(o)){for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[o][n])return Number(o)}return-1}function pe(e,t){if(!e||!e.getBoundingClientRect)return Z();var o=e,n=!1;do if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var a=y(o);if(o.clientWidth<o.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||o.clientHeight<o.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!o.getBoundingClientRect||o===document.body)return Z();if(n||t)return o;n=!0}}while(o=o.parentNode);return Z()}function ia(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function Ht(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Ue;function Gn(e,t){return function(){if(!Ue){var o=arguments,n=this;o.length===1?e.call(n,o[0]):e.apply(n,o),Ue=setTimeout(function(){Ue=void 0},t)}}}function la(){clearTimeout(Ue),Ue=void 0}function Vn(e,t,o){e.scrollLeft+=t,e.scrollTop+=o}function Kn(e){var t=window.Polymer,o=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):o?o(e).clone(!0)[0]:e.cloneNode(!0)}function Jn(e,t,o){var n={};return Array.from(e.children).forEach(function(a){var r,i,l,s;if(!(!K(a,t.draggable,e,!1)||a.animated||a===o)){var d=P(a);n.left=Math.min((r=n.left)!==null&&r!==void 0?r:1/0,d.left),n.top=Math.min((i=n.top)!==null&&i!==void 0?i:1/0,d.top),n.right=Math.max((l=n.right)!==null&&l!==void 0?l:-1/0,d.right),n.bottom=Math.max((s=n.bottom)!==null&&s!==void 0?s:-1/0,d.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var H="Sortable"+new Date().getTime();function sa(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(a){if(!(y(a,"display")==="none"||a===b.ghost)){e.push({target:a,rect:P(a)});var r=ee({},e[e.length-1].rect);if(a.thisAnimationDuration){var i=Ae(a,!0);i&&(r.top-=i.f,r.left-=i.e)}a.fromRect=r}})}},addAnimationState:function(n){e.push(n)},removeAnimationState:function(n){e.splice(ra(e,{target:n}),1)},animateAll:function(n){var a=this;if(!this.options.animation){clearTimeout(t),typeof n=="function"&&n();return}var r=!1,i=0;e.forEach(function(l){var s=0,d=l.target,c=d.fromRect,u=P(d),m=d.prevFromRect,f=d.prevToRect,h=l.rect,g=Ae(d,!0);g&&(u.top-=g.f,u.left-=g.e),d.toRect=u,d.thisAnimationDuration&&Ht(m,u)&&!Ht(c,u)&&(h.top-u.top)/(h.left-u.left)===(c.top-u.top)/(c.left-u.left)&&(s=ca(h,m,f,a.options)),Ht(u,c)||(d.prevFromRect=c,d.prevToRect=u,s||(s=a.options.animation),a.animate(d,h,u,s)),s&&(r=!0,i=Math.max(i,s),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},s),d.thisAnimationDuration=s)}),clearTimeout(t),r?t=setTimeout(function(){typeof n=="function"&&n()},i):typeof n=="function"&&n(),e=[]},animate:function(n,a,r,i){if(i){y(n,"transition",""),y(n,"transform","");var l=Ae(this.el),s=l&&l.a,d=l&&l.d,c=(a.left-r.left)/(s||1),u=(a.top-r.top)/(d||1);n.animatingX=!!c,n.animatingY=!!u,y(n,"transform","translate3d("+c+"px,"+u+"px,0)"),this.forRepaintDummy=da(n),y(n,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),y(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){y(n,"transition",""),y(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},i)}}}}function da(e){return e.offsetWidth}function ca(e,t,o,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))*n.animation}var Se=[],Xt={initializeByDefault:!0},tt={mount:function(t){for(var o in Xt)Xt.hasOwnProperty(o)&&!(o in t)&&(t[o]=Xt[o]);Se.forEach(function(n){if(n.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Se.push(t)},pluginEvent:function(t,o,n){var a=this;this.eventCanceled=!1,n.cancel=function(){a.eventCanceled=!0};var r=t+"Global";Se.forEach(function(i){o[i.pluginName]&&(o[i.pluginName][r]&&o[i.pluginName][r](ee({sortable:o},n)),o.options[i.pluginName]&&o[i.pluginName][t]&&o[i.pluginName][t](ee({sortable:o},n)))})},initializePlugins:function(t,o,n,a){Se.forEach(function(l){var s=l.pluginName;if(!(!t.options[s]&&!l.initializeByDefault)){var d=new l(t,o,t.options);d.sortable=t,d.options=t.options,t[s]=d,ie(n,d.defaults)}});for(var r in t.options)if(t.options.hasOwnProperty(r)){var i=this.modifyOption(t,r,t.options[r]);typeof i<"u"&&(t.options[r]=i)}},getEventProperties:function(t,o){var n={};return Se.forEach(function(a){typeof a.eventProperties=="function"&&ie(n,a.eventProperties.call(o[a.pluginName],t))}),n},modifyOption:function(t,o,n){var a;return Se.forEach(function(r){t[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[o]=="function"&&(a=r.optionListeners[o].call(t[r.pluginName],n))}),a}};function ua(e){var t=e.sortable,o=e.rootEl,n=e.name,a=e.targetEl,r=e.cloneEl,i=e.toEl,l=e.fromEl,s=e.oldIndex,d=e.newIndex,c=e.oldDraggableIndex,u=e.newDraggableIndex,m=e.originalEvent,f=e.putSortable,h=e.extraEventProperties;if(t=t||o&&o[H],!!t){var g,I=t.options,B="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!le&&!et?g=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(g=document.createEvent("Event"),g.initEvent(n,!0,!0)),g.to=i||o,g.from=l||o,g.item=a||o,g.clone=r,g.oldIndex=s,g.newIndex=d,g.oldDraggableIndex=c,g.newDraggableIndex=u,g.originalEvent=m,g.pullMode=f?f.lastPutMode:void 0;var S=ee(ee({},h),tt.getEventProperties(n,t));for(var k in S)g[k]=S[k];o&&o.dispatchEvent(g),I[B]&&I[B].call(t,g)}}var ma=["evt"],z=function(t,o){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=n.evt,r=oa(n,ma);tt.pluginEvent.bind(b)(t,o,ee({dragEl:p,parentEl:A,ghostEl:v,rootEl:T,nextEl:De,lastDownEl:gt,cloneEl:_,cloneHidden:me,dragStarted:$e,putSortable:N,activeSortable:b.active,originalEvent:a,oldIndex:_e,oldDraggableIndex:je,newIndex:U,newDraggableIndex:ue,hideGhostForTarget:to,unhideGhostForTarget:no,cloneNowHidden:function(){me=!0},cloneNowShown:function(){me=!1},dispatchSortableEvent:function(l){F({sortable:o,name:l,originalEvent:a})}},r))};function F(e){ua(ee({putSortable:N,cloneEl:_,targetEl:p,rootEl:T,oldIndex:_e,oldDraggableIndex:je,newIndex:U,newDraggableIndex:ue},e))}var p,A,v,T,De,gt,_,me,_e,U,je,ue,dt,N,Te=!1,St=!1,kt=[],Ee,G,Yt,Ut,In,Ln,$e,ke,qe,We=!1,ct=!1,bt,R,jt=[],tn=!1,Bt=[],Mt=typeof document<"u",ut=mn,Sn=et||le?"cssFloat":"float",fa=Mt&&!Un&&!mn&&"draggable"in document.createElement("div"),Qn=(function(){if(Mt){if(le)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),Zn=function(t,o){var n=y(t),a=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),r=Pe(t,0,o),i=Pe(t,1,o),l=r&&y(r),s=i&&y(i),d=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+P(r).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+P(i).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&l.float&&l.float!=="none"){var u=l.float==="left"?"left":"right";return i&&(s.clear==="both"||s.clear===u)?"vertical":"horizontal"}return r&&(l.display==="block"||l.display==="flex"||l.display==="table"||l.display==="grid"||d>=a&&n[Sn]==="none"||i&&n[Sn]==="none"&&d+c>a)?"vertical":"horizontal"},pa=function(t,o,n){var a=n?t.left:t.top,r=n?t.right:t.bottom,i=n?t.width:t.height,l=n?o.left:o.top,s=n?o.right:o.bottom,d=n?o.width:o.height;return a===l||r===s||a+i/2===l+d/2},ha=function(t,o){var n;return kt.some(function(a){var r=a[H].options.emptyInsertThreshold;if(!(!r||fn(a))){var i=P(a),l=t>=i.left-r&&t<=i.right+r,s=o>=i.top-r&&o<=i.bottom+r;if(l&&s)return n=a}}),n},eo=function(t){function o(r,i){return function(l,s,d,c){var u=l.options.group.name&&s.options.group.name&&l.options.group.name===s.options.group.name;if(r==null&&(i||u))return!0;if(r==null||r===!1)return!1;if(i&&r==="clone")return r;if(typeof r=="function")return o(r(l,s,d,c),i)(l,s,d,c);var m=(i?l:s).options.group.name;return r===!0||typeof r=="string"&&r===m||r.join&&r.indexOf(m)>-1}}var n={},a=t.group;(!a||ht(a)!="object")&&(a={name:a}),n.name=a.name,n.checkPull=o(a.pull,!0),n.checkPut=o(a.put),n.revertClone=a.revertClone,t.group=n},to=function(){!Qn&&v&&y(v,"display","none")},no=function(){!Qn&&v&&y(v,"display","")};Mt&&!Un&&document.addEventListener("click",function(e){if(St)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),St=!1,!1},!0);var we=function(t){if(p){t=t.touches?t.touches[0]:t;var o=ha(t.clientX,t.clientY);if(o){var n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=t[a]);n.target=n.rootEl=o,n.preventDefault=void 0,n.stopPropagation=void 0,o[H]._onDragOver(n)}}},ga=function(t){p&&p.parentNode[H]._isOutsideThisEl(t.target)};function b(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=ie({},t),e[H]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Zn(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(i,l){i.setData("Text",l.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:b.supportPointer!==!1&&"PointerEvent"in window&&(!Ye||mn),emptyInsertThreshold:5};tt.initializePlugins(this,e,o);for(var n in o)!(n in t)&&(t[n]=o[n]);eo(t);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=t.forceFallback?!1:fa,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?D(e,"pointerdown",this._onTapStart):(D(e,"mousedown",this._onTapStart),D(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(D(e,"dragover",this),D(e,"dragenter",this)),kt.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),ie(this,sa())}b.prototype={constructor:b,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(ke=null)},_getDirection:function(t,o){return typeof this.options.direction=="function"?this.options.direction.call(this,t,o,p):this.options.direction},_onTapStart:function(t){if(t.cancelable){var o=this,n=this.el,a=this.options,r=a.preventOnFilter,i=t.type,l=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,s=(l||t).target,d=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,c=a.filter;if(Ia(n),!p&&!(/mousedown|pointerdown/.test(i)&&t.button!==0||a.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&Ye&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=K(s,a.draggable,n,!1),!(s&&s.animated)&&gt!==s)){if(_e=j(s),je=j(s,a.draggable),typeof c=="function"){if(c.call(this,t,s,this)){F({sortable:o,rootEl:d,name:"filter",targetEl:s,toEl:n,fromEl:n}),z("filter",o,{evt:t}),r&&t.preventDefault();return}}else if(c&&(c=c.split(",").some(function(u){if(u=K(d,u.trim(),n,!1),u)return F({sortable:o,rootEl:u,name:"filter",targetEl:s,fromEl:n,toEl:n}),z("filter",o,{evt:t}),!0}),c)){r&&t.preventDefault();return}a.handle&&!K(d,a.handle,n,!1)||this._prepareDragStart(t,l,s)}}},_prepareDragStart:function(t,o,n){var a=this,r=a.el,i=a.options,l=r.ownerDocument,s;if(n&&!p&&n.parentNode===r){var d=P(n);if(T=r,p=n,A=p.parentNode,De=p.nextSibling,gt=n,dt=i.group,b.dragged=p,Ee={target:p,clientX:(o||t).clientX,clientY:(o||t).clientY},In=Ee.clientX-d.left,Ln=Ee.clientY-d.top,this._lastX=(o||t).clientX,this._lastY=(o||t).clientY,p.style["will-change"]="all",s=function(){if(z("delayEnded",a,{evt:t}),b.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!En&&a.nativeDraggable&&(p.draggable=!0),a._triggerDragStart(t,o),F({sortable:a,name:"choose",originalEvent:t}),Y(p,i.chosenClass,!0)},i.ignore.split(",").forEach(function(c){Wn(p,c.trim(),qt)}),D(l,"dragover",we),D(l,"mousemove",we),D(l,"touchmove",we),i.supportPointer?(D(l,"pointerup",a._onDrop),!this.nativeDraggable&&D(l,"pointercancel",a._onDrop)):(D(l,"mouseup",a._onDrop),D(l,"touchend",a._onDrop),D(l,"touchcancel",a._onDrop)),En&&this.nativeDraggable&&(this.options.touchStartThreshold=4,p.draggable=!0),z("delayStart",this,{evt:t}),i.delay&&(!i.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(et||le))){if(b.eventCanceled){this._onDrop();return}i.supportPointer?(D(l,"pointerup",a._disableDelayedDrag),D(l,"pointercancel",a._disableDelayedDrag)):(D(l,"mouseup",a._disableDelayedDrag),D(l,"touchend",a._disableDelayedDrag),D(l,"touchcancel",a._disableDelayedDrag)),D(l,"mousemove",a._delayedDragTouchMoveHandler),D(l,"touchmove",a._delayedDragTouchMoveHandler),i.supportPointer&&D(l,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(s,i.delay)}else s()}},_delayedDragTouchMoveHandler:function(t){var o=t.touches?t.touches[0]:t;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){p&&qt(p),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;w(t,"mouseup",this._disableDelayedDrag),w(t,"touchend",this._disableDelayedDrag),w(t,"touchcancel",this._disableDelayedDrag),w(t,"pointerup",this._disableDelayedDrag),w(t,"pointercancel",this._disableDelayedDrag),w(t,"mousemove",this._delayedDragTouchMoveHandler),w(t,"touchmove",this._delayedDragTouchMoveHandler),w(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,o){o=o||t.pointerType=="touch"&&t,!this.nativeDraggable||o?this.options.supportPointer?D(document,"pointermove",this._onTouchMove):o?D(document,"touchmove",this._onTouchMove):D(document,"mousemove",this._onTouchMove):(D(p,"dragend",this),D(T,"dragstart",this._onDragStart));try{document.selection?yt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,o){if(Te=!1,T&&p){z("dragStarted",this,{evt:o}),this.nativeDraggable&&D(document,"dragover",ga);var n=this.options;!t&&Y(p,n.dragClass,!1),Y(p,n.ghostClass,!0),b.active=this,t&&this._appendGhost(),F({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(G){this._lastX=G.clientX,this._lastY=G.clientY,to();for(var t=document.elementFromPoint(G.clientX,G.clientY),o=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(G.clientX,G.clientY),t!==o);)o=t;if(p.parentNode[H]._isOutsideThisEl(t),o)do{if(o[H]){var n=void 0;if(n=o[H]._onDragOver({clientX:G.clientX,clientY:G.clientY,target:t,rootEl:o}),n&&!this.options.dragoverBubble)break}t=o}while(o=qn(o));no()}},_onTouchMove:function(t){if(Ee){var o=this.options,n=o.fallbackTolerance,a=o.fallbackOffset,r=t.touches?t.touches[0]:t,i=v&&Ae(v,!0),l=v&&i&&i.a,s=v&&i&&i.d,d=ut&&R&&Cn(R),c=(r.clientX-Ee.clientX+a.x)/(l||1)+(d?d[0]-jt[0]:0)/(l||1),u=(r.clientY-Ee.clientY+a.y)/(s||1)+(d?d[1]-jt[1]:0)/(s||1);if(!b.active&&!Te){if(n&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(v){i?(i.e+=c-(Yt||0),i.f+=u-(Ut||0)):i={a:1,b:0,c:0,d:1,e:c,f:u};var m="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");y(v,"webkitTransform",m),y(v,"mozTransform",m),y(v,"msTransform",m),y(v,"transform",m),Yt=c,Ut=u,G=r}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!v){var t=this.options.fallbackOnBody?document.body:T,o=P(p,!0,ut,!0,t),n=this.options;if(ut){for(R=t;y(R,"position")==="static"&&y(R,"transform")==="none"&&R!==document;)R=R.parentNode;R!==document.body&&R!==document.documentElement?(R===document&&(R=Z()),o.top+=R.scrollTop,o.left+=R.scrollLeft):R=Z(),jt=Cn(R)}v=p.cloneNode(!0),Y(v,n.ghostClass,!1),Y(v,n.fallbackClass,!0),Y(v,n.dragClass,!0),y(v,"transition",""),y(v,"transform",""),y(v,"box-sizing","border-box"),y(v,"margin",0),y(v,"top",o.top),y(v,"left",o.left),y(v,"width",o.width),y(v,"height",o.height),y(v,"opacity","0.8"),y(v,"position",ut?"absolute":"fixed"),y(v,"zIndex","100000"),y(v,"pointerEvents","none"),b.ghost=v,t.appendChild(v),y(v,"transform-origin",In/parseInt(v.style.width)*100+"% "+Ln/parseInt(v.style.height)*100+"%")}},_onDragStart:function(t,o){var n=this,a=t.dataTransfer,r=n.options;if(z("dragStart",this,{evt:t}),b.eventCanceled){this._onDrop();return}z("setupClone",this),b.eventCanceled||(_=Kn(p),_.removeAttribute("id"),_.draggable=!1,_.style["will-change"]="",this._hideClone(),Y(_,this.options.chosenClass,!1),b.clone=_),n.cloneId=yt(function(){z("clone",n),!b.eventCanceled&&(n.options.removeCloneOnHide||T.insertBefore(_,p),n._hideClone(),F({sortable:n,name:"clone"}))}),!o&&Y(p,r.dragClass,!0),o?(St=!0,n._loopId=setInterval(n._emulateDragOver,50)):(w(document,"mouseup",n._onDrop),w(document,"touchend",n._onDrop),w(document,"touchcancel",n._onDrop),a&&(a.effectAllowed="move",r.setData&&r.setData.call(n,a,p)),D(document,"drop",n),y(p,"transform","translateZ(0)")),Te=!0,n._dragStartId=yt(n._dragStarted.bind(n,o,t)),D(document,"selectstart",n),$e=!0,window.getSelection().removeAllRanges(),Ye&&y(document.body,"user-select","none")},_onDragOver:function(t){var o=this.el,n=t.target,a,r,i,l=this.options,s=l.group,d=b.active,c=dt===s,u=l.sort,m=N||d,f,h=this,g=!1;if(tn)return;function I(Re,so){z(Re,h,ee({evt:t,isOwner:c,axis:f?"vertical":"horizontal",revert:i,dragRect:a,targetRect:r,canSort:u,fromSortable:m,target:n,completed:S,onMove:function(gn,co){return mt(T,o,p,a,gn,P(gn),t,co)},changed:k},so))}function B(){I("dragOverAnimationCapture"),h.captureAnimationState(),h!==m&&m.captureAnimationState()}function S(Re){return I("dragOverCompleted",{insertion:Re}),Re&&(c?d._hideClone():d._showClone(h),h!==m&&(Y(p,N?N.options.ghostClass:d.options.ghostClass,!1),Y(p,l.ghostClass,!0)),N!==h&&h!==b.active?N=h:h===b.active&&N&&(N=null),m===h&&(h._ignoreWhileAnimating=n),h.animateAll(function(){I("dragOverAnimationComplete"),h._ignoreWhileAnimating=null}),h!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(n===p&&!p.animated||n===o&&!n.animated)&&(ke=null),!l.dragoverBubble&&!t.rootEl&&n!==document&&(p.parentNode[H]._isOutsideThisEl(t.target),!Re&&we(t)),!l.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),g=!0}function k(){U=j(p),ue=j(p,l.draggable),F({sortable:h,name:"change",toEl:o,newIndex:U,newDraggableIndex:ue,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),n=K(n,l.draggable,o,!0),I("dragOver"),b.eventCanceled)return g;if(p.contains(t.target)||n.animated&&n.animatingX&&n.animatingY||h._ignoreWhileAnimating===n)return S(!1);if(St=!1,d&&!l.disabled&&(c?u||(i=A!==T):N===this||(this.lastPutMode=dt.checkPull(this,d,p,t))&&s.checkPut(this,d,p,t))){if(f=this._getDirection(t,n)==="vertical",a=P(p),I("dragOverValid"),b.eventCanceled)return g;if(i)return A=T,B(),this._hideClone(),I("revert"),b.eventCanceled||(De?T.insertBefore(p,De):T.appendChild(p)),S(!0);var L=fn(o,l.draggable);if(!L||Ea(t,f,this)&&!L.animated){if(L===p)return S(!1);if(L&&o===t.target&&(n=L),n&&(r=P(n)),mt(T,o,p,a,n,r,t,!!n)!==!1)return B(),L&&L.nextSibling?o.insertBefore(p,L.nextSibling):o.appendChild(p),A=o,k(),S(!0)}else if(L&&va(t,f,this)){var E=Pe(o,0,l,!0);if(E===p)return S(!1);if(n=E,r=P(n),mt(T,o,p,a,n,r,t,!1)!==!1)return B(),o.insertBefore(p,E),A=o,k(),S(!0)}else if(n.parentNode===o){r=P(n);var C=0,x,X=p.parentNode!==o,M=!pa(p.animated&&p.toRect||a,n.animated&&n.toRect||r,f),Le=f?"top":"left",q=Dn(n,"top","top")||Dn(p,"top","top"),se=q?q.scrollTop:void 0;ke!==n&&(x=r[Le],We=!1,ct=!M&&l.invertSwap||X),C=wa(t,n,r,f,M?1:l.swapThreshold,l.invertedSwapThreshold==null?l.swapThreshold:l.invertedSwapThreshold,ct,ke===n);var W;if(C!==0){var de=j(p);do de-=C,W=A.children[de];while(W&&(y(W,"display")==="none"||W===v))}if(C===0||W===n)return S(!1);ke=n,qe=C;var be=n.nextElementSibling,ce=!1;ce=C===1;var nt=mt(T,o,p,a,n,r,t,ce);if(nt!==!1)return(nt===1||nt===-1)&&(ce=nt===1),tn=!0,setTimeout(ya,30),B(),ce&&!be?o.appendChild(p):n.parentNode.insertBefore(p,ce?be:n),q&&Vn(q,0,se-q.scrollTop),A=p.parentNode,x!==void 0&&!ct&&(bt=Math.abs(x-P(n)[Le])),k(),S(!0)}if(o.contains(p))return S(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){w(document,"mousemove",this._onTouchMove),w(document,"touchmove",this._onTouchMove),w(document,"pointermove",this._onTouchMove),w(document,"dragover",we),w(document,"mousemove",we),w(document,"touchmove",we)},_offUpEvents:function(){var t=this.el.ownerDocument;w(t,"mouseup",this._onDrop),w(t,"touchend",this._onDrop),w(t,"pointerup",this._onDrop),w(t,"pointercancel",this._onDrop),w(t,"touchcancel",this._onDrop),w(document,"selectstart",this)},_onDrop:function(t){var o=this.el,n=this.options;if(U=j(p),ue=j(p,n.draggable),z("drop",this,{evt:t}),A=p&&p.parentNode,U=j(p),ue=j(p,n.draggable),b.eventCanceled){this._nulling();return}Te=!1,ct=!1,We=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),nn(this.cloneId),nn(this._dragStartId),this.nativeDraggable&&(w(document,"drop",this),w(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ye&&y(document.body,"user-select",""),y(p,"transform",""),t&&($e&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),v&&v.parentNode&&v.parentNode.removeChild(v),(T===A||N&&N.lastPutMode!=="clone")&&_&&_.parentNode&&_.parentNode.removeChild(_),p&&(this.nativeDraggable&&w(p,"dragend",this),qt(p),p.style["will-change"]="",$e&&!Te&&Y(p,N?N.options.ghostClass:this.options.ghostClass,!1),Y(p,this.options.chosenClass,!1),F({sortable:this,name:"unchoose",toEl:A,newIndex:null,newDraggableIndex:null,originalEvent:t}),T!==A?(U>=0&&(F({rootEl:A,name:"add",toEl:A,fromEl:T,originalEvent:t}),F({sortable:this,name:"remove",toEl:A,originalEvent:t}),F({rootEl:A,name:"sort",toEl:A,fromEl:T,originalEvent:t}),F({sortable:this,name:"sort",toEl:A,originalEvent:t})),N&&N.save()):U!==_e&&U>=0&&(F({sortable:this,name:"update",toEl:A,originalEvent:t}),F({sortable:this,name:"sort",toEl:A,originalEvent:t})),b.active&&((U==null||U===-1)&&(U=_e,ue=je),F({sortable:this,name:"end",toEl:A,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){z("nulling",this),T=p=A=v=De=_=gt=me=Ee=G=$e=U=ue=_e=je=ke=qe=N=dt=b.dragged=b.ghost=b.clone=b.active=null,Bt.forEach(function(t){t.checked=!0}),Bt.length=Yt=Ut=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":p&&(this._onDragOver(t),ba(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],o,n=this.el.children,a=0,r=n.length,i=this.options;a<r;a++)o=n[a],K(o,i.draggable,this.el,!1)&&t.push(o.getAttribute(i.dataIdAttr)||Ca(o));return t},sort:function(t,o){var n={},a=this.el;this.toArray().forEach(function(r,i){var l=a.children[i];K(l,this.options.draggable,a,!1)&&(n[r]=l)},this),o&&this.captureAnimationState(),t.forEach(function(r){n[r]&&(a.removeChild(n[r]),a.appendChild(n[r]))}),o&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,o){return K(t,o||this.options.draggable,this.el,!1)},option:function(t,o){var n=this.options;if(o===void 0)return n[t];var a=tt.modifyOption(this,t,o);typeof a<"u"?n[t]=a:n[t]=o,t==="group"&&eo(n)},destroy:function(){z("destroy",this);var t=this.el;t[H]=null,w(t,"mousedown",this._onTapStart),w(t,"touchstart",this._onTapStart),w(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(w(t,"dragover",this),w(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),kt.splice(kt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!me){if(z("hideClone",this),b.eventCanceled)return;y(_,"display","none"),this.options.removeCloneOnHide&&_.parentNode&&_.parentNode.removeChild(_),me=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(me){if(z("showClone",this),b.eventCanceled)return;p.parentNode==T&&!this.options.group.revertClone?T.insertBefore(_,p):De?T.insertBefore(_,De):T.appendChild(_),this.options.group.revertClone&&this.animate(p,_),y(_,"display",""),me=!1}}};function ba(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function mt(e,t,o,n,a,r,i,l){var s,d=e[H],c=d.options.onMove,u;return window.CustomEvent&&!le&&!et?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=t,s.from=e,s.dragged=o,s.draggedRect=n,s.related=a||t,s.relatedRect=r||P(t),s.willInsertAfter=l,s.originalEvent=i,e.dispatchEvent(s),c&&(u=c.call(d,s,i)),u}function qt(e){e.draggable=!1}function ya(){tn=!1}function va(e,t,o){var n=P(Pe(o.el,0,o.options,!0)),a=Jn(o.el,o.options,v),r=10;return t?e.clientX<a.left-r||e.clientY<n.top&&e.clientX<n.right:e.clientY<a.top-r||e.clientY<n.bottom&&e.clientX<n.left}function Ea(e,t,o){var n=P(fn(o.el,o.options.draggable)),a=Jn(o.el,o.options,v),r=10;return t?e.clientX>a.right+r||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>a.bottom+r||e.clientX>n.right&&e.clientY>n.top}function wa(e,t,o,n,a,r,i,l){var s=n?e.clientY:e.clientX,d=n?o.height:o.width,c=n?o.top:o.left,u=n?o.bottom:o.right,m=!1;if(!i){if(l&&bt<d*a){if(!We&&(qe===1?s>c+d*r/2:s<u-d*r/2)&&(We=!0),We)m=!0;else if(qe===1?s<c+bt:s>u-bt)return-qe}else if(s>c+d*(1-a)/2&&s<u-d*(1-a)/2)return Da(t)}return m=m||i,m&&(s<c+d*r/2||s>u-d*r/2)?s>c+d/2?1:-1:0}function Da(e){return j(p)<j(e)?1:-1}function Ca(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,n=0;o--;)n+=t.charCodeAt(o);return n.toString(36)}function Ia(e){Bt.length=0;for(var t=e.getElementsByTagName("input"),o=t.length;o--;){var n=t[o];n.checked&&Bt.push(n)}}function yt(e){return setTimeout(e,0)}function nn(e){return clearTimeout(e)}Mt&&D(document,"touchmove",function(e){(b.active||Te)&&e.cancelable&&e.preventDefault()});b.utils={on:D,off:w,css:y,find:Wn,is:function(t,o){return!!K(t,o,t,!1)},extend:ia,throttle:Gn,closest:K,toggleClass:Y,clone:Kn,index:j,nextTick:yt,cancelNextTick:nn,detectDirection:Zn,getChild:Pe,expando:H};b.get=function(e){return e[H]};b.mount=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];t[0].constructor===Array&&(t=t[0]),t.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(b.utils=ee(ee({},b.utils),n.utils)),tt.mount(n)})};b.create=function(e,t){return new b(e,t)};b.version=aa;var O=[],ze,on,an=!1,Wt,Gt,Tt,He;function La(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(o){var n=o.originalEvent;this.sortable.nativeDraggable?D(document,"dragover",this._handleAutoScroll):this.options.supportPointer?D(document,"pointermove",this._handleFallbackAutoScroll):n.touches?D(document,"touchmove",this._handleFallbackAutoScroll):D(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var n=o.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?w(document,"dragover",this._handleAutoScroll):(w(document,"pointermove",this._handleFallbackAutoScroll),w(document,"touchmove",this._handleFallbackAutoScroll),w(document,"mousemove",this._handleFallbackAutoScroll)),kn(),vt(),la()},nulling:function(){Tt=on=ze=an=He=Wt=Gt=null,O.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,n){var a=this,r=(o.touches?o.touches[0]:o).clientX,i=(o.touches?o.touches[0]:o).clientY,l=document.elementFromPoint(r,i);if(Tt=o,n||this.options.forceAutoScrollFallback||et||le||Ye){Vt(o,this.options,l,n);var s=pe(l,!0);an&&(!He||r!==Wt||i!==Gt)&&(He&&kn(),He=setInterval(function(){var d=pe(document.elementFromPoint(r,i),!0);d!==s&&(s=d,vt()),Vt(o,a.options,d,n)},10),Wt=r,Gt=i)}else{if(!this.options.bubbleScroll||pe(l,!0)===Z()){vt();return}Vt(o,this.options,pe(l,!1),!1)}}},ie(e,{pluginName:"scroll",initializeByDefault:!0})}function vt(){O.forEach(function(e){clearInterval(e.pid)}),O=[]}function kn(){clearInterval(He)}var Vt=Gn(function(e,t,o,n){if(t.scroll){var a=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,i=t.scrollSensitivity,l=t.scrollSpeed,s=Z(),d=!1,c;on!==o&&(on=o,vt(),ze=t.scroll,c=t.scrollFn,ze===!0&&(ze=pe(o,!0)));var u=0,m=ze;do{var f=m,h=P(f),g=h.top,I=h.bottom,B=h.left,S=h.right,k=h.width,L=h.height,E=void 0,C=void 0,x=f.scrollWidth,X=f.scrollHeight,M=y(f),Le=f.scrollLeft,q=f.scrollTop;f===s?(E=k<x&&(M.overflowX==="auto"||M.overflowX==="scroll"||M.overflowX==="visible"),C=L<X&&(M.overflowY==="auto"||M.overflowY==="scroll"||M.overflowY==="visible")):(E=k<x&&(M.overflowX==="auto"||M.overflowX==="scroll"),C=L<X&&(M.overflowY==="auto"||M.overflowY==="scroll"));var se=E&&(Math.abs(S-a)<=i&&Le+k<x)-(Math.abs(B-a)<=i&&!!Le),W=C&&(Math.abs(I-r)<=i&&q+L<X)-(Math.abs(g-r)<=i&&!!q);if(!O[u])for(var de=0;de<=u;de++)O[de]||(O[de]={});(O[u].vx!=se||O[u].vy!=W||O[u].el!==f)&&(O[u].el=f,O[u].vx=se,O[u].vy=W,clearInterval(O[u].pid),(se!=0||W!=0)&&(d=!0,O[u].pid=setInterval((function(){n&&this.layer===0&&b.active._onTouchMove(Tt);var be=O[this.layer].vy?O[this.layer].vy*l:0,ce=O[this.layer].vx?O[this.layer].vx*l:0;typeof c=="function"&&c.call(b.dragged.parentNode[H],ce,be,e,Tt,O[this.layer].el)!=="continue"||Vn(O[this.layer].el,ce,be)}).bind({layer:u}),24))),u++}while(t.bubbleScroll&&m!==s&&(m=pe(m,!1)));an=d}},30),oo=function(t){var o=t.originalEvent,n=t.putSortable,a=t.dragEl,r=t.activeSortable,i=t.dispatchSortableEvent,l=t.hideGhostForTarget,s=t.unhideGhostForTarget;if(o){var d=n||r;l();var c=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,u=document.elementFromPoint(c.clientX,c.clientY);s(),d&&!d.el.contains(u)&&(i("spill"),this.onSpill({dragEl:a,putSortable:n}))}};function pn(){}pn.prototype={startIndex:null,dragStart:function(t){var o=t.oldDraggableIndex;this.startIndex=o},onSpill:function(t){var o=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var a=Pe(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(o,a):this.sortable.el.appendChild(o),this.sortable.animateAll(),n&&n.animateAll()},drop:oo};ie(pn,{pluginName:"revertOnSpill"});function hn(){}hn.prototype={onSpill:function(t){var o=t.dragEl,n=t.putSortable,a=n||this.sortable;a.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),a.animateAll()},drop:oo};ie(hn,{pluginName:"removeOnSpill"});b.mount(new La);b.mount(hn,pn);let rn=[],Et=null,Ge=null,xe=0;function Sa(){ka(),Ta(),_a()}function ka(){rn.forEach(e=>e.destroy()),rn=[],Et&&(Et.destroy(),Et=null),ao()}function Ba(){const e=document.getElementById("board-container");!e||Ge||(Ge=setInterval(()=>{if(!e)return;const t=e.getBoundingClientRect(),o=80,n=12;xe>0&&(xe<t.left+o&&e.scrollLeft>0?e.scrollLeft-=n:xe>t.right-o&&e.scrollLeft<e.scrollWidth-e.clientWidth&&(e.scrollLeft+=n))},16))}function ao(){Ge&&(clearInterval(Ge),Ge=null),xe=0}function ft(e){e.touches&&e.touches[0]?xe=e.touches[0].clientX:e.clientX&&(xe=e.clientX)}function Ta(){document.querySelectorAll(".tasks:not(.hidden)").forEach(t=>{const o=new b(t,{group:{name:"tasks",pull:!0,put:!0},animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"task-ghost",chosenClass:"task-chosen",dragClass:"task-drag",draggable:".task",forceFallback:!0,fallbackClass:"task-fallback",fallbackOnBody:!0,fallbackTolerance:0,swapThreshold:.65,emptyInsertThreshold:20,direction:"vertical",onStart:function(n){document.body.classList.add("dragging"),Ba(),document.addEventListener("touchmove",ft,{passive:!0}),document.addEventListener("mousemove",ft,{passive:!0})},onEnd:async function(n){document.body.classList.remove("dragging"),ao(),document.removeEventListener("touchmove",ft),document.removeEventListener("mousemove",ft),yo();const{renderBoard:a}=await oe(async()=>{const{renderBoard:r}=await Promise.resolve().then(()=>re);return{renderBoard:r}},void 0,import.meta.url);a()}});rn.push(o)})}function _a(){const e=document.getElementById("board-container");e&&(Et=new b(e,{animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"column-ghost",chosenClass:"column-chosen",dragClass:"column-drag",handle:".column-header",filter:"button:not(.column-drag-handle), a, input, select, textarea, [contenteditable]",preventOnFilter:!0,draggable:".task-column",scrollSensitivity:80,scrollSpeed:15,forceFallback:!1,fallbackOnBody:!0,onStart:function(t){document.body.classList.add("dragging-column")},onEnd:function(t){document.body.classList.remove("dragging-column"),Io()}}))}let Bn=!1,ro="";function io(e){ro=(e||"").toString()}function Aa(e,t,o){if(!t)return!0;const n=typeof e?.text=="string"?e.text:"",a=typeof e?.title=="string"&&e.title.trim()!==""?e.title:n,r=typeof e?.description=="string"?e.description:"",i=typeof e?.priority=="string"?e.priority:"";if(a.toLowerCase().includes(t)||r.toLowerCase().includes(t)||i.toLowerCase().includes(t))return!0;const l=Array.isArray(e?.labels)?e.labels:[];for(const s of l){const d=o.get(s);if(d&&d.includes(t))return!0}return!1}function Ve(e=null){document.querySelectorAll(".column-menu").forEach(t=>{e&&t===e||t.classList.add("hidden")})}function xa(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=o.includes("T")?o:`${o}T00:00:00`,a=new Date(n);return Number.isNaN(a.getTime())?o:a.toLocaleDateString(t||void 0)}function Oa(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=new Date(o);return Number.isNaN(n.getTime())?o:n.toLocaleString(t||void 0)}function Pa(e){const t=(e?.creationDate||"").toString().trim();if(!t)return"";const o=new Date(t);if(Number.isNaN(o.getTime()))return"";const n=Date.now()-o.getTime(),a=Math.max(0,Math.floor(n/(1440*60*1e3)));return a>=30?`${Math.max(1,Math.floor(a/30))}M`:`${a}d`}function Na(e,t){const o=document.createElement("li");o.classList.add("task"),o.draggable=!0,o.dataset.taskId=e.id,o.setAttribute("role","listitem"),o.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const n=document.createElement("div");n.classList.add("task-labels"),n.setAttribute("role","list"),n.setAttribute("aria-label","Task labels");const a=ne();e.labels&&e.labels.length>0&&e.labels.forEach(E=>{const C=a.find(x=>x.id===E);if(C){const x=document.createElement("span");x.classList.add("task-label"),x.setAttribute("role","listitem"),x.style.backgroundColor=C.color,x.textContent=C.name,n.appendChild(x)}});const r=document.createElement("div");r.classList.add("task-header");const i=document.createElement("div");i.classList.add("task-title"),i.setAttribute("role","button"),i.setAttribute("tabindex","0");const l=typeof e.text=="string"?e.text:"";i.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:l,i.addEventListener("click",()=>Ft(e.id)),i.addEventListener("keydown",E=>{(E.key==="Enter"||E.key===" ")&&(E.preventDefault(),Ft(e.id))});const s=document.createElement("div");s.classList.add("task-actions");const d=document.createElement("button");d.classList.add("delete-task-btn"),d.setAttribute("aria-label","Delete task"),d.type="button";const c=document.createElement("span");c.dataset.lucide="trash-2",c.setAttribute("aria-hidden","true"),d.appendChild(c),d.addEventListener("click",async E=>{E.stopPropagation(),await Ce({title:"Delete Task",message:"Are you sure you want to delete this task?",confirmText:"Delete"})&&go(e.id)&&ge()}),s.appendChild(d),r.appendChild(i),r.appendChild(s);const u=typeof e.description=="string"?e.description.trim():"",m=document.createElement("div");m.classList.add("task-description"),m.textContent=u,m.style.display=u?"block":"none",m.addEventListener("click",()=>Ft(e.id));const f=document.createElement("div");f.classList.add("task-meta");const h=t?.showPriority!==!1,g=t?.showDueDate!==!1;if(h){const E=typeof e.priority=="string"?e.priority:"medium",C=document.createElement("span");C.classList.add("task-priority",`priority-${E}`),C.textContent=E,C.setAttribute("aria-label",`Priority: ${E}`),f.appendChild(C)}if(g){const E=typeof e.dueDate=="string"?e.dueDate.trim():"",C=document.createElement("span");C.classList.add("task-date"),E?C.textContent="Due "+xa(E,t?.locale):C.textContent="No due date",f.appendChild(C)}o.appendChild(r),o.appendChild(m),o.appendChild(n),f.childNodes.length>0&&o.appendChild(f);const I=t?.showChangeDate!==!1,B=t?.showAge!==!1,S=t?.locale,k=document.createElement("div");if(k.classList.add("task-footer"),I){const E=document.createElement("span");E.classList.add("task-change-date");const C=Oa(e?.changeDate,S);E.textContent=C?`Updated ${C}`:"",k.appendChild(E)}if(B){const E=document.createElement("span");E.classList.add("task-age");const C=Pa(e);E.textContent=C?`Age ${C}`:"",k.appendChild(E)}return Array.from(k.childNodes).some(E=>(E.textContent||"").trim()!=="")&&o.appendChild(k),o}function Ma(e){const t=document.createElement("article");t.classList.add("task-column"),t.dataset.column=e.id,t.draggable=!1,t.setAttribute("aria-labelledby",`column-title-${e.id}`);const o=e?.collapsed===!0;o&&t.classList.add("is-collapsed"),e?.color&&t.style.setProperty("--column-accent",e.color);const n=document.createElement("button");n.classList.add("column-collapse-btn"),n.type="button",n.setAttribute("aria-label",o?`Expand ${e.name} column`:`Collapse ${e.name} column`),n.title=o?"Expand column":"Collapse column";const a=document.createElement("span");a.dataset.lucide=o?"chevron-right":"chevrons-right-left",a.setAttribute("aria-hidden","true"),n.appendChild(a),n.addEventListener("click",X=>{X.stopPropagation(),wo(e.id)&&ge()});const r=document.createElement("button");r.classList.add("column-drag-handle"),r.type="button",r.setAttribute("aria-label","Drag to reorder column");const i=document.createElement("span");i.dataset.lucide="grip-vertical",i.setAttribute("aria-hidden","true"),r.appendChild(i),r.title="Drag to reorder";const l=document.createElement("header");l.classList.add("column-header");const s=document.createElement("h2");s.id=`column-title-${e.id}`,s.textContent=e.name;const d=document.createElement("span");d.classList.add("task-counter"),d.dataset.columnId=e.id,d.textContent="0",d.setAttribute("aria-label","Task count");const c=document.createElement("div");c.classList.add("column-actions");const u=document.createElement("button");u.classList.add("add-task-btn-icon"),u.type="button",u.setAttribute("aria-label",`Add task to ${e.name}`);const m=document.createElement("span");m.dataset.lucide="plus",m.setAttribute("aria-hidden","true"),u.appendChild(m),u.title="Add task",u.addEventListener("click",()=>qo(e.id));const f=document.createElement("div");f.classList.add("column-menu-wrapper");const h=document.createElement("button");h.classList.add("column-menu-btn"),h.type="button",h.setAttribute("aria-haspopup","menu"),h.setAttribute("aria-expanded","false"),h.setAttribute("aria-label",`${e.name} column menu`);const g=document.createElement("span");g.dataset.lucide="ellipsis-vertical",g.setAttribute("aria-hidden","true"),h.appendChild(g),h.title="Column menu";const I=document.createElement("div");I.classList.add("column-menu","hidden"),I.setAttribute("role","menu");const B=document.createElement("button");B.classList.add("column-menu-item"),B.type="button",B.setAttribute("role","menuitem");const S=document.createElement("span");S.dataset.lucide="pencil",S.setAttribute("aria-hidden","true"),B.appendChild(S);const k=document.createTextNode(" Edit");B.appendChild(k),B.title="Edit column",B.addEventListener("click",X=>{X.stopPropagation(),Ve(),Go(e.id)});const L=document.createElement("button");L.classList.add("column-menu-item","danger"),L.type="button",L.setAttribute("role","menuitem");const E=document.createElement("span");E.dataset.lucide="trash-2",E.setAttribute("aria-hidden","true"),L.appendChild(E);const C=document.createTextNode(" Delete");L.appendChild(C),L.title="Delete column",L.addEventListener("click",X=>{X.stopPropagation(),Ve(),(async()=>{if(e.id==="done"){await fe({title:"Cannot Delete Column",message:"The Done column is permanent and cannot be deleted."});return}if(Q().length<=1){await fe({title:"Cannot Delete Column",message:"Cannot delete the last column."});return}const q=te().filter(be=>be.column===e.id),se=e?.name?`"${e.name}"`:"this column",W=q.length>0?`Delete ${se}? This will also delete ${q.length} task(s).`:`Delete ${se}?`;await Ce({title:"Delete Column",message:W,confirmText:"Delete"})&&Co(e.id)&&ge()})()}),I.appendChild(B),I.appendChild(L),h.addEventListener("click",X=>{X.stopPropagation();const M=!I.classList.contains("hidden");Ve(),M?h.setAttribute("aria-expanded","false"):(I.classList.remove("hidden"),h.setAttribute("aria-expanded","true"))}),f.appendChild(h),f.appendChild(I),c.appendChild(u),c.appendChild(f),l.appendChild(n),l.appendChild(r),l.appendChild(s),l.appendChild(d),l.appendChild(c);const x=document.createElement("ul");return x.classList.add("tasks"),x.setAttribute("role","list"),x.setAttribute("aria-label",`Tasks in ${e.name}`),o&&(x.classList.add("hidden"),c.classList.add("hidden"),d.classList.add("hidden")),t.appendChild(l),t.appendChild(x),t}function Ra(){const e=Q(),t=document.getElementById("task-column");t.innerHTML="",e.forEach(o=>{const n=document.createElement("option");n.value=o.id,n.textContent=o.name,t.appendChild(n)})}function ge(){const e=Q(),t=te(),o=ne(),n=V(),a=new Map(o.map(d=>[d.id,(d.name||"").toString().trim().toLowerCase()])),r=(ro||"").toString().trim().toLowerCase(),i=r?t.filter(d=>Aa(d,r,a)):t,l=document.getElementById("board-container");l.innerHTML="",[...e].sort((d,c)=>(d.order??0)-(c.order??0)).forEach(d=>{const c=Ma(d);l.appendChild(c);const u=c.querySelector(".tasks"),m=c.querySelector(".task-counter"),f=i.filter(h=>h.column===d.id).sort((h,g)=>(h.order??0)-(g.order??0));f.forEach(h=>{u.appendChild(Na(h,n))}),m.textContent=f.length}),Sa(),Ra(),xt(),Bn||(Bn=!0,document.addEventListener("click",()=>Ve()),document.addEventListener("keydown",d=>{d.key==="Escape"&&Ve()}))}const re=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:ge,setBoardFilterQuery:io},Symbol.toStringTag,{value:"Module"})),lo="kanban-theme";function Fa(){const e=localStorage.getItem(lo);return e==="light"||e==="dark"?e:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Tn(e){document.documentElement.dataset.theme=e}function _n(e){const t=document.getElementById("theme-toggle-btn");if(!t)return;const o=e==="dark"?"light":"dark",n=o==="dark"?"Dark":"Light",a=o==="dark"?"moon":"sun";t.setAttribute("aria-pressed",String(e==="dark"));const r=t.querySelector("span[data-lucide]");r&&r.setAttribute("data-lucide",a);const i=Array.from(t.childNodes).filter(l=>l.nodeType===Node.TEXT_NODE);for(const l of i)l.remove();t.appendChild(document.createTextNode(` ${n}`)),xt()}function $a(){const e=Fa();Tn(e),_n(e);const t=document.getElementById("theme-toggle-btn");t&&t.addEventListener("click",()=>{const n=(document.documentElement.dataset.theme==="dark"?"dark":"light")==="dark"?"light":"dark";Tn(n),localStorage.setItem(lo,n),_n(n)})}function za(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function An(e){const t=Me(),o=dn();e.innerHTML="",t.forEach(n=>{const a=document.createElement("option");a.value=n.id,a.textContent=za(n),e.appendChild(a)}),o&&(e.value=o)}function Kt(){const e=document.getElementById("brand-text")||document.querySelector(".brand-text");e&&(e.textContent=At())}function Ha(){const e=document.getElementById("board-create-modal"),t=document.getElementById("board-create-name");!e||!t||(t.value="",e.classList.remove("hidden"),t.focus())}function pt(){const e=document.getElementById("board-create-modal");e&&e.classList.add("hidden")}function Xa(){sn();const e=document.getElementById("board-select");if(!e)return;An(e),Kt(),document.addEventListener("kanban:open-board-create",()=>{Ha()}),e.addEventListener("change",()=>{const a=e.value;if(!a)return;wt(a),Kt(),ge();const r=document.getElementById("board-controls-menu"),i=document.getElementById("desktop-menu-btn");r?.classList.remove("show"),i?.setAttribute("aria-expanded","false")});const t=document.getElementById("board-create-modal"),o=document.getElementById("board-create-form"),n=document.getElementById("cancel-board-create-btn");t&&(t.querySelector(".modal-backdrop")?.addEventListener("click",pt),t.addEventListener("keydown",r=>{r.key==="Escape"&&pt()})),n&&n.addEventListener("click",pt),o&&o.addEventListener("submit",async a=>{a.preventDefault();const r=document.getElementById("board-create-name"),i=(r?.value||"").trim();if(!i){await fe({title:"Error",message:"Board name cannot be empty."}),r?.focus();return}const l=xn(i);wt(l.id),An(e),Kt(),ge(),pt(),document.dispatchEvent(new CustomEvent("kanban:boards-changed"))})}function Ya(e){const t=[];for(const o of e){if(typeof o!="string")continue;const n=o.trim();n&&(t.includes(n)||t.push(n))}return t}function Ua(e){const t=typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US";return Ya([e,t,"en-US","en-GB","de-DE","fr-FR","es-ES","it-IT","pt-BR","ja-JP","zh-CN"])}function ja(){document.getElementById("settings-modal")?.classList.remove("hidden")}function Jt(){document.getElementById("settings-modal")?.classList.add("hidden")}async function Be(e){On(e);const{renderBoard:t}=await oe(async()=>{const{renderBoard:o}=await Promise.resolve().then(()=>re);return{renderBoard:o}},void 0,import.meta.url);t()}function qa(){const e=document.getElementById("settings-btn"),t=document.getElementById("settings-close-btn"),o=document.querySelector("#settings-modal .modal-backdrop"),n=document.getElementById("settings-show-priority"),a=document.getElementById("settings-show-due-date"),r=document.getElementById("settings-show-age"),i=document.getElementById("settings-show-change-date"),l=document.getElementById("settings-locale"),s=document.getElementById("settings-default-priority");if(!e||!t||!n||!a||!r||!i||!l||!s)return;function d(){const c=V();n.checked=c.showPriority!==!1,a.checked=c.showDueDate!==!1,r.checked=c.showAge!==!1,i.checked=c.showChangeDate!==!1;const u=Ua(c.locale);l.innerHTML="",u.forEach(m=>{const f=document.createElement("option");f.value=m,f.textContent=m,l.appendChild(f)}),l.value=c.locale,s.value=c.defaultPriority||"low"}e.addEventListener("click",()=>{d(),ja()}),t.addEventListener("click",Jt),o?.addEventListener("click",Jt),document.addEventListener("keydown",c=>{const u=document.getElementById("settings-modal");!u||u.classList.contains("hidden")||c.key==="Escape"&&Jt()}),r.addEventListener("change",async()=>{const c=V();await Be({...c,showAge:!!r.checked})}),i.addEventListener("change",async()=>{const c=V();await Be({...c,showChangeDate:!!i.checked})}),n.addEventListener("change",async()=>{const c=V();await Be({...c,showPriority:!!n.checked})}),a.addEventListener("change",async()=>{const c=V();await Be({...c,showDueDate:!!a.checked})}),l.addEventListener("change",async()=>{const c=V();await Be({...c,locale:l.value})}),s.addEventListener("change",async()=>{const c=V();await Be({...c,defaultPriority:s.value})})}document.addEventListener("DOMContentLoaded",()=>{$a(),qa();const e=document.getElementById("board-search-input");e&&e.addEventListener("input",()=>{io(e.value),ge()}),Xa(),ea(),document.getElementById("export-btn").addEventListener("click",async()=>{await Ce({title:"Export Board (Active Only)",message:`Export ONLY saves the current active board. It does NOT back up all boards.

To back up everything, export each board individually.

Continue with export?`,confirmText:"Export"})&&zo()}),document.getElementById("import-btn").addEventListener("click",async()=>{await Ce({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",n=>{const a=n.target.files[0];a&&Xo(a),n.target.value=""});const t=document.getElementById("desktop-menu-btn"),o=document.getElementById("board-controls-menu");t&&o&&(t.addEventListener("click",n=>{n.stopPropagation();const a=t.getAttribute("aria-expanded")==="true";o.classList.toggle("show"),t.setAttribute("aria-expanded",String(!a)),document.querySelectorAll(".column-menu").forEach(r=>r.classList.add("hidden"))}),o.addEventListener("click",n=>{n.target.closest("select, option, input, textarea, label")||!n.target.closest('button, a, [role="menuitem"]')||(o.classList.remove("show"),t.setAttribute("aria-expanded","false"))}),document.addEventListener("click",n=>{!o.contains(n.target)&&!t.contains(n.target)&&(o.classList.remove("show"),t.setAttribute("aria-expanded","false"))})),ge()});
