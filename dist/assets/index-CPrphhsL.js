(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function o(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(a){if(a.ep)return;a.ep=!0;const r=o(a);fetch(a.href,r)}})();function L(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const n=Math.random()*16|0;return(e==="x"?n:n&3|8).toString(16)})}function ie(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function ce(e){return e==="todo"?"#3b82f6":e==="inprogress"?"#f59e0b":e==="done"?"#16a34a":"#3b82f6"}function ue(e){const n=ie(e?.color)?e.color.trim():ce(e?.id);return{...e,color:n}}function k(){const e=localStorage.getItem("kanbanColumns");if(e)try{const n=JSON.parse(e);if(Array.isArray(n))return n.map(ue)}catch{}return[{id:"todo",name:"To Do",color:"#3b82f6"},{id:"inprogress",name:"In Progress",color:"#f59e0b"},{id:"done",name:"Done",color:"#16a34a"}]}function P(e){localStorage.setItem("kanbanColumns",JSON.stringify(e))}function v(){const e=localStorage.getItem("kanbanTasks");if(e)try{const n=JSON.parse(e);if(Array.isArray(n))return n}catch{}return[{id:L(),title:"Find out where the Soul Stone is",description:"Identify current location and access requirements.",priority:"high",dueDate:"",column:"todo",labels:["urgent"],creationDate:new Date().toISOString()},{id:L(),title:"Collect the Time Stone",description:"Coordinate with Dr. Strange and plan retrieval.",priority:"medium",dueDate:"",column:"inprogress",labels:["feature"],creationDate:new Date().toISOString()},{id:L(),title:"Collect the Mind Stone",description:"Determine safe extraction approach.",priority:"medium",dueDate:"",column:"inprogress",labels:[],creationDate:new Date().toISOString()},{id:L(),title:"Collect the Reality Stone",description:"Negotiate with the Collector, avoid escalation.",priority:"low",dueDate:"",column:"inprogress",labels:["task"],creationDate:new Date().toISOString()},{id:L(),title:"Collect the Power Stone",description:"Verify secure containment after retrieval.",priority:"high",dueDate:"",column:"done",labels:["urgent","feature"],creationDate:new Date().toISOString()},{id:L(),title:"Collect the Space Stone",description:"",priority:"low",dueDate:"",column:"done",labels:[],creationDate:new Date().toISOString()}]}function I(e){localStorage.setItem("kanbanTasks",JSON.stringify(e))}function b(){const e=localStorage.getItem("kanbanLabels");if(e)try{const n=JSON.parse(e);if(Array.isArray(n))return n}catch{}return[{id:"urgent",name:"Urgent",color:"#ef4444"},{id:"feature",name:"Feature",color:"#3b82f6"},{id:"task",name:"Task",color:"#f59e0b"}]}function M(e){localStorage.setItem("kanbanLabels",JSON.stringify(e))}const me=new Set(["low","medium","high"]);function ee(e){const n=(e||"").toString().trim().toLowerCase();return me.has(n)?n:"medium"}function te(e){return(e||"").toString().trim()}function pe(e,n,o,t,a,r=[]){if(!e||e.trim()==="")return;const l=v(),d=l.filter(c=>c.column===a).reduce((c,u)=>Math.max(c,u.order??0),0),i={id:L(),title:e.trim(),description:(n||"").toString().trim(),priority:ee(o),dueDate:te(t),column:a,order:d+1,labels:[...r],creationDate:new Date().toISOString()};l.push(i),I(l)}function fe(e,n,o,t,a,r,l=[]){if(!n||n.trim()==="")return;const s=v(),d=s.findIndex(i=>i.id===e);d!==-1&&(s[d].title=n.trim(),s[d].description=(o||"").toString().trim(),s[d].priority=ee(t),s[d].dueDate=te(a),s[d].column=r,s[d].labels=[...l],I(s))}function ge(e){if(!confirm("Are you sure you want to delete this task?"))return!1;const o=v().filter(t=>t.id!==e);return I(o),!0}function ye(){const e=[];return document.querySelectorAll(".task-column").forEach(n=>{const o=n.dataset.column;n.querySelectorAll(".task").forEach(t=>{e.push({id:t.dataset.taskId,column:o})})}),e}function he(){const e=ye(),o=v().map(t=>{const a=e.findIndex(r=>r.id===t.id);if(a!==-1){const r=e[a],l=e.filter((s,d)=>s.column===r.column&&d<=a);return{...t,column:r.column,order:l.length}}return t});I(o)}function be(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function ne(e){return be(e)?e.trim():"#3b82f6"}function Ee(e,n){if(!e||e.trim()==="")return;const o=k(),t=o.reduce((l,s)=>Math.max(l,s.order??0),0),r={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+L().substring(0,8),name:e.trim(),color:ne(n),order:t+1};o.push(r),P(o)}function ke(e,n,o){if(!n||n.trim()==="")return;const t=k(),a=t.findIndex(r=>r.id===e);a!==-1&&(t[a].name=n.trim(),t[a].color=ne(o),P(t))}function Le(e){const n=k();if(n.length<=1)return alert("Cannot delete the last column!"),!1;const o=n.find(d=>d.id===e),t=o?.name?`"${o.name}"`:"this column",a=v(),r=a.filter(d=>d.column===e),l=r.length>0?`Delete ${t}? This will also delete ${r.length} task(s).`:`Delete ${t}?`;if(!confirm(l))return!1;if(r.length>0){const d=a.filter(i=>i.column!==e);I(d)}const s=n.filter(d=>d.id!==e);return P(s),!0}function ve(){const n=document.getElementById("board-container").querySelectorAll(".task-column"),o=k();n.forEach((t,a)=>{const r=t.dataset.column,l=o.find(s=>s.id===r);l&&(l.order=a+1)}),P(o)}const Ce="modulepreload",Ie=function(e){return"/"+e},W={},S=function(n,o,t){let a=Promise.resolve();if(o&&o.length>0){let i=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};var l=i;document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),d=s?.nonce||s?.getAttribute("nonce");a=i(o.map(c=>{if(c=Ie(c),c in W)return;W[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":Ce,u||(m.as="script"),m.crossOrigin="",m.href=c,d&&m.setAttribute("nonce",d),document.head.appendChild(m),u)return new Promise((p,y)=>{m.addEventListener("load",p),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(s){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=s,window.dispatchEvent(d),!d.defaultPrevented)throw s}return a.then(s=>{for(const d of s||[])d.status==="rejected"&&r(d.reason);return n().catch(r)})};function xe(e,n){if(!e||e.trim()==="")return;const o=b(),a={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+L().substring(0,8),name:e.trim(),color:n};return o.push(a),M(o),a}function Se(e,n,o){if(!n||n.trim()==="")return;const t=b(),a=t.findIndex(r=>r.id===e);a!==-1&&(t[a].name=n.trim(),t[a].color=o,M(t))}function Be(e){const n=b(),o=v();o.forEach(a=>{a.labels&&(a.labels=a.labels.filter(r=>r!==e))}),I(o);const t=n.filter(a=>a.id!==e);M(t)}let Y="todo",D=null,A=null,$=null,h=[];function Te(){return(document.getElementById("task-label-search")?.value||"").trim().toLowerCase()}function J(){const e=document.getElementById("task-active-labels");if(!e)return;const n=b(),o=[];for(const a of h)o.includes(a)||o.push(a);h=o;const t=o.map(a=>n.find(r=>r.id===a)).filter(Boolean);e.innerHTML="",e.style.display=t.length>0?"flex":"none",t.forEach(a=>{const r=document.createElement("span");r.classList.add("task-label"),r.style.backgroundColor=a.color,r.textContent=a.name;const l=document.createElement("button");l.type="button",l.classList.add("active-label-remove"),l.setAttribute("aria-label",`Remove label ${a.name}`),l.title="Remove label",l.textContent="Ã—",l.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),h=h.filter(d=>d!==a.id),J(),R()}),r.appendChild(l),e.appendChild(r)})}function we(e){Y=e||k()[0]?.id||"todo",D=null,h=[];const n=document.getElementById("task-modal"),o=document.getElementById("task-column"),t=document.getElementById("task-title"),a=document.getElementById("task-description"),r=document.getElementById("task-priority"),l=document.getElementById("task-due-date"),s=document.getElementById("task-modal-title"),d=document.getElementById("task-submit-btn");s.textContent="Add New Task",d.textContent="Add Task",o.value=Y,t.value="",a.value="",r&&(r.value="medium"),l&&(l.value="");const i=document.getElementById("task-label-search");i&&(i.value=""),R(),n.classList.remove("hidden"),t.focus()}function H(e){const o=v().find(y=>y.id===e);if(!o)return;D=e,h=o.labels||[];const t=document.getElementById("task-modal"),a=document.getElementById("task-column"),r=document.getElementById("task-title"),l=document.getElementById("task-description"),s=document.getElementById("task-priority"),d=document.getElementById("task-due-date"),i=document.getElementById("task-modal-title"),c=document.getElementById("task-submit-btn");i.textContent="Edit Task",c.textContent="Save Changes",a.value=o.column;const u=typeof o.text=="string"?o.text:"";r.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:u,l.value=typeof o.description=="string"?o.description:"",s&&(s.value=typeof o.priority=="string"?o.priority:"medium");const f=typeof o.dueDate=="string"?o.dueDate:"",m=f.includes("T")?f.slice(0,10):f;d&&(d.value=m);const p=document.getElementById("task-label-search");p&&(p.value=""),R(),t.classList.remove("hidden"),r.focus()}function _(){document.getElementById("task-modal").classList.add("hidden"),D=null}function De(){A=null;const e=document.getElementById("column-modal"),n=document.getElementById("column-name"),o=document.getElementById("column-color"),t=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");t.textContent="Add New Column",a.textContent="Add Column",n.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),n.focus()}function Ae(e){const o=k().find(d=>d.id===e);if(!o)return;A=e;const t=document.getElementById("column-modal"),a=document.getElementById("column-name"),r=document.getElementById("column-color"),l=document.getElementById("column-modal-title"),s=document.getElementById("column-submit-btn");l.textContent="Edit Column",s.textContent="Save Changes",a.value=o.name,r&&(r.value=o.color||"#3b82f6"),t.classList.remove("hidden"),a.focus()}function N(){document.getElementById("column-modal").classList.add("hidden"),A=null}function Pe(){j(),document.getElementById("labels-modal").classList.remove("hidden")}function V(){document.getElementById("labels-modal").classList.add("hidden")}function Oe(){document.getElementById("help-modal").classList.remove("hidden")}function U(){document.getElementById("help-modal").classList.add("hidden")}function oe(e=null){$=e;const n=document.getElementById("label-modal"),o=document.getElementById("label-modal-title"),t=document.getElementById("label-name"),a=document.getElementById("label-color"),r=document.getElementById("label-submit-btn");if(e){const s=b().find(d=>d.id===e);s&&(o.textContent="Edit Label",r.textContent="Update Label",t.value=s.name,a.value=s.color)}else o.textContent="Add Label",r.textContent="Add Label",t.value="",a.value="#3b82f6";n.classList.remove("hidden"),t.focus()}function q(){document.getElementById("label-modal").classList.add("hidden"),$=null}function j(){const e=document.getElementById("labels-list");e.innerHTML="",b().forEach(o=>{const t=document.createElement("div");t.classList.add("label-item"),t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-between";const a=document.createElement("span");a.classList.add("task-label"),a.style.backgroundColor=o.color,a.textContent=o.name;const r=document.createElement("div");r.classList.add("label-actions"),r.style.display="flex",r.style.gap="4px";const l=document.createElement("button");l.classList.add("btn-small");const s=document.createElement("span");s.dataset.lucide="pencil",l.appendChild(s),l.title="Edit label",l.addEventListener("click",()=>oe(o.id));const d=document.createElement("button");d.classList.add("btn-small","btn-danger");const i=document.createElement("span");i.dataset.lucide="trash-2",d.appendChild(i),d.title="Delete label",d.addEventListener("click",async()=>{if(confirm(`Delete label "${o.name}"? This will remove it from all tasks.`)){Be(o.id),j();const{renderBoard:c}=await S(async()=>{const{renderBoard:u}=await Promise.resolve().then(()=>B);return{renderBoard:u}},void 0);c()}}),r.appendChild(l),r.appendChild(d),t.appendChild(a),t.appendChild(r),e.appendChild(t)}),lucide.createIcons()}function R(){J();const e=document.getElementById("task-labels-selection");e.innerHTML="";const n=Te(),o=b(),t=n?o.filter(a=>{const r=(a.name||"").toLowerCase(),l=(a.id||"").toLowerCase();return r.includes(n)||l.includes(n)}):o;if(t.length===0){const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent="No matching labels",e.appendChild(a);return}t.forEach(a=>{const r=document.createElement("label");r.classList.add("label-checkbox");const l=document.createElement("input");l.type="checkbox",l.value=a.id,l.checked=h.includes(a.id),l.addEventListener("change",d=>{d.target.checked?h.includes(a.id)||h.push(a.id):h=h.filter(i=>i!==a.id),J()});const s=document.createElement("span");s.classList.add("task-label","label-color-swatch"),s.style.backgroundColor=a.color,s.textContent=a.name,r.appendChild(l),r.appendChild(s),e.appendChild(r)})}function _e(){document.getElementById("task-label-search")?.addEventListener("input",R),document.getElementById("task-form").addEventListener("submit",async n=>{n.preventDefault();const o=document.getElementById("task-title").value,t=document.getElementById("task-description").value,a=document.getElementById("task-priority")?.value,r=document.getElementById("task-due-date")?.value,l=document.getElementById("task-column").value;D?fe(D,o,t,a,r,l,h):pe(o,t,a,r,l,h),_();const{renderBoard:s}=await S(async()=>{const{renderBoard:d}=await Promise.resolve().then(()=>B);return{renderBoard:d}},void 0);s()}),document.getElementById("cancel-task-btn").addEventListener("click",_),document.querySelector("#task-modal .modal-backdrop").addEventListener("click",_),document.getElementById("column-form").addEventListener("submit",async n=>{n.preventDefault();const o=document.getElementById("column-name").value,t=document.getElementById("column-color")?.value;A?ke(A,o,t):Ee(o,t),N();const{renderBoard:a}=await S(async()=>{const{renderBoard:r}=await Promise.resolve().then(()=>B);return{renderBoard:r}},void 0);a()}),document.getElementById("cancel-column-btn").addEventListener("click",N),document.querySelector("#column-modal .modal-backdrop").addEventListener("click",N),document.getElementById("manage-labels-btn").addEventListener("click",Pe),document.getElementById("labels-close-btn").addEventListener("click",V),document.getElementById("add-label-btn").addEventListener("click",()=>oe()),document.getElementById("label-form").addEventListener("submit",async n=>{n.preventDefault();const o=document.getElementById("label-name").value,t=document.getElementById("label-color").value;$?Se($,o,t):xe(o,t),q(),j();const{renderBoard:a}=await S(async()=>{const{renderBoard:r}=await Promise.resolve().then(()=>B);return{renderBoard:r}},void 0);a()}),document.getElementById("cancel-label-btn").addEventListener("click",q),document.querySelector("#labels-modal .modal-backdrop").addEventListener("click",V),document.querySelector("#label-modal .modal-backdrop").addEventListener("click",q),document.getElementById("help-btn").addEventListener("click",Oe),document.getElementById("help-close-btn").addEventListener("click",U),document.querySelector("#help-modal .modal-backdrop").addEventListener("click",U),document.getElementById("add-column-btn").addEventListener("click",De),document.addEventListener("keydown",n=>{n.key==="Escape"&&(_(),N(),V(),q(),U())})}function Ne(){document.querySelectorAll(".task").forEach(n=>{n.addEventListener("dragstart",o=>{n.id="dragged-task",o.dataTransfer.effectAllowed="move",o.dataTransfer.setData("task","")}),n.addEventListener("dragend",o=>{n.removeAttribute("id")})})}function qe(){document.querySelectorAll(".task-column").forEach(n=>{n.addEventListener("dragover",o=>{o.dataTransfer.types.includes("task")?Me(o):o.dataTransfer.types.includes("column")&&ae(o)}),n.addEventListener("dragleave",o=>{if(n.contains(o.relatedTarget))return;n.querySelector(".placeholder")?.remove()}),n.addEventListener("drop",async o=>{o.preventDefault();const t=document.getElementById("dragged-task"),a=n.querySelector(".placeholder");if(!t||!a)return;const r=n.querySelector(".tasks");t.remove(),r.insertBefore(t,a),a.remove(),he();const{renderBoard:l}=await S(async()=>{const{renderBoard:s}=await Promise.resolve().then(()=>B);return{renderBoard:s}},void 0);l()})})}function $e(){const e=document.querySelectorAll(".task-column"),n=document.getElementById("board-container");e.forEach(o=>{const t=o.querySelector(".column-drag-handle");o.draggable=!1,t.addEventListener("mousedown",()=>{o.draggable=!0}),document.addEventListener("mouseup",()=>{o.draggable=!1}),o.addEventListener("dragstart",a=>{a.target.closest(".task")||(o.id="dragged-column",a.dataTransfer.effectAllowed="move",a.dataTransfer.setData("column",""))}),o.addEventListener("dragend",()=>{o.removeAttribute("id"),o.draggable=!1,n.querySelector(".column-placeholder")?.remove()})}),n.addEventListener("dragover",o=>{o.dataTransfer.types.includes("column")&&(o.preventDefault(),ae(o))}),n.addEventListener("drop",o=>{if(!o.dataTransfer.types.includes("column"))return;o.preventDefault();const t=document.getElementById("dragged-column"),a=n.querySelector(".column-placeholder");!t||!a||(n.insertBefore(t,a),a.remove(),ve())})}function K(e){const n=document.createElement("li");return n.classList.add("placeholder"),n.style.height=`${e.offsetHeight}px`,n}function Me(e){if(!e.dataTransfer.types.includes("task"))return;e.preventDefault();const n=document.getElementById("dragged-task"),o=e.currentTarget,t=o.querySelector(".tasks"),a=o.querySelector(".placeholder");if(a){const r=a.getBoundingClientRect();if(r.top<=e.clientY&&r.bottom>=e.clientY)return}for(const r of t.children)if(r.getBoundingClientRect().bottom>=e.clientY){if(r===a||(a?.remove(),r===n||r.previousElementSibling===n))return;t.insertBefore(a??K(n),r);return}a?.remove(),t.lastElementChild!==n&&t.append(a??K(n))}function X(e){const n=document.createElement("div");return n.classList.add("column-placeholder"),n.style.width=`${e.offsetWidth}px`,n.style.height=`${e.offsetHeight}px`,n}function ae(e){if(!e.dataTransfer.types.includes("column"))return;const n=document.getElementById("board-container"),o=document.getElementById("dragged-column");if(!o)return;const t=n.querySelector(".column-placeholder"),a=Array.from(n.querySelectorAll(".task-column:not(#dragged-column)"));for(const r of a){const l=r.getBoundingClientRect(),s=l.left+l.width/2;if(e.clientX<s){if(t&&t.nextElementSibling===r)return;t?.remove(),n.insertBefore(X(o),r);return}}t?.remove(),n.appendChild(X(o))}let G=!1;function w(e=null){document.querySelectorAll(".column-menu").forEach(n=>{e&&n===e||n.classList.add("hidden")})}function Re(e){const n=document.createElement("li");n.classList.add("task"),n.draggable=!0,n.dataset.taskId=e.id,n.setAttribute("role","listitem"),n.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const o=document.createElement("div");o.classList.add("task-labels"),o.setAttribute("aria-label","Task labels");const t=b();e.labels&&e.labels.length>0&&e.labels.forEach(g=>{const E=t.find(C=>C.id===g);if(E){const C=document.createElement("span");C.classList.add("task-label"),C.style.backgroundColor=E.color,C.textContent=E.name,o.appendChild(C)}});const a=document.createElement("div");a.classList.add("task-header");const r=document.createElement("div");r.classList.add("task-title"),r.setAttribute("role","button"),r.setAttribute("tabindex","0");const l=typeof e.text=="string"?e.text:"";r.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:l,r.addEventListener("click",()=>H(e.id)),r.addEventListener("keydown",g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),H(e.id))});const s=document.createElement("div");s.classList.add("task-actions");const d=document.createElement("button");d.classList.add("delete-task-btn"),d.setAttribute("aria-label","Delete task"),d.type="button";const i=document.createElement("span");i.dataset.lucide="trash-2",i.setAttribute("aria-hidden","true"),d.appendChild(i),d.addEventListener("click",async g=>{g.stopPropagation(),ge(e.id)&&z()}),s.appendChild(d),a.appendChild(r),a.appendChild(s);const c=typeof e.description=="string"?e.description.trim():"",u=document.createElement("div");u.classList.add("task-description"),u.textContent=c,u.style.display=c?"block":"none",u.addEventListener("click",()=>H(e.id));const f=document.createElement("div");f.classList.add("task-meta");const m=typeof e.priority=="string"?e.priority:"medium",p=document.createElement("span");p.classList.add("task-priority",`priority-${m}`),p.textContent=m,p.setAttribute("aria-label",`Priority: ${m}`);const y=typeof e.dueDate=="string"?e.dueDate.trim():"",x=document.createElement("span");if(x.classList.add("task-date"),!y)x.textContent="No due date";else{const g=y.includes("T")?y:`${y}T00:00:00`,E=new Date(g);x.textContent=Number.isNaN(E.getTime())?y:E.toLocaleDateString()}return f.appendChild(p),f.appendChild(x),n.appendChild(a),n.appendChild(u),n.appendChild(o),n.appendChild(f),n}function ze(e){const n=document.createElement("article");n.classList.add("task-column"),n.dataset.column=e.id,n.draggable=!1,n.setAttribute("aria-labelledby",`column-title-${e.id}`),e?.color&&n.style.setProperty("--column-accent",e.color);const o=document.createElement("button");o.classList.add("column-drag-handle"),o.type="button",o.setAttribute("aria-label","Drag to reorder column");const t=document.createElement("span");t.dataset.lucide="grip-vertical",t.setAttribute("aria-hidden","true"),o.appendChild(t),o.title="Drag to reorder";const a=document.createElement("header");a.classList.add("column-header");const r=document.createElement("h2");r.id=`column-title-${e.id}`,r.textContent=e.name;const l=document.createElement("span");l.classList.add("task-counter"),l.dataset.columnId=e.id,l.textContent="0",l.setAttribute("aria-label","Task count");const s=document.createElement("div");s.classList.add("column-actions");const d=document.createElement("button");d.classList.add("add-task-btn-icon"),d.type="button",d.setAttribute("aria-label",`Add task to ${e.name}`);const i=document.createElement("span");i.dataset.lucide="plus",i.setAttribute("aria-hidden","true"),d.appendChild(i),d.title="Add task",d.addEventListener("click",()=>we(e.id));const c=document.createElement("div");c.classList.add("column-menu-wrapper");const u=document.createElement("button");u.classList.add("column-menu-btn"),u.type="button",u.setAttribute("aria-haspopup","menu"),u.setAttribute("aria-expanded","false"),u.setAttribute("aria-label",`${e.name} column menu`);const f=document.createElement("span");f.dataset.lucide="ellipsis-vertical",f.setAttribute("aria-hidden","true"),u.appendChild(f),u.title="Column menu";const m=document.createElement("div");m.classList.add("column-menu","hidden"),m.setAttribute("role","menu");const p=document.createElement("button");p.classList.add("column-menu-item"),p.type="button",p.setAttribute("role","menuitem");const y=document.createElement("span");y.dataset.lucide="pencil",y.setAttribute("aria-hidden","true"),p.appendChild(y);const x=document.createTextNode(" Edit");p.appendChild(x),p.title="Edit column",p.addEventListener("click",T=>{T.stopPropagation(),w(),Ae(e.id)});const g=document.createElement("button");g.classList.add("column-menu-item","danger"),g.type="button",g.setAttribute("role","menuitem");const E=document.createElement("span");E.dataset.lucide="trash-2",E.setAttribute("aria-hidden","true"),g.appendChild(E);const C=document.createTextNode(" Delete");g.appendChild(C),g.title="Delete column",g.addEventListener("click",T=>{T.stopPropagation(),w(),Le(e.id)&&z()}),m.appendChild(p),m.appendChild(g),u.addEventListener("click",T=>{T.stopPropagation();const de=!m.classList.contains("hidden");w(),de?u.setAttribute("aria-expanded","false"):(m.classList.remove("hidden"),u.setAttribute("aria-expanded","true"))}),c.appendChild(u),c.appendChild(m),s.appendChild(d),s.appendChild(c),a.appendChild(o),a.appendChild(r),a.appendChild(l),a.appendChild(s);const O=document.createElement("ul");return O.classList.add("tasks"),O.setAttribute("role","list"),O.setAttribute("aria-label",`Tasks in ${e.name}`),n.appendChild(a),n.appendChild(O),n}function He(){const e=k(),n=document.getElementById("task-column");n.innerHTML="",e.forEach(o=>{const t=document.createElement("option");t.value=o.id,t.textContent=o.name,n.appendChild(t)})}function z(){const e=k(),n=v(),o=document.getElementById("board-container");o.innerHTML="",[...e].sort((a,r)=>(a.order??0)-(r.order??0)).forEach(a=>{const r=ze(a);o.appendChild(r);const l=r.querySelector(".tasks"),s=r.querySelector(".task-counter"),d=n.filter(i=>i.column===a.id).sort((i,c)=>(i.order??0)-(c.order??0));if(d.forEach(i=>{l.appendChild(Re(i))}),s.textContent=d.length,d.length>12){r.classList.add("has-hidden-tasks");const i=document.createElement("button");i.classList.add("show-all-tasks-btn"),i.type="button";const c=d.length;i.textContent=`Show all tasks (${c})`,i.addEventListener("click",()=>{l.classList.toggle("expanded"),i.textContent=l.classList.contains("expanded")?"Hide extra tasks":`Show all tasks (${c})`}),r.appendChild(i)}}),Ne(),qe(),$e(),He(),lucide.createIcons(),G||(G=!0,document.addEventListener("click",()=>w()),document.addEventListener("keydown",a=>{a.key==="Escape"&&w()}))}const B=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:z},Symbol.toStringTag,{value:"Module"}));function F(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const Ve=new Set(["low","medium","high"]);function re(e){const n=(e||"").toString().trim().toLowerCase();return Ve.has(n)?n:"medium"}function le(e){const n=(e||"").toString().trim();return n.length>=10&&n.includes("T")?n.slice(0,10):n}function Ue(e){const n=typeof e?.text=="string"?e.text:"",o=typeof e?.title=="string"?e.title:n,t=typeof e?.description=="string"?e.description:"",a=le(e?.dueDate??e?.["due-date"]);return{...e,title:o.toString().trim(),description:t.toString().trim(),priority:re(e?.priority),dueDate:a}}function Je(e){if(!Array.isArray(e))return null;const n=e.map(t=>{const a=typeof t?.id=="string"?t.id:String(t?.id??""),r=typeof t?.text=="string"?t.text:String(t?.text??""),l=typeof t?.title=="string"?t.title:r,s=typeof t?.description=="string"?t.description:String(t?.description??""),d=re(t?.priority),i=typeof t?.dueDate=="string"?t.dueDate:typeof t?.["due-date"]=="string"?t["due-date"]:String(t?.dueDate??t?.["due-date"]??""),c=le(i),u=typeof t?.column=="string"?t.column:String(t?.column??""),f=Array.isArray(t?.labels)?t.labels.map(y=>typeof y=="string"?y:String(y)):[],m=Number.isFinite(t?.order)?t.order:void 0,p=typeof t?.creationDate=="string"?t.creationDate:void 0;return{id:a.trim(),title:l.trim(),description:s.trim(),priority:d,dueDate:c.trim(),column:u.trim(),...m!==void 0?{order:m}:{},...p?{creationDate:p}:{},labels:f}});return n.every(t=>t.id&&t.title&&t.column)?n:null}function je(e){if(!Array.isArray(e))return null;const n=e.map(t=>{const a=typeof t?.id=="string"?t.id:String(t?.id??""),r=typeof t?.name=="string"?t.name:String(t?.name??""),l=Number.isFinite(t?.order)?t.order:void 0,s=F(t?.color)?t.color.trim():"#3b82f6";return{id:a.trim(),name:r.trim(),color:s,...l!==void 0?{order:l}:{}}});return n.every(t=>t.id&&t.name)?n:null}function Fe(e){if(!Array.isArray(e))return null;const n=e.map(t=>{const a=typeof t?.id=="string"?t.id:String(t?.id??""),r=typeof t?.name=="string"?t.name:String(t?.name??""),l=F(t?.color)?t.color.trim():"#3b82f6";return{id:a.trim(),name:r.trim(),color:l}});return n.every(t=>t.id&&t.name&&t.color)?n:null}function We(){const e=v().map(Ue),n=k().map(d=>({...d,color:F(d?.color)?d.color.trim():"#3b82f6"})),o=b(),a=JSON.stringify({columns:n,tasks:e,labels:o},null,2),r=new Blob([a],{type:"application/json"}),l=URL.createObjectURL(r),s=document.createElement("a");s.href=l,s.download=`kanban-board-${new Date().toISOString()}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)}function Ye(e){const n=new FileReader;n.onload=async o=>{try{const t=JSON.parse(o.target.result);let a,r,l;if(Array.isArray(t))a=t,r=k(),l=b();else if(t.tasks&&t.columns)a=t.tasks,r=t.columns,l=t.labels||b();else{alert("Invalid JSON file format");return}const s=Je(a),d=je(r),i=l?Fe(l):null;if(!s||!d||l&&!i){alert("Invalid data structure");return}P(d),I(s),i&&M(i);const{renderBoard:c}=await S(async()=>{const{renderBoard:u}=await Promise.resolve().then(()=>B);return{renderBoard:u}},void 0);c(),alert("Board imported successfully!")}catch(t){alert("Error parsing JSON file: "+t.message)}},n.readAsText(e)}const se="kanban-theme";function Ke(){const e=localStorage.getItem(se);return e==="light"||e==="dark"?e:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Q(e){document.documentElement.dataset.theme=e}function Z(e){const n=document.getElementById("theme-toggle-btn");if(!n)return;const o=e==="dark"?"light":"dark",t=o==="dark"?"Dark":"Light",a=o==="dark"?"moon":"sun";n.setAttribute("aria-pressed",String(e==="dark"));const r=n.querySelector("span[data-lucide]");r&&r.setAttribute("data-lucide",a);const l=Array.from(n.childNodes).filter(s=>s.nodeType===Node.TEXT_NODE);for(const s of l)s.remove();n.appendChild(document.createTextNode(` ${t}`)),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}function Xe(){const e=Ke();Q(e),Z(e);const n=document.getElementById("theme-toggle-btn");n&&n.addEventListener("click",()=>{const t=(document.documentElement.dataset.theme==="dark"?"dark":"light")==="dark"?"light":"dark";Q(t),localStorage.setItem(se,t),Z(t)})}document.addEventListener("DOMContentLoaded",()=>{Xe(),_e(),document.getElementById("export-btn").addEventListener("click",We),document.getElementById("import-btn").addEventListener("click",()=>{document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",o=>{const t=o.target.files[0];t&&Ye(t),o.target.value=""});const e=document.getElementById("mobile-menu-btn"),n=document.getElementById("board-controls-menu");e&&n&&(e.addEventListener("click",o=>{o.stopPropagation();const t=e.getAttribute("aria-expanded")==="true";n.classList.toggle("show"),e.setAttribute("aria-expanded",!t),document.querySelectorAll(".column-menu").forEach(a=>a.classList.add("hidden"))}),n.addEventListener("click",()=>{window.innerWidth<=768&&(n.classList.remove("show"),e.setAttribute("aria-expanded","false"))}),document.addEventListener("click",o=>{!n.contains(o.target)&&!e.contains(o.target)&&(n.classList.remove("show"),e.setAttribute("aria-expanded","false"))})),window.addEventListener("beforeunload",o=>{const t="Your board data is stored in browser localStorage. Please export to a JSON file to save your work before closing.";return o.preventDefault(),o.returnValue=t,t}),z()});
