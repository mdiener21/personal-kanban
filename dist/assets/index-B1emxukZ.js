import{l as J,g as ln,s as Ie,a as Q,b as Qe,c as Z,d as _t,e as q,f as At,h as xn,i as wt,j as On,k as Pe,r as xt,m as sn,n as dn,o as uo,p as mo}from"./storage-CJ9_F5Vi.js";const fo=new Set(["low","medium","high"]);function Pn(e){const t=(e||"").toString().trim().toLowerCase();return fo.has(t)?t:"low"}function Nn(e){return(e||"").toString().trim()}function po(e,t,o,n,a,r=[]){if(!e||e.trim()==="")return;const i=J(),l=i.filter(m=>m.column===a).slice().sort((m,f)=>(m.order??0)-(f.order??0)),s=new Map;l.forEach((m,f)=>{s.set(m.id,f+2)});const d=i.map(m=>{if(m.column!==a)return m;const f=s.get(m.id);return typeof f=="number"?{...m,order:f}:m}),c=new Date().toISOString(),u={id:ln(),title:e.trim(),description:(t||"").toString().trim(),priority:Pn(o),dueDate:Nn(n),column:a,order:1,labels:[...r],creationDate:c,changeDate:c};d.push(u),Ie(d)}function ho(e,t,o,n,a,r,i=[]){if(!t||t.trim()==="")return;const l=J(),s=l.findIndex(d=>d.id===e);s!==-1&&(l[s].title=t.trim(),l[s].description=(o||"").toString().trim(),l[s].priority=Pn(n),l[s].dueDate=Nn(a),l[s].column=r,l[s].labels=[...i],l[s].changeDate=new Date().toISOString(),Ie(l))}function go(e){const o=J().filter(n=>n.id!==e);return Ie(o),!0}function bo(){const e=[];return document.querySelectorAll(".task-column").forEach(t=>{const o=t.dataset.column;t.querySelectorAll(".task").forEach(n=>{e.push({id:n.dataset.taskId,column:o})})}),e}function yo(){const e=bo(),t=J(),o=new Date().toISOString(),n=t.map(a=>{const r=e.findIndex(i=>i.id===a.id);if(r!==-1){const i=e[r],l=e.filter((u,m)=>u.column===i.column&&m<=r),s=i.column,d=l.length,c=a.column!==s;return{...a,column:s,order:d,...c?{changeDate:o}:{}}}return a});Ie(n)}function vo(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}function Mn(e){return vo(e)?e.trim():"#3b82f6"}function Eo(e,t){if(!e||e.trim()==="")return;const o=Q(),n=o.reduce((i,l)=>Math.max(i,l.order??0),0),r={id:e.toLowerCase().replace(/\s+/g,"-")+"-"+ln().substring(0,8),name:e.trim(),color:Mn(t),order:n+1};o.push(r),Qe(o)}function wo(e,t,o){if(!t||t.trim()==="")return;const n=Q(),a=n.findIndex(r=>r.id===e);a!==-1&&(n[a].name=t.trim(),n[a].color=Mn(o),Qe(n))}function Co(e){const t=Q();if(t.length<=1)return!1;const o=J();if(o.filter(r=>r.column===e).length>0){const r=o.filter(i=>i.column!==e);Ie(r)}const a=t.filter(r=>r.id!==e);return Qe(a),!0}function Do(){const t=document.getElementById("board-container").querySelectorAll(".task-column"),o=Q();t.forEach((n,a)=>{const r=n.dataset.column,i=o.find(l=>l.id===r);i&&(i.order=a+1)}),Qe(o)}const Io="modulepreload",Lo=function(e,t){return new URL(e,t).href},bn={},ne=function(t,o,n){let a=Promise.resolve();if(o&&o.length>0){let d=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const i=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),s=l?.nonce||l?.getAttribute("nonce");a=d(o.map(c=>{if(c=Lo(c,n),c in bn)return;bn[c]=!0;const u=c.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(n)for(let h=i.length-1;h>=0;h--){const g=i[h];if(g.href===c&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Io,u||(f.as="script"),f.crossOrigin="",f.href=c,s&&f.setAttribute("nonce",s),document.head.appendChild(f),u)return new Promise((h,g)=>{f.addEventListener("load",h),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&r(l.reason);return t().catch(r)})},cn=40;function un(e){return e.trim().slice(0,cn).toLowerCase().replace(/\s+/g," ")}function Rn(e,t,o=null){return e.some(n=>o&&n.id===o?!1:un(n.name)===t)}function ko(e,t){if(!e||e.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const o=e.trim().slice(0,cn),n=un(o),a=Z();if(Rn(a,n))return{success:!1,reason:"DUPLICATE_NAME",message:`Label "${o}" already exists.`};const i={id:n.replace(/\s+/g,"-")+"-"+ln().substring(0,8),name:o,color:t};return a.push(i),_t(a),{success:!0,label:i}}function So(e,t,o){if(!t||t.trim()==="")return{success:!1,reason:"EMPTY_NAME"};const n=t.trim().slice(0,cn),a=un(n),r=Z(),i=r.findIndex(l=>l.id===e);return i===-1?{success:!1,reason:"NOT_FOUND"}:Rn(r,a,e)?{success:!1,reason:"DUPLICATE_NAME",message:`Another label with the name "${n}" already exists.`}:(r[i].name=n,r[i].color=o,_t(r),{success:!0,label:r[i]})}function Bo(e){const t=Z(),o=J();o.forEach(a=>{a.labels&&(a.labels=a.labels.filter(r=>r!==e))}),Ie(o);const n=t.filter(a=>a.id!==e);_t(n)}let Ct=null;function G(e){return document.getElementById(e)}function ot(e){const t=G("dialog-modal");t&&t.classList.add("hidden");const o=Ct;Ct=null,typeof o=="function"&&o(!!e)}function To(){const e=G("dialog-modal");return e&&!e.classList.contains("hidden")}function Fn({title:e,message:t,confirmText:o,cancelText:n,showCancel:a}){const r=G("dialog-modal-title"),i=G("dialog-modal-message"),l=G("dialog-confirm-btn"),s=G("dialog-cancel-btn");r&&(r.textContent=e||"Confirm"),i&&(i.textContent=t||""),l&&(l.textContent=o||"OK"),s&&(s.textContent=n||"Cancel"),s&&(s.style.display=a?"inline-flex":"none")}function $n(){const e=G("dialog-modal");if(!e||e.dataset.handlersAttached==="true")return;e.dataset.handlersAttached="true";const t=G("dialog-confirm-btn"),o=G("dialog-cancel-btn"),n=e.querySelector(".modal-backdrop");t?.addEventListener("click",()=>ot(!0)),o?.addEventListener("click",()=>ot(!1)),n?.addEventListener("click",()=>ot(!1)),document.addEventListener("keydown",a=>{a.key==="Escape"&&To()&&ot(!1)})}function zn(){const e=G("dialog-modal");if(!e)return;e.classList.remove("hidden"),G("dialog-confirm-btn")?.focus()}function Ce({title:e="Confirm",message:t="",confirmText:o="Delete",cancelText:n="Cancel"}={}){return $n(),Fn({title:e,message:t,confirmText:o,cancelText:n,showCancel:!0}),zn(),new Promise(a=>{Ct=a})}function we({title:e="Notice",message:t="",okText:o="OK"}={}){return $n(),Fn({title:e,message:t,confirmText:o,cancelText:"",showCancel:!1}),zn(),new Promise(n=>{Ct=()=>n(!0)})}function Rt(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return Array.isArray(o)?o:null}catch{return null}}function _o(e){if(!e)return null;const t=localStorage.getItem(e);if(!t)return null;try{const o=JSON.parse(t);return o&&typeof o=="object"&&!Array.isArray(o)?o:null}catch{return null}}function Hn(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function Ao(e){const t=document.getElementById("brand-text")||document.querySelector(".brand-text");t&&(t.textContent=At());const o=document.getElementById("board-select");if(!o)return;const n=Pe();o.innerHTML="",n.forEach(a=>{const r=document.createElement("option");r.value=a.id,r.textContent=Hn(a),o.appendChild(r)}),e&&(o.value=e)}function xo(e){const t=typeof e?.name=="string"?e.name.trim():"";return t?t.replace(/\.[^.]+$/,"").trim():""}function Ot(e){return typeof e=="string"&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e.trim())}const Oo=new Set(["low","medium","high"]);function Pt(e){const t=(e||"").toString().trim().toLowerCase();return Oo.has(t)?t:"low"}function Po(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},o=t.showPriority!==!1,n=t.showDueDate!==!1,a=t.showAge!==!1,r=t.showChangeDate!==!1,i=typeof t.locale=="string"&&t.locale.trim()?t.locale.trim():typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US",l=Pt(t.defaultPriority);return{showPriority:o,showDueDate:n,showAge:a,showChangeDate:r,locale:i,defaultPriority:l}}function Xn(e){const t=(e||"").toString().trim();return t.length>=10&&t.includes("T")?t.slice(0,10):t}function Yn(e){const t=typeof e?.text=="string"?e.text:"",o=typeof e?.title=="string"?e.title:t,n=typeof e?.description=="string"?e.description:"",a=Xn(e?.dueDate??e?.["due-date"]),r=typeof e?.changeDate=="string"?e.changeDate:typeof e?.changedDate=="string"?e.changedDate:void 0;return{...e,title:o.toString().trim(),description:n.toString().trim(),priority:Pt(e?.priority),dueDate:a,...typeof r=="string"?{changeDate:r.toString().trim()}:{},changedDate:void 0}}function No(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),r=typeof n?.text=="string"?n.text:String(n?.text??""),i=typeof n?.title=="string"?n.title:r,l=typeof n?.description=="string"?n.description:String(n?.description??""),s=Pt(n?.priority),d=typeof n?.dueDate=="string"?n.dueDate:typeof n?.["due-date"]=="string"?n["due-date"]:String(n?.dueDate??n?.["due-date"]??""),c=Xn(d),u=typeof n?.column=="string"?n.column:String(n?.column??""),m=Array.isArray(n?.labels)?n.labels.map(I=>typeof I=="string"?I:String(I)):[],f=Number.isFinite(n?.order)?n.order:void 0,h=typeof n?.creationDate=="string"?n.creationDate:void 0,g=typeof n?.changeDate=="string"?n.changeDate:typeof n?.changedDate=="string"?n.changedDate:void 0;return{id:a.trim(),title:i.trim(),description:l.trim(),priority:s,dueDate:c.trim(),column:u.trim(),...f!==void 0?{order:f}:{},...h?{creationDate:h}:{},...typeof g=="string"&&g.trim()?{changeDate:g.trim()}:{},labels:m}});return t.every(n=>n.id&&n.title&&n.column)?t:null}function Mo(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),r=typeof n?.name=="string"?n.name:String(n?.name??""),i=Number.isFinite(n?.order)?n.order:void 0,l=Ot(n?.color)?n.color.trim():"#3b82f6";return{id:a.trim(),name:r.trim(),color:l,...i!==void 0?{order:i}:{}}});return t.every(n=>n.id&&n.name)?t:null}function Ro(e){if(!Array.isArray(e))return null;const t=e.map(n=>{const a=typeof n?.id=="string"?n.id:String(n?.id??""),r=typeof n?.name=="string"?n.name:String(n?.name??""),i=Ot(n?.color)?n.color.trim():"#3b82f6";return{id:a.trim(),name:r.trim(),color:i}});return t.every(n=>n.id&&n.name&&n.color)?t:null}function Fo(e){if(!e||typeof e!="object"||Array.isArray(e))return null;const t=e.showPriority!==!1,o=e.showDueDate!==!1,n=e.showAge!==!1,a=e.showChangeDate!==!1,r=typeof e.locale=="string"&&e.locale.trim()?e.locale.trim():void 0,i=typeof e.defaultPriority=="string"?e.defaultPriority:void 0,l=i?Pt(i):void 0;return{showPriority:t,showDueDate:o,showAge:n,showChangeDate:a,...r?{locale:r}:{},...l?{defaultPriority:l}:{}}}function $o(){const e=J().map(Yn),t=Q().map(c=>({...c,color:Ot(c?.color)?c.color.trim():"#3b82f6"})),o=Z(),n=q(),a=At(),i=JSON.stringify({boardName:a,columns:t,tasks:e,labels:o,settings:n},null,2),l=new Blob([i],{type:"application/json"}),s=URL.createObjectURL(l),d=document.createElement("a");d.href=s,d.download=`${a.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(s)}function zo(e){const t=typeof e=="string"?e.trim():"";if(!t)return;const o=Pe().find(v=>v.id===t),n=Hn(o),a=`kanbanBoard:${t}:columns`,r=`kanbanBoard:${t}:tasks`,i=`kanbanBoard:${t}:labels`,l=`kanbanBoard:${t}:settings`,s=Rt(r)||[],d=Rt(a)||[],c=Rt(i)||[],u=_o(l)||null,m=s.map(Yn),f=d.map(v=>({...v,color:Ot(v?.color)?v.color.trim():"#3b82f6"})),h=Array.isArray(c)?c:[],g=Po(u),S=JSON.stringify({boardName:n,columns:f,tasks:m,labels:h,settings:g},null,2),L=new Blob([S],{type:"application/json"}),_=URL.createObjectURL(L),k=document.createElement("a");k.href=_,k.download=`${n.replaceAll(" ","_").replaceAll(".","_")}_board_${new Date().toISOString().replaceAll(":","-").replaceAll(".","-")}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(_)}function Ho(e){const t=new FileReader;t.onload=async o=>{try{const n=JSON.parse(o.target.result);let a,r,i,l,s;if(Array.isArray(n))a=n,r=null,i=null,l=null,s=null;else if(n.tasks&&n.columns)a=n.tasks,r=n.columns,i=Object.prototype.hasOwnProperty.call(n,"labels")?n.labels:null,l=Object.prototype.hasOwnProperty.call(n,"settings")?n.settings:null,s=typeof n.boardName=="string"?n.boardName.trim():null;else{alert("Invalid JSON file format");return}const d=No(a),c=r?Mo(r):null,u=i?Ro(i):null,m=l?Fo(l):null;if(!d||r&&!c||i&&!u||l&&!m){alert("Invalid data structure");return}const f=s||xo(e)||"Imported board",h=xn(f);if(h?.id&&wt(h.id),c&&Qe(c),Ie(d),u&&_t(u),m){const I=q();On({...I,...m})}Ao(h?.id);const{renderBoard:g}=await ne(async()=>{const{renderBoard:I}=await Promise.resolve().then(()=>ae);return{renderBoard:I}},void 0,import.meta.url);g(),document.dispatchEvent(new CustomEvent("kanban:boards-changed")),alert("Board imported successfully!")}catch(n){alert("Error parsing JSON file: "+n.message)}},t.readAsText(e)}let yn="todo",Ve=null,Ke=null,He=null,Dt=null,$=[],me=!1,Ze=!1;const ge=40;let Re=!1;function Nt(e){const t=document.getElementById("task-modal");if(!t)return;t.classList.toggle("fullscreen",!!e),document.getElementById("task-fullpage-btn")?.setAttribute("aria-pressed",e?"true":"false")}function be(e){const t=document.getElementById(e);return!!t&&!t.classList.contains("hidden")}function Xo(){const e=document.getElementById("task-modal");e&&(e.classList.remove("hidden"),xe(),document.getElementById("task-label-search")?.focus(),me=!1)}function Yo(){return(document.getElementById("task-label-search")?.value||"").trim().toLowerCase()}function Uo(){return(document.getElementById("labels-search")?.value||"").trim().toLowerCase()}function Qt(){const e=document.getElementById("task-active-labels");if(!e)return;const t=Z(),o=[];for(const a of $)o.includes(a)||o.push(a);$=o;const n=o.map(a=>t.find(r=>r.id===a)).filter(Boolean);e.innerHTML="",e.style.display=n.length>0?"flex":"none",n.forEach(a=>{const r=document.createElement("span");r.classList.add("task-label"),r.style.backgroundColor=a.color,r.textContent=a.name;const i=document.createElement("button");i.type="button",i.classList.add("active-label-remove"),i.setAttribute("aria-label",`Remove label ${a.name}`),i.title="Remove label",i.textContent="Ã—",i.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),$=$.filter(s=>s!==a.id),Qt(),xe()}),r.appendChild(i),e.appendChild(r)})}function jo(e){yn=e||Q()[0]?.id||"todo",Ve=null,$=[],me=!1,Ze=!1,Nt(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden");const t=document.getElementById("task-modal"),o=document.getElementById("task-column"),n=document.getElementById("task-title"),a=document.getElementById("task-description"),r=document.getElementById("task-priority"),i=document.getElementById("task-due-date"),l=document.getElementById("task-modal-title"),s=document.getElementById("task-submit-btn");if(l.textContent="Add New Task",s.textContent="Add Task",o.value=yn,n.value="",a.value="",r){const c=q();r.value=c.defaultPriority||"low"}i&&(i.value="");const d=document.getElementById("task-label-search");d&&(d.value=""),xe(),t.classList.remove("hidden"),n.focus()}function Ft(e){const o=J().find(g=>g.id===e);if(!o)return;Ve=e,$=o.labels||[],me=!1,Ze=!1,Nt(!1),document.getElementById("task-fullpage-btn")?.classList.remove("hidden");const n=document.getElementById("task-modal"),a=document.getElementById("task-column"),r=document.getElementById("task-title"),i=document.getElementById("task-description"),l=document.getElementById("task-priority"),s=document.getElementById("task-due-date"),d=document.getElementById("task-modal-title"),c=document.getElementById("task-submit-btn");d.textContent="Edit Task",c.textContent="Save Changes",a.value=o.column;const u=typeof o.text=="string"?o.text:"";r.value=typeof o.title=="string"&&o.title.trim()!==""?o.title:u,i.value=typeof o.description=="string"?o.description:"",l&&(l.value=typeof o.priority=="string"?o.priority:"medium");const m=typeof o.dueDate=="string"?o.dueDate:"",f=m.includes("T")?m.slice(0,10):m;s&&(s.value=f);const h=document.getElementById("task-label-search");h&&(h.value=""),xe(),n.classList.remove("hidden"),r.focus()}function at(){document.getElementById("task-modal").classList.add("hidden"),Ve=null,me=!1,Nt(!1),document.getElementById("task-fullpage-btn")?.classList.add("hidden")}function qo(){Ke=null;const e=document.getElementById("column-modal"),t=document.getElementById("column-name"),o=document.getElementById("column-color"),n=document.getElementById("column-modal-title"),a=document.getElementById("column-submit-btn");n.textContent="Add New Column",a.textContent="Add Column",t.value="",o&&(o.value="#3b82f6"),e.classList.remove("hidden"),t.focus()}function Wo(e){const o=Q().find(s=>s.id===e);if(!o)return;Ke=e;const n=document.getElementById("column-modal"),a=document.getElementById("column-name"),r=document.getElementById("column-color"),i=document.getElementById("column-modal-title"),l=document.getElementById("column-submit-btn");i.textContent="Edit Column",l.textContent="Save Changes",a.value=o.name,r&&(r.value=o.color||"#3b82f6"),n.classList.remove("hidden"),a.focus()}function rt(){document.getElementById("column-modal").classList.add("hidden"),Ke=null}function Go(){const e=document.getElementById("labels-search");e&&(e.value=""),It(),document.getElementById("labels-modal").classList.remove("hidden"),me||document.getElementById("labels-search")?.focus()}function it(){document.getElementById("labels-modal").classList.add("hidden");const t=document.getElementById("labels-search");t&&(t.value=""),me&&Xo()}function Vo(){document.getElementById("help-modal").classList.remove("hidden")}function $t(){document.getElementById("help-modal").classList.add("hidden")}function Zt(e=null,{openedFromTaskEditor:t=!1}={}){He=e,Re=!1,Ze=!!t;const o=document.getElementById("label-modal"),n=document.getElementById("label-modal-title"),a=document.getElementById("label-name"),r=document.getElementById("label-color"),i=document.getElementById("label-submit-btn");if(e){const s=Z().find(d=>d.id===e);s&&(n.textContent="Edit Label",i.textContent="Update Label",a.value=s.name,r.value=s.color)}else n.textContent="Add Label",i.textContent="Add Label",a.value="",r.value="#3b82f6";o.classList.remove("hidden"),a.focus()}function lt(){document.getElementById("label-modal").classList.add("hidden"),He=null,Ze=!1}function It(){const e=document.getElementById("labels-list");e.innerHTML="";const t=Z(),o=Uo(),n=o?t.filter(a=>{const r=(a.name||"").toLowerCase(),i=(a.id||"").toLowerCase();return r.includes(o)||i.includes(o)}):t;if(n.length===0){const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent=o?"No matching labels":"No labels yet",e.appendChild(a);return}n.forEach(a=>{const r=document.createElement("div");r.classList.add("label-item"),r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="space-between";const i=document.createElement("span");i.classList.add("task-label"),i.style.backgroundColor=a.color,i.textContent=a.name;const l=document.createElement("div");l.classList.add("label-actions"),l.style.display="flex",l.style.gap="4px";const s=document.createElement("button");s.classList.add("btn-small");const d=document.createElement("span");d.dataset.lucide="pencil",s.appendChild(d),s.title="Edit label",s.addEventListener("click",()=>Zt(a.id));const c=document.createElement("button");c.classList.add("btn-small","btn-danger");const u=document.createElement("span");u.dataset.lucide="trash-2",c.appendChild(u),c.title="Delete label",c.addEventListener("click",async()=>{if(await Ce({title:"Delete Label",message:`Delete label "${a.name}"? This will remove it from all tasks.`,confirmText:"Delete"})){Bo(a.id),It();const{renderBoard:f}=await ne(async()=>{const{renderBoard:h}=await Promise.resolve().then(()=>ae);return{renderBoard:h}},void 0,import.meta.url);f()}}),l.appendChild(s),l.appendChild(c),r.appendChild(i),r.appendChild(l),e.appendChild(r)}),xt()}function en(){const e=document.getElementById("board-select");if(!e)return;const t=Pe(),o=dn();e.innerHTML="",t.forEach(a=>{const r=document.createElement("option");r.value=a.id,r.textContent=typeof a.name=="string"&&a.name.trim()?a.name.trim():"Untitled board",e.appendChild(r)}),o&&(e.value=o);const n=document.getElementById("brand-text")||document.querySelector(".brand-text");n&&(n.textContent=At())}function Je(){sn();const e=document.getElementById("boards-list");if(!e)return;e.innerHTML="";const t=Pe(),o=dn();t.forEach(n=>{const a=document.createElement("div");a.classList.add("label-item"),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="10px";const r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.gap="8px";const i=document.createElement("span");if(i.textContent=(n.name||"").toString(),r.appendChild(i),n.id===o){const g=document.createElement("span");g.classList.add("task-label"),g.style.backgroundColor="var(--color-primary)",g.textContent="Active",r.appendChild(g)}const l=document.createElement("div");l.classList.add("label-actions"),l.style.display="flex",l.style.gap="4px";const s=document.createElement("button");s.classList.add("btn-small"),s.textContent="Open",s.title="Open board",s.addEventListener("click",async()=>{wt(n.id),en(),Je();const{renderBoard:g}=await ne(async()=>{const{renderBoard:I}=await Promise.resolve().then(()=>ae);return{renderBoard:I}},void 0,import.meta.url);g()});const d=document.createElement("button");d.classList.add("btn-small"),d.type="button",d.title="Export board",d.setAttribute("aria-label",`Export board ${String(n.name||"Untitled board")}`);const c=document.createElement("span");c.dataset.lucide="download",d.appendChild(c),d.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),zo(n.id)});const u=document.createElement("button");u.classList.add("btn-small");const m=document.createElement("span");m.dataset.lucide="pencil",u.appendChild(m),u.title="Rename board",u.addEventListener("click",()=>Qo(n.id));const f=document.createElement("button");f.classList.add("btn-small","btn-danger");const h=document.createElement("span");h.dataset.lucide="trash-2",f.appendChild(h),f.title="Delete board",f.addEventListener("click",async()=>{if(!await Ce({title:"Delete Board",message:`Do you really want to delete the board "${n.name}"? This cannot be undone.`,confirmText:"Delete"}))return;if(!uo(n.id)){await we({title:"Unable to Delete",message:"Unable to delete board (you may be trying to delete the last board)."});return}en(),Je();const{renderBoard:S}=await ne(async()=>{const{renderBoard:L}=await Promise.resolve().then(()=>ae);return{renderBoard:L}},void 0,import.meta.url);S()}),l.appendChild(s),l.appendChild(d),l.appendChild(u),l.appendChild(f),a.appendChild(r),a.appendChild(l),e.appendChild(a)}),xt()}function Ko(){Je(),document.getElementById("boards-modal")?.classList.remove("hidden")}function zt(){document.getElementById("boards-modal")?.classList.add("hidden")}function Jo(){const e=document.getElementById("boards-modal");!e||e.classList.contains("hidden")||Je()}function Qo(e){sn();const t=Pe().find(i=>i.id===e);if(!t)return;Dt=e;const o=document.getElementById("board-rename-modal"),n=document.getElementById("board-rename-name"),a=document.getElementById("board-rename-modal-title"),r=document.getElementById("board-rename-submit-btn");a&&(a.textContent="Rename Board"),r&&(r.textContent="Save"),n&&(n.value=(t.name||"").toString()),o?.classList.remove("hidden"),n?.focus()}function st(){document.getElementById("board-rename-modal")?.classList.add("hidden"),Dt=null}function xe(){Qt();const e=document.getElementById("task-labels-selection");e.innerHTML="";const t=Yo(),o=Z(),n=t?o.filter(a=>{const r=(a.name||"").toLowerCase(),i=(a.id||"").toLowerCase();return r.includes(t)||i.includes(t)}):o;if(n.length===0){const a=document.createElement("div");a.classList.add("labels-empty"),a.textContent="No matching labels",e.appendChild(a);return}n.forEach(a=>{const r=document.createElement("label");r.classList.add("label-checkbox");const i=document.createElement("input");i.type="checkbox",i.value=a.id,i.checked=$.includes(a.id),i.addEventListener("change",s=>{s.target.checked?$.includes(a.id)||$.push(a.id):$=$.filter(d=>d!==a.id),Qt()});const l=document.createElement("span");l.classList.add("task-label","label-color-swatch"),l.style.backgroundColor=a.color,l.textContent=a.name,r.appendChild(i),r.appendChild(l),e.appendChild(r)})}function Zo(){document.addEventListener("kanban:boards-changed",()=>{Jo()}),document.getElementById("task-label-search")?.addEventListener("input",xe),document.getElementById("labels-search")?.addEventListener("input",It),document.getElementById("task-add-label-btn")?.addEventListener("click",()=>{me=!1,Zt(null,{openedFromTaskEditor:!0})}),document.getElementById("task-fullpage-btn")?.addEventListener("click",()=>{const r=document.getElementById("task-modal");r&&Nt(!r.classList.contains("fullscreen"))}),document.getElementById("task-form").addEventListener("submit",async r=>{r.preventDefault();const i=document.getElementById("task-title").value,l=document.getElementById("task-description").value,s=document.getElementById("task-priority")?.value,d=document.getElementById("task-due-date")?.value,c=document.getElementById("task-column").value;Ve?ho(Ve,i,l,s,d,c,$):po(i,l,s,d,c,$),at();const{renderBoard:u}=await ne(async()=>{const{renderBoard:m}=await Promise.resolve().then(()=>ae);return{renderBoard:m}},void 0,import.meta.url);u()}),document.getElementById("cancel-task-btn").addEventListener("click",at),document.querySelector("#task-modal .modal-backdrop").addEventListener("click",at),document.getElementById("column-form").addEventListener("submit",async r=>{r.preventDefault();const i=document.getElementById("column-name").value,l=document.getElementById("column-color")?.value;Ke?wo(Ke,i,l):Eo(i,l),rt();const{renderBoard:s}=await ne(async()=>{const{renderBoard:d}=await Promise.resolve().then(()=>ae);return{renderBoard:d}},void 0,import.meta.url);s()}),document.getElementById("cancel-column-btn").addEventListener("click",rt),document.querySelector("#column-modal .modal-backdrop").addEventListener("click",rt),document.getElementById("manage-labels-btn").addEventListener("click",Go),document.getElementById("labels-close-btn").addEventListener("click",it),document.getElementById("add-label-btn").addEventListener("click",()=>Zt());const a=document.getElementById("label-name");a?.addEventListener("beforeinput",r=>{if(!r||typeof r.data!="string"||r.data.length===0)return;const i=r.target;if(!i||typeof i.value!="string")return;const l=typeof i.selectionStart=="number"?i.selectionStart:i.value.length,s=typeof i.selectionEnd=="number"?i.selectionEnd:i.value.length;(i.value.slice(0,l)+r.data+i.value.slice(s)).trim().length<=ge||(r.preventDefault(),!Re&&(Re=!0,we({title:"Label Name Too Long",message:`Label names are limited to ${ge} characters.`})))}),a?.addEventListener("input",r=>{const i=r.target;if(!i||typeof i.value!="string")return;const l=i.value.trim();l.length<=ge||(i.value=l.slice(0,ge),!Re&&(Re=!0,we({title:"Label Name Too Long",message:`Label names are limited to ${ge} characters.`})))}),document.getElementById("label-form").addEventListener("submit",async r=>{r.preventDefault();const i=document.getElementById("label-name").value,l=document.getElementById("label-color").value,s=(i||"").trim();if(s.length>ge){await we({title:"Label Name Too Long",message:`Label names are limited to ${ge} characters.`});return}const d=!He,c=He?So(He,s,l):ko(s,l);if(!c?.success){let m="Unable to Save Label",f="Could not save label.";c?.reason==="DUPLICATE_NAME"?(m="Label Already Exists",f=c?.message||"A label with that name already exists (case-insensitive)."):c?.reason==="EMPTY_NAME"&&(m="Label Name Required",f="Please enter a label name."),await we({title:m,message:f}),document.getElementById("label-name")?.focus();return}d&&Ze&&c?.label?.id&&($.includes(c.label.id)||$.push(c.label.id),xe(),document.getElementById("task-label-search")?.focus()),lt(),It();const{renderBoard:u}=await ne(async()=>{const{renderBoard:m}=await Promise.resolve().then(()=>ae);return{renderBoard:m}},void 0,import.meta.url);u(),me&&d&&it()}),document.getElementById("cancel-label-btn").addEventListener("click",lt),document.querySelector("#labels-modal .modal-backdrop").addEventListener("click",it),document.querySelector("#label-modal .modal-backdrop").addEventListener("click",lt),document.getElementById("manage-boards-btn")?.addEventListener("click",Ko),document.getElementById("add-board-btn")?.addEventListener("click",async()=>{document.dispatchEvent(new CustomEvent("kanban:open-board-create"))}),document.getElementById("boards-import-btn")?.addEventListener("click",async()=>{await Ce({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file")?.click()}),document.getElementById("boards-close-btn")?.addEventListener("click",zt),document.querySelector("#boards-modal .modal-backdrop")?.addEventListener("click",zt),document.getElementById("board-rename-form")?.addEventListener("submit",r=>{if(r.preventDefault(),!Dt)return;const l=(document.getElementById("board-rename-name")?.value||"").trim();if(!l){alert("Board name cannot be empty.");return}if(!mo(Dt,l)){alert("Unable to rename board.");return}st(),en(),Je(),window.lucide&&typeof window.lucide.createIcons=="function"&&window.lucide.createIcons()}),document.getElementById("cancel-board-rename-btn")?.addEventListener("click",st),document.querySelector("#board-rename-modal .modal-backdrop")?.addEventListener("click",st),document.getElementById("help-btn").addEventListener("click",Vo),document.getElementById("help-close-btn").addEventListener("click",$t),document.querySelector("#help-modal .modal-backdrop").addEventListener("click",$t),document.getElementById("add-column-btn").addEventListener("click",qo),document.addEventListener("keydown",r=>{if(r.key==="Escape"){if(be("label-modal")){lt();return}if(be("labels-modal")){it();return}if(be("board-rename-modal")){st();return}if(be("boards-modal")){zt();return}if(be("help-modal")){$t();return}if(be("column-modal")){rt();return}be("task-modal")&&at()}})}function vn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),o.push.apply(o,n)}return o}function K(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?vn(Object(o),!0).forEach(function(n){ea(e,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):vn(Object(o)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))})}return e}function ht(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ht=function(t){return typeof t}:ht=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(e)}function ea(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function re(){return re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},re.apply(this,arguments)}function ta(e,t){if(e==null)return{};var o={},n=Object.keys(e),a,r;for(r=0;r<n.length;r++)a=n[r],!(t.indexOf(a)>=0)&&(o[a]=e[a]);return o}function na(e,t){if(e==null)return{};var o=ta(e,t),n,a;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var oa="1.15.6";function oe(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var ie=oe(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),et=oe(/Edge/i),En=oe(/firefox/i),Xe=oe(/safari/i)&&!oe(/chrome/i)&&!oe(/android/i),mn=oe(/iP(ad|od|hone)/i),Un=oe(/chrome/i)&&oe(/android/i),jn={capture:!1,passive:!1};function C(e,t,o){e.addEventListener(t,o,!ie&&jn)}function w(e,t,o){e.removeEventListener(t,o,!ie&&jn)}function Lt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function qn(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function W(e,t,o,n){if(e){o=o||document;do{if(t!=null&&(t[0]===">"?e.parentNode===o&&Lt(e,t):Lt(e,t))||n&&e===o)return e;if(e===o)break}while(e=qn(e))}return null}var wn=/\s+/g;function X(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(wn," ").replace(" "+t+" "," ");e.className=(n+(o?" "+t:"")).replace(wn," ")}}function y(e,t,o){var n=e&&e.style;if(n){if(o===void 0)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),t===void 0?o:o[t];!(t in n)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),n[t]=o+(typeof o=="string"?"":"px")}}function _e(e,t){var o="";if(typeof e=="string")o=e;else do{var n=y(e,"transform");n&&n!=="none"&&(o=n+" "+o)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(o)}function Wn(e,t,o){if(e){var n=e.getElementsByTagName(t),a=0,r=n.length;if(o)for(;a<r;a++)o(n[a],a);return n}return[]}function V(){var e=document.scrollingElement;return e||document.documentElement}function O(e,t,o,n,a){if(!(!e.getBoundingClientRect&&e!==window)){var r,i,l,s,d,c,u;if(e!==window&&e.parentNode&&e!==V()?(r=e.getBoundingClientRect(),i=r.top,l=r.left,s=r.bottom,d=r.right,c=r.height,u=r.width):(i=0,l=0,s=window.innerHeight,d=window.innerWidth,c=window.innerHeight,u=window.innerWidth),(t||o)&&e!==window&&(a=a||e.parentNode,!ie))do if(a&&a.getBoundingClientRect&&(y(a,"transform")!=="none"||o&&y(a,"position")!=="static")){var m=a.getBoundingClientRect();i-=m.top+parseInt(y(a,"border-top-width")),l-=m.left+parseInt(y(a,"border-left-width")),s=i+r.height,d=l+r.width;break}while(a=a.parentNode);if(n&&e!==window){var f=_e(a||e),h=f&&f.a,g=f&&f.d;f&&(i/=g,l/=h,u/=h,c/=g,s=i+c,d=l+u)}return{top:i,left:l,bottom:s,right:d,width:u,height:c}}}function Cn(e,t,o){for(var n=ue(e,!0),a=O(e)[t];n;){var r=O(n)[o],i=void 0;if(i=a>=r,!i)return n;if(n===V())break;n=ue(n,!1)}return!1}function Oe(e,t,o,n){for(var a=0,r=0,i=e.children;r<i.length;){if(i[r].style.display!=="none"&&i[r]!==b.ghost&&(n||i[r]!==b.dragged)&&W(i[r],o.draggable,e,!1)){if(a===t)return i[r];a++}r++}return null}function fn(e,t){for(var o=e.lastElementChild;o&&(o===b.ghost||y(o,"display")==="none"||t&&!Lt(o,t));)o=o.previousElementSibling;return o||null}function U(e,t){var o=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==b.clone&&(!t||Lt(e,t))&&o++;return o}function Dn(e){var t=0,o=0,n=V();if(e)do{var a=_e(e),r=a.a,i=a.d;t+=e.scrollLeft*r,o+=e.scrollTop*i}while(e!==n&&(e=e.parentNode));return[t,o]}function aa(e,t){for(var o in e)if(e.hasOwnProperty(o)){for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[o][n])return Number(o)}return-1}function ue(e,t){if(!e||!e.getBoundingClientRect)return V();var o=e,n=!1;do if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var a=y(o);if(o.clientWidth<o.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||o.clientHeight<o.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!o.getBoundingClientRect||o===document.body)return V();if(n||t)return o;n=!0}}while(o=o.parentNode);return V()}function ra(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function Ht(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Ye;function Gn(e,t){return function(){if(!Ye){var o=arguments,n=this;o.length===1?e.call(n,o[0]):e.apply(n,o),Ye=setTimeout(function(){Ye=void 0},t)}}}function ia(){clearTimeout(Ye),Ye=void 0}function Vn(e,t,o){e.scrollLeft+=t,e.scrollTop+=o}function Kn(e){var t=window.Polymer,o=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):o?o(e).clone(!0)[0]:e.cloneNode(!0)}function Jn(e,t,o){var n={};return Array.from(e.children).forEach(function(a){var r,i,l,s;if(!(!W(a,t.draggable,e,!1)||a.animated||a===o)){var d=O(a);n.left=Math.min((r=n.left)!==null&&r!==void 0?r:1/0,d.left),n.top=Math.min((i=n.top)!==null&&i!==void 0?i:1/0,d.top),n.right=Math.max((l=n.right)!==null&&l!==void 0?l:-1/0,d.right),n.bottom=Math.max((s=n.bottom)!==null&&s!==void 0?s:-1/0,d.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var H="Sortable"+new Date().getTime();function la(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(a){if(!(y(a,"display")==="none"||a===b.ghost)){e.push({target:a,rect:O(a)});var r=K({},e[e.length-1].rect);if(a.thisAnimationDuration){var i=_e(a,!0);i&&(r.top-=i.f,r.left-=i.e)}a.fromRect=r}})}},addAnimationState:function(n){e.push(n)},removeAnimationState:function(n){e.splice(aa(e,{target:n}),1)},animateAll:function(n){var a=this;if(!this.options.animation){clearTimeout(t),typeof n=="function"&&n();return}var r=!1,i=0;e.forEach(function(l){var s=0,d=l.target,c=d.fromRect,u=O(d),m=d.prevFromRect,f=d.prevToRect,h=l.rect,g=_e(d,!0);g&&(u.top-=g.f,u.left-=g.e),d.toRect=u,d.thisAnimationDuration&&Ht(m,u)&&!Ht(c,u)&&(h.top-u.top)/(h.left-u.left)===(c.top-u.top)/(c.left-u.left)&&(s=da(h,m,f,a.options)),Ht(u,c)||(d.prevFromRect=c,d.prevToRect=u,s||(s=a.options.animation),a.animate(d,h,u,s)),s&&(r=!0,i=Math.max(i,s),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},s),d.thisAnimationDuration=s)}),clearTimeout(t),r?t=setTimeout(function(){typeof n=="function"&&n()},i):typeof n=="function"&&n(),e=[]},animate:function(n,a,r,i){if(i){y(n,"transition",""),y(n,"transform","");var l=_e(this.el),s=l&&l.a,d=l&&l.d,c=(a.left-r.left)/(s||1),u=(a.top-r.top)/(d||1);n.animatingX=!!c,n.animatingY=!!u,y(n,"transform","translate3d("+c+"px,"+u+"px,0)"),this.forRepaintDummy=sa(n),y(n,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),y(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){y(n,"transition",""),y(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},i)}}}}function sa(e){return e.offsetWidth}function da(e,t,o,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))*n.animation}var Le=[],Xt={initializeByDefault:!0},tt={mount:function(t){for(var o in Xt)Xt.hasOwnProperty(o)&&!(o in t)&&(t[o]=Xt[o]);Le.forEach(function(n){if(n.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Le.push(t)},pluginEvent:function(t,o,n){var a=this;this.eventCanceled=!1,n.cancel=function(){a.eventCanceled=!0};var r=t+"Global";Le.forEach(function(i){o[i.pluginName]&&(o[i.pluginName][r]&&o[i.pluginName][r](K({sortable:o},n)),o.options[i.pluginName]&&o[i.pluginName][t]&&o[i.pluginName][t](K({sortable:o},n)))})},initializePlugins:function(t,o,n,a){Le.forEach(function(l){var s=l.pluginName;if(!(!t.options[s]&&!l.initializeByDefault)){var d=new l(t,o,t.options);d.sortable=t,d.options=t.options,t[s]=d,re(n,d.defaults)}});for(var r in t.options)if(t.options.hasOwnProperty(r)){var i=this.modifyOption(t,r,t.options[r]);typeof i<"u"&&(t.options[r]=i)}},getEventProperties:function(t,o){var n={};return Le.forEach(function(a){typeof a.eventProperties=="function"&&re(n,a.eventProperties.call(o[a.pluginName],t))}),n},modifyOption:function(t,o,n){var a;return Le.forEach(function(r){t[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[o]=="function"&&(a=r.optionListeners[o].call(t[r.pluginName],n))}),a}};function ca(e){var t=e.sortable,o=e.rootEl,n=e.name,a=e.targetEl,r=e.cloneEl,i=e.toEl,l=e.fromEl,s=e.oldIndex,d=e.newIndex,c=e.oldDraggableIndex,u=e.newDraggableIndex,m=e.originalEvent,f=e.putSortable,h=e.extraEventProperties;if(t=t||o&&o[H],!!t){var g,I=t.options,S="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!ie&&!et?g=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(g=document.createEvent("Event"),g.initEvent(n,!0,!0)),g.to=i||o,g.from=l||o,g.item=a||o,g.clone=r,g.oldIndex=s,g.newIndex=d,g.oldDraggableIndex=c,g.newDraggableIndex=u,g.originalEvent=m,g.pullMode=f?f.lastPutMode:void 0;var L=K(K({},h),tt.getEventProperties(n,t));for(var _ in L)g[_]=L[_];o&&o.dispatchEvent(g),I[S]&&I[S].call(t,g)}}var ua=["evt"],z=function(t,o){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=n.evt,r=na(n,ua);tt.pluginEvent.bind(b)(t,o,K({dragEl:p,parentEl:A,ghostEl:E,rootEl:B,nextEl:Ee,lastDownEl:gt,cloneEl:T,cloneHidden:ce,dragStarted:Fe,putSortable:P,activeSortable:b.active,originalEvent:a,oldIndex:Te,oldDraggableIndex:Ue,newIndex:Y,newDraggableIndex:de,hideGhostForTarget:to,unhideGhostForTarget:no,cloneNowHidden:function(){ce=!0},cloneNowShown:function(){ce=!1},dispatchSortableEvent:function(l){F({sortable:o,name:l,originalEvent:a})}},r))};function F(e){ca(K({putSortable:P,cloneEl:T,targetEl:p,rootEl:B,oldIndex:Te,oldDraggableIndex:Ue,newIndex:Y,newDraggableIndex:de},e))}var p,A,E,B,Ee,gt,T,ce,Te,Y,Ue,de,dt,P,Be=!1,kt=!1,St=[],ye,j,Yt,Ut,In,Ln,Fe,ke,je,qe=!1,ct=!1,bt,R,jt=[],tn=!1,Bt=[],Mt=typeof document<"u",ut=mn,kn=et||ie?"cssFloat":"float",ma=Mt&&!Un&&!mn&&"draggable"in document.createElement("div"),Qn=(function(){if(Mt){if(ie)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),Zn=function(t,o){var n=y(t),a=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),r=Oe(t,0,o),i=Oe(t,1,o),l=r&&y(r),s=i&&y(i),d=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+O(r).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+O(i).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&l.float&&l.float!=="none"){var u=l.float==="left"?"left":"right";return i&&(s.clear==="both"||s.clear===u)?"vertical":"horizontal"}return r&&(l.display==="block"||l.display==="flex"||l.display==="table"||l.display==="grid"||d>=a&&n[kn]==="none"||i&&n[kn]==="none"&&d+c>a)?"vertical":"horizontal"},fa=function(t,o,n){var a=n?t.left:t.top,r=n?t.right:t.bottom,i=n?t.width:t.height,l=n?o.left:o.top,s=n?o.right:o.bottom,d=n?o.width:o.height;return a===l||r===s||a+i/2===l+d/2},pa=function(t,o){var n;return St.some(function(a){var r=a[H].options.emptyInsertThreshold;if(!(!r||fn(a))){var i=O(a),l=t>=i.left-r&&t<=i.right+r,s=o>=i.top-r&&o<=i.bottom+r;if(l&&s)return n=a}}),n},eo=function(t){function o(r,i){return function(l,s,d,c){var u=l.options.group.name&&s.options.group.name&&l.options.group.name===s.options.group.name;if(r==null&&(i||u))return!0;if(r==null||r===!1)return!1;if(i&&r==="clone")return r;if(typeof r=="function")return o(r(l,s,d,c),i)(l,s,d,c);var m=(i?l:s).options.group.name;return r===!0||typeof r=="string"&&r===m||r.join&&r.indexOf(m)>-1}}var n={},a=t.group;(!a||ht(a)!="object")&&(a={name:a}),n.name=a.name,n.checkPull=o(a.pull,!0),n.checkPut=o(a.put),n.revertClone=a.revertClone,t.group=n},to=function(){!Qn&&E&&y(E,"display","none")},no=function(){!Qn&&E&&y(E,"display","")};Mt&&!Un&&document.addEventListener("click",function(e){if(kt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),kt=!1,!1},!0);var ve=function(t){if(p){t=t.touches?t.touches[0]:t;var o=pa(t.clientX,t.clientY);if(o){var n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=t[a]);n.target=n.rootEl=o,n.preventDefault=void 0,n.stopPropagation=void 0,o[H]._onDragOver(n)}}},ha=function(t){p&&p.parentNode[H]._isOutsideThisEl(t.target)};function b(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=re({},t),e[H]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Zn(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(i,l){i.setData("Text",l.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:b.supportPointer!==!1&&"PointerEvent"in window&&(!Xe||mn),emptyInsertThreshold:5};tt.initializePlugins(this,e,o);for(var n in o)!(n in t)&&(t[n]=o[n]);eo(t);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=t.forceFallback?!1:ma,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?C(e,"pointerdown",this._onTapStart):(C(e,"mousedown",this._onTapStart),C(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(C(e,"dragover",this),C(e,"dragenter",this)),St.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),re(this,la())}b.prototype={constructor:b,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(ke=null)},_getDirection:function(t,o){return typeof this.options.direction=="function"?this.options.direction.call(this,t,o,p):this.options.direction},_onTapStart:function(t){if(t.cancelable){var o=this,n=this.el,a=this.options,r=a.preventOnFilter,i=t.type,l=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,s=(l||t).target,d=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,c=a.filter;if(Da(n),!p&&!(/mousedown|pointerdown/.test(i)&&t.button!==0||a.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&Xe&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=W(s,a.draggable,n,!1),!(s&&s.animated)&&gt!==s)){if(Te=U(s),Ue=U(s,a.draggable),typeof c=="function"){if(c.call(this,t,s,this)){F({sortable:o,rootEl:d,name:"filter",targetEl:s,toEl:n,fromEl:n}),z("filter",o,{evt:t}),r&&t.preventDefault();return}}else if(c&&(c=c.split(",").some(function(u){if(u=W(d,u.trim(),n,!1),u)return F({sortable:o,rootEl:u,name:"filter",targetEl:s,fromEl:n,toEl:n}),z("filter",o,{evt:t}),!0}),c)){r&&t.preventDefault();return}a.handle&&!W(d,a.handle,n,!1)||this._prepareDragStart(t,l,s)}}},_prepareDragStart:function(t,o,n){var a=this,r=a.el,i=a.options,l=r.ownerDocument,s;if(n&&!p&&n.parentNode===r){var d=O(n);if(B=r,p=n,A=p.parentNode,Ee=p.nextSibling,gt=n,dt=i.group,b.dragged=p,ye={target:p,clientX:(o||t).clientX,clientY:(o||t).clientY},In=ye.clientX-d.left,Ln=ye.clientY-d.top,this._lastX=(o||t).clientX,this._lastY=(o||t).clientY,p.style["will-change"]="all",s=function(){if(z("delayEnded",a,{evt:t}),b.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!En&&a.nativeDraggable&&(p.draggable=!0),a._triggerDragStart(t,o),F({sortable:a,name:"choose",originalEvent:t}),X(p,i.chosenClass,!0)},i.ignore.split(",").forEach(function(c){Wn(p,c.trim(),qt)}),C(l,"dragover",ve),C(l,"mousemove",ve),C(l,"touchmove",ve),i.supportPointer?(C(l,"pointerup",a._onDrop),!this.nativeDraggable&&C(l,"pointercancel",a._onDrop)):(C(l,"mouseup",a._onDrop),C(l,"touchend",a._onDrop),C(l,"touchcancel",a._onDrop)),En&&this.nativeDraggable&&(this.options.touchStartThreshold=4,p.draggable=!0),z("delayStart",this,{evt:t}),i.delay&&(!i.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(et||ie))){if(b.eventCanceled){this._onDrop();return}i.supportPointer?(C(l,"pointerup",a._disableDelayedDrag),C(l,"pointercancel",a._disableDelayedDrag)):(C(l,"mouseup",a._disableDelayedDrag),C(l,"touchend",a._disableDelayedDrag),C(l,"touchcancel",a._disableDelayedDrag)),C(l,"mousemove",a._delayedDragTouchMoveHandler),C(l,"touchmove",a._delayedDragTouchMoveHandler),i.supportPointer&&C(l,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(s,i.delay)}else s()}},_delayedDragTouchMoveHandler:function(t){var o=t.touches?t.touches[0]:t;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){p&&qt(p),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;w(t,"mouseup",this._disableDelayedDrag),w(t,"touchend",this._disableDelayedDrag),w(t,"touchcancel",this._disableDelayedDrag),w(t,"pointerup",this._disableDelayedDrag),w(t,"pointercancel",this._disableDelayedDrag),w(t,"mousemove",this._delayedDragTouchMoveHandler),w(t,"touchmove",this._delayedDragTouchMoveHandler),w(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,o){o=o||t.pointerType=="touch"&&t,!this.nativeDraggable||o?this.options.supportPointer?C(document,"pointermove",this._onTouchMove):o?C(document,"touchmove",this._onTouchMove):C(document,"mousemove",this._onTouchMove):(C(p,"dragend",this),C(B,"dragstart",this._onDragStart));try{document.selection?yt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,o){if(Be=!1,B&&p){z("dragStarted",this,{evt:o}),this.nativeDraggable&&C(document,"dragover",ha);var n=this.options;!t&&X(p,n.dragClass,!1),X(p,n.ghostClass,!0),b.active=this,t&&this._appendGhost(),F({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(j){this._lastX=j.clientX,this._lastY=j.clientY,to();for(var t=document.elementFromPoint(j.clientX,j.clientY),o=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(j.clientX,j.clientY),t!==o);)o=t;if(p.parentNode[H]._isOutsideThisEl(t),o)do{if(o[H]){var n=void 0;if(n=o[H]._onDragOver({clientX:j.clientX,clientY:j.clientY,target:t,rootEl:o}),n&&!this.options.dragoverBubble)break}t=o}while(o=qn(o));no()}},_onTouchMove:function(t){if(ye){var o=this.options,n=o.fallbackTolerance,a=o.fallbackOffset,r=t.touches?t.touches[0]:t,i=E&&_e(E,!0),l=E&&i&&i.a,s=E&&i&&i.d,d=ut&&R&&Dn(R),c=(r.clientX-ye.clientX+a.x)/(l||1)+(d?d[0]-jt[0]:0)/(l||1),u=(r.clientY-ye.clientY+a.y)/(s||1)+(d?d[1]-jt[1]:0)/(s||1);if(!b.active&&!Be){if(n&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(E){i?(i.e+=c-(Yt||0),i.f+=u-(Ut||0)):i={a:1,b:0,c:0,d:1,e:c,f:u};var m="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");y(E,"webkitTransform",m),y(E,"mozTransform",m),y(E,"msTransform",m),y(E,"transform",m),Yt=c,Ut=u,j=r}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!E){var t=this.options.fallbackOnBody?document.body:B,o=O(p,!0,ut,!0,t),n=this.options;if(ut){for(R=t;y(R,"position")==="static"&&y(R,"transform")==="none"&&R!==document;)R=R.parentNode;R!==document.body&&R!==document.documentElement?(R===document&&(R=V()),o.top+=R.scrollTop,o.left+=R.scrollLeft):R=V(),jt=Dn(R)}E=p.cloneNode(!0),X(E,n.ghostClass,!1),X(E,n.fallbackClass,!0),X(E,n.dragClass,!0),y(E,"transition",""),y(E,"transform",""),y(E,"box-sizing","border-box"),y(E,"margin",0),y(E,"top",o.top),y(E,"left",o.left),y(E,"width",o.width),y(E,"height",o.height),y(E,"opacity","0.8"),y(E,"position",ut?"absolute":"fixed"),y(E,"zIndex","100000"),y(E,"pointerEvents","none"),b.ghost=E,t.appendChild(E),y(E,"transform-origin",In/parseInt(E.style.width)*100+"% "+Ln/parseInt(E.style.height)*100+"%")}},_onDragStart:function(t,o){var n=this,a=t.dataTransfer,r=n.options;if(z("dragStart",this,{evt:t}),b.eventCanceled){this._onDrop();return}z("setupClone",this),b.eventCanceled||(T=Kn(p),T.removeAttribute("id"),T.draggable=!1,T.style["will-change"]="",this._hideClone(),X(T,this.options.chosenClass,!1),b.clone=T),n.cloneId=yt(function(){z("clone",n),!b.eventCanceled&&(n.options.removeCloneOnHide||B.insertBefore(T,p),n._hideClone(),F({sortable:n,name:"clone"}))}),!o&&X(p,r.dragClass,!0),o?(kt=!0,n._loopId=setInterval(n._emulateDragOver,50)):(w(document,"mouseup",n._onDrop),w(document,"touchend",n._onDrop),w(document,"touchcancel",n._onDrop),a&&(a.effectAllowed="move",r.setData&&r.setData.call(n,a,p)),C(document,"drop",n),y(p,"transform","translateZ(0)")),Be=!0,n._dragStartId=yt(n._dragStarted.bind(n,o,t)),C(document,"selectstart",n),Fe=!0,window.getSelection().removeAllRanges(),Xe&&y(document.body,"user-select","none")},_onDragOver:function(t){var o=this.el,n=t.target,a,r,i,l=this.options,s=l.group,d=b.active,c=dt===s,u=l.sort,m=P||d,f,h=this,g=!1;if(tn)return;function I(Me,so){z(Me,h,K({evt:t,isOwner:c,axis:f?"vertical":"horizontal",revert:i,dragRect:a,targetRect:r,canSort:u,fromSortable:m,target:n,completed:L,onMove:function(gn,co){return mt(B,o,p,a,gn,O(gn),t,co)},changed:_},so))}function S(){I("dragOverAnimationCapture"),h.captureAnimationState(),h!==m&&m.captureAnimationState()}function L(Me){return I("dragOverCompleted",{insertion:Me}),Me&&(c?d._hideClone():d._showClone(h),h!==m&&(X(p,P?P.options.ghostClass:d.options.ghostClass,!1),X(p,l.ghostClass,!0)),P!==h&&h!==b.active?P=h:h===b.active&&P&&(P=null),m===h&&(h._ignoreWhileAnimating=n),h.animateAll(function(){I("dragOverAnimationComplete"),h._ignoreWhileAnimating=null}),h!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(n===p&&!p.animated||n===o&&!n.animated)&&(ke=null),!l.dragoverBubble&&!t.rootEl&&n!==document&&(p.parentNode[H]._isOutsideThisEl(t.target),!Me&&ve(t)),!l.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),g=!0}function _(){Y=U(p),de=U(p,l.draggable),F({sortable:h,name:"change",toEl:o,newIndex:Y,newDraggableIndex:de,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),n=W(n,l.draggable,o,!0),I("dragOver"),b.eventCanceled)return g;if(p.contains(t.target)||n.animated&&n.animatingX&&n.animatingY||h._ignoreWhileAnimating===n)return L(!1);if(kt=!1,d&&!l.disabled&&(c?u||(i=A!==B):P===this||(this.lastPutMode=dt.checkPull(this,d,p,t))&&s.checkPut(this,d,p,t))){if(f=this._getDirection(t,n)==="vertical",a=O(p),I("dragOverValid"),b.eventCanceled)return g;if(i)return A=B,S(),this._hideClone(),I("revert"),b.eventCanceled||(Ee?B.insertBefore(p,Ee):B.appendChild(p)),L(!0);var k=fn(o,l.draggable);if(!k||va(t,f,this)&&!k.animated){if(k===p)return L(!1);if(k&&o===t.target&&(n=k),n&&(r=O(n)),mt(B,o,p,a,n,r,t,!!n)!==!1)return S(),k&&k.nextSibling?o.insertBefore(p,k.nextSibling):o.appendChild(p),A=o,_(),L(!0)}else if(k&&ya(t,f,this)){var v=Oe(o,0,l,!0);if(v===p)return L(!1);if(n=v,r=O(n),mt(B,o,p,a,n,r,t,!1)!==!1)return S(),o.insertBefore(p,v),A=o,_(),L(!0)}else if(n.parentNode===o){r=O(n);var D=0,N,le=p.parentNode!==o,M=!fa(p.animated&&p.toRect||a,n.animated&&n.toRect||r,f),fe=f?"top":"left",ee=Cn(n,"top","top")||Cn(p,"top","top"),pe=ee?ee.scrollTop:void 0;ke!==n&&(N=r[fe],qe=!1,ct=!M&&l.invertSwap||le),D=Ea(t,n,r,f,M?1:l.swapThreshold,l.invertedSwapThreshold==null?l.swapThreshold:l.invertedSwapThreshold,ct,ke===n);var te;if(D!==0){var he=U(p);do he-=D,te=A.children[he];while(te&&(y(te,"display")==="none"||te===E))}if(D===0||te===n)return L(!1);ke=n,je=D;var Ne=n.nextElementSibling,se=!1;se=D===1;var nt=mt(B,o,p,a,n,r,t,se);if(nt!==!1)return(nt===1||nt===-1)&&(se=nt===1),tn=!0,setTimeout(ba,30),S(),se&&!Ne?o.appendChild(p):n.parentNode.insertBefore(p,se?Ne:n),ee&&Vn(ee,0,pe-ee.scrollTop),A=p.parentNode,N!==void 0&&!ct&&(bt=Math.abs(N-O(n)[fe])),_(),L(!0)}if(o.contains(p))return L(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){w(document,"mousemove",this._onTouchMove),w(document,"touchmove",this._onTouchMove),w(document,"pointermove",this._onTouchMove),w(document,"dragover",ve),w(document,"mousemove",ve),w(document,"touchmove",ve)},_offUpEvents:function(){var t=this.el.ownerDocument;w(t,"mouseup",this._onDrop),w(t,"touchend",this._onDrop),w(t,"pointerup",this._onDrop),w(t,"pointercancel",this._onDrop),w(t,"touchcancel",this._onDrop),w(document,"selectstart",this)},_onDrop:function(t){var o=this.el,n=this.options;if(Y=U(p),de=U(p,n.draggable),z("drop",this,{evt:t}),A=p&&p.parentNode,Y=U(p),de=U(p,n.draggable),b.eventCanceled){this._nulling();return}Be=!1,ct=!1,qe=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),nn(this.cloneId),nn(this._dragStartId),this.nativeDraggable&&(w(document,"drop",this),w(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Xe&&y(document.body,"user-select",""),y(p,"transform",""),t&&(Fe&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),E&&E.parentNode&&E.parentNode.removeChild(E),(B===A||P&&P.lastPutMode!=="clone")&&T&&T.parentNode&&T.parentNode.removeChild(T),p&&(this.nativeDraggable&&w(p,"dragend",this),qt(p),p.style["will-change"]="",Fe&&!Be&&X(p,P?P.options.ghostClass:this.options.ghostClass,!1),X(p,this.options.chosenClass,!1),F({sortable:this,name:"unchoose",toEl:A,newIndex:null,newDraggableIndex:null,originalEvent:t}),B!==A?(Y>=0&&(F({rootEl:A,name:"add",toEl:A,fromEl:B,originalEvent:t}),F({sortable:this,name:"remove",toEl:A,originalEvent:t}),F({rootEl:A,name:"sort",toEl:A,fromEl:B,originalEvent:t}),F({sortable:this,name:"sort",toEl:A,originalEvent:t})),P&&P.save()):Y!==Te&&Y>=0&&(F({sortable:this,name:"update",toEl:A,originalEvent:t}),F({sortable:this,name:"sort",toEl:A,originalEvent:t})),b.active&&((Y==null||Y===-1)&&(Y=Te,de=Ue),F({sortable:this,name:"end",toEl:A,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){z("nulling",this),B=p=A=E=Ee=T=gt=ce=ye=j=Fe=Y=de=Te=Ue=ke=je=P=dt=b.dragged=b.ghost=b.clone=b.active=null,Bt.forEach(function(t){t.checked=!0}),Bt.length=Yt=Ut=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":p&&(this._onDragOver(t),ga(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],o,n=this.el.children,a=0,r=n.length,i=this.options;a<r;a++)o=n[a],W(o,i.draggable,this.el,!1)&&t.push(o.getAttribute(i.dataIdAttr)||Ca(o));return t},sort:function(t,o){var n={},a=this.el;this.toArray().forEach(function(r,i){var l=a.children[i];W(l,this.options.draggable,a,!1)&&(n[r]=l)},this),o&&this.captureAnimationState(),t.forEach(function(r){n[r]&&(a.removeChild(n[r]),a.appendChild(n[r]))}),o&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,o){return W(t,o||this.options.draggable,this.el,!1)},option:function(t,o){var n=this.options;if(o===void 0)return n[t];var a=tt.modifyOption(this,t,o);typeof a<"u"?n[t]=a:n[t]=o,t==="group"&&eo(n)},destroy:function(){z("destroy",this);var t=this.el;t[H]=null,w(t,"mousedown",this._onTapStart),w(t,"touchstart",this._onTapStart),w(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(w(t,"dragover",this),w(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),St.splice(St.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!ce){if(z("hideClone",this),b.eventCanceled)return;y(T,"display","none"),this.options.removeCloneOnHide&&T.parentNode&&T.parentNode.removeChild(T),ce=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(ce){if(z("showClone",this),b.eventCanceled)return;p.parentNode==B&&!this.options.group.revertClone?B.insertBefore(T,p):Ee?B.insertBefore(T,Ee):B.appendChild(T),this.options.group.revertClone&&this.animate(p,T),y(T,"display",""),ce=!1}}};function ga(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function mt(e,t,o,n,a,r,i,l){var s,d=e[H],c=d.options.onMove,u;return window.CustomEvent&&!ie&&!et?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=t,s.from=e,s.dragged=o,s.draggedRect=n,s.related=a||t,s.relatedRect=r||O(t),s.willInsertAfter=l,s.originalEvent=i,e.dispatchEvent(s),c&&(u=c.call(d,s,i)),u}function qt(e){e.draggable=!1}function ba(){tn=!1}function ya(e,t,o){var n=O(Oe(o.el,0,o.options,!0)),a=Jn(o.el,o.options,E),r=10;return t?e.clientX<a.left-r||e.clientY<n.top&&e.clientX<n.right:e.clientY<a.top-r||e.clientY<n.bottom&&e.clientX<n.left}function va(e,t,o){var n=O(fn(o.el,o.options.draggable)),a=Jn(o.el,o.options,E),r=10;return t?e.clientX>a.right+r||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>a.bottom+r||e.clientX>n.right&&e.clientY>n.top}function Ea(e,t,o,n,a,r,i,l){var s=n?e.clientY:e.clientX,d=n?o.height:o.width,c=n?o.top:o.left,u=n?o.bottom:o.right,m=!1;if(!i){if(l&&bt<d*a){if(!qe&&(je===1?s>c+d*r/2:s<u-d*r/2)&&(qe=!0),qe)m=!0;else if(je===1?s<c+bt:s>u-bt)return-je}else if(s>c+d*(1-a)/2&&s<u-d*(1-a)/2)return wa(t)}return m=m||i,m&&(s<c+d*r/2||s>u-d*r/2)?s>c+d/2?1:-1:0}function wa(e){return U(p)<U(e)?1:-1}function Ca(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,n=0;o--;)n+=t.charCodeAt(o);return n.toString(36)}function Da(e){Bt.length=0;for(var t=e.getElementsByTagName("input"),o=t.length;o--;){var n=t[o];n.checked&&Bt.push(n)}}function yt(e){return setTimeout(e,0)}function nn(e){return clearTimeout(e)}Mt&&C(document,"touchmove",function(e){(b.active||Be)&&e.cancelable&&e.preventDefault()});b.utils={on:C,off:w,css:y,find:Wn,is:function(t,o){return!!W(t,o,t,!1)},extend:ra,throttle:Gn,closest:W,toggleClass:X,clone:Kn,index:U,nextTick:yt,cancelNextTick:nn,detectDirection:Zn,getChild:Oe,expando:H};b.get=function(e){return e[H]};b.mount=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];t[0].constructor===Array&&(t=t[0]),t.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(b.utils=K(K({},b.utils),n.utils)),tt.mount(n)})};b.create=function(e,t){return new b(e,t)};b.version=oa;var x=[],$e,on,an=!1,Wt,Gt,Tt,ze;function Ia(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(o){var n=o.originalEvent;this.sortable.nativeDraggable?C(document,"dragover",this._handleAutoScroll):this.options.supportPointer?C(document,"pointermove",this._handleFallbackAutoScroll):n.touches?C(document,"touchmove",this._handleFallbackAutoScroll):C(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var n=o.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?w(document,"dragover",this._handleAutoScroll):(w(document,"pointermove",this._handleFallbackAutoScroll),w(document,"touchmove",this._handleFallbackAutoScroll),w(document,"mousemove",this._handleFallbackAutoScroll)),Sn(),vt(),ia()},nulling:function(){Tt=on=$e=an=ze=Wt=Gt=null,x.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,n){var a=this,r=(o.touches?o.touches[0]:o).clientX,i=(o.touches?o.touches[0]:o).clientY,l=document.elementFromPoint(r,i);if(Tt=o,n||this.options.forceAutoScrollFallback||et||ie||Xe){Vt(o,this.options,l,n);var s=ue(l,!0);an&&(!ze||r!==Wt||i!==Gt)&&(ze&&Sn(),ze=setInterval(function(){var d=ue(document.elementFromPoint(r,i),!0);d!==s&&(s=d,vt()),Vt(o,a.options,d,n)},10),Wt=r,Gt=i)}else{if(!this.options.bubbleScroll||ue(l,!0)===V()){vt();return}Vt(o,this.options,ue(l,!1),!1)}}},re(e,{pluginName:"scroll",initializeByDefault:!0})}function vt(){x.forEach(function(e){clearInterval(e.pid)}),x=[]}function Sn(){clearInterval(ze)}var Vt=Gn(function(e,t,o,n){if(t.scroll){var a=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,i=t.scrollSensitivity,l=t.scrollSpeed,s=V(),d=!1,c;on!==o&&(on=o,vt(),$e=t.scroll,c=t.scrollFn,$e===!0&&($e=ue(o,!0)));var u=0,m=$e;do{var f=m,h=O(f),g=h.top,I=h.bottom,S=h.left,L=h.right,_=h.width,k=h.height,v=void 0,D=void 0,N=f.scrollWidth,le=f.scrollHeight,M=y(f),fe=f.scrollLeft,ee=f.scrollTop;f===s?(v=_<N&&(M.overflowX==="auto"||M.overflowX==="scroll"||M.overflowX==="visible"),D=k<le&&(M.overflowY==="auto"||M.overflowY==="scroll"||M.overflowY==="visible")):(v=_<N&&(M.overflowX==="auto"||M.overflowX==="scroll"),D=k<le&&(M.overflowY==="auto"||M.overflowY==="scroll"));var pe=v&&(Math.abs(L-a)<=i&&fe+_<N)-(Math.abs(S-a)<=i&&!!fe),te=D&&(Math.abs(I-r)<=i&&ee+k<le)-(Math.abs(g-r)<=i&&!!ee);if(!x[u])for(var he=0;he<=u;he++)x[he]||(x[he]={});(x[u].vx!=pe||x[u].vy!=te||x[u].el!==f)&&(x[u].el=f,x[u].vx=pe,x[u].vy=te,clearInterval(x[u].pid),(pe!=0||te!=0)&&(d=!0,x[u].pid=setInterval((function(){n&&this.layer===0&&b.active._onTouchMove(Tt);var Ne=x[this.layer].vy?x[this.layer].vy*l:0,se=x[this.layer].vx?x[this.layer].vx*l:0;typeof c=="function"&&c.call(b.dragged.parentNode[H],se,Ne,e,Tt,x[this.layer].el)!=="continue"||Vn(x[this.layer].el,se,Ne)}).bind({layer:u}),24))),u++}while(t.bubbleScroll&&m!==s&&(m=ue(m,!1)));an=d}},30),oo=function(t){var o=t.originalEvent,n=t.putSortable,a=t.dragEl,r=t.activeSortable,i=t.dispatchSortableEvent,l=t.hideGhostForTarget,s=t.unhideGhostForTarget;if(o){var d=n||r;l();var c=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,u=document.elementFromPoint(c.clientX,c.clientY);s(),d&&!d.el.contains(u)&&(i("spill"),this.onSpill({dragEl:a,putSortable:n}))}};function pn(){}pn.prototype={startIndex:null,dragStart:function(t){var o=t.oldDraggableIndex;this.startIndex=o},onSpill:function(t){var o=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var a=Oe(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(o,a):this.sortable.el.appendChild(o),this.sortable.animateAll(),n&&n.animateAll()},drop:oo};re(pn,{pluginName:"revertOnSpill"});function hn(){}hn.prototype={onSpill:function(t){var o=t.dragEl,n=t.putSortable,a=n||this.sortable;a.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),a.animateAll()},drop:oo};re(hn,{pluginName:"removeOnSpill"});b.mount(new Ia);b.mount(hn,pn);let rn=[],Et=null,We=null,Ae=0;function La(){ka(),Ba(),Ta()}function ka(){rn.forEach(e=>e.destroy()),rn=[],Et&&(Et.destroy(),Et=null),ao()}function Sa(){const e=document.getElementById("board-container");!e||We||(We=setInterval(()=>{if(!e)return;const t=e.getBoundingClientRect(),o=80,n=12;Ae>0&&(Ae<t.left+o&&e.scrollLeft>0?e.scrollLeft-=n:Ae>t.right-o&&e.scrollLeft<e.scrollWidth-e.clientWidth&&(e.scrollLeft+=n))},16))}function ao(){We&&(clearInterval(We),We=null),Ae=0}function ft(e){e.touches&&e.touches[0]?Ae=e.touches[0].clientX:e.clientX&&(Ae=e.clientX)}function Ba(){document.querySelectorAll(".tasks").forEach(t=>{const o=new b(t,{group:{name:"tasks",pull:!0,put:!0},animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"task-ghost",chosenClass:"task-chosen",dragClass:"task-drag",draggable:".task",forceFallback:!0,fallbackClass:"task-fallback",fallbackOnBody:!0,fallbackTolerance:0,swapThreshold:.65,emptyInsertThreshold:20,direction:"vertical",onStart:function(n){document.body.classList.add("dragging"),Sa(),document.addEventListener("touchmove",ft,{passive:!0}),document.addEventListener("mousemove",ft,{passive:!0})},onEnd:async function(n){document.body.classList.remove("dragging"),ao(),document.removeEventListener("touchmove",ft),document.removeEventListener("mousemove",ft),yo();const{renderBoard:a}=await ne(async()=>{const{renderBoard:r}=await Promise.resolve().then(()=>ae);return{renderBoard:r}},void 0,import.meta.url);a()}});rn.push(o)})}function Ta(){const e=document.getElementById("board-container");e&&(Et=new b(e,{animation:150,delay:150,delayOnTouchOnly:!0,touchStartThreshold:5,ghostClass:"column-ghost",chosenClass:"column-chosen",dragClass:"column-drag",handle:".column-drag-handle",draggable:".task-column",scrollSensitivity:80,scrollSpeed:15,forceFallback:!1,fallbackOnBody:!0,onStart:function(t){document.body.classList.add("dragging-column")},onEnd:function(t){document.body.classList.remove("dragging-column"),Do()}}))}let Bn=!1,ro="";function io(e){ro=(e||"").toString()}function _a(e,t,o){if(!t)return!0;const n=typeof e?.text=="string"?e.text:"",a=typeof e?.title=="string"&&e.title.trim()!==""?e.title:n,r=typeof e?.description=="string"?e.description:"",i=typeof e?.priority=="string"?e.priority:"";if(a.toLowerCase().includes(t)||r.toLowerCase().includes(t)||i.toLowerCase().includes(t))return!0;const l=Array.isArray(e?.labels)?e.labels:[];for(const s of l){const d=o.get(s);if(d&&d.includes(t))return!0}return!1}function Ge(e=null){document.querySelectorAll(".column-menu").forEach(t=>{e&&t===e||t.classList.add("hidden")})}function Aa(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=o.includes("T")?o:`${o}T00:00:00`,a=new Date(n);return Number.isNaN(a.getTime())?o:a.toLocaleDateString(t||void 0)}function xa(e,t){const o=(e||"").toString().trim();if(!o)return"";const n=new Date(o);return Number.isNaN(n.getTime())?o:n.toLocaleString(t||void 0)}function Oa(e){const t=(e?.creationDate||"").toString().trim();if(!t)return"";const o=new Date(t);if(Number.isNaN(o.getTime()))return"";const n=Date.now()-o.getTime(),a=Math.max(0,Math.floor(n/(1440*60*1e3)));return a>=30?`${Math.max(1,Math.floor(a/30))}M`:`${a}d`}function Pa(e,t){const o=document.createElement("li");o.classList.add("task"),o.draggable=!0,o.dataset.taskId=e.id,o.setAttribute("role","listitem"),o.setAttribute("aria-label",`Task: ${e.title||e.text||"Untitled"}`);const n=document.createElement("div");n.classList.add("task-labels"),n.setAttribute("role","list"),n.setAttribute("aria-label","Task labels");const a=Z();e.labels&&e.labels.length>0&&e.labels.forEach(v=>{const D=a.find(N=>N.id===v);if(D){const N=document.createElement("span");N.classList.add("task-label"),N.setAttribute("role","listitem"),N.style.backgroundColor=D.color,N.textContent=D.name,n.appendChild(N)}});const r=document.createElement("div");r.classList.add("task-header");const i=document.createElement("div");i.classList.add("task-title"),i.setAttribute("role","button"),i.setAttribute("tabindex","0");const l=typeof e.text=="string"?e.text:"";i.textContent=typeof e.title=="string"&&e.title.trim()!==""?e.title:l,i.addEventListener("click",()=>Ft(e.id)),i.addEventListener("keydown",v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),Ft(e.id))});const s=document.createElement("div");s.classList.add("task-actions");const d=document.createElement("button");d.classList.add("delete-task-btn"),d.setAttribute("aria-label","Delete task"),d.type="button";const c=document.createElement("span");c.dataset.lucide="trash-2",c.setAttribute("aria-hidden","true"),d.appendChild(c),d.addEventListener("click",async v=>{v.stopPropagation(),await Ce({title:"Delete Task",message:"Are you sure you want to delete this task?",confirmText:"Delete"})&&go(e.id)&&De()}),s.appendChild(d),r.appendChild(i),r.appendChild(s);const u=typeof e.description=="string"?e.description.trim():"",m=document.createElement("div");m.classList.add("task-description"),m.textContent=u,m.style.display=u?"block":"none",m.addEventListener("click",()=>Ft(e.id));const f=document.createElement("div");f.classList.add("task-meta");const h=t?.showPriority!==!1,g=t?.showDueDate!==!1;if(h){const v=typeof e.priority=="string"?e.priority:"medium",D=document.createElement("span");D.classList.add("task-priority",`priority-${v}`),D.textContent=v,D.setAttribute("aria-label",`Priority: ${v}`),f.appendChild(D)}if(g){const v=typeof e.dueDate=="string"?e.dueDate.trim():"",D=document.createElement("span");D.classList.add("task-date"),v?D.textContent="Due "+Aa(v,t?.locale):D.textContent="No due date",f.appendChild(D)}o.appendChild(r),o.appendChild(m),o.appendChild(n),f.childNodes.length>0&&o.appendChild(f);const I=t?.showChangeDate!==!1,S=t?.showAge!==!1,L=t?.locale,_=document.createElement("div");if(_.classList.add("task-footer"),I){const v=document.createElement("span");v.classList.add("task-change-date");const D=xa(e?.changeDate,L);v.textContent=D?`Updated ${D}`:"",_.appendChild(v)}if(S){const v=document.createElement("span");v.classList.add("task-age");const D=Oa(e);v.textContent=D?`Age ${D}`:"",_.appendChild(v)}return Array.from(_.childNodes).some(v=>(v.textContent||"").trim()!=="")&&o.appendChild(_),o}function Na(e){const t=document.createElement("article");t.classList.add("task-column"),t.dataset.column=e.id,t.draggable=!1,t.setAttribute("aria-labelledby",`column-title-${e.id}`),e?.color&&t.style.setProperty("--column-accent",e.color);const o=document.createElement("button");o.classList.add("column-drag-handle"),o.type="button",o.setAttribute("aria-label","Drag to reorder column");const n=document.createElement("span");n.dataset.lucide="grip-vertical",n.setAttribute("aria-hidden","true"),o.appendChild(n),o.title="Drag to reorder";const a=document.createElement("header");a.classList.add("column-header");const r=document.createElement("h2");r.id=`column-title-${e.id}`,r.textContent=e.name;const i=document.createElement("span");i.classList.add("task-counter"),i.dataset.columnId=e.id,i.textContent="0",i.setAttribute("aria-label","Task count");const l=document.createElement("div");l.classList.add("column-actions");const s=document.createElement("button");s.classList.add("add-task-btn-icon"),s.type="button",s.setAttribute("aria-label",`Add task to ${e.name}`);const d=document.createElement("span");d.dataset.lucide="plus",d.setAttribute("aria-hidden","true"),s.appendChild(d),s.title="Add task",s.addEventListener("click",()=>jo(e.id));const c=document.createElement("div");c.classList.add("column-menu-wrapper");const u=document.createElement("button");u.classList.add("column-menu-btn"),u.type="button",u.setAttribute("aria-haspopup","menu"),u.setAttribute("aria-expanded","false"),u.setAttribute("aria-label",`${e.name} column menu`);const m=document.createElement("span");m.dataset.lucide="ellipsis-vertical",m.setAttribute("aria-hidden","true"),u.appendChild(m),u.title="Column menu";const f=document.createElement("div");f.classList.add("column-menu","hidden"),f.setAttribute("role","menu");const h=document.createElement("button");h.classList.add("column-menu-item"),h.type="button",h.setAttribute("role","menuitem");const g=document.createElement("span");g.dataset.lucide="pencil",g.setAttribute("aria-hidden","true"),h.appendChild(g);const I=document.createTextNode(" Edit");h.appendChild(I),h.title="Edit column",h.addEventListener("click",v=>{v.stopPropagation(),Ge(),Wo(e.id)});const S=document.createElement("button");S.classList.add("column-menu-item","danger"),S.type="button",S.setAttribute("role","menuitem");const L=document.createElement("span");L.dataset.lucide="trash-2",L.setAttribute("aria-hidden","true"),S.appendChild(L);const _=document.createTextNode(" Delete");S.appendChild(_),S.title="Delete column",S.addEventListener("click",v=>{v.stopPropagation(),Ge(),(async()=>{if(Q().length<=1){await we({title:"Cannot Delete Column",message:"Cannot delete the last column."});return}const le=J().filter(pe=>pe.column===e.id),M=e?.name?`"${e.name}"`:"this column",fe=le.length>0?`Delete ${M}? This will also delete ${le.length} task(s).`:`Delete ${M}?`;await Ce({title:"Delete Column",message:fe,confirmText:"Delete"})&&Co(e.id)&&De()})()}),f.appendChild(h),f.appendChild(S),u.addEventListener("click",v=>{v.stopPropagation();const D=!f.classList.contains("hidden");Ge(),D?u.setAttribute("aria-expanded","false"):(f.classList.remove("hidden"),u.setAttribute("aria-expanded","true"))}),c.appendChild(u),c.appendChild(f),l.appendChild(s),l.appendChild(c),a.appendChild(o),a.appendChild(r),a.appendChild(i),a.appendChild(l);const k=document.createElement("ul");return k.classList.add("tasks"),k.setAttribute("role","list"),k.setAttribute("aria-label",`Tasks in ${e.name}`),t.appendChild(a),t.appendChild(k),t}function Ma(){const e=Q(),t=document.getElementById("task-column");t.innerHTML="",e.forEach(o=>{const n=document.createElement("option");n.value=o.id,n.textContent=o.name,t.appendChild(n)})}function De(){const e=Q(),t=J(),o=Z(),n=q(),a=new Map(o.map(d=>[d.id,(d.name||"").toString().trim().toLowerCase()])),r=(ro||"").toString().trim().toLowerCase(),i=r?t.filter(d=>_a(d,r,a)):t,l=document.getElementById("board-container");l.innerHTML="",[...e].sort((d,c)=>(d.order??0)-(c.order??0)).forEach(d=>{const c=Na(d);l.appendChild(c);const u=c.querySelector(".tasks"),m=c.querySelector(".task-counter"),f=i.filter(h=>h.column===d.id).sort((h,g)=>(h.order??0)-(g.order??0));f.forEach(h=>{u.appendChild(Pa(h,n))}),m.textContent=f.length}),La(),Ma(),xt(),Bn||(Bn=!0,document.addEventListener("click",()=>Ge()),document.addEventListener("keydown",d=>{d.key==="Escape"&&Ge()}))}const ae=Object.freeze(Object.defineProperty({__proto__:null,renderBoard:De,setBoardFilterQuery:io},Symbol.toStringTag,{value:"Module"})),lo="kanban-theme";function Ra(){const e=localStorage.getItem(lo);return e==="light"||e==="dark"?e:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Tn(e){document.documentElement.dataset.theme=e}function _n(e){const t=document.getElementById("theme-toggle-btn");if(!t)return;const o=e==="dark"?"light":"dark",n=o==="dark"?"Dark":"Light",a=o==="dark"?"moon":"sun";t.setAttribute("aria-pressed",String(e==="dark"));const r=t.querySelector("span[data-lucide]");r&&r.setAttribute("data-lucide",a);const i=Array.from(t.childNodes).filter(l=>l.nodeType===Node.TEXT_NODE);for(const l of i)l.remove();t.appendChild(document.createTextNode(` ${n}`)),xt()}function Fa(){const e=Ra();Tn(e),_n(e);const t=document.getElementById("theme-toggle-btn");t&&t.addEventListener("click",()=>{const n=(document.documentElement.dataset.theme==="dark"?"dark":"light")==="dark"?"light":"dark";Tn(n),localStorage.setItem(lo,n),_n(n)})}function $a(e){return(typeof e?.name=="string"?e.name.trim():"")||"Untitled board"}function An(e){const t=Pe(),o=dn();e.innerHTML="",t.forEach(n=>{const a=document.createElement("option");a.value=n.id,a.textContent=$a(n),e.appendChild(a)}),o&&(e.value=o)}function Kt(){const e=document.getElementById("brand-text")||document.querySelector(".brand-text");e&&(e.textContent=At())}function za(){const e=document.getElementById("board-create-modal"),t=document.getElementById("board-create-name");!e||!t||(t.value="",e.classList.remove("hidden"),t.focus())}function pt(){const e=document.getElementById("board-create-modal");e&&e.classList.add("hidden")}function Ha(){sn();const e=document.getElementById("board-select");if(!e)return;An(e),Kt(),document.addEventListener("kanban:open-board-create",()=>{za()}),e.addEventListener("change",()=>{const a=e.value;if(!a)return;wt(a),Kt(),De();const r=document.getElementById("board-controls-menu"),i=document.getElementById("desktop-menu-btn");r?.classList.remove("show"),i?.setAttribute("aria-expanded","false")});const t=document.getElementById("board-create-modal"),o=document.getElementById("board-create-form"),n=document.getElementById("cancel-board-create-btn");t&&(t.querySelector(".modal-backdrop")?.addEventListener("click",pt),t.addEventListener("keydown",r=>{r.key==="Escape"&&pt()})),n&&n.addEventListener("click",pt),o&&o.addEventListener("submit",async a=>{a.preventDefault();const r=document.getElementById("board-create-name"),i=(r?.value||"").trim();if(!i){await we({title:"Error",message:"Board name cannot be empty."}),r?.focus();return}const l=xn(i);wt(l.id),An(e),Kt(),De(),pt(),document.dispatchEvent(new CustomEvent("kanban:boards-changed"))})}function Xa(e){const t=[];for(const o of e){if(typeof o!="string")continue;const n=o.trim();n&&(t.includes(n)||t.push(n))}return t}function Ya(e){const t=typeof navigator<"u"&&typeof navigator.language=="string"?navigator.language:"en-US";return Xa([e,t,"en-US","en-GB","de-DE","fr-FR","es-ES","it-IT","pt-BR","ja-JP","zh-CN"])}function Ua(){document.getElementById("settings-modal")?.classList.remove("hidden")}function Jt(){document.getElementById("settings-modal")?.classList.add("hidden")}async function Se(e){On(e);const{renderBoard:t}=await ne(async()=>{const{renderBoard:o}=await Promise.resolve().then(()=>ae);return{renderBoard:o}},void 0,import.meta.url);t()}function ja(){const e=document.getElementById("settings-btn"),t=document.getElementById("settings-close-btn"),o=document.querySelector("#settings-modal .modal-backdrop"),n=document.getElementById("settings-show-priority"),a=document.getElementById("settings-show-due-date"),r=document.getElementById("settings-show-age"),i=document.getElementById("settings-show-change-date"),l=document.getElementById("settings-locale"),s=document.getElementById("settings-default-priority");if(!e||!t||!n||!a||!r||!i||!l||!s)return;function d(){const c=q();n.checked=c.showPriority!==!1,a.checked=c.showDueDate!==!1,r.checked=c.showAge!==!1,i.checked=c.showChangeDate!==!1;const u=Ya(c.locale);l.innerHTML="",u.forEach(m=>{const f=document.createElement("option");f.value=m,f.textContent=m,l.appendChild(f)}),l.value=c.locale,s.value=c.defaultPriority||"low"}e.addEventListener("click",()=>{d(),Ua()}),t.addEventListener("click",Jt),o?.addEventListener("click",Jt),document.addEventListener("keydown",c=>{const u=document.getElementById("settings-modal");!u||u.classList.contains("hidden")||c.key==="Escape"&&Jt()}),r.addEventListener("change",async()=>{const c=q();await Se({...c,showAge:!!r.checked})}),i.addEventListener("change",async()=>{const c=q();await Se({...c,showChangeDate:!!i.checked})}),n.addEventListener("change",async()=>{const c=q();await Se({...c,showPriority:!!n.checked})}),a.addEventListener("change",async()=>{const c=q();await Se({...c,showDueDate:!!a.checked})}),l.addEventListener("change",async()=>{const c=q();await Se({...c,locale:l.value})}),s.addEventListener("change",async()=>{const c=q();await Se({...c,defaultPriority:s.value})})}document.addEventListener("DOMContentLoaded",()=>{Fa(),ja();const e=document.getElementById("board-search-input");e&&e.addEventListener("input",()=>{io(e.value),De()}),Ha(),Zo(),document.getElementById("export-btn").addEventListener("click",async()=>{await Ce({title:"Export Board (Active Only)",message:`Export ONLY saves the current active board. It does NOT back up all boards.

To back up everything, export each board individually.

Continue with export?`,confirmText:"Export"})&&$o()}),document.getElementById("import-btn").addEventListener("click",async()=>{await Ce({title:"Import Board (New Board)",message:`Import will CREATE A NEW BOARD and switch to it. Your current active board will not be overwritten.

Continue with import?`,confirmText:"Import"})&&document.getElementById("import-file").click()}),document.getElementById("import-file").addEventListener("change",n=>{const a=n.target.files[0];a&&Ho(a),n.target.value=""});const t=document.getElementById("desktop-menu-btn"),o=document.getElementById("board-controls-menu");t&&o&&(t.addEventListener("click",n=>{n.stopPropagation();const a=t.getAttribute("aria-expanded")==="true";o.classList.toggle("show"),t.setAttribute("aria-expanded",String(!a)),document.querySelectorAll(".column-menu").forEach(r=>r.classList.add("hidden"))}),o.addEventListener("click",n=>{n.target.closest("select, option, input, textarea, label")||!n.target.closest('button, a, [role="menuitem"]')||(o.classList.remove("show"),t.setAttribute("aria-expanded","false"))}),document.addEventListener("click",n=>{!o.contains(n.target)&&!t.contains(n.target)&&(o.classList.remove("show"),t.setAttribute("aria-expanded","false"))})),De()});
